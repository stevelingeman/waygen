import{j as Ie,u as _e,c as tp}from"./index-Ch6acjUi.js";import{i as rp,j as np,k as ip,H as op,l as ap,T as sp,r as oe}from"./vendor-CgYbqmbV.js";import{b as up,i as So,d as Ku,g as _o,m as Cr,M as cp,e as ya}from"./mapbox-C3udIXGP.js";import{k as V,s as pt,n as Kr,o as Ot,q as Xe,r as U,_ as Ft,u as Pt,v as Eo,w as X,x as dt,y as Mt,z as Ju,A as Ve,B as lp,C as Yu,D as fp,E as Zu,F as pp,G as Xu,H as tr,I as Qu,J as ec,K as dp,L as tc,M as hp,N as yp,O as gp,e as wn,b as An,p as In,P as ga,f as vp}from"./turf-D8sFHwPo.js";import{c as mp}from"./utils-P9aiU5u9.js";/* empty css                           */var wo={exports:{}};const bp=function(e,t){const r={drag:[],click:[],mousemove:[],mousedown:[],mouseup:[],mouseout:[],keydown:[],keyup:[],touchstart:[],touchmove:[],touchend:[],tap:[]},n={on:function(o,a,c){if(r[o]===void 0)throw new Error(`Invalid event type: ${o}`);r[o].push({selector:a,fn:c})},render:function(o){t.store.featureChanged(o)}},i=function(o,a){const c=r[o];let u=c.length;for(;u--;){const h=c[u];if(h.selector(a)){h.fn.call(n,a),t.store.render(),t.ui.updateMapClasses();break}}};return e.start.call(n),{render:e.render,stop:function(){e.stop&&e.stop()},trash:function(){e.trash&&(e.trash(),t.store.render())},combineFeatures:function(){e.combineFeatures&&e.combineFeatures()},uncombineFeatures:function(){e.uncombineFeatures&&e.uncombineFeatures()},drag:function(o){i("drag",o)},click:function(o){i("click",o)},mousemove:function(o){i("mousemove",o)},mousedown:function(o){i("mousedown",o)},mouseup:function(o){i("mouseup",o)},mouseout:function(o){i("mouseout",o)},keydown:function(o){i("keydown",o)},keyup:function(o){i("keyup",o)},touchstart:function(o){i("touchstart",o)},touchmove:function(o){i("touchmove",o)},touchend:function(o){i("touchend",o)},tap:function(o){i("tap",o)}}};var Tp=bp,G={classes:{CONTROL_BASE:"mapboxgl-ctrl",CONTROL_BUTTON:"mapbox-gl-draw_ctrl-draw-btn",CONTROL_BUTTON_LINE:"mapbox-gl-draw_line",CONTROL_BUTTON_POLYGON:"mapbox-gl-draw_polygon",CONTROL_BUTTON_POINT:"mapbox-gl-draw_point",CONTROL_BUTTON_TRASH:"mapbox-gl-draw_trash",CONTROL_BUTTON_COMBINE_FEATURES:"mapbox-gl-draw_combine",CONTROL_BUTTON_UNCOMBINE_FEATURES:"mapbox-gl-draw_uncombine",CONTROL_GROUP:"mapboxgl-ctrl-group",ACTIVE_BUTTON:"active",BOX_SELECT:"mapbox-gl-draw_boxselect"},sources:{HOT:"mapbox-gl-draw-hot",COLD:"mapbox-gl-draw-cold"},cursors:{ADD:"add",MOVE:"move",DRAG:"drag",POINTER:"pointer",NONE:"none"},types:{POLYGON:"polygon",LINE:"line_string",POINT:"point"},geojsonTypes:{FEATURE:"Feature",POLYGON:"Polygon",LINE_STRING:"LineString",POINT:"Point",FEATURE_COLLECTION:"FeatureCollection",MULTI_PREFIX:"Multi",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon"},modes:{DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select",STATIC:"static"},events:{CREATE:"draw.create",DELETE:"draw.delete",UPDATE:"draw.update",SELECTION_CHANGE:"draw.selectionchange",MODE_CHANGE:"draw.modechange",ACTIONABLE:"draw.actionable",RENDER:"draw.render",COMBINE_FEATURES:"draw.combine",UNCOMBINE_FEATURES:"draw.uncombine"},updateActions:{MOVE:"move",CHANGE_COORDINATES:"change_coordinates"},meta:{FEATURE:"feature",MIDPOINT:"midpoint",VERTEX:"vertex"},activeStates:{ACTIVE:"true",INACTIVE:"false"},interactions:["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate"],LAT_MIN:-90,LAT_RENDERED_MIN:-85,LAT_MAX:90,LAT_RENDERED_MAX:85,LNG_MIN:-270,LNG_MAX:270};const Sp=up,eo=G,va={Point:0,LineString:1,Polygon:2};function _p(e,t){const r=va[e.geometry.type]-va[t.geometry.type];return r===0&&e.geometry.type===eo.geojsonTypes.POLYGON?e.area-t.area:r}function Ep(e){return e.map(t=>(t.geometry.type===eo.geojsonTypes.POLYGON&&(t.area=Sp.geometry({type:eo.geojsonTypes.FEATURE,property:{},geometry:t.geometry})),t)).sort(_p).map(t=>(delete t.area,t))}var wp=Ep;function Ap(e,t=0){return[[e.point.x-t,e.point.y-t],[e.point.x+t,e.point.y+t]]}var Ip=Ap;function Lt(e){if(this._items={},this._nums={},this._length=e?e.length:0,!!e)for(let t=0,r=e.length;t<r;t++)this.add(e[t]),e[t]!==void 0&&(typeof e[t]=="string"?this._items[e[t]]=t:this._nums[e[t]]=t)}Lt.prototype.add=function(e){return this.has(e)?this:(this._length++,typeof e=="string"?this._items[e]=this._length:this._nums[e]=this._length,this)};Lt.prototype.delete=function(e){return this.has(e)===!1?this:(this._length--,delete this._items[e],delete this._nums[e],this)};Lt.prototype.has=function(e){return typeof e!="string"&&typeof e!="number"?!1:this._items[e]!==void 0||this._nums[e]!==void 0};Lt.prototype.values=function(){const e=[];return Object.keys(this._items).forEach(t=>{e.push({k:t,v:this._items[t]})}),Object.keys(this._nums).forEach(t=>{e.push({k:JSON.parse(t),v:this._nums[t]})}),e.sort((t,r)=>t.v-r.v).map(t=>t.k)};Lt.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this};var Jr=Lt;const $p=wp,Cp=Ip,$n=G,Op=Jr,Fp=[$n.meta.FEATURE,$n.meta.MIDPOINT,$n.meta.VERTEX];var Yr={click:Pp,touch:Mp};function Pp(e,t,r){return rc(e,t,r,r.options.clickBuffer)}function Mp(e,t,r){return rc(e,t,r,r.options.touchBuffer)}function rc(e,t,r,n){if(r.map===null)return[];const i=e?Cp(e,n):t,o={};r.options.styles&&(o.layers=r.options.styles.map(h=>h.id));const a=r.map.queryRenderedFeatures(i,o).filter(h=>Fp.indexOf(h.properties.meta)!==-1),c=new Op,u=[];return a.forEach(h=>{const y=h.properties.id;c.has(y)||(c.add(y),u.push(h))}),$p(u)}const Lp=Yr,Ht=G;var Rp=function(t,r){const n=Lp.click(t,null,r),i={mouse:Ht.cursors.NONE};return n[0]&&(i.mouse=n[0].properties.active===Ht.activeStates.ACTIVE?Ht.cursors.MOVE:Ht.cursors.POINTER,i.feature=n[0].properties.meta),r.events.currentModeName().indexOf("draw")!==-1&&(i.mouse=Ht.cursors.ADD),r.ui.queueMapClasses(i),r.ui.updateMapClasses(),n[0]},nc=function(e,t){const r=e.x-t.x,n=e.y-t.y;return Math.sqrt(r*r+n*n)};const Np=nc,xp=4,Bp=12,Dp=500;var Up=function(t,r,n={}){const i=n.fineTolerance!=null?n.fineTolerance:xp,o=n.grossTolerance!=null?n.grossTolerance:Bp,a=n.interval!=null?n.interval:Dp;t.point=t.point||r.point,t.time=t.time||r.time;const c=Np(t.point,r.point);return c<i||c<o&&r.time-t.time<a};const kp=nc,qp=25,jp=250;var Gp=function(t,r,n={}){const i=n.tolerance!=null?n.tolerance:qp,o=n.interval!=null?n.interval:jp;return t.point=t.point||r.point,t.time=t.time||r.time,kp(t.point,r.point)<i&&r.time-t.time<o},ic={exports:{}},oc={exports:{}},ac={exports:{}},to=ac.exports=function(e,t){if(t||(t=16),e===void 0&&(e=128),e<=0)return"0";for(var r=Math.log(Math.pow(2,e))/Math.log(t),n=2;r===1/0;n*=2)r=Math.log(Math.pow(2,e/n))/Math.log(t)*n;for(var i=r-Math.floor(r),o="",n=0;n<Math.floor(r);n++){var a=Math.floor(Math.random()*t).toString(t);o=a+o}if(i){var c=Math.pow(t,i),a=Math.floor(Math.random()*c).toString(t);o=a+o}var u=parseInt(o,t);return u!==1/0&&u>=Math.pow(2,e)?to(e,t):o};to.rack=function(e,t,r){var n=function(o){var a=0;do{if(a++>10)if(r)e+=r;else throw new Error("too many ID collisions, use more bits");var c=to(e,t)}while(Object.hasOwnProperty.call(i,c));return i[c]=o,c},i=n.hats={};return n.get=function(o){return n.hats[o]},n.set=function(o,a){return n.hats[o]=a,n},n.bits=e||128,n.base=t||16,n};var Ao=ac.exports;const Vp=Ao,Or=G,Qe=function(e,t){this.ctx=e,this.properties=t.properties||{},this.coordinates=t.geometry.coordinates,this.id=t.id||Vp(),this.type=t.geometry.type};Qe.prototype.changed=function(){this.ctx.store.featureChanged(this.id)};Qe.prototype.incomingCoords=function(e){this.setCoordinates(e)};Qe.prototype.setCoordinates=function(e){this.coordinates=e,this.changed()};Qe.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.coordinates))};Qe.prototype.setProperty=function(e,t){this.properties[e]=t};Qe.prototype.toGeoJSON=function(){return JSON.parse(JSON.stringify({id:this.id,type:Or.geojsonTypes.FEATURE,properties:this.properties,geometry:{coordinates:this.getCoordinates(),type:this.type}}))};Qe.prototype.internal=function(e){const t={id:this.id,meta:Or.meta.FEATURE,"meta:type":this.type,active:Or.activeStates.INACTIVE,mode:e};if(this.ctx.options.userProperties)for(const r in this.properties)t[`user_${r}`]=this.properties[r];return{type:Or.geojsonTypes.FEATURE,properties:t,geometry:{coordinates:this.getCoordinates(),type:this.type}}};var Zr=Qe;const sc=Zr,rr=function(e,t){sc.call(this,e,t)};rr.prototype=Object.create(sc.prototype);rr.prototype.isValid=function(){return typeof this.coordinates[0]=="number"&&typeof this.coordinates[1]=="number"};rr.prototype.updateCoordinate=function(e,t,r){arguments.length===3?this.coordinates=[t,r]:this.coordinates=[e,t],this.changed()};rr.prototype.getCoordinate=function(){return this.getCoordinates()};var Io=rr;const uc=Zr,ht=function(e,t){uc.call(this,e,t)};ht.prototype=Object.create(uc.prototype);ht.prototype.isValid=function(){return this.coordinates.length>1};ht.prototype.addCoordinate=function(e,t,r){this.changed();const n=parseInt(e,10);this.coordinates.splice(n,0,[t,r])};ht.prototype.getCoordinate=function(e){const t=parseInt(e,10);return JSON.parse(JSON.stringify(this.coordinates[t]))};ht.prototype.removeCoordinate=function(e){this.changed(),this.coordinates.splice(parseInt(e,10),1)};ht.prototype.updateCoordinate=function(e,t,r){const n=parseInt(e,10);this.coordinates[n]=[t,r],this.changed()};var $o=ht;const cc=Zr,xe=function(e,t){cc.call(this,e,t),this.coordinates=this.coordinates.map(r=>r.slice(0,-1))};xe.prototype=Object.create(cc.prototype);xe.prototype.isValid=function(){return this.coordinates.length===0?!1:this.coordinates.every(e=>e.length>2)};xe.prototype.incomingCoords=function(e){this.coordinates=e.map(t=>t.slice(0,-1)),this.changed()};xe.prototype.setCoordinates=function(e){this.coordinates=e,this.changed()};xe.prototype.addCoordinate=function(e,t,r){this.changed();const n=e.split(".").map(o=>parseInt(o,10));this.coordinates[n[0]].splice(n[1],0,[t,r])};xe.prototype.removeCoordinate=function(e){this.changed();const t=e.split(".").map(n=>parseInt(n,10)),r=this.coordinates[t[0]];r&&(r.splice(t[1],1),r.length<3&&this.coordinates.splice(t[0],1))};xe.prototype.getCoordinate=function(e){const t=e.split(".").map(n=>parseInt(n,10)),r=this.coordinates[t[0]];return JSON.parse(JSON.stringify(r[t[1]]))};xe.prototype.getCoordinates=function(){return this.coordinates.map(e=>e.concat([e[0]]))};xe.prototype.updateCoordinate=function(e,t,r){this.changed();const n=e.split("."),i=parseInt(n[0],10),o=parseInt(n[1],10);this.coordinates[i]===void 0&&(this.coordinates[i]=[]),this.coordinates[i][o]=[t,r]};var Co=xe;const lc=Zr,fc=G,Wp=Ao,zp={MultiPoint:Io,MultiLineString:$o,MultiPolygon:Co},Xr=(e,t,r,n,i)=>{const o=r.split("."),a=parseInt(o[0],10),c=o[1]?o.slice(1).join("."):null;return e[a][t](c,n,i)},Fe=function(e,t){if(lc.call(this,e,t),delete this.coordinates,this.model=zp[t.geometry.type],this.model===void 0)throw new TypeError(`${t.geometry.type} is not a valid type`);this.features=this._coordinatesToFeatures(t.geometry.coordinates)};Fe.prototype=Object.create(lc.prototype);Fe.prototype._coordinatesToFeatures=function(e){const t=this.model.bind(this);return e.map(r=>new t(this.ctx,{id:Wp(),type:fc.geojsonTypes.FEATURE,properties:{},geometry:{coordinates:r,type:this.type.replace("Multi","")}}))};Fe.prototype.isValid=function(){return this.features.every(e=>e.isValid())};Fe.prototype.setCoordinates=function(e){this.features=this._coordinatesToFeatures(e),this.changed()};Fe.prototype.getCoordinate=function(e){return Xr(this.features,"getCoordinate",e)};Fe.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.features.map(e=>e.type===fc.geojsonTypes.POLYGON?e.getCoordinates():e.coordinates)))};Fe.prototype.updateCoordinate=function(e,t,r){Xr(this.features,"updateCoordinate",e,t,r),this.changed()};Fe.prototype.addCoordinate=function(e,t,r){Xr(this.features,"addCoordinate",e,t,r),this.changed()};Fe.prototype.removeCoordinate=function(e){Xr(this.features,"removeCoordinate",e),this.changed()};Fe.prototype.getFeatures=function(){return this.features};var Fr=Fe;const It=G,Hp=Yr,pc=Io,dc=$o,hc=Co,yc=Fr,ie=oc.exports=function(e){this.map=e.map,this.drawConfig=JSON.parse(JSON.stringify(e.options||{})),this._ctx=e};ie.prototype.setSelected=function(e){return this._ctx.store.setSelected(e)};ie.prototype.setSelectedCoordinates=function(e){this._ctx.store.setSelectedCoordinates(e),e.reduce((t,r)=>(t[r.feature_id]===void 0&&(t[r.feature_id]=!0,this._ctx.store.get(r.feature_id).changed()),t),{})};ie.prototype.getSelected=function(){return this._ctx.store.getSelected()};ie.prototype.getSelectedIds=function(){return this._ctx.store.getSelectedIds()};ie.prototype.isSelected=function(e){return this._ctx.store.isSelected(e)};ie.prototype.getFeature=function(e){return this._ctx.store.get(e)};ie.prototype.select=function(e){return this._ctx.store.select(e)};ie.prototype.deselect=function(e){return this._ctx.store.deselect(e)};ie.prototype.deleteFeature=function(e,t={}){return this._ctx.store.delete(e,t)};ie.prototype.addFeature=function(e){return this._ctx.store.add(e)};ie.prototype.clearSelectedFeatures=function(){return this._ctx.store.clearSelected()};ie.prototype.clearSelectedCoordinates=function(){return this._ctx.store.clearSelectedCoordinates()};ie.prototype.setActionableState=function(e={}){const t={trash:e.trash||!1,combineFeatures:e.combineFeatures||!1,uncombineFeatures:e.uncombineFeatures||!1};return this._ctx.events.actionable(t)};ie.prototype.changeMode=function(e,t={},r={}){return this._ctx.events.changeMode(e,t,r)};ie.prototype.updateUIClasses=function(e){return this._ctx.ui.queueMapClasses(e)};ie.prototype.activateUIButton=function(e){return this._ctx.ui.setActiveButton(e)};ie.prototype.featuresAt=function(e,t,r="click"){if(r!=="click"&&r!=="touch")throw new Error("invalid buffer type");return Hp[r](e,t,this._ctx)};ie.prototype.newFeature=function(e){const t=e.geometry.type;return t===It.geojsonTypes.POINT?new pc(this._ctx,e):t===It.geojsonTypes.LINE_STRING?new dc(this._ctx,e):t===It.geojsonTypes.POLYGON?new hc(this._ctx,e):new yc(this._ctx,e)};ie.prototype.isInstanceOf=function(e,t){if(e===It.geojsonTypes.POINT)return t instanceof pc;if(e===It.geojsonTypes.LINE_STRING)return t instanceof dc;if(e===It.geojsonTypes.POLYGON)return t instanceof hc;if(e==="MultiFeature")return t instanceof yc;throw new Error(`Unknown feature class: ${e}`)};ie.prototype.doRender=function(e){return this._ctx.store.featureChanged(e)};var Kp=oc.exports;const ue=ic.exports=Kp;ue.prototype.onSetup=function(){};ue.prototype.onDrag=function(){};ue.prototype.onClick=function(){};ue.prototype.onMouseMove=function(){};ue.prototype.onMouseDown=function(){};ue.prototype.onMouseUp=function(){};ue.prototype.onMouseOut=function(){};ue.prototype.onKeyUp=function(){};ue.prototype.onKeyDown=function(){};ue.prototype.onTouchStart=function(){};ue.prototype.onTouchMove=function(){};ue.prototype.onTouchEnd=function(){};ue.prototype.onTap=function(){};ue.prototype.onStop=function(){};ue.prototype.onTrash=function(){};ue.prototype.onCombineFeature=function(){};ue.prototype.onUncombineFeature=function(){};ue.prototype.toDisplayFeatures=function(){throw new Error("You must overwrite toDisplayFeatures")};var Jp=ic.exports;const Yp=Jp,gc={drag:"onDrag",click:"onClick",mousemove:"onMouseMove",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseout:"onMouseOut",keyup:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",tap:"onTap"},Zp=Object.keys(gc);var Xp=function(e){const t=Object.keys(e);return function(r,n={}){let i={};const o=t.reduce((c,u)=>(c[u]=e[u],c),new Yp(r));function a(c){return function(u){o[c](i,u)}}return{start:function(){i=o.onSetup(n),Zp.forEach(c=>{const u=gc[c];let h=()=>!1;e[u]&&(h=()=>!0),this.on(c,h,a(u))})},stop:function(){o.onStop(i)},trash:function(){o.onTrash(i)},combineFeatures:function(){o.onCombineFeatures(i)},uncombineFeatures:function(){o.onUncombineFeatures(i)},render:function(c,u){o.toDisplayFeatures(i,c,u)}}}};const ma=Tp,Cn=Rp,ba=Yr,Ta=Up,Sa=Gp,St=G,Qp=Xp;var ed=function(e){const t=Object.keys(e.options.modes).reduce((l,p)=>(l[p]=Qp(e.options.modes[p]),l),{});let r={},n={};const i={};let o=null,a=null;i.drag=function(l,p){p({point:l.point,time:new Date().getTime()})?(e.ui.queueMapClasses({mouse:St.cursors.DRAG}),a.drag(l)):l.originalEvent.stopPropagation()},i.mousedrag=function(l){i.drag(l,p=>!Ta(r,p))},i.touchdrag=function(l){i.drag(l,p=>!Sa(n,p))},i.mousemove=function(l){if((l.originalEvent.buttons!==void 0?l.originalEvent.buttons:l.originalEvent.which)===1)return i.mousedrag(l);const _=Cn(l,e);l.featureTarget=_,a.mousemove(l)},i.mousedown=function(l){r={time:new Date().getTime(),point:l.point};const p=Cn(l,e);l.featureTarget=p,a.mousedown(l)},i.mouseup=function(l){const p=Cn(l,e);l.featureTarget=p,Ta(r,{point:l.point,time:new Date().getTime()})?a.click(l):a.mouseup(l)},i.mouseout=function(l){a.mouseout(l)},i.touchstart=function(l){if(l.originalEvent.preventDefault(),!e.options.touchEnabled)return;n={time:new Date().getTime(),point:l.point};const p=ba.touch(l,null,e)[0];l.featureTarget=p,a.touchstart(l)},i.touchmove=function(l){if(l.originalEvent.preventDefault(),!!e.options.touchEnabled)return a.touchmove(l),i.touchdrag(l)},i.touchend=function(l){if(l.originalEvent.preventDefault(),!e.options.touchEnabled)return;const p=ba.touch(l,null,e)[0];l.featureTarget=p,Sa(n,{time:new Date().getTime(),point:l.point})?a.tap(l):a.touchend(l)};const c=l=>!(l===8||l===46||l>=48&&l<=57);i.keydown=function(l){(l.srcElement||l.target).classList[0]==="mapboxgl-canvas"&&((l.keyCode===8||l.keyCode===46)&&e.options.controls.trash?(l.preventDefault(),a.trash()):c(l.keyCode)?a.keydown(l):l.keyCode===49&&e.options.controls.point?u(St.modes.DRAW_POINT):l.keyCode===50&&e.options.controls.line_string?u(St.modes.DRAW_LINE_STRING):l.keyCode===51&&e.options.controls.polygon&&u(St.modes.DRAW_POLYGON))},i.keyup=function(l){c(l.keyCode)&&a.keyup(l)},i.zoomend=function(){e.store.changeZoom()},i.data=function(l){if(l.dataType==="style"){const{setup:p,map:_,options:w,store:A}=e;w.styles.some(O=>_.getLayer(O.id))||(p.addLayers(),A.setDirty(),A.render())}};function u(l,p,_={}){a.stop();const w=t[l];if(w===void 0)throw new Error(`${l} is not valid`);o=l;const A=w(e,p);a=ma(A,e),_.silent||e.map.fire(St.events.MODE_CHANGE,{mode:l}),e.store.setDirty(),e.store.render()}const h={trash:!1,combineFeatures:!1,uncombineFeatures:!1};function y(l){let p=!1;Object.keys(l).forEach(_=>{if(h[_]===void 0)throw new Error("Invalid action type");h[_]!==l[_]&&(p=!0),h[_]=l[_]}),p&&e.map.fire(St.events.ACTIONABLE,{actions:h})}return{start:function(){o=e.options.defaultMode,a=ma(t[o](e),e)},changeMode:u,actionable:y,currentModeName:function(){return o},currentModeRender:function(l,p){return a.render(l,p)},fire:function(l,p){i[l]&&i[l](p)},addEventListeners:function(){e.map.on("mousemove",i.mousemove),e.map.on("mousedown",i.mousedown),e.map.on("mouseup",i.mouseup),e.map.on("data",i.data),e.map.on("touchmove",i.touchmove),e.map.on("touchstart",i.touchstart),e.map.on("touchend",i.touchend),e.container.addEventListener("mouseout",i.mouseout),e.options.keybindings&&(e.container.addEventListener("keydown",i.keydown),e.container.addEventListener("keyup",i.keyup))},removeEventListeners:function(){e.map.off("mousemove",i.mousemove),e.map.off("mousedown",i.mousedown),e.map.off("mouseup",i.mouseup),e.map.off("data",i.data),e.map.off("touchmove",i.touchmove),e.map.off("touchstart",i.touchstart),e.map.off("touchend",i.touchend),e.container.removeEventListener("mouseout",i.mouseout),e.options.keybindings&&(e.container.removeEventListener("keydown",i.keydown),e.container.removeEventListener("keyup",i.keyup))},trash:function(l){a.trash(l)},combineFeatures:function(){a.combineFeatures()},uncombineFeatures:function(){a.uncombineFeatures()},getMode:function(){return o}}},vc={exports:{}};function td(e,t,r){let n,i;function o(){n=!1,i&&(a.apply(r,i),i=!1)}function a(){n?i=arguments:(n=!0,e.apply(r,arguments),setTimeout(o,t))}return a}var rd=td;function nd(e){return[].concat(e).filter(t=>t!==void 0)}var id=nd;const Me=G;var od=function(){const t=this;if(!(t.ctx.map&&t.ctx.map.getSource(Me.sources.HOT)!==void 0))return h();const n=t.ctx.events.currentModeName();t.ctx.ui.queueMapClasses({mode:n});let i=[],o=[];t.isDirty?o=t.getAllIds():(i=t.getChangedIds().filter(y=>t.get(y)!==void 0),o=t.sources.hot.filter(y=>y.properties.id&&i.indexOf(y.properties.id)===-1&&t.get(y.properties.id)!==void 0).map(y=>y.properties.id)),t.sources.hot=[];const a=t.sources.cold.length;t.sources.cold=t.isDirty?[]:t.sources.cold.filter(y=>{const b=y.properties.id||y.properties.parent;return i.indexOf(b)===-1});const c=a!==t.sources.cold.length||o.length>0;i.forEach(y=>u(y,"hot")),o.forEach(y=>u(y,"cold"));function u(y,b){const p=t.get(y).internal(n);t.ctx.events.currentModeRender(p,_=>{t.sources[b].push(_)})}if(c&&t.ctx.map.getSource(Me.sources.COLD).setData({type:Me.geojsonTypes.FEATURE_COLLECTION,features:t.sources.cold}),t.ctx.map.getSource(Me.sources.HOT).setData({type:Me.geojsonTypes.FEATURE_COLLECTION,features:t.sources.hot}),t._emitSelectionChange&&(t.ctx.map.fire(Me.events.SELECTION_CHANGE,{features:t.getSelected().map(y=>y.toGeoJSON()),points:t.getSelectedCoordinates().map(y=>({type:Me.geojsonTypes.FEATURE,properties:{},geometry:{type:Me.geojsonTypes.POINT,coordinates:y.coordinates}}))}),t._emitSelectionChange=!1),t._deletedFeaturesToEmit.length){const y=t._deletedFeaturesToEmit.map(b=>b.toGeoJSON());t._deletedFeaturesToEmit=[],t.ctx.map.fire(Me.events.DELETE,{features:y})}h(),t.ctx.map.fire(Me.events.RENDER,{});function h(){t.isDirty=!1,t.clearChangedIds()}};const ad=rd,Qr=id,On=Jr,sd=od,ud=G.interactions,J=vc.exports=function(e){this._features={},this._featureIds=new On,this._selectedFeatureIds=new On,this._selectedCoordinates=[],this._changedFeatureIds=new On,this._deletedFeaturesToEmit=[],this._emitSelectionChange=!1,this._mapInitialConfig={},this.ctx=e,this.sources={hot:[],cold:[]},this.render=ad(sd,16,this),this.isDirty=!1};J.prototype.createRenderBatch=function(){const e=this.render;let t=0;return this.render=function(){t++},()=>{this.render=e,t>0&&this.render()}};J.prototype.setDirty=function(){return this.isDirty=!0,this};J.prototype.featureChanged=function(e){return this._changedFeatureIds.add(e),this};J.prototype.getChangedIds=function(){return this._changedFeatureIds.values()};J.prototype.clearChangedIds=function(){return this._changedFeatureIds.clear(),this};J.prototype.getAllIds=function(){return this._featureIds.values()};J.prototype.add=function(e){return this.featureChanged(e.id),this._features[e.id]=e,this._featureIds.add(e.id),this};J.prototype.delete=function(e,t={}){return Qr(e).forEach(r=>{this._featureIds.has(r)&&(this._featureIds.delete(r),this._selectedFeatureIds.delete(r),t.silent||this._deletedFeaturesToEmit.indexOf(this._features[r])===-1&&this._deletedFeaturesToEmit.push(this._features[r]),delete this._features[r],this.isDirty=!0)}),mc.call(this,t),this};J.prototype.get=function(e){return this._features[e]};J.prototype.getAll=function(){return Object.keys(this._features).map(e=>this._features[e])};J.prototype.select=function(e,t={}){return Qr(e).forEach(r=>{this._selectedFeatureIds.has(r)||(this._selectedFeatureIds.add(r),this._changedFeatureIds.add(r),t.silent||(this._emitSelectionChange=!0))}),this};J.prototype.deselect=function(e,t={}){return Qr(e).forEach(r=>{this._selectedFeatureIds.has(r)&&(this._selectedFeatureIds.delete(r),this._changedFeatureIds.add(r),t.silent||(this._emitSelectionChange=!0))}),mc.call(this,t),this};J.prototype.clearSelected=function(e={}){return this.deselect(this._selectedFeatureIds.values(),{silent:e.silent}),this};J.prototype.setSelected=function(e,t={}){return e=Qr(e),this.deselect(this._selectedFeatureIds.values().filter(r=>e.indexOf(r)===-1),{silent:t.silent}),this.select(e.filter(r=>!this._selectedFeatureIds.has(r)),{silent:t.silent}),this};J.prototype.setSelectedCoordinates=function(e){return this._selectedCoordinates=e,this._emitSelectionChange=!0,this};J.prototype.clearSelectedCoordinates=function(){return this._selectedCoordinates=[],this._emitSelectionChange=!0,this};J.prototype.getSelectedIds=function(){return this._selectedFeatureIds.values()};J.prototype.getSelected=function(){return this._selectedFeatureIds.values().map(e=>this.get(e))};J.prototype.getSelectedCoordinates=function(){return this._selectedCoordinates.map(t=>({coordinates:this.get(t.feature_id).getCoordinate(t.coord_path)}))};J.prototype.isSelected=function(e){return this._selectedFeatureIds.has(e)};J.prototype.setFeatureProperty=function(e,t,r){this.get(e).setProperty(t,r),this.featureChanged(e)};function mc(e){const t=this._selectedCoordinates.filter(r=>this._selectedFeatureIds.has(r.feature_id));this._selectedCoordinates.length!==t.length&&!e.silent&&(this._emitSelectionChange=!0),this._selectedCoordinates=t}J.prototype.storeMapConfig=function(){ud.forEach(e=>{this.ctx.map[e]&&(this._mapInitialConfig[e]=this.ctx.map[e].isEnabled())})};J.prototype.restoreMapConfig=function(){Object.keys(this._mapInitialConfig).forEach(e=>{this._mapInitialConfig[e]?this.ctx.map[e].enable():this.ctx.map[e].disable()})};J.prototype.getInitialConfigValue=function(e){return this._mapInitialConfig[e]!==void 0?this._mapInitialConfig[e]:!0};var cd=vc.exports;const _a=So,Z=G,ld=["mode","feature","mouse"];var fd=function(e){const t={};let r=null,n={mode:null,feature:null,mouse:null},i={mode:null,feature:null,mouse:null};function o(){a({mode:null,feature:null,mouse:null}),c()}function a(p){i=_a(i,p)}function c(){if(!e.container)return;const p=[],_=[];ld.forEach(w=>{i[w]!==n[w]&&(p.push(`${w}-${n[w]}`),i[w]!==null&&_.push(`${w}-${i[w]}`))}),p.length>0&&e.container.classList.remove.apply(e.container.classList,p),_.length>0&&e.container.classList.add.apply(e.container.classList,_),n=_a(n,i)}function u(p,_={}){const w=document.createElement("button");return w.className=`${Z.classes.CONTROL_BUTTON} ${_.className}`,w.setAttribute("title",_.title),_.container.appendChild(w),w.addEventListener("click",A=>{if(A.preventDefault(),A.stopPropagation(),A.target===r){h();return}y(p),_.onActivate()},!0),w}function h(){r&&(r.classList.remove(Z.classes.ACTIVE_BUTTON),r=null)}function y(p){h();const _=t[p];_&&_&&p!=="trash"&&(_.classList.add(Z.classes.ACTIVE_BUTTON),r=_)}function b(){const p=e.options.controls,_=document.createElement("div");return _.className=`${Z.classes.CONTROL_GROUP} ${Z.classes.CONTROL_BASE}`,p&&(p[Z.types.LINE]&&(t[Z.types.LINE]=u(Z.types.LINE,{container:_,className:Z.classes.CONTROL_BUTTON_LINE,title:`LineString tool ${e.options.keybindings?"(l)":""}`,onActivate:()=>e.events.changeMode(Z.modes.DRAW_LINE_STRING)})),p[Z.types.POLYGON]&&(t[Z.types.POLYGON]=u(Z.types.POLYGON,{container:_,className:Z.classes.CONTROL_BUTTON_POLYGON,title:`Polygon tool ${e.options.keybindings?"(p)":""}`,onActivate:()=>e.events.changeMode(Z.modes.DRAW_POLYGON)})),p[Z.types.POINT]&&(t[Z.types.POINT]=u(Z.types.POINT,{container:_,className:Z.classes.CONTROL_BUTTON_POINT,title:`Marker tool ${e.options.keybindings?"(m)":""}`,onActivate:()=>e.events.changeMode(Z.modes.DRAW_POINT)})),p.trash&&(t.trash=u("trash",{container:_,className:Z.classes.CONTROL_BUTTON_TRASH,title:"Delete",onActivate:()=>{e.events.trash()}})),p.combine_features&&(t.combine_features=u("combineFeatures",{container:_,className:Z.classes.CONTROL_BUTTON_COMBINE_FEATURES,title:"Combine",onActivate:()=>{e.events.combineFeatures()}})),p.uncombine_features&&(t.uncombine_features=u("uncombineFeatures",{container:_,className:Z.classes.CONTROL_BUTTON_UNCOMBINE_FEATURES,title:"Uncombine",onActivate:()=>{e.events.uncombineFeatures()}}))),_}function l(){Object.keys(t).forEach(p=>{const _=t[p];_.parentNode&&_.parentNode.removeChild(_),delete t[p]})}return{setActiveButton:y,queueMapClasses:a,updateMapClasses:c,clearMapClasses:o,addButtons:b,removeButtons:l}};const pd=ed,dd=cd,hd=fd,Ye=G,yd=So;var gd=function(e){let t=null,r=null;const n={onRemove:function(){return e.map.off("load",n.connect),clearInterval(r),n.removeLayers(),e.store.restoreMapConfig(),e.ui.removeButtons(),e.events.removeEventListeners(),e.ui.clearMapClasses(),e.map=null,e.container=null,e.store=null,t&&t.parentNode&&t.parentNode.removeChild(t),t=null,this},connect:function(){e.map.off("load",n.connect),clearInterval(r),n.addLayers(),e.store.storeMapConfig(),e.events.addEventListeners()},onAdd:function(i){{const o=i.fire;i.fire=function(a,c){let u=arguments;return o.length===1&&arguments.length!==1&&(u=[yd({},{type:a},c)]),o.apply(i,u)}}return e.map=i,e.events=pd(e),e.ui=hd(e),e.container=i.getContainer(),e.store=new dd(e),t=e.ui.addButtons(),e.options.boxSelect&&(i.boxZoom.disable(),i.dragPan.disable(),i.dragPan.enable()),i.loaded()?n.connect():(i.on("load",n.connect),r=setInterval(()=>{i.loaded()&&n.connect()},16)),e.events.start(),t},addLayers:function(){e.map.addSource(Ye.sources.COLD,{data:{type:Ye.geojsonTypes.FEATURE_COLLECTION,features:[]},type:"geojson"}),e.map.addSource(Ye.sources.HOT,{data:{type:Ye.geojsonTypes.FEATURE_COLLECTION,features:[]},type:"geojson"}),e.options.styles.forEach(i=>{e.map.addLayer(i)}),e.store.setDirty(!0),e.store.render()},removeLayers:function(){e.options.styles.forEach(i=>{e.map.getLayer(i.id)&&e.map.removeLayer(i.id)}),e.map.getSource(Ye.sources.COLD)&&e.map.removeSource(Ye.sources.COLD),e.map.getSource(Ye.sources.HOT)&&e.map.removeSource(Ye.sources.HOT)}};return e.setup=n,n},vd=[{id:"gl-draw-polygon-fill-inactive",type:"fill",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#3bb2d0","fill-outline-color":"#3bb2d0","fill-opacity":.1}},{id:"gl-draw-polygon-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"#fbb03b","fill-outline-color":"#fbb03b","fill-opacity":.1}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-stroke-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","active","true"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-polygon-and-line-vertex-stroke-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-color":"#fff"}},{id:"gl-draw-polygon-and-line-vertex-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-point-point-stroke-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-opacity":1,"circle-color":"#fff"}},{id:"gl-draw-point-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#3bb2d0"}},{id:"gl-draw-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["==","active","true"],["!=","meta","midpoint"]],paint:{"circle-radius":7,"circle-color":"#fff"}},{id:"gl-draw-point-active",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","true"]],paint:{"circle-radius":5,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","mode","static"],["==","$type","Polygon"]],paint:{"fill-color":"#404040","fill-outline-color":"#404040","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","mode","static"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-line-static",type:"line",filter:["all",["==","mode","static"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-point-static",type:"circle",filter:["all",["==","mode","static"],["==","$type","Point"]],paint:{"circle-radius":5,"circle-color":"#404040"}}];const _t=G;var Rt={isOfMetaType:function(e){return function(t){const r=t.featureTarget;return!r||!r.properties?!1:r.properties.meta===e}},isShiftMousedown:function(e){return!e.originalEvent||!e.originalEvent.shiftKey?!1:e.originalEvent.button===0},isActiveFeature:function(e){return!e.featureTarget||!e.featureTarget.properties?!1:e.featureTarget.properties.active===_t.activeStates.ACTIVE&&e.featureTarget.properties.meta===_t.meta.FEATURE},isInactiveFeature:function(e){return!e.featureTarget||!e.featureTarget.properties?!1:e.featureTarget.properties.active===_t.activeStates.INACTIVE&&e.featureTarget.properties.meta===_t.meta.FEATURE},noTarget:function(e){return e.featureTarget===void 0},isFeature:function(e){return!e.featureTarget||!e.featureTarget.properties?!1:e.featureTarget.properties.meta===_t.meta.FEATURE},isVertex:function(e){const t=e.featureTarget;return!t||!t.properties?!1:t.properties.meta===_t.meta.VERTEX},isShiftDown:function(e){return e.originalEvent?e.originalEvent.shiftKey===!0:!1},isEscapeKey:function(e){return e.keyCode===27},isEnterKey:function(e){return e.keyCode===13},true:function(){return!0}},md=$t;function $t(e,t){this.x=e,this.y=t}$t.prototype={clone:function(){return new $t(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,r=e.y-this.y;return t*t+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[0]*this.x+e[1]*this.y,r=e[2]*this.x+e[3]*this.y;return this.x=t,this.y=r,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),r=Math.sin(e),n=t*this.x-r*this.y,i=r*this.x+t*this.y;return this.x=n,this.y=i,this},_rotateAround:function(e,t){var r=Math.cos(e),n=Math.sin(e),i=t.x+r*(this.x-t.x)-n*(this.y-t.y),o=t.y+n*(this.x-t.x)+r*(this.y-t.y);return this.x=i,this.y=o,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}};$t.convert=function(e){return e instanceof $t?e:Array.isArray(e)?new $t(e[0],e[1]):e};const bd=md;function Td(e,t){const r=t.getBoundingClientRect();return new bd(e.clientX-r.left-(t.clientLeft||0),e.clientY-r.top-(t.clientTop||0))}var Sd=Td;const Kt=G;var en=function(e,t,r,n){return{type:Kt.geojsonTypes.FEATURE,properties:{meta:Kt.meta.VERTEX,parent:e,coord_path:r,active:n?Kt.activeStates.ACTIVE:Kt.activeStates.INACTIVE},geometry:{type:Kt.geojsonTypes.POINT,coordinates:t}}};const ut=G;var _d=function(e,t,r,n){const i=t.geometry.coordinates,o=r.geometry.coordinates;if(i[1]>ut.LAT_RENDERED_MAX||i[1]<ut.LAT_RENDERED_MIN||o[1]>ut.LAT_RENDERED_MAX||o[1]<ut.LAT_RENDERED_MIN)return null;const a=n.project([i[0],i[1]]),c=n.project([o[0],o[1]]),u=n.unproject([(a.x+c.x)/2,(a.y+c.y)/2]);return{type:ut.geojsonTypes.FEATURE,properties:{meta:ut.meta.MIDPOINT,parent:e,lng:u.lng,lat:u.lat,coord_path:r.properties.coord_path},geometry:{type:ut.geojsonTypes.POINT,coordinates:[u.lng,u.lat]}}};const Ea=en,Ed=_d,Et=G;function bc(e,t={},r=null){const{type:n,coordinates:i}=e.geometry,o=e.properties&&e.properties.id;let a=[];n===Et.geojsonTypes.POINT?a.push(Ea(o,i,r,u(r))):n===Et.geojsonTypes.POLYGON?i.forEach((y,b)=>{c(y,r!==null?`${r}.${b}`:String(b))}):n===Et.geojsonTypes.LINE_STRING?c(i,r):n.indexOf(Et.geojsonTypes.MULTI_PREFIX)===0&&h();function c(y,b){let l="",p=null;y.forEach((_,w)=>{const A=b!=null?`${b}.${w}`:String(w),R=Ea(o,_,A,u(A));if(t.midpoints&&p){const m=Ed(o,p,R,t.map);m&&a.push(m)}p=R;const O=JSON.stringify(_);l!==O&&a.push(R),w===0&&(l=O)})}function u(y){return t.selectedPaths?t.selectedPaths.indexOf(y)!==-1:!1}function h(){const y=n.replace(Et.geojsonTypes.MULTI_PREFIX,"");i.forEach((b,l)=>{const p={type:Et.geojsonTypes.FEATURE,properties:e.properties,geometry:{type:y,coordinates:b}};a=a.concat(bc(p,t,l))})}return a}var tn=bc,Nt={enable(e){setTimeout(()=>{!e.map||!e.map.doubleClickZoom||!e._ctx||!e._ctx.store||!e._ctx.store.getInitialConfigValue||e._ctx.store.getInitialConfigValue("doubleClickZoom")&&e.map.doubleClickZoom.enable()},0)},disable(e){setTimeout(()=>{!e.map||!e.map.doubleClickZoom||e.map.doubleClickZoom.disable()},0)}},rn={exports:{}},wd=function e(t){switch(t&&t.type||null){case"FeatureCollection":return t.features=t.features.reduce(function(r,n){return r.concat(e(n))},[]),t;case"Feature":return t.geometry?e(t.geometry).map(function(r){var n={type:"Feature",properties:JSON.parse(JSON.stringify(t.properties)),geometry:r};return t.id!==void 0&&(n.id=t.id),n}):t;case"MultiPoint":return t.coordinates.map(function(r){return{type:"Point",coordinates:r}});case"MultiPolygon":return t.coordinates.map(function(r){return{type:"Polygon",coordinates:r}});case"MultiLineString":return t.coordinates.map(function(r){return{type:"LineString",coordinates:r}});case"GeometryCollection":return t.geometries.map(e).reduce(function(r,n){return r.concat(n)},[]);case"Point":case"Polygon":case"LineString":return[t]}},Ad=function(t){return r(t);function r(n){return Array.isArray(n)&&n.length&&typeof n[0]=="number"?[n]:n.reduce(function(i,o){return Array.isArray(o)&&Array.isArray(o[0])?i.concat(r(o)):(i.push(o),i)},[])}},Id=Ku,$d=wd,Cd=Ad,Od=function(e){if(!e)return[];var t=$d(Id(e)),r=[];return t.features.forEach(function(n){n.geometry&&(r=r.concat(Cd(n.geometry.coordinates)))}),r},Tc=Function.prototype.toString,At=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,ro,Pr;if(typeof At=="function"&&typeof Object.defineProperty=="function")try{ro=Object.defineProperty({},"length",{get:function(){throw Pr}}),Pr={},At(function(){throw 42},null,ro)}catch(e){e!==Pr&&(At=null)}else At=null;var Fd=/^\s*class\b/,no=function(t){try{var r=Tc.call(t);return Fd.test(r)}catch{return!1}},Fn=function(t){try{return no(t)?!1:(Tc.call(t),!0)}catch{return!1}},Mr=Object.prototype.toString,Pd="[object Object]",Md="[object Function]",Ld="[object GeneratorFunction]",Rd="[object HTMLAllCollection]",Nd="[object HTML document.all class]",xd="[object HTMLCollection]",Bd=typeof Symbol=="function"&&!!Symbol.toStringTag,Dd=!(0 in[,]),io=function(){return!1};if(typeof document=="object"){var Ud=document.all;Mr.call(Ud)===Mr.call(document.all)&&(io=function(t){if((Dd||!t)&&(typeof t>"u"||typeof t=="object"))try{var r=Mr.call(t);return(r===Rd||r===Nd||r===xd||r===Pd)&&t("")==null}catch{}return!1})}var nn=At?function(t){if(io(t))return!0;if(!t||typeof t!="function"&&typeof t!="object")return!1;try{At(t,null,ro)}catch(r){if(r!==Pr)return!1}return!no(t)&&Fn(t)}:function(t){if(io(t))return!0;if(!t||typeof t!="function"&&typeof t!="object")return!1;if(Bd)return Fn(t);if(no(t))return!1;var r=Mr.call(t);return r!==Md&&r!==Ld&&!/^\[object HTML/.test(r)?!1:Fn(t)},kd=nn,qd=Object.prototype.toString,Sc=Object.prototype.hasOwnProperty,jd=function(t,r,n){for(var i=0,o=t.length;i<o;i++)Sc.call(t,i)&&(n==null?r(t[i],i,t):r.call(n,t[i],i,t))},Gd=function(t,r,n){for(var i=0,o=t.length;i<o;i++)n==null?r(t.charAt(i),i,t):r.call(n,t.charAt(i),i,t)},Vd=function(t,r,n){for(var i in t)Sc.call(t,i)&&(n==null?r(t[i],i,t):r.call(n,t[i],i,t))};function Wd(e){return qd.call(e)==="[object Array]"}var Oo=function(t,r,n){if(!kd(r))throw new TypeError("iterator must be a function");var i;arguments.length>=3&&(i=n),Wd(t)?jd(t,r,i):typeof t=="string"?Gd(t,r,i):Vd(t,r,i)},_c=["Float16Array","Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"],Pn=_c,zd=typeof globalThis>"u"?window:globalThis,nr=function(){for(var t=[],r=0;r<Pn.length;r++)typeof zd[Pn[r]]=="function"&&(t[t.length]=Pn[r]);return t},Rr=Oo,Hd=nr,wa=Xe,Fo=V,Lr=Kr,yr=Ot,Kd=Fo("Object.prototype.toString"),Ec=pt(),Aa=typeof globalThis>"u"?window:globalThis,oo=Hd(),Po=Fo("String.prototype.slice"),Jd=Fo("Array.prototype.indexOf",!0)||function(t,r){for(var n=0;n<t.length;n+=1)if(t[n]===r)return n;return-1},Nr={__proto__:null};Ec&&Lr&&yr?Rr(oo,function(e){var t=new Aa[e];if(Symbol.toStringTag in t&&yr){var r=yr(t),n=Lr(r,Symbol.toStringTag);if(!n&&r){var i=yr(r);n=Lr(i,Symbol.toStringTag)}Nr["$"+e]=wa(n.get)}}):Rr(oo,function(e){var t=new Aa[e],r=t.slice||t.set;r&&(Nr["$"+e]=wa(r))});var Yd=function(t){var r=!1;return Rr(Nr,function(n,i){if(!r)try{"$"+n(t)===i&&(r=Po(i,1))}catch{}}),r},Zd=function(t){var r=!1;return Rr(Nr,function(n,i){if(!r)try{n(t),r=Po(i,1)}catch{}}),r},xt=function(t){if(!t||typeof t!="object")return!1;if(!Ec){var r=Po(Kd(t),8,-1);return Jd(oo,r)>-1?r:r!=="Object"?!1:Zd(t)}return Lr?Yd(t):null};const Xd={},Qd=Object.freeze(Object.defineProperty({__proto__:null,default:Xd},Symbol.toStringTag,{value:"Module"})),ao=_o(Qd);var Mo=typeof Map=="function"&&Map.prototype,Mn=Object.getOwnPropertyDescriptor&&Mo?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,xr=Mo&&Mn&&typeof Mn.get=="function"?Mn.get:null,Ia=Mo&&Map.prototype.forEach,Lo=typeof Set=="function"&&Set.prototype,Ln=Object.getOwnPropertyDescriptor&&Lo?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,Br=Lo&&Ln&&typeof Ln.get=="function"?Ln.get:null,$a=Lo&&Set.prototype.forEach,eh=typeof WeakMap=="function"&&WeakMap.prototype,Xt=eh?WeakMap.prototype.has:null,th=typeof WeakSet=="function"&&WeakSet.prototype,Qt=th?WeakSet.prototype.has:null,rh=typeof WeakRef=="function"&&WeakRef.prototype,Ca=rh?WeakRef.prototype.deref:null,nh=Boolean.prototype.valueOf,ih=Object.prototype.toString,oh=Function.prototype.toString,ah=String.prototype.match,Ro=String.prototype.slice,Ze=String.prototype.replace,sh=String.prototype.toUpperCase,Oa=String.prototype.toLowerCase,wc=RegExp.prototype.test,Fa=Array.prototype.concat,Le=Array.prototype.join,uh=Array.prototype.slice,Pa=Math.floor,so=typeof BigInt=="function"?BigInt.prototype.valueOf:null,Rn=Object.getOwnPropertySymbols,uo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,Ct=typeof Symbol=="function"&&typeof Symbol.iterator=="object",er=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Ct||!0)?Symbol.toStringTag:null,Ac=Object.prototype.propertyIsEnumerable,Ma=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null);function La(e,t){if(e===1/0||e===-1/0||e!==e||e&&e>-1e3&&e<1e3||wc.call(/e/,t))return t;var r=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof e=="number"){var n=e<0?-Pa(-e):Pa(e);if(n!==e){var i=String(n),o=Ro.call(t,i.length+1);return Ze.call(i,r,"$&_")+"."+Ze.call(Ze.call(o,/([0-9]{3})/g,"$&_"),/_$/,"")}}return Ze.call(t,r,"$&_")}var co=ao,Ra=co.custom,Na=Cc(Ra)?Ra:null,Ic={__proto__:null,double:'"',single:"'"},ch={__proto__:null,double:/(["\\])/g,single:/(['\\])/g},lh=function e(t,r,n,i){var o=r||{};if(Ge(o,"quoteStyle")&&!Ge(Ic,o.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Ge(o,"maxStringLength")&&(typeof o.maxStringLength=="number"?o.maxStringLength<0&&o.maxStringLength!==1/0:o.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var a=Ge(o,"customInspect")?o.customInspect:!0;if(typeof a!="boolean"&&a!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Ge(o,"indent")&&o.indent!==null&&o.indent!=="	"&&!(parseInt(o.indent,10)===o.indent&&o.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Ge(o,"numericSeparator")&&typeof o.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var c=o.numericSeparator;if(typeof t>"u")return"undefined";if(t===null)return"null";if(typeof t=="boolean")return t?"true":"false";if(typeof t=="string")return Fc(t,o);if(typeof t=="number"){if(t===0)return 1/0/t>0?"0":"-0";var u=String(t);return c?La(t,u):u}if(typeof t=="bigint"){var h=String(t)+"n";return c?La(t,h):h}var y=typeof o.depth>"u"?5:o.depth;if(typeof n>"u"&&(n=0),n>=y&&y>0&&typeof t=="object")return lo(t)?"[Array]":"[Object]";var b=Ch(o,n);if(typeof i>"u")i=[];else if(Oc(i,t)>=0)return"[Circular]";function l(E,N,j){if(N&&(i=uh.call(i),i.push(N)),j){var Q={depth:o.depth};return Ge(o,"quoteStyle")&&(Q.quoteStyle=o.quoteStyle),e(E,Q,n+1,i)}return e(E,o,n+1,i)}if(typeof t=="function"&&!xa(t)){var p=bh(t),_=gr(t,l);return"[Function"+(p?": "+p:" (anonymous)")+"]"+(_.length>0?" { "+Le.call(_,", ")+" }":"")}if(Cc(t)){var w=Ct?Ze.call(String(t),/^(Symbol\(.*\))_[^)]*$/,"$1"):uo.call(t);return typeof t=="object"&&!Ct?Jt(w):w}if(Ah(t)){for(var A="<"+Oa.call(String(t.nodeName)),R=t.attributes||[],O=0;O<R.length;O++)A+=" "+R[O].name+"="+$c(fh(R[O].value),"double",o);return A+=">",t.childNodes&&t.childNodes.length&&(A+="..."),A+="</"+Oa.call(String(t.nodeName))+">",A}if(lo(t)){if(t.length===0)return"[]";var m=gr(t,l);return b&&!$h(m)?"["+fo(m,b)+"]":"[ "+Le.call(m,", ")+" ]"}if(dh(t)){var I=gr(t,l);return!("cause"in Error.prototype)&&"cause"in t&&!Ac.call(t,"cause")?"{ ["+String(t)+"] "+Le.call(Fa.call("[cause]: "+l(t.cause),I),", ")+" }":I.length===0?"["+String(t)+"]":"{ ["+String(t)+"] "+Le.call(I,", ")+" }"}if(typeof t=="object"&&a){if(Na&&typeof t[Na]=="function"&&co)return co(t,{depth:y-n});if(a!=="symbol"&&typeof t.inspect=="function")return t.inspect()}if(Th(t)){var $=[];return Ia&&Ia.call(t,function(E,N){$.push(l(N,t,!0)+" => "+l(E,t))}),Ba("Map",xr.call(t),$,b)}if(Eh(t)){var P=[];return $a&&$a.call(t,function(E){P.push(l(E,t))}),Ba("Set",Br.call(t),P,b)}if(Sh(t))return Nn("WeakMap");if(wh(t))return Nn("WeakSet");if(_h(t))return Nn("WeakRef");if(yh(t))return Jt(l(Number(t)));if(vh(t))return Jt(l(so.call(t)));if(gh(t))return Jt(nh.call(t));if(hh(t))return Jt(l(String(t)));if(typeof window<"u"&&t===window)return"{ [object Window] }";if(typeof globalThis<"u"&&t===globalThis||typeof window<"u"&&t===window)return"{ [object globalThis] }";if(!ph(t)&&!xa(t)){var C=gr(t,l),B=Ma?Ma(t)===Object.prototype:t instanceof Object||t.constructor===Object,f=t instanceof Object?"":"null prototype",S=!B&&er&&Object(t)===t&&er in t?Ro.call(et(t),8,-1):f?"Object":"",g=B||typeof t.constructor!="function"?"":t.constructor.name?t.constructor.name+" ":"",v=g+(S||f?"["+Le.call(Fa.call([],S||[],f||[]),": ")+"] ":"");return C.length===0?v+"{}":b?v+"{"+fo(C,b)+"}":v+"{ "+Le.call(C,", ")+" }"}return String(t)};function $c(e,t,r){var n=r.quoteStyle||t,i=Ic[n];return i+e+i}function fh(e){return Ze.call(String(e),/"/g,"&quot;")}function yt(e){return!er||!(typeof e=="object"&&(er in e||typeof e[er]<"u"))}function lo(e){return et(e)==="[object Array]"&&yt(e)}function ph(e){return et(e)==="[object Date]"&&yt(e)}function xa(e){return et(e)==="[object RegExp]"&&yt(e)}function dh(e){return et(e)==="[object Error]"&&yt(e)}function hh(e){return et(e)==="[object String]"&&yt(e)}function yh(e){return et(e)==="[object Number]"&&yt(e)}function gh(e){return et(e)==="[object Boolean]"&&yt(e)}function Cc(e){if(Ct)return e&&typeof e=="object"&&e instanceof Symbol;if(typeof e=="symbol")return!0;if(!e||typeof e!="object"||!uo)return!1;try{return uo.call(e),!0}catch{}return!1}function vh(e){if(!e||typeof e!="object"||!so)return!1;try{return so.call(e),!0}catch{}return!1}var mh=Object.prototype.hasOwnProperty||function(e){return e in this};function Ge(e,t){return mh.call(e,t)}function et(e){return ih.call(e)}function bh(e){if(e.name)return e.name;var t=ah.call(oh.call(e),/^function\s*([\w$]+)/);return t?t[1]:null}function Oc(e,t){if(e.indexOf)return e.indexOf(t);for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}function Th(e){if(!xr||!e||typeof e!="object")return!1;try{xr.call(e);try{Br.call(e)}catch{return!0}return e instanceof Map}catch{}return!1}function Sh(e){if(!Xt||!e||typeof e!="object")return!1;try{Xt.call(e,Xt);try{Qt.call(e,Qt)}catch{return!0}return e instanceof WeakMap}catch{}return!1}function _h(e){if(!Ca||!e||typeof e!="object")return!1;try{return Ca.call(e),!0}catch{}return!1}function Eh(e){if(!Br||!e||typeof e!="object")return!1;try{Br.call(e);try{xr.call(e)}catch{return!0}return e instanceof Set}catch{}return!1}function wh(e){if(!Qt||!e||typeof e!="object")return!1;try{Qt.call(e,Qt);try{Xt.call(e,Xt)}catch{return!0}return e instanceof WeakSet}catch{}return!1}function Ah(e){return!e||typeof e!="object"?!1:typeof HTMLElement<"u"&&e instanceof HTMLElement?!0:typeof e.nodeName=="string"&&typeof e.getAttribute=="function"}function Fc(e,t){if(e.length>t.maxStringLength){var r=e.length-t.maxStringLength,n="... "+r+" more character"+(r>1?"s":"");return Fc(Ro.call(e,0,t.maxStringLength),t)+n}var i=ch[t.quoteStyle||"single"];i.lastIndex=0;var o=Ze.call(Ze.call(e,i,"\\$1"),/[\x00-\x1f]/g,Ih);return $c(o,"single",t)}function Ih(e){var t=e.charCodeAt(0),r={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return r?"\\"+r:"\\x"+(t<16?"0":"")+sh.call(t.toString(16))}function Jt(e){return"Object("+e+")"}function Nn(e){return e+" { ? }"}function Ba(e,t,r,n){var i=n?fo(r,n):Le.call(r,", ");return e+" ("+t+") {"+i+"}"}function $h(e){for(var t=0;t<e.length;t++)if(Oc(e[t],`
`)>=0)return!1;return!0}function Ch(e,t){var r;if(e.indent==="	")r="	";else if(typeof e.indent=="number"&&e.indent>0)r=Le.call(Array(e.indent+1)," ");else return null;return{base:r,prev:Le.call(Array(t+1),r)}}function fo(e,t){if(e.length===0)return"";var r=`
`+t.prev+t.base;return r+Le.call(e,","+r)+`
`+t.prev}function gr(e,t){var r=lo(e),n=[];if(r){n.length=e.length;for(var i=0;i<e.length;i++)n[i]=Ge(e,i)?t(e[i],e):""}var o=typeof Rn=="function"?Rn(e):[],a;if(Ct){a={};for(var c=0;c<o.length;c++)a["$"+o[c]]=o[c]}for(var u in e)Ge(e,u)&&(r&&String(Number(u))===u&&u<e.length||Ct&&a["$"+u]instanceof Symbol||(wc.call(/[^\w$]/,u)?n.push(t(u,e)+": "+t(e[u],e)):n.push(u+": "+t(e[u],e))));if(typeof Rn=="function")for(var h=0;h<o.length;h++)Ac.call(e,o[h])&&n.push("["+t(o[h])+"]: "+t(e[o[h]],e));return n}var on=function(t){return typeof t=="string"||typeof t=="symbol"},tt=function(t){return!!t&&(typeof t=="function"||typeof t=="object")},Da=U,Oh=lh,Fh=on,Ph=tt,Mh=function(t,r){if(!Ph(t))throw new Da("Assertion failed: Type(O) is not Object");if(!Fh(r))throw new Da("Assertion failed: P is not a Property Key, got "+Oh(r));return t[r]},Lh=Ft,We=function(t){return(typeof t=="number"||typeof t=="bigint")&&!Lh(t)&&t!==1/0&&t!==-1/0},Rh=Eo,Nh=Pt,xh=Ft,Bh=We,an=function(t){if(typeof t!="number"||xh(t)||!Bh(t))return!1;var r=Rh(t);return Nh(r)===r},xn,Ua;function Bt(){if(Ua)return xn;Ua=1;var e=Xe,t=V,r=X,n=r("%ArrayBuffer%",!0),i=t("ArrayBuffer.prototype.byteLength",!0),o=t("Object.prototype.toString"),a=!!n&&!i&&new n(0).slice,c=!!a&&e(a);return xn=i||c?function(h){if(!h||typeof h!="object")return!1;try{return i?i(h):c(h,0),!0}catch{return!1}}:n?function(h){return o(h)==="[object ArrayBuffer]"}:function(h){return!1},xn}var Dh=V,ka=Dh("ArrayBuffer.prototype.byteLength",!0),Uh=Bt(),Pc=function(t){return Uh(t)?ka?ka(t):t.byteLength:NaN},Bn,qa;function ir(){if(qa)return Bn;qa=1;var e=V,t=e("SharedArrayBuffer.prototype.byteLength",!0);return Bn=t?function(n){if(!n||typeof n!="object")return!1;try{return t(n),!0}catch{return!1}}:function(n){return!1},Bn}var kh=U,qh=Pc,jh=nr(),Gh=V,Vh=Bt(),Wh=ir(),zh=Gh("SharedArrayBuffer.prototype.byteLength",!0),Dt=function(t){var r=Wh(t);if(!Vh(t)&&!r)throw new kh("Assertion failed: `arrayBuffer` must be an Object with an [[ArrayBufferData]] internal slot");if((r?zh:qh)(t)===0)try{new window[jh[0]](t)}catch(n){return!!n&&n.name==="TypeError"}return!1},Dn,ja;function Mc(){if(ja)return Dn;ja=1;var e=U,t=dt,r=tt,n=on;return Dn=function(o,a){if(!r(o))throw new e("Assertion failed: `O` must be an Object");if(!n(a))throw new e("Assertion failed: `P` must be a Property Key");return t(o,a)},Dn}var Hh=X,Lc=Hh("%Array%"),Kh=!Lc.isArray&&V("Object.prototype.toString"),Rc=Lc.isArray||function(t){return Kh(t)==="[object Array]"},No=Rc,Un,Ga;function Nc(){return Ga||(Ga=1,Un=function(t){return t==="BIGUINT64"||t==="BIGINT64"}),Un}var kn,Va;function Jh(){return Va||(Va=1,kn=function(t){return t==="UINT8"||t==="UINT8C"||t==="UINT16"||t==="UINT32"||t==="BIGUINT64"}),kn}var qn,Wa;function Yh(){if(Wa)return qn;Wa=1;var e=Mt;return qn=function(r){var n=r[3]&128?-1:1,i=(r[3]&127)<<1|r[2]>>7,o=(r[2]&127)<<16|r[1]<<8|r[0];return i===0&&o===0?n===1?0:-0:i===255&&o===0?n===1?1/0:-1/0:i===255&&o!==0?NaN:(i-=127,i===-127?n*o*e(2,-149):n*(1+o*e(2,-23))*e(2,i))},qn}var jn,za;function Zh(){if(za)return jn;za=1;var e=Mt;return jn=function(r){var n=r[7]&128?-1:1,i=(r[7]&127)<<4|(r[6]&240)>>4,o=(r[6]&15)*281474976710656+r[5]*1099511627776+r[4]*4294967296+r[3]*16777216+r[2]*65536+r[1]*256+r[0];return i===0&&o===0?n*0:i===2047&&o!==0?NaN:i===2047&&o===0?n*(1/0):(i-=1023,i===-1023?n*o*5e-324:n*(1+o/4503599627370496)*e(2,i))},jn}var Gn,Ha;function Xh(){if(Ha)return Gn;Ha=1;var e=X,t=Mt,r=e("%Number%"),n=e("%BigInt%",!0);return Gn=function(o,a,c,u){for(var h=u?n:r,y=h(0),b=0;b<o.length;b++)y+=h(o[b]*t(2,8*b));if(!c){var l=a*8;o[a-1]&128&&(y-=h(t(2,l)))}return y},Gn}var Vn,Ka;function Qh(){return Ka||(Ka=1,Vn=function(t,r){for(var n=0;n<t.length;n+=1)if(!r(t[n],n,t))return!1;return!0}),Vn}var Wn,Ja;function ey(){return Ja||(Ja=1,Wn=function(t){return typeof t=="number"&&t>=0&&t<=255&&(t|0)===t}),Wn}var Ut={__proto__:null,name:{__proto__:null,$Int8Array:"INT8",$Uint8Array:"UINT8",$Uint8ClampedArray:"UINT8C",$Int16Array:"INT16",$Uint16Array:"UINT16",$Int32Array:"INT32",$Uint32Array:"UINT32",$BigInt64Array:"BIGINT64",$BigUint64Array:"BIGUINT64",$Float32Array:"FLOAT32",$Float64Array:"FLOAT64"},size:{__proto__:null,$INT8:1,$UINT8:1,$UINT8C:1,$INT16:2,$UINT16:2,$INT32:4,$UINT32:4,$BIGINT64:8,$BIGUINT64:8,$FLOAT32:4,$FLOAT64:8},choices:'"INT8", "UINT8", "UINT8C", "INT16", "UINT16", "INT32", "UINT32", "BIGINT64", "BIGUINT64", "FLOAT32", or "FLOAT64"'},zn,Ya;function ty(){if(Ya)return zn;Ya=1;var e=X,t=V,r=Ju,n=Ve,i=U,o=e("%BigInt%",!0),a=Mc(),c=No,u=Nc(),h=Jh(),y=Yh(),b=Zh(),l=Xh(),p=Qh(),_=ey(),w=t("Array.prototype.reverse"),A=t("Array.prototype.slice"),R=Ut;return zn=function(m,I,$){if(!a(R.size,"$"+m))throw new i("Assertion failed: `type` must be a TypedArray element type");if(!c(I)||!p(I,_))throw new i("Assertion failed: `rawBytes` must be an Array of bytes");if(typeof $!="boolean")throw new i("Assertion failed: `isLittleEndian` must be a Boolean");var P=R.size["$"+m];if(I.length!==P)throw new r("Assertion failed: `rawBytes` must have a length of "+P+" for type "+m);var C=u(m);if(C&&!o)throw new n("this environment does not support BigInts");return I=A(I,0,P),$||w(I),m==="FLOAT32"?y(I):m==="FLOAT64"?b(I):l(I,P,h(m),C)},zn}var Hn,Za;function ry(){if(Za)return Hn;Za=1;var e={}.toString;return Hn=Array.isArray||function(t){return e.call(t)=="[object Array]"},Hn}var Kn,Xa;function ny(){if(Xa)return Kn;Xa=1;var e=X,t=e("%Array.prototype.concat%"),r=Xe,n=V,i=n("Array.prototype.slice"),o=lp(),a=o&&Symbol.isConcatSpreadable,c=[],u=a?r.apply(t,c):null,h=a?ry():null;return Kn=a?function(b){for(var l=0;l<arguments.length;l+=1){var p=arguments[l];if(p&&typeof p=="object"&&typeof p[a]=="boolean"){c[a]||(c[a]=!0);var _=h(p)?i(p):[p];_[a]=!0,arguments[l]=_}}return u(arguments)}:r(t,c),Kn}var iy=xt,kt=function(t){return!!iy(t)},oy=U,ay=V,sy=ay("TypedArray.prototype.buffer",!0),uy=kt,or=sy||function(t){if(!uy(t))throw new oy("Not a Typed Array");return t.buffer},Jn,Qa;function xc(){if(Qa)return Jn;Qa=1;var e=X,t=e("%Uint8Array%",!0),r=e("%Uint32Array%",!0),n=or,i=r&&new r([305419896]),o=i&&new t(n(i));return Jn=o?o[0]===120?"little":o[0]===18?"big":o[0]===52?"mixed":"unknown":"indeterminate",Jn}var cy=X,ly=Ve,qe=U,fy=V,py=an,dy=cy("%Uint8Array%",!0),Yn=fy("Array.prototype.slice"),hy=Dt,yy=ty(),gy=Bt(),vy=ir(),es=ny(),vr=Ut,my=xc(),by=function(t,r,n,i,o){var a=vy(t);if(!gy(t)&&!a)throw new qe("Assertion failed: `arrayBuffer` must be an ArrayBuffer or a SharedArrayBuffer");if(!py(r))throw new qe("Assertion failed: `byteIndex` must be an integer");if(typeof n!="string"||typeof vr.size["$"+n]!="number")throw new qe("Assertion failed: `type` must be one of "+vr.choices);if(typeof i!="boolean")throw new qe("Assertion failed: `isTypedArray` must be a boolean");if(o!=="SEQ-CST"&&o!=="UNORDERED")throw new qe("Assertion failed: `order` must be either `SEQ-CST` or `UNORDERED`");if(arguments.length>5&&typeof arguments[5]!="boolean")throw new qe("Assertion failed: `isLittleEndian` must be a boolean, if present");if(hy(t))throw new qe("Assertion failed: `arrayBuffer` is detached");if(r<0)throw new qe("Assertion failed: `byteIndex` must be non-negative");var c=vr.size["$"+n];if(!c)throw new qe("Assertion failed: `type` must be one of "+vr.choices);var u;if(a)throw new ly("SharedArrayBuffer is not supported by this implementation");u=Yn(new dy(t,r),0,c);var h=arguments.length>5?arguments[5]:my==="little",y=h?Yn(es([0,0,0,0,0,0,0,0],u),-c):Yn(es(u,[0,0,0,0,0,0,0,0]),0,c);return yy(n,y,h)},ts=Ft,Bc=function(t,r){return t===r?t===0?1/t===1/r:!0:ts(t)&&ts(r)},mr=U,Ty=tt,Sy=on,rs=Bc,ns=function(){try{return delete[].length,!0}catch{return!1}}(),_y=function(t,r,n,i){if(!Ty(t))throw new mr("Assertion failed: `O` must be an Object");if(!Sy(r))throw new mr("Assertion failed: `P` must be a Property Key");if(typeof i!="boolean")throw new mr("Assertion failed: `Throw` must be a Boolean");if(i){if(t[r]=n,ns&&!rs(t[r],n))throw new mr("Attempted to assign to readonly property.");return!0}try{return t[r]=n,ns?rs(t[r],n):!0}catch{return!1}},Zn,is;function Ey(){if(is)return Zn;is=1;var e=X,t=e("%BigInt%",!0),r=U,n=Ve;return Zn=function(o){if(typeof o!="string")throw new r("`argument` must be a string");if(!t)throw new n("BigInts are not supported in this environment");try{return t(o)}catch{return}},Zn}var Xn,os;function wy(){return os||(os=1,Xn=function(t){return t===null||typeof t!="function"&&typeof t!="object"}),Xn}var br={exports:{}},Qn,as;function sn(){if(as)return Qn;as=1;var e=V,t=Yu,r=e("RegExp.prototype.exec"),n=U;return Qn=function(o){if(!t(o))throw new n("`regex` must be a RegExp");return function(c){return r(o,c)!==null}},Qn}var ss;function Dc(){if(ss)return br.exports;ss=1;var e=V,t=e("Object.prototype.toString"),r=fp()(),n=sn();if(r){var i=e("Symbol.prototype.toString"),o=n(/^Symbol\(.*\)$/),a=function(u){return typeof u.valueOf()!="symbol"?!1:o(i(u))};br.exports=function(u){if(typeof u=="symbol")return!0;if(!u||typeof u!="object"||t(u)!=="[object Symbol]")return!1;try{return a(u)}catch{return!1}}}else br.exports=function(u){return!1};return br.exports}var ei,us;function Ay(){if(us)return ei;us=1;var e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol",t=wy(),r=nn,n=Zu,i=Dc(),o=function(u,h){if(typeof u>"u"||u===null)throw new TypeError("Cannot call method on "+u);if(typeof h!="string"||h!=="number"&&h!=="string")throw new TypeError('hint must be "string" or "number"');var y=h==="string"?["toString","valueOf"]:["valueOf","toString"],b,l,p;for(p=0;p<y.length;++p)if(b=u[y[p]],r(b)&&(l=b.call(u),t(l)))return l;throw new TypeError("No default value")},a=function(u,h){var y=u[h];if(y!==null&&typeof y<"u"){if(!r(y))throw new TypeError(y+" returned for property "+String(h)+" of object "+u+" is not a function");return y}};return ei=function(u){if(t(u))return u;var h="default";arguments.length>1&&(arguments[1]===String?h="string":arguments[1]===Number&&(h="number"));var y;if(e&&(Symbol.toPrimitive?y=a(u,Symbol.toPrimitive):i(u)&&(y=Symbol.prototype.valueOf)),typeof y<"u"){var b=y.call(u,h);if(t(b))return b;throw new TypeError("unable to convert exotic object to primitive")}return h==="default"&&(n(u)||i(u))&&(h="string"),o(u,h==="default"?"number":h)},ei}var ti,cs;function Uc(){if(cs)return ti;cs=1;var e=Ay();return ti=function(r){return arguments.length>1?e(r,arguments[1]):e(r)},ti}var ri,ls;function kc(){if(ls)return ri;ls=1;var e=X,t=e("%BigInt%",!0),r=e("%Number%"),n=U,i=Ve,o=Ey(),a=Uc();return ri=function(u){if(!t)throw new i("BigInts are not supported in this environment");var h=a(u,r);if(h==null)throw new n("Cannot convert null or undefined to a BigInt");if(typeof h=="boolean")return t(h?1:0);if(typeof h=="number")throw new n("Cannot convert a Number value to a BigInt");if(typeof h=="string"){var y=o(h);if(typeof y>"u")throw new n("Failed to parse String to BigInt");return y}if(typeof h=="symbol")throw new n("Cannot convert a Symbol value to a BigInt");if(typeof h!="bigint")throw new i("Assertion failed: unknown primitive type");return h},ri}var ni,fs;function qc(){if(fs)return ni;fs=1;var e=X,t=e("%BigInt%",!0),r=Ju,n=U,i=t&&t(0);return ni=function(a,c){if(typeof a!="bigint"||typeof c!="bigint")throw new n("Assertion failed: `n` and `d` arguments must be BigInts");if(c===i)throw new r("Division by zero");return a===i?i:a%c},ni}var ii,ps;function jc(){return ps||(ps=1,ii=function(t,r,n){var i=t(r,n);return i>=0?i:i+n}),ii}var oi,ds;function Iy(){if(ds)return oi;ds=1;var e=X,t=e("%BigInt%",!0),r=Mt,n=kc(),i=qc(),o=jc(),a=t&&BigInt(r(2,32))*BigInt(r(2,31)),c=t&&BigInt(r(2,32))*BigInt(r(2,32));return oi=function(h){var y=n(h),b=o(i,y,c);return b>=a?b-c:b},oi}var ai,hs;function $y(){if(hs)return ai;hs=1;var e=X,t=e("%BigInt%",!0),r=Mt,n=kc(),i=qc(),o=jc(),a=t&&BigInt(r(2,32))*BigInt(r(2,32));return ai=function(u){var h=n(u),y=o(i,h,a);return y},ai}var si,ys;function Cy(){if(ys)return si;ys=1;var e=Pt;return si=function(r,n){var i=r%n;return e(i>=0?i:i+n)},si}var ui,gs;function Oy(){return gs||(gs=1,ui=Cy()),ui}var ci,vs;function qt(){if(vs)return ci;vs=1;var e=Oy();return ci=function(r,n){return e(r,n)},ci}var li,ms;function Fy(){return ms||(ms=1,li=function(t){return t===null||typeof t!="function"&&typeof t!="object"}),li}var fi,bs;function Gc(){if(bs)return fi;bs=1;var e=U;return fi=function(r){if(r==null)throw new e(arguments.length>0&&arguments[1]||"Cannot call method on "+r);return r},fi}var Py=X,My=Py("%String%"),Ly=U,Vc=function(t){if(typeof t=="symbol")throw new Ly("Cannot convert a Symbol value to a string");return My(t)},pi,Ts;function Wc(){if(Ts)return pi;Ts=1;var e=Gc(),t=Vc,r=V,n=r("String.prototype.replace"),i=/^\s$/.test(""),o=i?/^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/:/^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/,a=i?/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+$/:/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+$/;return pi=function(){var u=t(e(this));return n(n(u,o,""),a,"")},pi}var di,Ss;function zc(){if(Ss)return di;Ss=1;var e=Wc(),t="",r="";return di=function(){return String.prototype.trim&&t.trim()===t&&r.trim()===r&&("_"+r).trim()==="_"+r&&(r+"_").trim()===r+"_"?String.prototype.trim:e},di}var hi,_s;function Ry(){if(_s)return hi;_s=1;var e=Xu(),t=pp,r=zc();return hi=function(){var i=r();return String.prototype.trim!==i&&(e?t(String.prototype,"trim",i,!0):t(String.prototype,"trim",i)),i},hi}var yi,Es;function Ny(){if(Es)return yi;Es=1;var e=Xe,t=tr,r=Gc(),n=Wc(),i=zc(),o=Ry(),a=e(i()),c=function(h){return r(h),a(h)};return t(c,{getPolyfill:i,implementation:n,shim:o}),yi=c,yi}var gi,ws;function xy(){if(ws)return gi;ws=1;var e=X,t=e("%RegExp%"),r=U,n=e("%parseInt%"),i=V,o=sn(),a=i("String.prototype.slice"),c=o(/^0b[01]+$/i),u=o(/^0o[0-7]+$/i),h=o(/^[-+]0x[0-9a-f]+$/i),y=["","",""].join(""),b=new t("["+y+"]","g"),l=o(b),p=Ny();return gi=function _(w){if(typeof w!="string")throw new r("Assertion failed: `argument` is not a String");if(c(w))return+n(a(w,2),2);if(u(w))return+n(a(w,2),8);if(l(w)||h(w))return NaN;var A=p(w);return A!==w?_(A):+w},gi}var By=X,As=U,Dy=By("%Number%"),Uy=Fy(),ky=Uc(),qy=xy(),rt=function(t){var r=Uy(t)?t:ky(t,Dy);if(typeof r=="symbol")throw new As("Cannot convert a Symbol value to a number");if(typeof r=="bigint")throw new As("Conversion from 'BigInt' to 'number' is not allowed.");return typeof r=="string"?qy(r):+r},jy=Pt,xo=function(t){return typeof t=="bigint"?t:jy(t)},Is=xo,Gy=U,gt=function(t){if(typeof t!="number"&&typeof t!="bigint")throw new Gy("argument must be a Number or a BigInt");var r=t<0?-Is(-t):Is(t);return r===0?0:r},vi,$s;function Vy(){if($s)return vi;$s=1;var e=qt(),t=rt,r=gt,n=We,i=65536;return vi=function(a){var c=t(a);if(!n(c)||c===0)return 0;var u=r(c),h=e(u,i);return h>=32768?h-i:h},vi}var mi,Cs;function Wy(){if(Cs)return mi;Cs=1;var e=qt(),t=rt,r=gt,n=We,i=2147483648,o=4294967296;return mi=function(c){var u=t(c);if(!n(u)||u===0)return 0;var h=r(u),y=e(h,o),b=y>=i?y-o:y;return b===0?0:b},mi}var bi,Os;function zy(){if(Os)return bi;Os=1;var e=qt(),t=rt,r=gt,n=We;return bi=function(o){var a=t(o);if(!n(a)||a===0)return 0;var c=r(a),u=e(c,256);return u>=128?u-256:u},bi}var Ti,Fs;function Hy(){if(Fs)return Ti;Fs=1;var e=qt(),t=rt,r=gt,n=We,i=65536;return Ti=function(a){var c=t(a);if(!n(c)||c===0)return 0;var u=r(c),h=e(u,i);return h===0?0:h},Ti}var Si,Ps;function Ky(){if(Ps)return Si;Ps=1;var e=qt(),t=rt,r=gt,n=We,i=4294967296;return Si=function(a){var c=t(a);if(!n(c)||c===0)return 0;var u=r(c),h=e(u,i);return h===0?0:h},Si}var _i,Ms;function Jy(){if(Ms)return _i;Ms=1;var e=We,t=qt(),r=rt,n=gt;return _i=function(o){var a=r(o);if(!e(a)||a===0)return 0;var c=n(a),u=t(c,256);return u},_i}var Ei,Ls;function Yy(){if(Ls)return Ei;Ls=1;var e=U,t=ec,r=Qu;return Ei=function(i,o,a){if(typeof i!="number"||typeof o!="number"||typeof a!="number"||!(o<=a))throw new e("Assertion failed: all three arguments must be MVs, and `lower` must be `<= upper`");return r(t(o,i),a)},Ei}var wi,Rs;function Zy(){if(Rs)return wi;Rs=1;var e=Yy(),t=rt,r=xo,n=Ft;return wi=function(o){var a=t(o);if(n(a))return 0;var c=e(a,0,255),u=r(c);return c<u+.5?u:c>u+.5?u+1:u%2===0?u:u+1},wi}var Ai,Ns;function Hc(){return Ns||(Ns=1,Ai=function(t){return t===0&&1/t===-1/0}),Ai}var Ii,xs;function Xy(){if(xs)return Ii;xs=1;var e=Eo,t=Pt,r=Mt,n=We,i=Ft,o=Hc(),a=34028234663852886e22;return Ii=function(u,h){if(i(u))return h?[0,0,192,127]:[127,192,0,0];var y;if(u===0)return y=o(u)?128:0,h?[0,0,0,y]:[y,0,0,0];if(e(u)>a||!n(u))return y=u<0?255:127,h?[0,0,128,y]:[y,128,0,0];var b=u<0?1:0;u=e(u);for(var l=0;u>=2;)l+=1,u/=2;for(;u<1;)l-=1,u*=2;var p=u-1;p*=r(2,23)+.5,p=t(p),l+=127,l<<=23;var _=b<<31|l|p,w=_&255;_>>=8;var A=_&255;_>>=8;var R=_&255;_>>=8;var O=_&255;return h?[w,A,R,O]:[O,R,A,w]},Ii}var $i,Bs;function Qy(){if(Bs)return $i;Bs=1;var e=1075,t=54;return $i=function(n){var i="";if(n===0)return i;for(var o=e,a,c=0;c<e;c+=1)if(a=n*2,a>=1?(n=a-1,i+="1",o===e&&(o=c)):(n=a,i+="0"),a===1||c-o>t)return i;return i},$i}var Ci,Ds;function eg(){if(Ds)return Ci;Ds=1;var e=Pt;return Ci=function(r){for(var n="",i;r>0;)i=r/2,r=e(i),i===r?n="0"+n:n="1"+n;return n},Ci}var Oi,Us;function tg(){if(Us)return Oi;Us=1;var e=X,t=e("%parseInt%"),r=Eo,n=Pt,i=Hc(),o=V,a=o("String.prototype.indexOf"),c=o("String.prototype.slice"),u=Qy(),h=eg(),y=1023,b="11111111111",l="00000000000",p=l+l+l+l+"0000000";return Oi=function(w,A){var R=w<0||i(w)?"1":"0",O,m;if(isNaN(w))O=b,m="1"+p;else if(!isFinite(w))O=b,m="0"+p;else if(w===0)O=l,m="0"+p;else{w=r(w);var I=n(w),$=h(I),P=u(w-I),C;if($)O=$.length-1;else{var B=a(P,"1");B>-1&&(C=B+1),O=-C}m=$+P,O<0?(O<=-y&&(C=y-1),m=c(m,C)):m=c(m,1),O=c(l+h(O+y),-11),m=c(m+p+"0",0,52)}for(var f=R+O+m,S=[],g=0;g<8;g++){var v=A?8-g-1:g;S[v]=t(c(f,g*8,(g+1)*8),2)}return S},Oi}var Fi,ks;function rg(){if(ks)return Fi;ks=1;var e=X,t=e("%Number%"),r=e("%BigInt%",!0);return Fi=function(i,o,a){var c=typeof i=="bigint"?r:t;i<0&&(i>>>=0);for(var u=[],h=0;h<o;h++)u[a?h:o-1-h]=t(i&c(255)),i>>=c(8);return u},Fi}var Pi,qs;function ng(){if(qs)return Pi;qs=1;var e=U,t=Mc(),r=Iy(),n=$y(),i=Vy(),o=Wy(),a=zy(),c=Hy(),u=Ky(),h=Jy(),y=Zy(),b=Xy(),l=tg(),p=rg(),_=Ut,w={__proto__:null,$INT8:a,$UINT8:h,$UINT8C:y,$INT16:i,$UINT16:c,$INT32:o,$UINT32:u,$BIGINT64:r,$BIGUINT64:n};return Pi=function(R,O,m){if(typeof R!="string"||!t(_.size,"$"+R))throw new e("Assertion failed: `type` must be a TypedArray element type");if(typeof O!="number"&&typeof O!="bigint")throw new e("Assertion failed: `value` must be a Number or a BigInt");if(typeof m!="boolean")throw new e("Assertion failed: `isLittleEndian` must be a Boolean");if(R==="FLOAT32")return b(O,m);if(R==="FLOAT64")return l(O,m);var I=_.size["$"+R],$=w["$"+R],P=$(O);return p(P,I,m)},Pi}var Mi,js;function ig(){return js||(js=1,Mi=function(t,r){for(var n=0;n<t.length;n+=1)r(t[n],n,t)}),Mi}var og=X,ag=Ve,je=U,sg=an,ug=og("%Uint8Array%",!0),cg=Nc(),lg=Dt,fg=ng(),pg=Bt(),dg=ir(),hg=dt,Li=Ut,yg=xc(),gg=ig(),vg=function(t,r,n,i,o,a){var c=dg(t);if(!pg(t)&&!c)throw new je("Assertion failed: `arrayBuffer` must be an ArrayBuffer or a SharedArrayBuffer");if(!sg(r)||r<0)throw new je("Assertion failed: `byteIndex` must be a non-negative integer");if(typeof n!="string"||!hg(Li.size,"$"+n))throw new je("Assertion failed: `type` must be one of "+Li.choices);if(typeof i!="number"&&typeof i!="bigint")throw new je("Assertion failed: `value` must be a Number or a BigInt");if(typeof o!="boolean")throw new je("Assertion failed: `isTypedArray` must be a boolean");if(a!=="SEQ-CST"&&a!=="UNORDERED"&&a!=="INIT")throw new je('Assertion failed: `order` must be `"SEQ-CST"`, `"UNORDERED"`, or `"INIT"`');if(arguments.length>6&&typeof arguments[6]!="boolean")throw new je("Assertion failed: `isLittleEndian` must be a boolean, if present");if(lg(t))throw new je("Assertion failed: ArrayBuffer is detached");if(cg(n)?typeof i!="bigint":typeof i!="number")throw new je("Assertion failed: `value` must be a BigInt if type is ~BIGINT64~ or ~BIGUINT64~, otherwise a Number");var u=Li.size["$"+n],h=arguments.length>6?arguments[6]:yg==="little",y=fg(n,i,h);if(c)throw new ag("SharedArrayBuffer is not supported by this implementation");var b=new ug(t,r,u);gg(y,function(l,p){b[p]=l})},mg=rt,bg=gt,Tg=Ft,Sg=We,_g=function(t){var r=mg(t);return Tg(r)||r===0?0:Sg(r)?bg(r):r},Eg=Ve,wg=U,Ag=an,Ig=xt,Gs=Ut,Bo=function(t){var r=Ig(t);if(!r)throw new wg("Assertion failed: `O` must be a TypedArray");var n=Gs.size["$"+Gs.name["$"+r]];if(!Ag(n)||n<0)throw new Eg("Assertion failed: Unknown TypedArray type `"+r+"`");return n},$g=Ve,Cg=U,Og=xt,Fg=Ut,Pg=function(t){var r=Og(t);if(!r)throw new Cg("Assertion failed: `O` must be a TypedArray");var n=Fg.name["$"+r];if(typeof n!="string")throw new $g("Assertion failed: Unknown TypedArray type `"+r+"`");return n},po={exports:{}},Mg=X,Ri,Vs;function Do(){if(Vs)return Ri;Vs=1;var e=U,t=dt,r={__proto__:null,"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};return Ri=function(i){if(!i||typeof i!="object")return!1;for(var o in i)if(t(i,o)&&!r[o])return!1;var a=t(i,"[[Value]]")||t(i,"[[Writable]]"),c=t(i,"[[Get]]")||t(i,"[[Set]]");if(a&&c)throw new e("Property Descriptors may not be both accessor and data descriptors");return!0},Ri}var Ni,Ws;function Lg(){if(Ws)return Ni;Ws=1;var e=Xu,t=dp,r=e.hasArrayLengthDefineBug(),n=r&&Rc,i=V,o=i("Object.prototype.propertyIsEnumerable");return Ni=function(c,u,h,y,b,l){if(!t){if(!c(l)||!l["[[Configurable]]"]||!l["[[Writable]]"]||b in y&&o(y,b)!==!!l["[[Enumerable]]"])return!1;var p=l["[[Value]]"];return y[b]=p,u(y[b],p)}return r&&b==="length"&&"[[Value]]"in l&&n(y)&&y.length!==l["[[Value]]"]?(y.length=l["[[Value]]"],y.length===l["[[Value]]"]):(t(y,b,h(l)),!0)},Ni}var xi,zs;function Rg(){return zs||(zs=1,xi=function(t){if(typeof t>"u")return t;var r={};return"[[Value]]"in t&&(r.value=t["[[Value]]"]),"[[Writable]]"in t&&(r.writable=!!t["[[Writable]]"]),"[[Get]]"in t&&(r.get=t["[[Get]]"]),"[[Set]]"in t&&(r.set=t["[[Set]]"]),"[[Enumerable]]"in t&&(r.enumerable=!!t["[[Enumerable]]"]),"[[Configurable]]"in t&&(r.configurable=!!t["[[Configurable]]"]),r}),xi}var Bi,Hs;function Ng(){if(Hs)return Bi;Hs=1;var e=U,t=Do(),r=Rg();return Bi=function(i){if(typeof i<"u"&&!t(i))throw new e("Assertion failed: `Desc` must be a Property Descriptor");return r(i)},Bi}var Di,Ks;function xg(){if(Ks)return Di;Ks=1;var e=U,t=dt,r=Do();return Di=function(i){if(typeof i>"u")return!1;if(!r(i))throw new e("Assertion failed: `Desc` must be a Property Descriptor");return!(!t(i,"[[Value]]")&&!t(i,"[[Writable]]"))},Di}var Kc=nn,Ui,Js;function Bg(){return Js||(Js=1,Ui=function(t){return!!t}),Ui}var ki,Ys;function Dg(){if(Ys)return ki;Ys=1;var e=dt,t=U,r=tt,n=Kc,i=Bg();return ki=function(a){if(!r(a))throw new t("ToPropertyDescriptor requires an object");var c={};if(e(a,"enumerable")&&(c["[[Enumerable]]"]=i(a.enumerable)),e(a,"configurable")&&(c["[[Configurable]]"]=i(a.configurable)),e(a,"value")&&(c["[[Value]]"]=a.value),e(a,"writable")&&(c["[[Writable]]"]=i(a.writable)),e(a,"get")){var u=a.get;if(typeof u<"u"&&!n(u))throw new t("getter must be a function");c["[[Get]]"]=u}if(e(a,"set")){var h=a.set;if(typeof h<"u"&&!n(h))throw new t("setter must be a function");c["[[Set]]"]=h}if((e(c,"[[Get]]")||e(c,"[[Set]]"))&&(e(c,"[[Value]]")||e(c,"[[Writable]]")))throw new t("Invalid property descriptor. Cannot both specify accessors and a value or writable attribute");return c},ki}var qi,Zs;function Ug(){if(Zs)return qi;Zs=1;var e=U,t=tt,r=Do(),n=Lg(),i=Ng(),o=xg(),a=on,c=Bc,u=Dg();return qi=function(y,b,l){if(!t(y))throw new e("Assertion failed: Type(O) is not Object");if(!a(b))throw new e("Assertion failed: P is not a Property Key");var p=r(l)?l:u(l);if(!r(p))throw new e("Assertion failed: Desc is not a valid Property Descriptor");return n(o,c,i,y,b,p)},qi}var kg=Mg,Xs=kg("%Reflect.construct%",!0),Dr=Ug();try{Dr({},"",{"[[Get]]":function(){}})}catch{Dr=null}if(Dr&&Xs){var Qs={},eu={};Dr(eu,"length",{"[[Get]]":function(){throw Qs},"[[Enumerable]]":!0}),po.exports=function(t){try{Xs(t,eu)}catch(r){return r===Qs}}}else po.exports=function(t){return typeof t=="function"&&!!t.prototype};var Jc=po.exports,qg=X,tu=qg("%Symbol.species%",!0),ji=U,ru=tt,jg=Jc,Gg=function(t,r){if(!ru(t))throw new ji("Assertion failed: Type(O) is not Object");var n=t.constructor;if(typeof n>"u")return r;if(!ru(n))throw new ji("O.constructor is not an Object");var i=tu?n[tu]:void 0;if(i==null)return r;if(jg(i))return i;throw new ji("no constructor found")},Vg=U,Yc=V,nu=Yc("%ArrayBuffer.prototype.resizable%",!0),iu=Yc("%SharedArrayBuffer.prototype.growable%",!0),Wg=Bt(),zg=ir(),Zc=function(t){var r=Wg(t),n=zg(t);if(!r&&!n)throw new Vg("Assertion failed: `arrayBuffer` must be an ArrayBuffer or SharedArrayBuffer");return r&&nu?!nu(t):n&&iu?!iu(t):!0},Hg=an,ou=dt,Kg=kt,Jg=Hg,Xc=function(t){return!!t&&typeof t=="object"&&ou(t,"[[Object]]")&&ou(t,"[[CachedBufferByteLength]]")&&(Jg(t["[[CachedBufferByteLength]]"])&&t["[[CachedBufferByteLength]]"]>=0||t["[[CachedBufferByteLength]]"]==="DETACHED")&&Kg(t["[[Object]]"])},Yg=tt,Qc=V,Zg=Qc("String.prototype.valueOf"),Xg=function(t){try{return Zg(t),!0}catch{return!1}},Qg=Qc("Object.prototype.toString"),ev="[object String]",tv=pt(),rv=function(t){return typeof t=="string"?!0:!t||typeof t!="object"?!1:tv?Xg(t):Qg(t)===ev},el=V,nv=el("Number.prototype.toString"),iv=function(t){try{return nv(t),!0}catch{return!1}},ov=el("Object.prototype.toString"),av="[object Number]",sv=pt(),uv=function(t){return typeof t=="number"?!0:!t||typeof t!="object"?!1:sv?iv(t):ov(t)===av},tl=V,cv=tl("Boolean.prototype.toString"),lv=tl("Object.prototype.toString"),fv=function(t){try{return cv(t),!0}catch{return!1}},pv="[object Boolean]",dv=pt(),hv=function(t){return typeof t=="boolean"?!0:t===null||typeof t!="object"?!1:dv?fv(t):lv(t)===pv},ho={exports:{}},au=typeof BigInt<"u"&&BigInt,yv=function(){return typeof au=="function"&&typeof BigInt=="function"&&typeof au(42)=="bigint"&&typeof BigInt(42)=="bigint"},gv=yv();if(gv){var vv=BigInt.prototype.valueOf,mv=function(t){try{return vv.call(t),!0}catch{}return!1};ho.exports=function(t){return t===null||typeof t>"u"||typeof t=="boolean"||typeof t=="string"||typeof t=="number"||typeof t=="symbol"||typeof t=="function"?!1:typeof t=="bigint"?!0:mv(t)}}else ho.exports=function(t){return!1};var bv=ho.exports,Tv=rv,Sv=uv,_v=hv,Ev=Dc(),wv=bv,Av=function(t){if(t==null||typeof t!="object"&&typeof t!="function")return null;if(Tv(t))return"String";if(Sv(t))return"Number";if(_v(t))return"Boolean";if(Ev(t))return"Symbol";if(wv(t))return"BigInt"},Uo=typeof Map=="function"&&Map.prototype?Map:null,Iv=typeof Set=="function"&&Set.prototype?Set:null,Ur;Uo||(Ur=function(t){return!1});var rl=Uo?Map.prototype.has:null,su=Iv?Set.prototype.has:null;!Ur&&!rl&&(Ur=function(t){return!1});var $v=Ur||function(t){if(!t||typeof t!="object")return!1;try{if(rl.call(t),su)try{su.call(t)}catch{return!0}return t instanceof Uo}catch{}return!1},Cv=typeof Map=="function"&&Map.prototype?Map:null,ko=typeof Set=="function"&&Set.prototype?Set:null,kr;ko||(kr=function(t){return!1});var uu=Cv?Map.prototype.has:null,nl=ko?Set.prototype.has:null;!kr&&!nl&&(kr=function(t){return!1});var Ov=kr||function(t){if(!t||typeof t!="object")return!1;try{if(nl.call(t),uu)try{uu.call(t)}catch{return!0}return t instanceof ko}catch{}return!1},qr=typeof WeakMap=="function"&&WeakMap.prototype?WeakMap:null,cu=typeof WeakSet=="function"&&WeakSet.prototype?WeakSet:null,jr;qr||(jr=function(t){return!1});var yo=qr?qr.prototype.has:null,Gi=cu?cu.prototype.has:null;!jr&&!yo&&(jr=function(t){return!1});var Fv=jr||function(t){if(!t||typeof t!="object")return!1;try{if(yo.call(t,yo),Gi)try{Gi.call(t,Gi)}catch{return!0}return t instanceof qr}catch{}return!1},go={exports:{}},Pv=X,il=V,Mv=Pv("%WeakSet%",!0),Vi=il("WeakSet.prototype.has",!0);if(Vi){var Wi=il("WeakMap.prototype.has",!0);go.exports=function(t){if(!t||typeof t!="object")return!1;try{if(Vi(t,Vi),Wi)try{Wi(t,Wi)}catch{return!0}return t instanceof Mv}catch{}return!1}}else go.exports=function(t){return!1};var Lv=go.exports,Rv=$v,Nv=Ov,xv=Fv,Bv=Lv,Dv=function(t){if(t&&typeof t=="object"){if(Rv(t))return"Map";if(Nv(t))return"Set";if(xv(t))return"WeakMap";if(Bv(t))return"WeakSet"}return!1},Uv={}.toString,kv=Array.isArray||function(e){return Uv.call(e)=="[object Array]"},qv=V,jv=qv("WeakRef.prototype.deref",!0),Gv=typeof WeakRef>"u"?function(t){return!1}:function(t){if(!t||typeof t!="object")return!1;try{return jv(t),!0}catch{return!1}},Vv=V,lu=Vv("FinalizationRegistry.prototype.register",!0),Wv=lu?function(t){if(!t||typeof t!="object")return!1;try{return lu(t,{},null),!0}catch{return!1}}:function(t){return!1},ol=nn,zv=dt,Hv=tc(),qo=V,al=qo("Function.prototype.toString"),sl=qo("String.prototype.match"),zi=qo("Object.prototype.toString"),Kv=/^class /,Jv=function(t){if(ol(t)||typeof t!="function")return!1;try{var r=sl(al(t),Kv);return!!r}catch{}return!1},Yv=/\s*function\s+([^(\s]*)\s*/,Zv=!(0 in[,]),Xv="[object Object]",Qv="[object HTMLAllCollection]",em=Function.prototype,ul=function(){return!1};if(typeof document=="object"){var tm=document.all;zi(tm)===zi(document.all)&&(ul=function(t){if((Zv||!t)&&(typeof t>"u"||typeof t=="object"))try{var r=zi(t);return(r===Qv||r===Xv)&&t("")==null}catch{}return!1})}var cl=function(){if(ul(this)||!Jv(this)&&!ol(this))throw new TypeError("Function.prototype.name sham getter called on non-function");if(Hv&&zv(this,"name"))return this.name;if(this===em)return"";var t=al(this),r=sl(t,Yv),n=r&&r[1];return n},rm=cl,ll=function(){return rm},nm=tr.supportsDescriptors,im=tc(),om=ll,fu=Object.defineProperty,am=TypeError,sm=function(){var t=om();if(im)return t;if(!nm)throw new am("Shimming Function.prototype.name support requires ES5 property descriptor support.");var r=Function.prototype;return fu(r,"name",{configurable:!0,enumerable:!1,get:function(){var n=t.call(this);return this!==r&&fu(this,"name",{configurable:!0,enumerable:!1,value:n,writable:!1}),n}}),t},um=tr,cm=Xe,fl=cl,lm=ll,fm=sm,pl=cm(fl);um(pl,{getPolyfill:lm,implementation:fl,shim:fm});var pm=pl,Hi,pu;function dm(){if(pu)return Hi;pu=1;const e=(function*(){}).constructor;return Hi=()=>e,Hi}var dl=V,hm=sn(),ym=hm(/^\s*(?:function)?\*/),gm=pt(),du=Ot,vm=dl("Object.prototype.toString"),mm=dl("Function.prototype.toString"),bm=dm(),Tm=function(t){if(typeof t!="function")return!1;if(ym(mm(t)))return!0;if(!gm){var r=vm(t);return r==="[object GeneratorFunction]"}if(!du)return!1;var n=bm();return n&&du(t)===n.prototype},Ki,hu;function Sm(){if(hu)return Ki;hu=1;const e=(async function(){}).constructor;return Ki=()=>e,Ki}var hl=V,_m=sn(),Em=hl("Object.prototype.toString"),wm=hl("Function.prototype.toString"),Am=_m(/^\s*async(?:\s+function(?:\s+|\()|\s*\()/),Im=pt(),yu=Ot,$m=Sm(),Cm=function(t){if(typeof t!="function")return!1;if(Am(wm(t)))return!0;if(!Im){var r=Em(t);return r==="[object AsyncFunction]"}if(!yu)return!1;var n=$m();return n&&n.prototype===yu(t)},Om=Av,Fm=Dv,Pm=xt,Mm=kv,Lm=Zu,Rm=Yu,Nm=Gv,xm=Wv,Bm=pm,Dm=Tm,Um=Cm,km=V,qm=pt(),Ji=qm&&Symbol.toStringTag,jm=Object,gu=km("Promise.prototype.then",!0),Gm=function(t){if(!t||typeof t!="object"||!gu)return!1;try{return gu(t,null,function(){}),!0}catch{}return!1},vu=function(t){return!!t&&t!=="BigInt"&&t!=="Boolean"&&t!=="Null"&&t!=="Number"&&t!=="String"&&t!=="Symbol"&&t!=="Undefined"&&t!=="Math"&&t!=="JSON"&&t!=="Reflect"&&t!=="Atomics"&&t!=="Map"&&t!=="Set"&&t!=="WeakMap"&&t!=="WeakSet"&&t!=="BigInt64Array"&&t!=="BigUint64Array"&&t!=="Float32Array"&&t!=="Float64Array"&&t!=="Int16Array"&&t!=="Int32Array"&&t!=="Int8Array"&&t!=="Uint16Array"&&t!=="Uint32Array"&&t!=="Uint8Array"&&t!=="Uint8ClampedArray"&&t!=="Array"&&t!=="Date"&&t!=="FinalizationRegistry"&&t!=="Promise"&&t!=="RegExp"&&t!=="WeakRef"&&t!=="Function"&&t!=="GeneratorFunction"&&t!=="AsyncFunction"},Vm=function(t){if(t==null)return t;var r=Om(jm(t))||Fm(t)||Pm(t);if(r)return r;if(Mm(t))return"Array";if(Lm(t))return"Date";if(Rm(t))return"RegExp";if(Nm(t))return"WeakRef";if(xm(t))return"FinalizationRegistry";if(typeof t=="function")return Dm(t)?"GeneratorFunction":Um(t)?"AsyncFunction":"Function";if(Gm(t))return"Promise";if(Ji&&Ji in t){var n=t[Ji];if(vu(n))return n}if(typeof t.constructor=="function"){var i=Bm(t.constructor);if(vu(i))return i}return"Object"},Wm=X,zm=Kc,Hm=Yg,Km=Vm,Jm=U,mu=Ot,Ym=hp,Zm=function(t){if(!Hm(t))throw new Jm("Reflect.getPrototypeOf called on non-object");if(mu)return mu(t);var r=Km(t);if(r){var n=Wm("%"+r+".prototype%",!0);if(n)return n}return zm(t.constructor)?t.constructor.prototype:t instanceof Object?Ym.prototype:null},Xm=Zm,bu=Ot,yl=function(){return typeof Reflect=="object"&&Reflect&&Reflect.getPrototypeOf?Reflect.getPrototypeOf:bu?function(r){return bu(r)}:Xm},gl=Oo,Qm=Xe,eb=yl(),tb=nr(),vo={__proto__:null},Tr=Kr,Tu=Object.defineProperty;if(Tr){var rb=function(e){return e.byteOffset};gl(tb,function(e){if(typeof window[e]=="function"||typeof window[e]=="object"){var t=window[e].prototype,r=Tr(t,"byteOffset");if(!r){var n=eb(t);r=Tr(n,"byteOffset")}if(r&&r.get)vo[e]=Qm(r.get);else if(Tu){var i=new window[e](2);r=Tr(i,"byteOffset"),r&&r.configurable&&Tu(i,"length",{value:3}),i.length===2&&(vo[e]=rb)}}})}var nb=function(t){var r;return gl(vo,function(n){if(typeof r!="number")try{var i=n(t);typeof i=="number"&&(r=i)}catch{}}),r},ib=kt,jo=function(t){return ib(t)?nb(t):!1},ob=Xe,vl=Oo,Sr=Kr,ab=kt,sb=_c,ub=yl(),mo={__proto__:null},Su=Object.defineProperty;if(Sr){var cb=function(e){return e.length};vl(sb,function(e){var t=window[e];if(typeof t=="function"||typeof t=="object"){var r=t.prototype,n=Sr(r,"length");if(!n){var i=ub(r);n=Sr(i,"length")}if(n&&n.get)mo["$"+e]=ob(n.get);else if(Su){var o=new window[e](2);n=Sr(o,"length"),n&&n.configurable&&Su(o,"length",{value:3}),o.length===2&&(mo["$"+e]=cb)}}})}var lb=function(t){var r;return vl(mo,function(n){if(typeof r!="number")try{var i=n(t);typeof i=="number"&&(r=i)}catch{}}),r},ml=function(t){return ab(t)?lb(t):!1},_u=U,fb=Dt,pb=Zc,db=Bo,hb=Xc,Eu=or,yb=jo,gb=ml,Go=function(t){if(!hb(t))throw new _u("Assertion failed: `taRecord` must be a TypedArray With Buffer Witness Record");var r=t["[[Object]]"],n=t["[[CachedBufferByteLength]]"];if(fb(Eu(r))&&n!=="DETACHED")throw new _u("Assertion failed: typed array is detached only if the byte length is ~DETACHED~");if(n==="DETACHED")return!0;var i=yb(r),o=pb(Eu(r)),a,c=o?gb(r):"AUTO";if(c==="AUTO")a=n;else{var u=db(r);a=i+c*u}return i>n||a>n},_r=U,vb=xo,mb=Zc,bb=Go,Tb=Bo,Sb=Xc,_b=or,Eb=jo,wb=ml,Ab=function(t){if(!Sb(t))throw new _r("Assertion failed: `taRecord` must be a TypedArray With Buffer Witness Record");if(bb(t))throw new _r("Assertion failed: `taRecord` is out of bounds");var r=t["[[Object]]"],n=mb(_b(r)),i=n?wb(r):"AUTO";if(i!=="AUTO")return i;if(n)throw new _r("Assertion failed: array buffer is not fixed length");var o=Eb(r),a=Tb(r),c=t["[[CachedBufferByteLength]]"];if(c==="DETACHED")throw new _r("Assertion failed: typed array is detached");return vb((c-o)/a)},Yi=U,Ib=Dt,$b=Bt(),Cb=ir(),Ob=Pc,Fb=V,Pb=Fb("SharedArrayBuffer.prototype.byteLength",!0),Mb=function(t,r){var n=Cb(t);if(!$b(t)&&!n)throw new Yi("Assertion failed: `arrayBuffer` must be an ArrayBuffer or a SharedArrayBuffer");if(r!=="SEQ-CST"&&r!=="UNORDERED")throw new Yi("Assertion failed: `order` must be ~SEQ-CST~ or ~UNORDERED~");if(Ib(t))throw new Yi("Assertion failed: `arrayBuffer` must not be detached");return n?Pb(t):Ob(t)},wu=U,Lb=Mb,Rb=Dt,Nb=kt,xb=or,Bb=function(t,r){if(!Nb(t))throw new wu("Assertion failed: `obj` must be a Typed Array");if(r!=="SEQ-CST"&&r!=="UNORDERED")throw new wu("Assertion failed: `order` must be ~SEQ-CST~ or ~UNORDERED~");var n=xb(t),i=Rb(n)?"DETACHED":Lb(n,r);return{"[[Object]]":t,"[[CachedBufferByteLength]]":i}},Er=U,Db=tt,Ub=Go,kb=Bb,qb=kt,bl=function(t,r){if(r!=="SEQ-CST"&&r!=="UNORDERED")throw new Er("Assertion failed: `order` must be ~SEQ-CST~ or ~UNORDERED~");if(!Db(t))throw new Er("Assertion failed: `O` must be an Object");if(!qb(t))throw new Er("Assertion failed: `O` must be a Typed Array");var n=kb(t,r);if(Ub(n))throw new Er("`O` must be in-bounds and backed by a non-detached buffer");return n},jb=Ve,wr=U,Gb=No,Vb=Jc,Wb=Go,zb=Ab,Hb=bl,Kb=nr(),Jb=function(t,r){if(!Vb(t))throw new wr("Assertion failed: `constructor` must be a constructor");if(!Gb(r))throw new wr("Assertion failed: `argumentList` must be a List");if(Kb.length===0)throw new jb("Assertion failed: Typed Arrays are not supported in this environment");var n;r.length===0?n=new t:r.length===1?n=new t(r[0]):r.length===2?n=new t(r[0],r[1]):n=new t(r[0],r[1],r[2]);var i=Hb(n,"SEQ-CST");if(r.length===1&&typeof r[0]=="number"){if(Wb(i))throw new wr("new Typed Array is out of bounds");var o=zb(i);if(o<r[0])throw new wr("`argumentList[0]` must be <= `newTypedArray.length`")}return n},Ee=X,Yb={__proto__:null,$Int8Array:Ee("%Int8Array%",!0),$Uint8Array:Ee("%Uint8Array%",!0),$Uint8ClampedArray:Ee("%Uint8ClampedArray%",!0),$Int16Array:Ee("%Int16Array%",!0),$Uint16Array:Ee("%Uint16Array%",!0),$Int32Array:Ee("%Int32Array%",!0),$Uint32Array:Ee("%Uint32Array%",!0),$BigInt64Array:Ee("%BigInt64Array%",!0),$BigUint64Array:Ee("%BigUint64Array%",!0),$Float16Array:Ee("%Float16Array%",!0),$Float32Array:Ee("%Float32Array%",!0),$Float64Array:Ee("%Float64Array%",!0)},Zb=function(t){return Yb["$"+t]},Au=Ve,Iu=U,Xb=xt,Qb=nr(),e0=No,t0=Gg,r0=Jb,n0=Zb,i0=function(t,r){if(Qb.length===0)throw new Au("Assertion failed: Typed Arrays are not supported in this environment");var n=Xb(t);if(!n)throw new Iu("Assertion failed: exemplar must be a TypedArray");if(!e0(r))throw new Iu("Assertion failed: `argumentList` must be a List");var i=n0(n);if(typeof i!="function")throw new Au("Assertion failed: `constructor` of `exemplar` ("+n+") must exist. Please report this!");var o=t0(t,i);return r0(o,r)},o0=U,a0=Mh,s0=by,u0=Dt,Zi=ec,$u=Qu,c0=_y,l0=vg,Cu=_g,Ou=Vc,f0=Bo,Fu=Pg,p0=i0,d0=bl,Xi=or,Pu=jo,Tl=function(t,r){var n=this;d0(n,"SEQ-CST");var i=n.length,o=Cu(t),a;o===-1/0?a=0:o<0?a=Zi(i+o,0):a=$u(o,i);var c=typeof r>"u"?i:Cu(r),u;c===-1/0?u=0:c<0?u=Zi(i+c,0):u=$u(c,i);var h=Zi(u-a,0),y=p0(n,[h]);if(h>0){if(u0(Xi(n)))throw new o0("Cannot use a Typed Array with an underlying ArrayBuffer that is detached");var b=Fu(n),l=Fu(y);if(b===l)for(var p=Xi(n),_=Xi(y),w=f0(n),A=Pu(n),R=a*w+A,O=Pu(y),m=O+h*w;O<m;){var I=s0(p,R,"UINT8",!0,"UNORDERED");l0(_,O,"UINT8",I,!0,"UNORDERED"),R+=1,O+=1}else for(var $=0;a<u;){var P=Ou(a),C=a0(n,P);c0(y,Ou($),C,!0),a+=1,$+=1}}return y},h0=Tl,Sl=function(){return typeof Uint8Array=="function"&&Uint8Array.prototype.slice||h0},y0=tr,g0=Ot,v0=Sl,m0=function(){if(typeof Uint8Array=="function"){var t=v0(),r=g0(Uint8Array.prototype);y0(r,{slice:t},{slice:function(){return r.slice!==t}})}return t},b0=tr,T0=Xe,S0=Tl,_l=Sl,_0=m0,El=T0(_l());b0(El,{getPolyfill:_l,implementation:S0,shim:_0});var E0=El,wl=xt,Al=E0,Mu=Kr;function jt(e){return Object.prototype.toString.call(e)}function w0(e){return jt(e)==="[object Date]"}function A0(e){return jt(e)==="[object RegExp]"}function I0(e){return jt(e)==="[object Error]"}function $0(e){return jt(e)==="[object Boolean]"}function C0(e){return jt(e)==="[object Number]"}function O0(e){return jt(e)==="[object String]"}var Il=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};function un(e,t){if(e.forEach)return e.forEach(t);for(var r=0;r<e.length;r++)t(e[r],r,e)}var cn=Object.keys||function(t){var r=[];for(var n in t)r[r.length]=n;return r},F0=Object.prototype.propertyIsEnumerable,Lu=Object.getOwnPropertySymbols;function ln(e){var t=cn(e);if(Lu)for(var r=Lu(e),n=0;n<r.length;n++)F0.call(e,r[n])&&(t[t.length]=r[n]);return t}var fn=Object.prototype.hasOwnProperty||function(e,t){return t in e};function P0(e,t){if(typeof Mu!="function")return!0;var r=Mu(e,t);return!r||!r.writable}function $l(e,t){if(typeof e=="object"&&e!==null){var r;if(Il(e))r=[];else if(w0(e))r=new Date(e.getTime?e.getTime():e);else if(A0(e))r=new RegExp(e);else if(I0(e))r={message:e.message};else if($0(e)||C0(e)||O0(e))r=Object(e);else{var n=wl(e);if(n)return Al(e);if(Object.create&&Object.getPrototypeOf)r=Object.create(Object.getPrototypeOf(e));else if(e.constructor===Object)r={};else{var i=e.constructor&&e.constructor.prototype||e.__proto__||{},o=function(){};o.prototype=i,r=new o}}var a=t.includeSymbols?ln:cn;return un(a(e),function(c){r[c]=e[c]}),r}return e}var Vo={__proto__:null};function Cl(e,t){var r=[],n=[],i=!0,o=arguments.length>2?arguments[2]:Vo,a=o.includeSymbols?ln:cn,c=!!o.immutable;return function u(h){var y=c?$l(h,o):h,b={__proto__:null},l=!0,p={node:y,node_:h,path:[].concat(r),parent:n[n.length-1],parents:n,key:r[r.length-1],removedKeys:{__proto__:null},isRoot:r.length===0,level:r.length,circular:null,update:function(A,R){p.isRoot||(p.parent.node[p.key]=A),p.node=A,R&&(l=!1)},delete:function(A){delete p.parent.node[p.key],p.parent.removedKeys[p.key]=!0,A&&(l=!1)},remove:function(A){Il(p.parent.node)?(p.parent.node.splice(p.key,1),p.parent.removedKeys[p.key]=!0,A&&(l=!1)):p.delete(A)},keys:null,before:function(A){b.before=A},after:function(A){b.after=A},pre:function(A){b.pre=A},post:function(A){b.post=A},stop:function(){i=!1},block:function(){l=!1}};if(!i)return p;function _(){if(typeof p.node=="object"&&p.node!==null){(!p.keys||p.node_!==p.node)&&(p.keys=a(p.node)),p.isLeaf=p.keys.length===0;for(var A=0;A<n.length;A++)if(n[A].node_===h){p.circular=n[A];break}}else p.isLeaf=!0,p.keys=null;p.notLeaf=!p.isLeaf,p.notRoot=!p.isRoot}_();var w=t.call(p,p.node);return w!==void 0&&p.update&&p.update(w),b.before&&b.before.call(p,p.node),l&&(typeof p.node=="object"&&p.node!==null&&!p.circular&&(n[n.length]=p,_(),un(p.keys,function(A,R){var O=R-1 in p.removedKeys;O&&(A=p.keys[R-1]),r[r.length]=A,b.pre&&b.pre.call(p,p.node[A],A);var m=u(p.node[A]);c&&fn.call(p.node,A)&&!P0(p.node,A)&&!O&&(p.node[A]=m.node),m.isLast=R===p.keys.length-1,m.isFirst=R===0,b.post&&b.post.call(p,m),r.pop()}),n.pop()),b.after&&b.after.call(p,p.node)),p}(e).node}function we(e){this.options=arguments.length>1?arguments[1]:Vo,this.value=e}we.prototype.get=function(e){for(var t=this.value,r=0;t&&r<e.length;r++){var n=e[r];if(!fn.call(t,n)||!this.options.includeSymbols&&typeof n=="symbol")return;t=t[n]}return t};we.prototype.has=function(e){var t=this.value;if(!t&&e.length>0)return!1;for(var r=0;t&&r<e.length;r++){var n=e[r];if(!fn.call(t,n)||!this.options.includeSymbols&&typeof n=="symbol")return!1;t=t[n]}return!0};we.prototype.set=function(e,t){for(var r=this.value,n=0;n<e.length-1;n++){var i=e[n];fn.call(r,i)||(r[i]={}),r=r[i]}return r[e[n]]=t,t};we.prototype.map=function(e){return Cl(this.value,e,{__proto__:null,immutable:!0,includeSymbols:!!this.options.includeSymbols})};we.prototype.forEach=function(e){return this.value=Cl(this.value,e,this.options),this.value};we.prototype.reduce=function(e,t){var r=arguments.length===1,n=r?this.value:t;return this.forEach(function(i){(!this.isRoot||!r)&&(n=e.call(this,n,i))}),n};we.prototype.paths=function(){var e=[];return this.forEach(function(){e[e.length]=this.path}),e};we.prototype.nodes=function(){var e=[];return this.forEach(function(){e[e.length]=this.node}),e};we.prototype.clone=function(){var e=[],t=[],r=this.options;return wl(this.value)?Al(this.value):function n(i){for(var o=0;o<e.length;o++)if(e[o]===i)return t[o];if(typeof i=="object"&&i!==null){var a=$l(i,r);e[e.length]=i,t[t.length]=a;var c=r.includeSymbols?ln:cn;return un(c(i),function(u){a[u]=n(i[u])}),e.pop(),t.pop(),a}return i}(this.value)};function Ol(e){var t=arguments.length>1?arguments[1]:Vo;return new we(e,t)}un(ln(we.prototype),function(e){Ol[e]=function(t){var r=[].slice.call(arguments,1),n=new we(t);return n[e].apply(n,r)}});var M0=Ol,L0=ye;function ye(e){if(!(this instanceof ye))return new ye(e);this._bbox=e||[1/0,1/0,-1/0,-1/0],this._valid=!!e}ye.prototype.include=function(e){return this._valid=!0,this._bbox[0]=Math.min(this._bbox[0],e[0]),this._bbox[1]=Math.min(this._bbox[1],e[1]),this._bbox[2]=Math.max(this._bbox[2],e[0]),this._bbox[3]=Math.max(this._bbox[3],e[1]),this};ye.prototype.equals=function(e){var t;return e instanceof ye?t=e.bbox():t=e,this._bbox[0]==t[0]&&this._bbox[1]==t[1]&&this._bbox[2]==t[2]&&this._bbox[3]==t[3]};ye.prototype.center=function(e){return this._valid?[(this._bbox[0]+this._bbox[2])/2,(this._bbox[1]+this._bbox[3])/2]:null};ye.prototype.union=function(e){this._valid=!0;var t;return e instanceof ye?t=e.bbox():t=e,this._bbox[0]=Math.min(this._bbox[0],t[0]),this._bbox[1]=Math.min(this._bbox[1],t[1]),this._bbox[2]=Math.max(this._bbox[2],t[2]),this._bbox[3]=Math.max(this._bbox[3],t[3]),this};ye.prototype.bbox=function(){return this._valid?this._bbox:null};ye.prototype.contains=function(e){if(!e)return this._fastContains();if(!this._valid)return null;var t=e[0],r=e[1];return this._bbox[0]<=t&&this._bbox[1]<=r&&this._bbox[2]>=t&&this._bbox[3]>=r};ye.prototype.intersect=function(e){if(!this._valid)return null;var t;return e instanceof ye?t=e.bbox():t=e,!(this._bbox[0]>t[2]||this._bbox[2]<t[0]||this._bbox[3]<t[1]||this._bbox[1]>t[3])};ye.prototype._fastContains=function(){if(!this._valid)return new Function("return null;");var e="return "+this._bbox[0]+"<= ll[0] &&"+this._bbox[1]+"<= ll[1] &&"+this._bbox[2]+">= ll[0] &&"+this._bbox[3]+">= ll[1]";return new Function("ll",e)};ye.prototype.polygon=function(){return this._valid?{type:"Polygon",coordinates:[[[this._bbox[0],this._bbox[1]],[this._bbox[2],this._bbox[1]],[this._bbox[2],this._bbox[3]],[this._bbox[0],this._bbox[3]],[this._bbox[0],this._bbox[1]]]]}:null};var R0=Od,N0=M0,x0=L0,Fl={features:["FeatureCollection"],coordinates:["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],geometry:["Feature"],geometries:["GeometryCollection"]},B0=Object.keys(Fl);rn.exports=function(e){return Wo(e).bbox()};rn.exports.polygon=function(e){return Wo(e).polygon()};rn.exports.bboxify=function(e){return N0(e).map(function(t){if(t){var r=B0.some(function(n){return t[n]?Fl[n].indexOf(t.type)!==-1:!1});r&&(t.bbox=Wo(t).bbox(),this.update(t))}})};function Wo(e){for(var t=x0(),r=R0(e),n=0;n<r.length;n++)t.include(r[n]);return t}var D0=rn.exports;const U0=D0,k0=G,{LAT_MIN:Ar,LAT_MAX:Ir,LAT_RENDERED_MIN:Ru,LAT_RENDERED_MAX:Nu,LNG_MIN:xu,LNG_MAX:Bu}=k0;var zo=function(e,t){let r=Ar,n=Ir,i=Ar,o=Ir,a=Bu,c=xu;e.forEach(h=>{const y=U0(h),b=y[1],l=y[3],p=y[0],_=y[2];b>r&&(r=b),l<n&&(n=l),l>i&&(i=l),b<o&&(o=b),p<a&&(a=p),_>c&&(c=_)});const u=t;return r+u.lat>Nu&&(u.lat=Nu-r),i+u.lat>Ir&&(u.lat=Ir-i),n+u.lat<Ru&&(u.lat=Ru-n),o+u.lat<Ar&&(u.lat=Ar-o),a+u.lng<=xu&&(u.lng+=Math.ceil(Math.abs(u.lng)/360)*360),c+u.lng>=Bu&&(u.lng-=Math.ceil(Math.abs(u.lng)/360)*360),u};const q0=zo,wt=G;var pn=function(e,t){const r=q0(e.map(n=>n.toGeoJSON()),t);e.forEach(n=>{const i=n.getCoordinates(),o=h=>{const y={lng:h[0]+r.lng,lat:h[1]+r.lat};return[y.lng,y.lat]},a=h=>h.map(y=>o(y)),c=h=>h.map(y=>a(y));let u;n.type===wt.geojsonTypes.POINT?u=o(i):n.type===wt.geojsonTypes.LINE_STRING||n.type===wt.geojsonTypes.MULTI_POINT?u=i.map(o):n.type===wt.geojsonTypes.POLYGON||n.type===wt.geojsonTypes.MULTI_LINE_STRING?u=i.map(a):n.type===wt.geojsonTypes.MULTI_POLYGON&&(u=i.map(c)),n.incomingCoords(u)})};const ft=Rt,Ho=Sd,j0=tn,G0=Jr,Gr=Nt,V0=pn,ne=G,z={};z.onSetup=function(e){const t={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoveing:!1,canDragMove:!1,initiallySelectedFeatureIds:e.featureIds||[]};return this.setSelected(t.initiallySelectedFeatureIds.filter(r=>this.getFeature(r)!==void 0)),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),t};z.fireUpdate=function(){this.map.fire(ne.events.UPDATE,{action:ne.updateActions.MOVE,features:this.getSelected().map(e=>e.toGeoJSON())})};z.fireActionable=function(){const e=this.getSelected(),t=e.filter(o=>this.isInstanceOf("MultiFeature",o));let r=!1;if(e.length>1){r=!0;const o=e[0].type.replace("Multi","");e.forEach(a=>{a.type.replace("Multi","")!==o&&(r=!1)})}const n=t.length>0,i=e.length>0;this.setActionableState({combineFeatures:r,uncombineFeatures:n,trash:i})};z.getUniqueIds=function(e){return e.length?e.map(r=>r.properties.id).filter(r=>r!==void 0).reduce((r,n)=>(r.add(n),r),new G0).values():[]};z.stopExtendedInteractions=function(e){e.boxSelectElement&&(e.boxSelectElement.parentNode&&e.boxSelectElement.parentNode.removeChild(e.boxSelectElement),e.boxSelectElement=null),this.map.dragPan.enable(),e.boxSelecting=!1,e.canBoxSelect=!1,e.dragMoving=!1,e.canDragMove=!1};z.onStop=function(){Gr.enable(this)};z.onMouseMove=function(e){return this.stopExtendedInteractions(e)};z.onMouseOut=function(e){if(e.dragMoving)return this.fireUpdate()};z.onTap=z.onClick=function(e,t){if(ft.noTarget(t))return this.clickAnywhere(e,t);if(ft.isOfMetaType(ne.meta.VERTEX)(t))return this.clickOnVertex(e,t);if(ft.isFeature(t))return this.clickOnFeature(e,t)};z.clickAnywhere=function(e){const t=this.getSelectedIds();t.length&&(this.clearSelectedFeatures(),t.forEach(r=>this.doRender(r))),Gr.enable(this),this.stopExtendedInteractions(e)};z.clickOnVertex=function(e,t){this.changeMode(ne.modes.DIRECT_SELECT,{featureId:t.featureTarget.properties.parent,coordPath:t.featureTarget.properties.coord_path,startPos:t.lngLat}),this.updateUIClasses({mouse:ne.cursors.MOVE})};z.startOnActiveFeature=function(e,t){this.stopExtendedInteractions(e),this.map.dragPan.disable(),this.doRender(t.featureTarget.properties.id),e.canDragMove=!0,e.dragMoveLocation=t.lngLat};z.clickOnFeature=function(e,t){Gr.disable(this),this.stopExtendedInteractions(e);const r=ft.isShiftDown(t),n=this.getSelectedIds(),i=t.featureTarget.properties.id,o=this.isSelected(i);if(!r&&o&&this.getFeature(i).type!==ne.geojsonTypes.POINT)return this.changeMode(ne.modes.DIRECT_SELECT,{featureId:i});o&&r?(this.deselect(i),this.updateUIClasses({mouse:ne.cursors.POINTER}),n.length===1&&Gr.enable(this)):!o&&r?(this.select(i),this.updateUIClasses({mouse:ne.cursors.MOVE})):!o&&!r&&(n.forEach(a=>this.doRender(a)),this.setSelected(i),this.updateUIClasses({mouse:ne.cursors.MOVE})),this.doRender(i)};z.onMouseDown=function(e,t){if(ft.isActiveFeature(t))return this.startOnActiveFeature(e,t);if(this.drawConfig.boxSelect&&ft.isShiftMousedown(t))return this.startBoxSelect(e,t)};z.startBoxSelect=function(e,t){this.stopExtendedInteractions(e),this.map.dragPan.disable(),e.boxSelectStartLocation=Ho(t.originalEvent,this.map.getContainer()),e.canBoxSelect=!0};z.onTouchStart=function(e,t){if(ft.isActiveFeature(t))return this.startOnActiveFeature(e,t)};z.onDrag=function(e,t){if(e.canDragMove)return this.dragMove(e,t);if(this.drawConfig.boxSelect&&e.canBoxSelect)return this.whileBoxSelect(e,t)};z.whileBoxSelect=function(e,t){e.boxSelecting=!0,this.updateUIClasses({mouse:ne.cursors.ADD}),e.boxSelectElement||(e.boxSelectElement=document.createElement("div"),e.boxSelectElement.classList.add(ne.classes.BOX_SELECT),this.map.getContainer().appendChild(e.boxSelectElement));const r=Ho(t.originalEvent,this.map.getContainer()),n=Math.min(e.boxSelectStartLocation.x,r.x),i=Math.max(e.boxSelectStartLocation.x,r.x),o=Math.min(e.boxSelectStartLocation.y,r.y),a=Math.max(e.boxSelectStartLocation.y,r.y),c=`translate(${n}px, ${o}px)`;e.boxSelectElement.style.transform=c,e.boxSelectElement.style.WebkitTransform=c,e.boxSelectElement.style.width=`${i-n}px`,e.boxSelectElement.style.height=`${a-o}px`};z.dragMove=function(e,t){e.dragMoving=!0,t.originalEvent.stopPropagation();const r={lng:t.lngLat.lng-e.dragMoveLocation.lng,lat:t.lngLat.lat-e.dragMoveLocation.lat};V0(this.getSelected(),r),e.dragMoveLocation=t.lngLat};z.onMouseUp=function(e,t){if(e.dragMoving)this.fireUpdate();else if(e.boxSelecting){const r=[e.boxSelectStartLocation,Ho(t.originalEvent,this.map.getContainer())],n=this.featuresAt(null,r,"click"),i=this.getUniqueIds(n).filter(o=>!this.isSelected(o));i.length&&(this.select(i),i.forEach(o=>this.doRender(o)),this.updateUIClasses({mouse:ne.cursors.MOVE}))}this.stopExtendedInteractions(e)};z.toDisplayFeatures=function(e,t,r){t.properties.active=this.isSelected(t.properties.id)?ne.activeStates.ACTIVE:ne.activeStates.INACTIVE,r(t),this.fireActionable(),!(t.properties.active!==ne.activeStates.ACTIVE||t.geometry.type===ne.geojsonTypes.POINT)&&j0(t).forEach(r)};z.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()};z.onCombineFeatures=function(){const e=this.getSelected();if(e.length===0||e.length<2)return;const t=[],r=[],n=e[0].type.replace("Multi","");for(let i=0;i<e.length;i++){const o=e[i];if(o.type.replace("Multi","")!==n)return;o.type.includes("Multi")?o.getCoordinates().forEach(a=>{t.push(a)}):t.push(o.getCoordinates()),r.push(o.toGeoJSON())}if(r.length>1){const i=this.newFeature({type:ne.geojsonTypes.FEATURE,properties:r[0].properties,geometry:{type:`Multi${n}`,coordinates:t}});this.addFeature(i),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([i.id]),this.map.fire(ne.events.COMBINE_FEATURES,{createdFeatures:[i.toGeoJSON()],deletedFeatures:r})}this.fireActionable()};z.onUncombineFeatures=function(){const e=this.getSelected();if(e.length===0)return;const t=[],r=[];for(let n=0;n<e.length;n++){const i=e[n];this.isInstanceOf("MultiFeature",i)&&(i.getFeatures().forEach(o=>{this.addFeature(o),o.properties=i.properties,t.push(o.toGeoJSON()),this.select([o.id])}),this.deleteFeature(i.id,{silent:!0}),r.push(i.toGeoJSON()))}t.length>1&&this.map.fire(ne.events.UNCOMBINE_FEATURES,{createdFeatures:t,deletedFeatures:r}),this.fireActionable()};var W0=z;const{noTarget:Pl,isOfMetaType:Ml,isInactiveFeature:Ll,isShiftDown:Du}=Rt,z0=tn,H0=zo,Rl=Nt,he=G,dn=Rt,K0=pn,Nl=Ml(he.meta.VERTEX),J0=Ml(he.meta.MIDPOINT),W={};W.fireUpdate=function(){this.map.fire(he.events.UPDATE,{action:he.updateActions.CHANGE_COORDINATES,features:this.getSelected().map(e=>e.toGeoJSON())})};W.fireActionable=function(e){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:e.selectedCoordPaths.length>0})};W.startDragging=function(e,t){this.map.dragPan.disable(),e.canDragMove=!0,e.dragMoveLocation=t.lngLat};W.stopDragging=function(e){this.map.dragPan.enable(),e.dragMoving=!1,e.canDragMove=!1,e.dragMoveLocation=null};W.onVertex=function(e,t){this.startDragging(e,t);const r=t.featureTarget.properties,n=e.selectedCoordPaths.indexOf(r.coord_path);!Du(t)&&n===-1?e.selectedCoordPaths=[r.coord_path]:Du(t)&&n===-1&&e.selectedCoordPaths.push(r.coord_path);const i=this.pathsToCoordinates(e.featureId,e.selectedCoordPaths);this.setSelectedCoordinates(i)};W.onMidpoint=function(e,t){this.startDragging(e,t);const r=t.featureTarget.properties;e.feature.addCoordinate(r.coord_path,r.lng,r.lat),this.fireUpdate(),e.selectedCoordPaths=[r.coord_path]};W.pathsToCoordinates=function(e,t){return t.map(r=>({feature_id:e,coord_path:r}))};W.onFeature=function(e,t){e.selectedCoordPaths.length===0?this.startDragging(e,t):this.stopDragging(e)};W.dragFeature=function(e,t,r){K0(this.getSelected(),r),e.dragMoveLocation=t.lngLat};W.dragVertex=function(e,t,r){const n=e.selectedCoordPaths.map(a=>e.feature.getCoordinate(a)),i=n.map(a=>({type:he.geojsonTypes.FEATURE,properties:{},geometry:{type:he.geojsonTypes.POINT,coordinates:a}})),o=H0(i,r);for(let a=0;a<n.length;a++){const c=n[a];e.feature.updateCoordinate(e.selectedCoordPaths[a],c[0]+o.lng,c[1]+o.lat)}};W.clickNoTarget=function(){this.changeMode(he.modes.SIMPLE_SELECT)};W.clickInactive=function(){this.changeMode(he.modes.SIMPLE_SELECT)};W.clickActiveFeature=function(e){e.selectedCoordPaths=[],this.clearSelectedCoordinates(),e.feature.changed()};W.onSetup=function(e){const t=e.featureId,r=this.getFeature(t);if(!r)throw new Error("You must provide a featureId to enter direct_select mode");if(r.type===he.geojsonTypes.POINT)throw new TypeError("direct_select mode doesn't handle point features");const n={featureId:t,feature:r,dragMoveLocation:e.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:e.coordPath?[e.coordPath]:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(t,n.selectedCoordPaths)),this.setSelected(t),Rl.disable(this),this.setActionableState({trash:!0}),n};W.onStop=function(){Rl.enable(this),this.clearSelectedCoordinates()};W.toDisplayFeatures=function(e,t,r){e.featureId===t.properties.id?(t.properties.active=he.activeStates.ACTIVE,r(t),z0(t,{map:this.map,midpoints:!0,selectedPaths:e.selectedCoordPaths}).forEach(r)):(t.properties.active=he.activeStates.INACTIVE,r(t)),this.fireActionable(e)};W.onTrash=function(e){e.selectedCoordPaths.sort().reverse().forEach(t=>e.feature.removeCoordinate(t)),this.fireUpdate(),e.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(e),e.feature.isValid()===!1&&(this.deleteFeature([e.featureId]),this.changeMode(he.modes.SIMPLE_SELECT,{}))};W.onMouseMove=function(e,t){const r=dn.isActiveFeature(t),n=Nl(t),i=e.selectedCoordPaths.length===0;r&&i?this.updateUIClasses({mouse:he.cursors.MOVE}):n&&!i?this.updateUIClasses({mouse:he.cursors.MOVE}):this.updateUIClasses({mouse:he.cursors.NONE}),this.stopDragging(e)};W.onMouseOut=function(e){e.dragMoving&&this.fireUpdate()};W.onTouchStart=W.onMouseDown=function(e,t){if(Nl(t))return this.onVertex(e,t);if(dn.isActiveFeature(t))return this.onFeature(e,t);if(J0(t))return this.onMidpoint(e,t)};W.onDrag=function(e,t){if(e.canDragMove!==!0)return;e.dragMoving=!0,t.originalEvent.stopPropagation();const r={lng:t.lngLat.lng-e.dragMoveLocation.lng,lat:t.lngLat.lat-e.dragMoveLocation.lat};e.selectedCoordPaths.length>0?this.dragVertex(e,t,r):this.dragFeature(e,t,r),e.dragMoveLocation=t.lngLat};W.onClick=function(e,t){if(Pl(t))return this.clickNoTarget(e,t);if(dn.isActiveFeature(t))return this.clickActiveFeature(e,t);if(Ll(t))return this.clickInactive(e,t);this.stopDragging(e)};W.onTap=function(e,t){if(Pl(t))return this.clickNoTarget(e,t);if(dn.isActiveFeature(t))return this.clickActiveFeature(e,t);if(Ll(t))return this.clickInactive(e,t)};W.onTouchEnd=W.onMouseUp=function(e){e.dragMoving&&this.fireUpdate(),this.stopDragging(e)};var Y0=W;const Uu=Rt,Re=G,Ne={};Ne.onSetup=function(){const e=this.newFeature({type:Re.geojsonTypes.FEATURE,properties:{},geometry:{type:Re.geojsonTypes.POINT,coordinates:[]}});return this.addFeature(e),this.clearSelectedFeatures(),this.updateUIClasses({mouse:Re.cursors.ADD}),this.activateUIButton(Re.types.POINT),this.setActionableState({trash:!0}),{point:e}};Ne.stopDrawingAndRemove=function(e){this.deleteFeature([e.point.id],{silent:!0}),this.changeMode(Re.modes.SIMPLE_SELECT)};Ne.onTap=Ne.onClick=function(e,t){this.updateUIClasses({mouse:Re.cursors.MOVE}),e.point.updateCoordinate("",t.lngLat.lng,t.lngLat.lat),this.map.fire(Re.events.CREATE,{features:[e.point.toGeoJSON()]}),this.changeMode(Re.modes.SIMPLE_SELECT,{featureIds:[e.point.id]})};Ne.onStop=function(e){this.activateUIButton(),e.point.getCoordinate().length||this.deleteFeature([e.point.id],{silent:!0})};Ne.toDisplayFeatures=function(e,t,r){const n=t.properties.id===e.point.id;if(t.properties.active=n?Re.activeStates.ACTIVE:Re.activeStates.INACTIVE,!n)return r(t)};Ne.onTrash=Ne.stopDrawingAndRemove;Ne.onKeyUp=function(e,t){if(Uu.isEscapeKey(t)||Uu.isEnterKey(t))return this.stopDrawingAndRemove(e,t)};var Z0=Ne;function X0(e,t){return e.lngLat?e.lngLat.lng===t[0]&&e.lngLat.lat===t[1]:!1}var xl=X0;const Vr=Rt,Bl=Nt,ae=G,Q0=xl,ku=en,$e={};$e.onSetup=function(){const e=this.newFeature({type:ae.geojsonTypes.FEATURE,properties:{},geometry:{type:ae.geojsonTypes.POLYGON,coordinates:[[]]}});return this.addFeature(e),this.clearSelectedFeatures(),Bl.disable(this),this.updateUIClasses({mouse:ae.cursors.ADD}),this.activateUIButton(ae.types.POLYGON),this.setActionableState({trash:!0}),{polygon:e,currentVertexPosition:0}};$e.clickAnywhere=function(e,t){if(e.currentVertexPosition>0&&Q0(t,e.polygon.coordinates[0][e.currentVertexPosition-1]))return this.changeMode(ae.modes.SIMPLE_SELECT,{featureIds:[e.polygon.id]});this.updateUIClasses({mouse:ae.cursors.ADD}),e.polygon.updateCoordinate(`0.${e.currentVertexPosition}`,t.lngLat.lng,t.lngLat.lat),e.currentVertexPosition++,e.polygon.updateCoordinate(`0.${e.currentVertexPosition}`,t.lngLat.lng,t.lngLat.lat)};$e.clickOnVertex=function(e){return this.changeMode(ae.modes.SIMPLE_SELECT,{featureIds:[e.polygon.id]})};$e.onMouseMove=function(e,t){e.polygon.updateCoordinate(`0.${e.currentVertexPosition}`,t.lngLat.lng,t.lngLat.lat),Vr.isVertex(t)&&this.updateUIClasses({mouse:ae.cursors.POINTER})};$e.onTap=$e.onClick=function(e,t){return Vr.isVertex(t)?this.clickOnVertex(e,t):this.clickAnywhere(e,t)};$e.onKeyUp=function(e,t){Vr.isEscapeKey(t)?(this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(ae.modes.SIMPLE_SELECT)):Vr.isEnterKey(t)&&this.changeMode(ae.modes.SIMPLE_SELECT,{featureIds:[e.polygon.id]})};$e.onStop=function(e){this.updateUIClasses({mouse:ae.cursors.NONE}),Bl.enable(this),this.activateUIButton(),this.getFeature(e.polygon.id)!==void 0&&(e.polygon.removeCoordinate(`0.${e.currentVertexPosition}`),e.polygon.isValid()?this.map.fire(ae.events.CREATE,{features:[e.polygon.toGeoJSON()]}):(this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(ae.modes.SIMPLE_SELECT,{},{silent:!0})))};$e.toDisplayFeatures=function(e,t,r){const n=t.properties.id===e.polygon.id;if(t.properties.active=n?ae.activeStates.ACTIVE:ae.activeStates.INACTIVE,!n)return r(t);if(t.geometry.coordinates.length===0)return;const i=t.geometry.coordinates[0].length;if(!(i<3)){if(t.properties.meta=ae.meta.FEATURE,r(ku(e.polygon.id,t.geometry.coordinates[0][0],"0.0",!1)),i>3){const o=t.geometry.coordinates[0].length-3;r(ku(e.polygon.id,t.geometry.coordinates[0][o],`0.${o}`,!1))}if(i<=4){const o=[[t.geometry.coordinates[0][0][0],t.geometry.coordinates[0][0][1]],[t.geometry.coordinates[0][1][0],t.geometry.coordinates[0][1][1]]];if(r({type:ae.geojsonTypes.FEATURE,properties:t.properties,geometry:{coordinates:o,type:ae.geojsonTypes.LINE_STRING}}),i===3)return}return r(t)}};$e.onTrash=function(e){this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(ae.modes.SIMPLE_SELECT)};var eT=$e;const Wr=Rt,qu=xl,Dl=Nt,pe=G,tT=en,Ce={};Ce.onSetup=function(e){e=e||{};const t=e.featureId;let r,n,i="forward";if(t){if(r=this.getFeature(t),!r)throw new Error("Could not find a feature with the provided featureId");let o=e.from;if(o&&o.type==="Feature"&&o.geometry&&o.geometry.type==="Point"&&(o=o.geometry),o&&o.type==="Point"&&o.coordinates&&o.coordinates.length===2&&(o=o.coordinates),!o||!Array.isArray(o))throw new Error("Please use the `from` property to indicate which point to continue the line from");const a=r.coordinates.length-1;if(r.coordinates[a][0]===o[0]&&r.coordinates[a][1]===o[1])n=a+1,r.addCoordinate(n,...r.coordinates[a]);else if(r.coordinates[0][0]===o[0]&&r.coordinates[0][1]===o[1])i="backwards",n=0,r.addCoordinate(n,...r.coordinates[0]);else throw new Error("`from` should match the point at either the start or the end of the provided LineString")}else r=this.newFeature({type:pe.geojsonTypes.FEATURE,properties:{},geometry:{type:pe.geojsonTypes.LINE_STRING,coordinates:[]}}),n=0,this.addFeature(r);return this.clearSelectedFeatures(),Dl.disable(this),this.updateUIClasses({mouse:pe.cursors.ADD}),this.activateUIButton(pe.types.LINE),this.setActionableState({trash:!0}),{line:r,currentVertexPosition:n,direction:i}};Ce.clickAnywhere=function(e,t){if(e.currentVertexPosition>0&&qu(t,e.line.coordinates[e.currentVertexPosition-1])||e.direction==="backwards"&&qu(t,e.line.coordinates[e.currentVertexPosition+1]))return this.changeMode(pe.modes.SIMPLE_SELECT,{featureIds:[e.line.id]});this.updateUIClasses({mouse:pe.cursors.ADD}),e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat),e.direction==="forward"?(e.currentVertexPosition++,e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat)):e.line.addCoordinate(0,t.lngLat.lng,t.lngLat.lat)};Ce.clickOnVertex=function(e){return this.changeMode(pe.modes.SIMPLE_SELECT,{featureIds:[e.line.id]})};Ce.onMouseMove=function(e,t){e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat),Wr.isVertex(t)&&this.updateUIClasses({mouse:pe.cursors.POINTER})};Ce.onTap=Ce.onClick=function(e,t){if(Wr.isVertex(t))return this.clickOnVertex(e,t);this.clickAnywhere(e,t)};Ce.onKeyUp=function(e,t){Wr.isEnterKey(t)?this.changeMode(pe.modes.SIMPLE_SELECT,{featureIds:[e.line.id]}):Wr.isEscapeKey(t)&&(this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(pe.modes.SIMPLE_SELECT))};Ce.onStop=function(e){Dl.enable(this),this.activateUIButton(),this.getFeature(e.line.id)!==void 0&&(e.line.removeCoordinate(`${e.currentVertexPosition}`),e.line.isValid()?this.map.fire(pe.events.CREATE,{features:[e.line.toGeoJSON()]}):(this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(pe.modes.SIMPLE_SELECT,{},{silent:!0})))};Ce.onTrash=function(e){this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(pe.modes.SIMPLE_SELECT)};Ce.toDisplayFeatures=function(e,t,r){const n=t.properties.id===e.line.id;if(t.properties.active=n?pe.activeStates.ACTIVE:pe.activeStates.INACTIVE,!n)return r(t);t.geometry.coordinates.length<2||(t.properties.meta=pe.meta.FEATURE,r(tT(e.line.id,t.geometry.coordinates[e.direction==="forward"?t.geometry.coordinates.length-2:1],`${e.direction==="forward"?t.geometry.coordinates.length-2:1}`,!1)),r(t))};var rT=Ce,Ul={simple_select:W0,direct_select:Y0,draw_point:Z0,draw_polygon:eT,draw_line_string:rT};const Yt=So,bo=G,nT={defaultMode:bo.modes.SIMPLE_SELECT,keybindings:!0,touchEnabled:!0,clickBuffer:2,touchBuffer:25,boxSelect:!0,displayControlsDefault:!0,styles:vd,modes:Ul,controls:{},userProperties:!1},iT={point:!0,line_string:!0,polygon:!0,trash:!0,combine_features:!0,uncombine_features:!0},oT={point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1};function ju(e,t){return e.map(r=>r.source?r:Yt(r,{id:`${r.id}.${t}`,source:t==="hot"?bo.sources.HOT:bo.sources.COLD}))}var aT=function(e={}){let t=Yt(e);return e.controls||(t.controls={}),e.displayControlsDefault===!1?t.controls=Yt(oT,e.controls):t.controls=Yt(iT,e.controls),t=Yt(nT,t),t.styles=ju(t.styles,"cold").concat(ju(t.styles,"hot")),t},zr={exports:{}};zr.exports;(function(e,t){var r=200,n="__lodash_hash_undefined__",i=1,o=2,a=9007199254740991,c="[object Arguments]",u="[object Array]",h="[object AsyncFunction]",y="[object Boolean]",b="[object Date]",l="[object Error]",p="[object Function]",_="[object GeneratorFunction]",w="[object Map]",A="[object Number]",R="[object Null]",O="[object Object]",m="[object Promise]",I="[object Proxy]",$="[object RegExp]",P="[object Set]",C="[object String]",B="[object Symbol]",f="[object Undefined]",S="[object WeakMap]",g="[object ArrayBuffer]",v="[object DataView]",E="[object Float32Array]",N="[object Float64Array]",j="[object Int8Array]",Q="[object Int16Array]",ge="[object Int32Array]",Be="[object Uint8Array]",vt="[object Uint8ClampedArray]",x="[object Uint16Array]",L="[object Uint32Array]",q=/[\\^$.*+?()[\]{}|]/g,k=/^\[object .+?Constructor\]$/,K=/^(?:0|[1-9]\d*)$/,M={};M[E]=M[N]=M[j]=M[Q]=M[ge]=M[Be]=M[vt]=M[x]=M[L]=!0,M[c]=M[u]=M[g]=M[y]=M[v]=M[b]=M[l]=M[p]=M[w]=M[A]=M[O]=M[$]=M[P]=M[C]=M[S]=!1;var re=typeof window=="object"&&window&&window.Object===Object&&window,le=typeof self=="object"&&self&&self.Object===Object&&self,te=re||le||Function("return this")(),De=t&&!t.nodeType&&t,ze=De&&!0&&e&&!e.nodeType&&e,me=ze&&ze.exports===De,be=me&&re.process,mt=function(){try{return be&&be.binding&&be.binding("util")}catch{}}(),bt=mt&&mt.isTypedArray;function ar(s,d){for(var T=-1,F=s==null?0:s.length,H=0,D=[];++T<F;){var ee=s[T];d(ee,T,s)&&(D[H++]=ee)}return D}function gn(s,d){for(var T=-1,F=d.length,H=s.length;++T<F;)s[H+T]=d[T];return s}function zl(s,d){for(var T=-1,F=s==null?0:s.length;++T<F;)if(d(s[T],T,s))return!0;return!1}function Hl(s,d){for(var T=-1,F=Array(s);++T<s;)F[T]=d(T);return F}function Kl(s){return function(d){return s(d)}}function Jl(s,d){return s.has(d)}function Yl(s,d){return s==null?void 0:s[d]}function Zl(s){var d=-1,T=Array(s.size);return s.forEach(function(F,H){T[++d]=[H,F]}),T}function Xl(s,d){return function(T){return s(d(T))}}function Ql(s){var d=-1,T=Array(s.size);return s.forEach(function(F){T[++d]=F}),T}var ef=Array.prototype,tf=Function.prototype,sr=Object.prototype,vn=te["__core-js_shared__"],Zo=tf.toString,Pe=sr.hasOwnProperty,Xo=function(){var s=/[^.]+$/.exec(vn&&vn.keys&&vn.keys.IE_PROTO||"");return s?"Symbol(src)_1."+s:""}(),Qo=sr.toString,rf=RegExp("^"+Zo.call(Pe).replace(q,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ea=me?te.Buffer:void 0,ur=te.Symbol,ta=te.Uint8Array,ra=sr.propertyIsEnumerable,nf=ef.splice,nt=ur?ur.toStringTag:void 0,na=Object.getOwnPropertySymbols,of=ea?ea.isBuffer:void 0,af=Xl(Object.keys,Object),mn=Tt(te,"DataView"),Gt=Tt(te,"Map"),bn=Tt(te,"Promise"),Tn=Tt(te,"Set"),Sn=Tt(te,"WeakMap"),Vt=Tt(Object,"create"),sf=at(mn),uf=at(Gt),cf=at(bn),lf=at(Tn),ff=at(Sn),ia=ur?ur.prototype:void 0,_n=ia?ia.valueOf:void 0;function it(s){var d=-1,T=s==null?0:s.length;for(this.clear();++d<T;){var F=s[d];this.set(F[0],F[1])}}function pf(){this.__data__=Vt?Vt(null):{},this.size=0}function df(s){var d=this.has(s)&&delete this.__data__[s];return this.size-=d?1:0,d}function hf(s){var d=this.__data__;if(Vt){var T=d[s];return T===n?void 0:T}return Pe.call(d,s)?d[s]:void 0}function yf(s){var d=this.__data__;return Vt?d[s]!==void 0:Pe.call(d,s)}function gf(s,d){var T=this.__data__;return this.size+=this.has(s)?0:1,T[s]=Vt&&d===void 0?n:d,this}it.prototype.clear=pf,it.prototype.delete=df,it.prototype.get=hf,it.prototype.has=yf,it.prototype.set=gf;function Ue(s){var d=-1,T=s==null?0:s.length;for(this.clear();++d<T;){var F=s[d];this.set(F[0],F[1])}}function vf(){this.__data__=[],this.size=0}function mf(s){var d=this.__data__,T=lr(d,s);if(T<0)return!1;var F=d.length-1;return T==F?d.pop():nf.call(d,T,1),--this.size,!0}function bf(s){var d=this.__data__,T=lr(d,s);return T<0?void 0:d[T][1]}function Tf(s){return lr(this.__data__,s)>-1}function Sf(s,d){var T=this.__data__,F=lr(T,s);return F<0?(++this.size,T.push([s,d])):T[F][1]=d,this}Ue.prototype.clear=vf,Ue.prototype.delete=mf,Ue.prototype.get=bf,Ue.prototype.has=Tf,Ue.prototype.set=Sf;function ot(s){var d=-1,T=s==null?0:s.length;for(this.clear();++d<T;){var F=s[d];this.set(F[0],F[1])}}function _f(){this.size=0,this.__data__={hash:new it,map:new(Gt||Ue),string:new it}}function Ef(s){var d=fr(this,s).delete(s);return this.size-=d?1:0,d}function wf(s){return fr(this,s).get(s)}function Af(s){return fr(this,s).has(s)}function If(s,d){var T=fr(this,s),F=T.size;return T.set(s,d),this.size+=T.size==F?0:1,this}ot.prototype.clear=_f,ot.prototype.delete=Ef,ot.prototype.get=wf,ot.prototype.has=Af,ot.prototype.set=If;function cr(s){var d=-1,T=s==null?0:s.length;for(this.__data__=new ot;++d<T;)this.add(s[d])}function $f(s){return this.__data__.set(s,n),this}function Cf(s){return this.__data__.has(s)}cr.prototype.add=cr.prototype.push=$f,cr.prototype.has=Cf;function He(s){var d=this.__data__=new Ue(s);this.size=d.size}function Of(){this.__data__=new Ue,this.size=0}function Ff(s){var d=this.__data__,T=d.delete(s);return this.size=d.size,T}function Pf(s){return this.__data__.get(s)}function Mf(s){return this.__data__.has(s)}function Lf(s,d){var T=this.__data__;if(T instanceof Ue){var F=T.__data__;if(!Gt||F.length<r-1)return F.push([s,d]),this.size=++T.size,this;T=this.__data__=new ot(F)}return T.set(s,d),this.size=T.size,this}He.prototype.clear=Of,He.prototype.delete=Ff,He.prototype.get=Pf,He.prototype.has=Mf,He.prototype.set=Lf;function Rf(s,d){var T=pr(s),F=!T&&Jf(s),H=!T&&!F&&En(s),D=!T&&!F&&!H&&da(s),ee=T||F||H||D,se=ee?Hl(s.length,String):[],ce=se.length;for(var Y in s)Pe.call(s,Y)&&!(ee&&(Y=="length"||H&&(Y=="offset"||Y=="parent")||D&&(Y=="buffer"||Y=="byteLength"||Y=="byteOffset")||Vf(Y,ce)))&&se.push(Y);return se}function lr(s,d){for(var T=s.length;T--;)if(ca(s[T][0],d))return T;return-1}function Nf(s,d,T){var F=d(s);return pr(s)?F:gn(F,T(s))}function Wt(s){return s==null?s===void 0?f:R:nt&&nt in Object(s)?jf(s):Kf(s)}function oa(s){return zt(s)&&Wt(s)==c}function aa(s,d,T,F,H){return s===d?!0:s==null||d==null||!zt(s)&&!zt(d)?s!==s&&d!==d:xf(s,d,T,F,aa,H)}function xf(s,d,T,F,H,D){var ee=pr(s),se=pr(d),ce=ee?u:Ke(s),Y=se?u:Ke(d);ce=ce==c?O:ce,Y=Y==c?O:Y;var ve=ce==O,Ae=Y==O,fe=ce==Y;if(fe&&En(s)){if(!En(d))return!1;ee=!0,ve=!1}if(fe&&!ve)return D||(D=new He),ee||da(s)?sa(s,d,T,F,H,D):kf(s,d,ce,T,F,H,D);if(!(T&i)){var Te=ve&&Pe.call(s,"__wrapped__"),Se=Ae&&Pe.call(d,"__wrapped__");if(Te||Se){var Je=Te?s.value():s,ke=Se?d.value():d;return D||(D=new He),H(Je,ke,T,F,D)}}return fe?(D||(D=new He),qf(s,d,T,F,H,D)):!1}function Bf(s){if(!pa(s)||zf(s))return!1;var d=la(s)?rf:k;return d.test(at(s))}function Df(s){return zt(s)&&fa(s.length)&&!!M[Wt(s)]}function Uf(s){if(!Hf(s))return af(s);var d=[];for(var T in Object(s))Pe.call(s,T)&&T!="constructor"&&d.push(T);return d}function sa(s,d,T,F,H,D){var ee=T&i,se=s.length,ce=d.length;if(se!=ce&&!(ee&&ce>se))return!1;var Y=D.get(s);if(Y&&D.get(d))return Y==d;var ve=-1,Ae=!0,fe=T&o?new cr:void 0;for(D.set(s,d),D.set(d,s);++ve<se;){var Te=s[ve],Se=d[ve];if(F)var Je=ee?F(Se,Te,ve,d,s,D):F(Te,Se,ve,s,d,D);if(Je!==void 0){if(Je)continue;Ae=!1;break}if(fe){if(!zl(d,function(ke,st){if(!Jl(fe,st)&&(Te===ke||H(Te,ke,T,F,D)))return fe.push(st)})){Ae=!1;break}}else if(!(Te===Se||H(Te,Se,T,F,D))){Ae=!1;break}}return D.delete(s),D.delete(d),Ae}function kf(s,d,T,F,H,D,ee){switch(T){case v:if(s.byteLength!=d.byteLength||s.byteOffset!=d.byteOffset)return!1;s=s.buffer,d=d.buffer;case g:return!(s.byteLength!=d.byteLength||!D(new ta(s),new ta(d)));case y:case b:case A:return ca(+s,+d);case l:return s.name==d.name&&s.message==d.message;case $:case C:return s==d+"";case w:var se=Zl;case P:var ce=F&i;if(se||(se=Ql),s.size!=d.size&&!ce)return!1;var Y=ee.get(s);if(Y)return Y==d;F|=o,ee.set(s,d);var ve=sa(se(s),se(d),F,H,D,ee);return ee.delete(s),ve;case B:if(_n)return _n.call(s)==_n.call(d)}return!1}function qf(s,d,T,F,H,D){var ee=T&i,se=ua(s),ce=se.length,Y=ua(d),ve=Y.length;if(ce!=ve&&!ee)return!1;for(var Ae=ce;Ae--;){var fe=se[Ae];if(!(ee?fe in d:Pe.call(d,fe)))return!1}var Te=D.get(s);if(Te&&D.get(d))return Te==d;var Se=!0;D.set(s,d),D.set(d,s);for(var Je=ee;++Ae<ce;){fe=se[Ae];var ke=s[fe],st=d[fe];if(F)var ha=ee?F(st,ke,fe,d,s,D):F(ke,st,fe,s,d,D);if(!(ha===void 0?ke===st||H(ke,st,T,F,D):ha)){Se=!1;break}Je||(Je=fe=="constructor")}if(Se&&!Je){var dr=s.constructor,hr=d.constructor;dr!=hr&&"constructor"in s&&"constructor"in d&&!(typeof dr=="function"&&dr instanceof dr&&typeof hr=="function"&&hr instanceof hr)&&(Se=!1)}return D.delete(s),D.delete(d),Se}function ua(s){return Nf(s,Xf,Gf)}function fr(s,d){var T=s.__data__;return Wf(d)?T[typeof d=="string"?"string":"hash"]:T.map}function Tt(s,d){var T=Yl(s,d);return Bf(T)?T:void 0}function jf(s){var d=Pe.call(s,nt),T=s[nt];try{s[nt]=void 0;var F=!0}catch{}var H=Qo.call(s);return F&&(d?s[nt]=T:delete s[nt]),H}var Gf=na?function(s){return s==null?[]:(s=Object(s),ar(na(s),function(d){return ra.call(s,d)}))}:Qf,Ke=Wt;(mn&&Ke(new mn(new ArrayBuffer(1)))!=v||Gt&&Ke(new Gt)!=w||bn&&Ke(bn.resolve())!=m||Tn&&Ke(new Tn)!=P||Sn&&Ke(new Sn)!=S)&&(Ke=function(s){var d=Wt(s),T=d==O?s.constructor:void 0,F=T?at(T):"";if(F)switch(F){case sf:return v;case uf:return w;case cf:return m;case lf:return P;case ff:return S}return d});function Vf(s,d){return d=d??a,!!d&&(typeof s=="number"||K.test(s))&&s>-1&&s%1==0&&s<d}function Wf(s){var d=typeof s;return d=="string"||d=="number"||d=="symbol"||d=="boolean"?s!=="__proto__":s===null}function zf(s){return!!Xo&&Xo in s}function Hf(s){var d=s&&s.constructor,T=typeof d=="function"&&d.prototype||sr;return s===T}function Kf(s){return Qo.call(s)}function at(s){if(s!=null){try{return Zo.call(s)}catch{}try{return s+""}catch{}}return""}function ca(s,d){return s===d||s!==s&&d!==d}var Jf=oa(function(){return arguments}())?oa:function(s){return zt(s)&&Pe.call(s,"callee")&&!ra.call(s,"callee")},pr=Array.isArray;function Yf(s){return s!=null&&fa(s.length)&&!la(s)}var En=of||ep;function Zf(s,d){return aa(s,d)}function la(s){if(!pa(s))return!1;var d=Wt(s);return d==p||d==_||d==h||d==I}function fa(s){return typeof s=="number"&&s>-1&&s%1==0&&s<=a}function pa(s){var d=typeof s;return s!=null&&(d=="object"||d=="function")}function zt(s){return s!=null&&typeof s=="object"}var da=bt?Kl(bt):Df;function Xf(s){return Yf(s)?Rf(s):Uf(s)}function Qf(){return[]}function ep(){return!1}e.exports=Zf})(zr,zr.exports);var sT=zr.exports,uT=function(e,t){return e.length!==t.length?!1:JSON.stringify(e.map(r=>r).sort())===JSON.stringify(t.map(r=>r).sort())},kl={},To={exports:{}};(function(e,t){var r={env:{},argv:[]},n=function(){var i=function(O,m,I,$){for(I=I||{},$=O.length;$--;I[O[$]]=m);return I},o=[1,12],a=[1,13],c=[1,9],u=[1,10],h=[1,11],y=[1,14],b=[1,15],l=[14,18,22,24],p=[18,22],_=[22,24],w={trace:function(){},yy:{},symbols_:{error:2,JSONString:3,STRING:4,JSONNumber:5,NUMBER:6,JSONNullLiteral:7,NULL:8,JSONBooleanLiteral:9,TRUE:10,FALSE:11,JSONText:12,JSONValue:13,EOF:14,JSONObject:15,JSONArray:16,"{":17,"}":18,JSONMemberList:19,JSONMember:20,":":21,",":22,"[":23,"]":24,JSONElementList:25,$accept:0,$end:1},terminals_:{2:"error",4:"STRING",6:"NUMBER",8:"NULL",10:"TRUE",11:"FALSE",14:"EOF",17:"{",18:"}",21:":",22:",",23:"[",24:"]"},productions_:[0,[3,1],[5,1],[7,1],[9,1],[9,1],[12,2],[13,1],[13,1],[13,1],[13,1],[13,1],[13,1],[15,2],[15,3],[20,3],[19,1],[19,3],[16,2],[16,3],[25,1],[25,3]],performAction:function(m,I,$,P,C,B,f){var S=B.length-1;switch(C){case 1:this.$=m.replace(/\\(\\|")/g,"$1").replace(/\\n/g,`
`).replace(/\\r/g,"\r").replace(/\\t/g,"	").replace(/\\v/g,"\v").replace(/\\f/g,"\f").replace(/\\b/g,"\b");break;case 2:this.$=Number(m);break;case 3:this.$=null;break;case 4:this.$=!0;break;case 5:this.$=!1;break;case 6:return this.$=B[S-1];case 13:this.$={},Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 14:case 19:this.$=B[S-1],Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 15:this.$=[B[S-2],B[S]];break;case 16:this.$={},this.$[B[S][0]]=B[S][1];break;case 17:this.$=B[S-2],B[S-2][B[S][0]]!==void 0&&(this.$.__duplicateProperties__||Object.defineProperty(this.$,"__duplicateProperties__",{value:[],enumerable:!1}),this.$.__duplicateProperties__.push(B[S][0])),B[S-2][B[S][0]]=B[S][1];break;case 18:this.$=[],Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 20:this.$=[B[S]];break;case 21:this.$=B[S-2],B[S-2].push(B[S]);break}},table:[{3:5,4:o,5:6,6:a,7:3,8:c,9:4,10:u,11:h,12:1,13:2,15:7,16:8,17:y,23:b},{1:[3]},{14:[1,16]},i(l,[2,7]),i(l,[2,8]),i(l,[2,9]),i(l,[2,10]),i(l,[2,11]),i(l,[2,12]),i(l,[2,3]),i(l,[2,4]),i(l,[2,5]),i([14,18,21,22,24],[2,1]),i(l,[2,2]),{3:20,4:o,18:[1,17],19:18,20:19},{3:5,4:o,5:6,6:a,7:3,8:c,9:4,10:u,11:h,13:23,15:7,16:8,17:y,23:b,24:[1,21],25:22},{1:[2,6]},i(l,[2,13]),{18:[1,24],22:[1,25]},i(p,[2,16]),{21:[1,26]},i(l,[2,18]),{22:[1,28],24:[1,27]},i(_,[2,20]),i(l,[2,14]),{3:20,4:o,20:29},{3:5,4:o,5:6,6:a,7:3,8:c,9:4,10:u,11:h,13:30,15:7,16:8,17:y,23:b},i(l,[2,19]),{3:5,4:o,5:6,6:a,7:3,8:c,9:4,10:u,11:h,13:31,15:7,16:8,17:y,23:b},i(p,[2,17]),i(p,[2,15]),i(_,[2,21])],defaultActions:{16:[2,6]},parseError:function(m,I){if(I.recoverable)this.trace(m);else{let $=function(P,C){this.message=P,this.hash=C};throw $.prototype=Error,new $(m,I)}},parse:function(m){var I=this,$=[0],P=[null],C=[],B=this.table,f="",S=0,g=0,v=2,E=1,N=C.slice.call(arguments,1),j=Object.create(this.lexer),Q={yy:{}};for(var ge in this.yy)Object.prototype.hasOwnProperty.call(this.yy,ge)&&(Q.yy[ge]=this.yy[ge]);j.setInput(m,Q.yy),Q.yy.lexer=j,Q.yy.parser=this,typeof j.yylloc>"u"&&(j.yylloc={});var Be=j.yylloc;C.push(Be);var vt=j.options&&j.options.ranges;typeof Q.yy.parseError=="function"?this.parseError=Q.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var x=function(){var me;return me=j.lex()||E,typeof me!="number"&&(me=I.symbols_[me]||me),me},L,q,k,K,M={},re,le,te,De;;){if(q=$[$.length-1],this.defaultActions[q]?k=this.defaultActions[q]:((L===null||typeof L>"u")&&(L=x()),k=B[q]&&B[q][L]),typeof k>"u"||!k.length||!k[0]){var ze="";De=[];for(re in B[q])this.terminals_[re]&&re>v&&De.push("'"+this.terminals_[re]+"'");j.showPosition?ze="Parse error on line "+(S+1)+`:
`+j.showPosition()+`
Expecting `+De.join(", ")+", got '"+(this.terminals_[L]||L)+"'":ze="Parse error on line "+(S+1)+": Unexpected "+(L==E?"end of input":"'"+(this.terminals_[L]||L)+"'"),this.parseError(ze,{text:j.match,token:this.terminals_[L]||L,line:j.yylineno,loc:Be,expected:De})}if(k[0]instanceof Array&&k.length>1)throw new Error("Parse Error: multiple actions possible at state: "+q+", token: "+L);switch(k[0]){case 1:$.push(L),P.push(j.yytext),C.push(j.yylloc),$.push(k[1]),L=null,g=j.yyleng,f=j.yytext,S=j.yylineno,Be=j.yylloc;break;case 2:if(le=this.productions_[k[1]][1],M.$=P[P.length-le],M._$={first_line:C[C.length-(le||1)].first_line,last_line:C[C.length-1].last_line,first_column:C[C.length-(le||1)].first_column,last_column:C[C.length-1].last_column},vt&&(M._$.range=[C[C.length-(le||1)].range[0],C[C.length-1].range[1]]),K=this.performAction.apply(M,[f,g,S,Q.yy,k[1],P,C].concat(N)),typeof K<"u")return K;le&&($=$.slice(0,-1*le*2),P=P.slice(0,-1*le),C=C.slice(0,-1*le)),$.push(this.productions_[k[1]][0]),P.push(M.$),C.push(M._$),te=B[$[$.length-2]][$[$.length-1]],$.push(te);break;case 3:return!0}}return!0}},A=function(){var O={EOF:1,parseError:function(I,$){if(this.yy.parser)this.yy.parser.parseError(I,$);else throw new Error(I)},setInput:function(m,I){return this.yy=I||this.yy||{},this._input=m,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var m=this._input[0];this.yytext+=m,this.yyleng++,this.offset++,this.match+=m,this.matched+=m;var I=m.match(/(?:\r\n?|\n).*/g);return I?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),m},unput:function(m){var I=m.length,$=m.split(/(?:\r\n?|\n)/g);this._input=m+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-I),this.offset-=I;var P=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),$.length-1&&(this.yylineno-=$.length-1);var C=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:$?($.length===P.length?this.yylloc.first_column:0)+P[P.length-$.length].length-$[0].length:this.yylloc.first_column-I},this.options.ranges&&(this.yylloc.range=[C[0],C[0]+this.yyleng-I]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(m){this.unput(this.match.slice(m))},pastInput:function(){var m=this.matched.substr(0,this.matched.length-this.match.length);return(m.length>20?"...":"")+m.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var m=this.match;return m.length<20&&(m+=this._input.substr(0,20-m.length)),(m.substr(0,20)+(m.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var m=this.pastInput(),I=new Array(m.length+1).join("-");return m+this.upcomingInput()+`
`+I+"^"},test_match:function(m,I){var $,P,C;if(this.options.backtrack_lexer&&(C={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(C.yylloc.range=this.yylloc.range.slice(0))),P=m[0].match(/(?:\r\n?|\n).*/g),P&&(this.yylineno+=P.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:P?P[P.length-1].length-P[P.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+m[0].length},this.yytext+=m[0],this.match+=m[0],this.matches=m,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(m[0].length),this.matched+=m[0],$=this.performAction.call(this,this.yy,this,I,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),$)return $;if(this._backtrack){for(var B in C)this[B]=C[B];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var m,I,$,P;this._more||(this.yytext="",this.match="");for(var C=this._currentRules(),B=0;B<C.length;B++)if($=this._input.match(this.rules[C[B]]),$&&(!I||$[0].length>I[0].length)){if(I=$,P=B,this.options.backtrack_lexer){if(m=this.test_match($,C[B]),m!==!1)return m;if(this._backtrack){I=!1;continue}else return!1}else if(!this.options.flex)break}return I?(m=this.test_match(I,C[P]),m!==!1?m:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var I=this.next();return I||this.lex()},begin:function(I){this.conditionStack.push(I)},popState:function(){var I=this.conditionStack.length-1;return I>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(I){return I=this.conditionStack.length-1-Math.abs(I||0),I>=0?this.conditionStack[I]:"INITIAL"},pushState:function(I){this.begin(I)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(I,$,P,C){switch(P){case 0:break;case 1:return 6;case 2:return $.yytext=$.yytext.substr(1,$.yyleng-2),4;case 3:return 17;case 4:return 18;case 5:return 23;case 6:return 24;case 7:return 22;case 8:return 21;case 9:return 10;case 10:return 11;case 11:return 8;case 12:return 14;case 13:return"INVALID"}},rules:[/^(?:\s+)/,/^(?:(-?([0-9]|[1-9][0-9]+))(\.[0-9]+)?([eE][-+]?[0-9]+)?\b)/,/^(?:"(?:\\[\\"bfnrt\/]|\\u[a-fA-F0-9]{4}|[^\\\0-\x09\x0a-\x1f"])*")/,/^(?:\{)/,/^(?:\})/,/^(?:\[)/,/^(?:\])/,/^(?:,)/,/^(?::)/,/^(?:true\b)/,/^(?:false\b)/,/^(?:null\b)/,/^(?:$)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13],inclusive:!0}}};return O}();w.lexer=A;function R(){this.yy={}}return R.prototype=w,w.Parser=R,new R}();typeof mp<"u"&&(t.parser=n,t.Parser=n.Parser,t.parse=function(){return n.parse.apply(n,arguments)},t.main=function(o){o[1]||(console.log("Usage: "+o[0]+" FILE"),r.exit(1));var a=ao.readFileSync(ao.normalize(o[1]),"utf8");return t.parser.parse(a)},require.main===e&&t.main(r.argv.slice(1)))})(To,To.exports);var cT=To.exports,ql={};function Qi(e){return e*Math.PI/180}function Gu(e){var t=0;if(e.length>2)for(var r,n,i=0;i<e.length-1;i++)r=e[i],n=e[i+1],t+=Qi(n[0]-r[0])*(2+Math.sin(Qi(r[1]))+Math.sin(Qi(n[1])));return t>=0}function Vu(e){if(e&&e.length>0){if(Gu(e[0]))return!1;var t=e.slice(1,e.length);if(!t.every(Gu))return!1}return!0}function lT(e){if(e.type==="Polygon")return Vu(e.coordinates);if(e.type==="MultiPolygon")return e.coordinates.every(Vu)}var fT=function(t,r){lT(t)||r.push({message:"Polygons and MultiPolygons should follow the right-hand rule",level:"message",line:t.__line__})},Wu=fT;function pT(e,t){var r=[],n=0,i=10,o=6;function a(f){if((!t||t.noDuplicateMembers!==!1)&&f.__duplicateProperties__&&r.push({message:"An object contained duplicate members, making parsing ambigous: "+f.__duplicateProperties__.join(", "),line:f.__line__}),!u(f,"type","string"))if(C[f.type])f&&C[f.type](f);else{var S=B[f.type.toLowerCase()];S!==void 0?r.push({message:"Expected "+S+" but got "+f.type+" (case sensitive)",line:f.__line__}):r.push({message:"The type "+f.type+" is unknown",line:f.__line__})}}function c(f,S){return f.every(function(g){return g!==null&&typeof g===S})}function u(f,S,g){if(typeof f[S]>"u")return r.push({message:'"'+S+'" member required',line:f.__line__});if(g==="array"){if(!Array.isArray(f[S]))return r.push({message:'"'+S+'" member should be an array, but is an '+typeof f[S]+" instead",line:f.__line__})}else{if(g==="object"&&f[S]&&f[S].constructor!==Object)return r.push({message:'"'+S+'" member should be '+g+", but is an "+f[S].constructor.name+" instead",line:f.__line__});if(g&&typeof f[S]!==g)return r.push({message:'"'+S+'" member should be '+g+", but is an "+typeof f[S]+" instead",line:f.__line__})}}function h(f){if(l(f),p(f),f.properties!==void 0&&r.push({message:'FeatureCollection object cannot contain a "properties" member',line:f.__line__}),f.coordinates!==void 0&&r.push({message:'FeatureCollection object cannot contain a "coordinates" member',line:f.__line__}),!u(f,"features","array")){if(!c(f.features,"object"))return r.push({message:"Every feature must be an object",line:f.__line__});f.features.forEach(P)}}function y(f,S){if(!Array.isArray(f))return r.push({message:"position should be an array, is a "+typeof f+" instead",line:f.__line__||S});if(f.length<2)return r.push({message:"position must have 2 or more elements",line:f.__line__||S});if(f.length>3)return r.push({message:"position should not have more than 3 elements",level:"message",line:f.__line__||S});if(!c(f,"number"))return r.push({message:"each element in a position must be a number",line:f.__line__||S});if(t&&t.precisionWarning){if(n===i)return n+=1,r.push({message:"truncated warnings: we've encountered coordinate precision warning "+i+" times, no more warnings will be reported",level:"message",line:f.__line__||S});n<i&&f.forEach(function(g){var v=0,E=String(g).split(".")[1];if(E!==void 0&&(v=E.length),v>o)return n+=1,r.push({message:"precision of coordinates should be reduced",level:"message",line:f.__line__||S})})}}function b(f,S,g,v){if(v===void 0&&f.__line__!==void 0&&(v=f.__line__),g===0)return y(f,v);if(g===1&&S){if(S==="LinearRing"){if(!Array.isArray(f[f.length-1]))return r.push({message:"a number was found where a coordinate array should have been found: this needs to be nested more deeply",line:v}),!0;if(f.length<4&&r.push({message:"a LinearRing of coordinates needs to have four or more positions",line:v}),f.length&&(f[f.length-1].length!==f[0].length||!f[f.length-1].every(function(N,j){return f[0][j]===N})))return r.push({message:"the first and last positions in a LinearRing of coordinates must be the same",line:v}),!0}else if(S==="Line"&&f.length<2)return r.push({message:"a line needs to have two or more coordinates to be valid",line:v})}if(!Array.isArray(f))r.push({message:"a number was found where a coordinate array should have been found: this needs to be nested more deeply",line:v});else{var E=f.map(function(N){return b(N,S,g-1,N.__line__||v)});return E.some(function(N){return N})}}function l(f){if(f.crs){var S="urn:ogc:def:crs:OGC:1.3:CRS84";typeof f.crs=="object"&&f.crs.properties&&f.crs.properties.name===S?r.push({message:"old-style crs member is not recommended, this object is equivalent to the default and should be removed",line:f.__line__}):r.push({message:"old-style crs member is not recommended",line:f.__line__})}}function p(f){if(f.bbox){if(Array.isArray(f.bbox))return c(f.bbox,"number")||r.push({message:"each element in a bbox member must be a number",line:f.bbox.__line__}),f.bbox.length===4||f.bbox.length===6||r.push({message:"bbox must contain 4 elements (for 2D) or 6 elements (for 3D)",line:f.bbox.__line__}),r.length;r.push({message:"bbox member must be an array of numbers, but is a "+typeof f.bbox,line:f.__line__})}}function _(f){f.properties!==void 0&&r.push({message:'geometry object cannot contain a "properties" member',line:f.__line__}),f.geometry!==void 0&&r.push({message:'geometry object cannot contain a "geometry" member',line:f.__line__}),f.features!==void 0&&r.push({message:'geometry object cannot contain a "features" member',line:f.__line__})}function w(f){l(f),p(f),_(f),u(f,"coordinates","array")||y(f.coordinates)}function A(f){l(f),p(f),u(f,"coordinates","array")||b(f.coordinates,"LinearRing",2)||Wu(f,r)}function R(f){l(f),p(f),u(f,"coordinates","array")||b(f.coordinates,"LinearRing",3)||Wu(f,r)}function O(f){l(f),p(f),u(f,"coordinates","array")||b(f.coordinates,"Line",1)}function m(f){l(f),p(f),u(f,"coordinates","array")||b(f.coordinates,"Line",2)}function I(f){l(f),p(f),u(f,"coordinates","array")||b(f.coordinates,"",1)}function $(f){l(f),p(f),u(f,"geometries","array")||(c(f.geometries,"object")||r.push({message:"The geometries array in a GeometryCollection must contain only geometry objects",line:f.__line__}),f.geometries.length===1&&r.push({message:"GeometryCollection with a single geometry should be avoided in favor of single part or a single object of multi-part type",line:f.geometries.__line__}),f.geometries.forEach(function(S){S&&(S.type==="GeometryCollection"&&r.push({message:"GeometryCollection should avoid nested geometry collections",line:f.geometries.__line__}),a(S))}))}function P(f){l(f),p(f),f.id!==void 0&&typeof f.id!="string"&&typeof f.id!="number"&&r.push({message:'Feature "id" member must have a string or number value',line:f.__line__}),f.features!==void 0&&r.push({message:'Feature object cannot contain a "features" member',line:f.__line__}),f.coordinates!==void 0&&r.push({message:'Feature object cannot contain a "coordinates" member',line:f.__line__}),f.type!=="Feature"&&r.push({message:"GeoJSON features must have a type=feature member",line:f.__line__}),u(f,"properties","object"),u(f,"geometry","object")||f.geometry&&a(f.geometry)}var C={Point:w,Feature:P,MultiPoint:I,LineString:O,MultiLineString:m,FeatureCollection:h,GeometryCollection:$,Polygon:A,MultiPolygon:R},B=Object.keys(C).reduce(function(f,S){return f[S.toLowerCase()]=S,f},{});return typeof e!="object"||e===null||e===void 0?(r.push({message:"The root of a GeoJSON object must be an object.",line:0}),r):(a(e),r.forEach(function(f){({}).hasOwnProperty.call(f,"line")&&f.line===void 0&&delete f.line}),r)}ql.hint=pT;var dT=cT,hT=ql;function yT(e,t){var r,n=[];if(typeof e=="object")r=e;else if(typeof e=="string")try{r=dT.parse(e)}catch(a){var i=a.message.match(/line (\d+)/),o=parseInt(i[1],10);return[{line:o-1,message:a.message,error:a}]}else return[{message:"Expected string or object as input",line:0}];return n=n.concat(hT.hint(r,t)),n}kl.hint=yT;const gT=sT,vT=Ku,mT=Ao,bT=Yr,TT=uT,ST=kl,de=G,_T=Jr,ET={Polygon:Co,LineString:$o,Point:Io,MultiPolygon:Fr,MultiLineString:Fr,MultiPoint:Fr};var wT=function(e,t){return t.modes=de.modes,t.getFeatureIdsAt=function(r){return bT.click({point:r},null,e).map(i=>i.properties.id)},t.getSelectedIds=function(){return e.store.getSelectedIds()},t.getSelected=function(){return{type:de.geojsonTypes.FEATURE_COLLECTION,features:e.store.getSelectedIds().map(r=>e.store.get(r)).map(r=>r.toGeoJSON())}},t.getSelectedPoints=function(){return{type:de.geojsonTypes.FEATURE_COLLECTION,features:e.store.getSelectedCoordinates().map(r=>({type:de.geojsonTypes.FEATURE,properties:{},geometry:{type:de.geojsonTypes.POINT,coordinates:r.coordinates}}))}},t.set=function(r){if(r.type===void 0||r.type!==de.geojsonTypes.FEATURE_COLLECTION||!Array.isArray(r.features))throw new Error("Invalid FeatureCollection");const n=e.store.createRenderBatch();let i=e.store.getAllIds().slice();const o=t.add(r),a=new _T(o);return i=i.filter(c=>!a.has(c)),i.length&&t.delete(i),n(),o},t.add=function(r){const n=ST.hint(r,{precisionWarning:!1}).filter(a=>a.level!=="message");if(n.length)throw new Error(n[0].message);const o=JSON.parse(JSON.stringify(vT(r))).features.map(a=>{if(a.id=a.id||mT(),a.geometry===null)throw new Error("Invalid geometry: null");if(e.store.get(a.id)===void 0||e.store.get(a.id).type!==a.geometry.type){const c=ET[a.geometry.type];if(c===void 0)throw new Error(`Invalid geometry type: ${a.geometry.type}.`);const u=new c(e,a);e.store.add(u)}else{const c=e.store.get(a.id);c.properties=a.properties,gT(c.getCoordinates(),a.geometry.coordinates)||c.incomingCoords(a.geometry.coordinates)}return a.id});return e.store.render(),o},t.get=function(r){const n=e.store.get(r);if(n)return n.toGeoJSON()},t.getAll=function(){return{type:de.geojsonTypes.FEATURE_COLLECTION,features:e.store.getAll().map(r=>r.toGeoJSON())}},t.delete=function(r){return e.store.delete(r,{silent:!0}),t.getMode()===de.modes.DIRECT_SELECT&&!e.store.getSelectedIds().length?e.events.changeMode(de.modes.SIMPLE_SELECT,void 0,{silent:!0}):e.store.render(),t},t.deleteAll=function(){return e.store.delete(e.store.getAllIds(),{silent:!0}),t.getMode()===de.modes.DIRECT_SELECT?e.events.changeMode(de.modes.SIMPLE_SELECT,void 0,{silent:!0}):e.store.render(),t},t.changeMode=function(r,n={}){return r===de.modes.SIMPLE_SELECT&&t.getMode()===de.modes.SIMPLE_SELECT?(TT(n.featureIds||[],e.store.getSelectedIds())||(e.store.setSelected(n.featureIds,{silent:!0}),e.store.render()),t):(r===de.modes.DIRECT_SELECT&&t.getMode()===de.modes.DIRECT_SELECT&&n.featureId===e.store.getSelectedIds()[0]||e.events.changeMode(r,n,{silent:!0}),t)},t.getMode=function(){return e.events.getMode()},t.trash=function(){return e.events.trash({silent:!0}),t},t.combineFeatures=function(){return e.events.combineFeatures({silent:!0}),t},t.uncombineFeatures=function(){return e.events.uncombineFeatures({silent:!0}),t},t.setFeatureProperty=function(r,n,i){return e.store.setFeatureProperty(r,n,i),t},t};const AT=gd,IT=aT,$T=wT,CT=G,OT=function(e,t){e=IT(e);const r={options:e};t=$T(r,t),r.api=t;const n=AT(r);return t.onAdd=n.onAdd,t.onRemove=n.onRemove,t.types=CT.types,t.options=e,t};wo.exports=function(e){OT(e,this)};wo.exports.modes=Ul;var hn=wo.exports;const Ko=_o(yp),FT=hn,Zt=G,PT=Nt,MT=Ko.default,jl={...FT.modes.draw_polygon},LT=2;jl.onSetup=function(e){const t=this.newFeature({type:Zt.geojsonTypes.FEATURE,properties:{isCircle:!0,center:[]},geometry:{type:Zt.geojsonTypes.POLYGON,coordinates:[[]]}});return this.addFeature(t),this.clearSelectedFeatures(),PT.disable(this),this.updateUIClasses({mouse:Zt.cursors.ADD}),this.activateUIButton(Zt.types.POLYGON),this.setActionableState({trash:!0}),{initialRadiusInKm:e.initialRadiusInKm||LT,polygon:t,currentVertexPosition:0}};jl.clickAnywhere=function(e,t){if(e.currentVertexPosition===0){e.currentVertexPosition++;const r=[t.lngLat.lng,t.lngLat.lat],n=MT(r,e.initialRadiusInKm);e.polygon.incomingCoords(n.geometry.coordinates),e.polygon.properties.center=r,e.polygon.properties.radiusInKm=e.initialRadiusInKm}return this.changeMode(Zt.modes.SIMPLE_SELECT,{featureIds:[e.polygon.id]})};var RT={enable(e){setTimeout(()=>{!e.map||!e.map.dragPan||!e._ctx||!e._ctx.store||!e._ctx.store.getInitialConfigValue||e._ctx.store.getInitialConfigValue("dragPan")&&e.map.dragPan.enable()},0)},disable(e){setTimeout(()=>{!e.map||!e.map.doubleClickZoom||e.map.dragPan.disable()},0)}};const Gl=_o(gp);var Jo={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.earthRadius=63710088e-1,e.factors={centimeters:e.earthRadius*100,centimetres:e.earthRadius*100,degrees:e.earthRadius/111325,feet:e.earthRadius*3.28084,inches:e.earthRadius*39.37,kilometers:e.earthRadius/1e3,kilometres:e.earthRadius/1e3,meters:e.earthRadius,metres:e.earthRadius,miles:e.earthRadius/1609.344,millimeters:e.earthRadius*1e3,millimetres:e.earthRadius*1e3,nauticalmiles:e.earthRadius/1852,radians:1,yards:e.earthRadius*1.0936},e.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/e.earthRadius,yards:1.0936133},e.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function t(g,v,E){E===void 0&&(E={});var N={type:"Feature"};return(E.id===0||E.id)&&(N.id=E.id),E.bbox&&(N.bbox=E.bbox),N.properties=v||{},N.geometry=g,N}e.feature=t;function r(g,v,E){switch(g){case"Point":return n(v).geometry;case"LineString":return c(v).geometry;case"Polygon":return o(v).geometry;case"MultiPoint":return b(v).geometry;case"MultiLineString":return y(v).geometry;case"MultiPolygon":return l(v).geometry;default:throw new Error(g+" is invalid")}}e.geometry=r;function n(g,v,E){if(E===void 0&&(E={}),!g)throw new Error("coordinates is required");if(!Array.isArray(g))throw new Error("coordinates must be an Array");if(g.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!C(g[0])||!C(g[1]))throw new Error("coordinates must contain numbers");var N={type:"Point",coordinates:g};return t(N,v,E)}e.point=n;function i(g,v,E){return E===void 0&&(E={}),h(g.map(function(N){return n(N,v)}),E)}e.points=i;function o(g,v,E){E===void 0&&(E={});for(var N=0,j=g;N<j.length;N++){var Q=j[N];if(Q.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var ge=0;ge<Q[Q.length-1].length;ge++)if(Q[Q.length-1][ge]!==Q[0][ge])throw new Error("First and last Position are not equivalent.")}var Be={type:"Polygon",coordinates:g};return t(Be,v,E)}e.polygon=o;function a(g,v,E){return E===void 0&&(E={}),h(g.map(function(N){return o(N,v)}),E)}e.polygons=a;function c(g,v,E){if(E===void 0&&(E={}),g.length<2)throw new Error("coordinates must be an array of two or more positions");var N={type:"LineString",coordinates:g};return t(N,v,E)}e.lineString=c;function u(g,v,E){return E===void 0&&(E={}),h(g.map(function(N){return c(N,v)}),E)}e.lineStrings=u;function h(g,v){v===void 0&&(v={});var E={type:"FeatureCollection"};return v.id&&(E.id=v.id),v.bbox&&(E.bbox=v.bbox),E.features=g,E}e.featureCollection=h;function y(g,v,E){E===void 0&&(E={});var N={type:"MultiLineString",coordinates:g};return t(N,v,E)}e.multiLineString=y;function b(g,v,E){E===void 0&&(E={});var N={type:"MultiPoint",coordinates:g};return t(N,v,E)}e.multiPoint=b;function l(g,v,E){E===void 0&&(E={});var N={type:"MultiPolygon",coordinates:g};return t(N,v,E)}e.multiPolygon=l;function p(g,v,E){E===void 0&&(E={});var N={type:"GeometryCollection",geometries:g};return t(N,v,E)}e.geometryCollection=p;function _(g,v){if(v===void 0&&(v=0),v&&!(v>=0))throw new Error("precision must be a positive number");var E=Math.pow(10,v||0);return Math.round(g*E)/E}e.round=_;function w(g,v){v===void 0&&(v="kilometers");var E=e.factors[v];if(!E)throw new Error(v+" units is invalid");return g*E}e.radiansToLength=w;function A(g,v){v===void 0&&(v="kilometers");var E=e.factors[v];if(!E)throw new Error(v+" units is invalid");return g/E}e.lengthToRadians=A;function R(g,v){return m(A(g,v))}e.lengthToDegrees=R;function O(g){var v=g%360;return v<0&&(v+=360),v}e.bearingToAzimuth=O;function m(g){var v=g%(2*Math.PI);return v*180/Math.PI}e.radiansToDegrees=m;function I(g){var v=g%360;return v*Math.PI/180}e.degreesToRadians=I;function $(g,v,E){if(v===void 0&&(v="kilometers"),E===void 0&&(E="kilometers"),!(g>=0))throw new Error("length must be a positive number");return w(A(g,v),E)}e.convertLength=$;function P(g,v,E){if(v===void 0&&(v="meters"),E===void 0&&(E="kilometers"),!(g>=0))throw new Error("area must be a positive number");var N=e.areaFactors[v];if(!N)throw new Error("invalid original units");var j=e.areaFactors[E];if(!j)throw new Error("invalid final units");return g/N*j}e.convertArea=P;function C(g){return!isNaN(g)&&g!==null&&!Array.isArray(g)}e.isNumber=C;function B(g){return!!g&&g.constructor===Object}e.isObject=B;function f(g){if(!g)throw new Error("bbox is required");if(!Array.isArray(g))throw new Error("bbox must be an Array");if(g.length!==4&&g.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");g.forEach(function(v){if(!C(v))throw new Error("bbox must only contain numbers")})}e.validateBBox=f;function S(g){if(!g)throw new Error("id is required");if(["string","number"].indexOf(typeof g)===-1)throw new Error("id must be a number or a string")}e.validateId=S})(Jo);const NT=hn,lt=G,xT=Nt,Vl=RT,BT=Ko.default,DT=Gl.default,zu=Jo,Oe={...NT.modes.draw_polygon};Oe.onSetup=function(e){const t=this.newFeature({type:lt.geojsonTypes.FEATURE,properties:{isCircle:!0,center:[]},geometry:{type:lt.geojsonTypes.POLYGON,coordinates:[[]]}});return this.addFeature(t),this.clearSelectedFeatures(),xT.disable(this),Vl.disable(this),this.updateUIClasses({mouse:lt.cursors.ADD}),this.activateUIButton(lt.types.POLYGON),this.setActionableState({trash:!0}),{polygon:t,currentVertexPosition:0}};Oe.onMouseDown=Oe.onTouchStart=function(e,t){e.polygon.properties.center.length===0&&(e.polygon.properties.center=[t.lngLat.lng,t.lngLat.lat])};Oe.onDrag=Oe.onMouseMove=function(e,t){const r=e.polygon.properties.center;if(r.length>0){const n=DT(zu.point(r),zu.point([t.lngLat.lng,t.lngLat.lat]),{units:"kilometers"}),i=BT(r,n);e.polygon.incomingCoords(i.geometry.coordinates),e.polygon.properties.radiusInKm=n}};Oe.onMouseUp=Oe.onTouchEnd=function(e,t){return Vl.enable(this),this.changeMode(lt.modes.SIMPLE_SELECT,{featureIds:[e.polygon.id]})};Oe.onClick=Oe.onTap=function(e,t){e.polygon.properties.center=[]};Oe.toDisplayFeatures=function(e,t,r){const n=t.properties.id===e.polygon.id;return t.properties.active=n?lt.activeStates.ACTIVE:lt.activeStates.INACTIVE,r(t)};var UT=Oe;const kT=en;function qT(e){const{properties:t,geometry:r}=e;if(!t.user_isCircle)return null;const n=[],i=r.coordinates[0].slice(0,-1);for(let o=0;o<i.length;o+=Math.round(i.length/4))n.push(kT(t.id,i[o],`0.${o}`,!1));return n}var Wl=qT;const jT=hn,GT=tn,VT=pn,Hr=G,WT=zo,zT=Gl.default,Hu=Jo,HT=Ko.default,KT=Wl,yn=jT.modes.direct_select;yn.dragFeature=function(e,t,r){VT(this.getSelected(),r),this.getSelected().filter(n=>n.properties.isCircle).map(n=>n.properties.center).forEach(n=>{n[0]+=r.lng,n[1]+=r.lat}),e.dragMoveLocation=t.lngLat};yn.dragVertex=function(e,t,r){if(e.feature.properties.isCircle){const n=e.feature.properties.center,i=[t.lngLat.lng,t.lngLat.lat],o=zT(Hu.point(n),Hu.point(i),{units:"kilometers"}),a=HT(n,o);e.feature.incomingCoords(a.geometry.coordinates),e.feature.properties.radiusInKm=o}else{const n=e.selectedCoordPaths.map(a=>e.feature.getCoordinate(a)),i=n.map(a=>({type:Hr.geojsonTypes.FEATURE,properties:{},geometry:{type:Hr.geojsonTypes.POINT,coordinates:a}})),o=WT(i,r);for(let a=0;a<n.length;a++){const c=n[a];e.feature.updateCoordinate(e.selectedCoordPaths[a],c[0]+o.lng,c[1]+o.lat)}}};yn.toDisplayFeatures=function(e,t,r){e.featureId===t.properties.id?(t.properties.active=Hr.activeStates.ACTIVE,r(t),(t.properties.user_isCircle?KT(t):GT(t,{map:this.map,midpoints:!0,selectedPaths:e.selectedCoordPaths})).forEach(r)):(t.properties.active=Hr.activeStates.INACTIVE,r(t)),this.fireActionable(e)};var JT=yn;const YT=hn,ZT=tn,XT=pn,$r=G,QT=Wl,Yo=YT.modes.simple_select;Yo.dragMove=function(e,t){e.dragMoving=!0,t.originalEvent.stopPropagation();const r={lng:t.lngLat.lng-e.dragMoveLocation.lng,lat:t.lngLat.lat-e.dragMoveLocation.lat};XT(this.getSelected(),r),this.getSelected().filter(n=>n.properties.isCircle).map(n=>n.properties.center).forEach(n=>{n[0]+=r.lng,n[1]+=r.lat}),e.dragMoveLocation=t.lngLat};Yo.toDisplayFeatures=function(e,t,r){if(t.properties.active=this.isSelected(t.properties.id)?$r.activeStates.ACTIVE:$r.activeStates.INACTIVE,r(t),this.fireActionable(),t.properties.active!==$r.activeStates.ACTIVE||t.geometry.type===$r.geojsonTypes.POINT)return;(t.properties.user_isCircle?QT(t):ZT(t)).forEach(r)};var eS=Yo;const tS=UT,ct=JT,rS=eS,nS={onSetup:function(e){const t=this.newFeature({type:"Feature",properties:{isRectangle:!0},geometry:{type:"Polygon",coordinates:[[[0,0],[0,0],[0,0],[0,0],[0,0]]]}});return this.addFeature(t),this.clearSelectedFeatures(),this.updateUIClasses({mouse:"add"}),this.activateUIButton("polygon"),this.setActionableState({trash:!0}),this.map&&this.map.dragPan&&this.map.dragPan.disable(),{polygon:t,startPoint:null}},onStop:function(e){this.updateUIClasses({mouse:"none"}),this.activateUIButton(),this.setActionableState({trash:!0}),this.map&&this.map.dragPan&&this.map.dragPan.enable()},onMouseDown:function(e,t){t.originalEvent&&(t.originalEvent.preventDefault(),t.originalEvent.stopPropagation()),e.startPoint=[t.lngLat.lng,t.lngLat.lat],this.updateFeature(e,t)},onDrag:function(e,t){e.startPoint&&this.updateFeature(e,t)},onMouseUp:function(e,t){e.startPoint&&(this.updateFeature(e,t),this.map.fire("draw.create",{features:[e.polygon.toGeoJSON()]}),this.changeMode("simple_select",{featureIds:[e.polygon.id]}))},updateFeature:function(e,t){const r=e.startPoint,n=[t.lngLat.lng,t.lngLat.lat],i=Math.min(r[0],n[0]),o=Math.max(r[0],n[0]),a=Math.min(r[1],n[1]),c=Math.max(r[1],n[1]),u=[[i,c],[o,c],[o,a],[i,a],[i,c]];e.polygon.incomingCoords([u])},toDisplayFeatures:function(e,t,r){const n=t.properties.id===e.polygon.id;if(t.properties.active=n?"true":"false",!n)return r(t);t.geometry.coordinates.length!==0&&r(t)},onTrash:function(e){this.deleteFeature(e.polygon.id,{silent:!0}),this.changeMode("simple_select")}},iS={...ct,isRectangle:function(e){if(e&&e.properties&&(e.properties.isRectangle===!0||e.properties.isRectangle==="true"))return!0;if(e&&e.geometry&&e.geometry.type==="Polygon"&&e.geometry.coordinates.length>0){const t=e.geometry.coordinates[0];if(t.length!==5)return!1;const r=t.slice(0,4).map(a=>a[0]),n=t.slice(0,4).map(a=>a[1]),i=new Set(r.map(a=>a.toFixed(5))).size,o=new Set(n.map(a=>a.toFixed(5))).size;return i<=2&&o<=2}return!1},onSetup:function(e){const t=ct.onSetup.call(this,e);return t.draggingHandle=null,t},onMouseDown:function(e,t){const r=e.featureId,n=this.getFeature(r);this.isRectangle(n),ct.onMouseDown.call(this,e,t)},onDrag:function(e,t){const{featureId:r}=e,n=this.getFeature(r);if(!this.isRectangle(n))return ct.onDrag.call(this,e,t);if(e.selectedCoordPaths&&e.selectedCoordPaths.length>0){const o=e.selectedCoordPaths[0].split("."),a=parseInt(o[0],10),c=parseInt(o[1],10);if(a===0&&c>=0&&c<=4){const u=n.coordinates[0],h=t.lngLat.lng,y=t.lngLat.lat,l=((c===4?0:c)+2)%4,p=u[l];if(!p)return;const _=Math.min(h,p[0]),w=Math.max(h,p[0]),A=Math.min(y,p[1]),R=Math.max(y,p[1]),O=[[_,R],[w,R],[w,A],[_,A],[_,R]];n.incomingCoords([O]);return}}ct.onDrag.call(this,e,t)},onMouseUp:function(e,t){e.draggingHandle&&(e.draggingHandle=null,this.map.dragPan.enable(),this.fireUpdate()),ct.onMouseUp.call(this,e,t)},fireUpdate:function(){this.map.fire("draw.update",{action:"move",features:this.getSelected().map(e=>e.toGeoJSON())})},toDisplayFeatures:function(e,t,r){const n=this.getFeature(e.featureId);this.isRectangle(n)&&t.properties.meta==="midpoint"||ct.toDisplayFeatures.call(this,e,t,r)}};function oS({currentMode:e,onModeChange:t,onDelete:r,canDelete:n}){const i=[{id:"simple_select",icon:rp,title:"Select (Pointer)"},{id:"add_waypoint",icon:np,title:"Add Waypoint"},{id:"draw_rectangle",icon:ip,title:"Draw Square"},{id:"draw_polygon",icon:op,title:"Draw Polygon"},{id:"drag_circle",icon:ap,title:"Draw Circle"}];return Ie.jsxs("div",{className:"absolute top-4 left-4 flex flex-col gap-2 bg-white rounded-md shadow-md p-1 z-10",children:[i.map(o=>{const a=o.icon,c=e===o.id||o.id==="simple_select"&&e==="direct_select";return Ie.jsx("button",{onClick:()=>{console.log("Switching to mode:",o.id),t(o.id)},className:`p-2 rounded hover:bg-gray-100 flex items-center justify-center ${c?"text-blue-600 bg-blue-50":"text-gray-700"}`,title:o.title,children:Ie.jsx(a,{size:20})},o.id)}),Ie.jsx("div",{className:"h-px bg-gray-200 my-1"}),Ie.jsx("button",{onClick:r,disabled:!n,className:`p-2 rounded flex items-center justify-center ${n?"text-red-600 hover:bg-red-50 cursor-pointer":"text-gray-300 cursor-not-allowed"}`,title:"Delete Selected",children:Ie.jsx(sp,{size:20})})]})}Cr.accessToken="pk.eyJ1Ijoid2F5Z2VuIiwiYSI6ImNtaThyMXF2czBmZ3QybXBvbW1hazFpamcifQ.P0D5plS_fpnx3qheQytxfQ";const aS="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`
<svg width="40" height="40" viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg">
  <path d="M20 0 L35 20 A 15 15 0 0 1 5 20 Z" fill="#3b82f6" stroke="white" stroke-width="2"/>
</svg>
`),sS="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`
<svg width="40" height="40" viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg">
  <path d="M20 0 L35 20 A 15 15 0 0 1 5 20 Z" fill="#ef4444" stroke="white" stroke-width="2"/>
</svg>
`),uS=[{id:"gl-draw-line",type:"line",filter:["all",["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3b82f6","line-width":2}},{id:"gl-draw-polygon-fill",type:"fill",filter:["all",["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#3b82f6","fill-outline-color":"#3b82f6","fill-opacity":.2}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3b82f6","line-width":2}},{id:"gl-draw-point-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":6,"circle-color":"#fff"}},{id:"gl-draw-point",type:"circle",filter:["all",["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":4,"circle-color":"#3b82f6"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","$type","Polygon"],["==","mode","static"]],paint:{"fill-color":"#000","fill-outline-color":"#000","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","$type","Polygon"],["==","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#000","line-width":2}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","resize-handle"]],paint:{"circle-radius":4,"circle-color":"#fbb03b"}}];function yS({onPolygonDrawn:e,polygon:t}){const r=oe.useRef(null),n=oe.useRef(null),i=oe.useRef(null),{waypoints:o,selectedIds:a,selectWaypoint:c,setSelectedIds:u,resetTrigger:h,settings:y,updateWaypoint:b,addWaypoint:l,setMapRef:p}=_e(),_=oe.useRef(null),[w,A]=oe.useState("simple_select"),R=oe.useRef(w);oe.useEffect(()=>{R.current=w},[w]),oe.useEffect(()=>{h>0&&i.current&&(i.current.deleteAll(),e(null))},[h,e]);const[O,m]=oe.useState(null),[I,$]=oe.useState(!1),P=oe.useRef(null);oe.useEffect(()=>{if(!i.current||!n.current)return;const f=i.current.getSelectedIds();if(f.length===0)return;const S=i.current.get(f[0]);if(!S||S.geometry.type!=="Polygon")return;const g=wn(S),v=An(g,In(S.geometry.coordinates[0][0]),{units:"meters"});if(Math.abs(v-y.orbitRadius)>1){const E=ga(g.geometry.coordinates,y.orbitRadius,{steps:64,units:"meters"});E.id=S.id,E.properties={...S.properties,isCircle:!0},i.current.add(E),e(E)}},[y.orbitRadius]);const C=f=>{if(!f||f.geometry.type!=="Polygon")return;const S=wn(f),g=An(S,In(f.geometry.coordinates[0][0]),{units:"meters"});Math.abs(g-y.orbitRadius)>1&&_e.getState().updateSettings({orbitRadius:Math.round(g)})};oe.useEffect(()=>{if(n.current)return;n.current=new Cr.Map({container:r.current,style:"mapbox://styles/mapbox/satellite-streets-v12",center:[-98,39],zoom:4,boxZoom:!1});const f=new cp({accessToken:Cr.accessToken,mapboxgl:Cr,marker:!1,collapsed:!0});n.current.addControl(f,"top-right"),p(n.current),i.current=new ya({userProperties:!0,displayControlsDefault:!1,controls:{point:!1,line:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1},styles:uS,modes:{...ya.modes,drag_circle:tS,draw_rectangle:nS,direct_select:iS,simple_select:rS}}),n.current.addControl(i.current),window.mapboxDraw=i.current,n.current.on("draw.create",x=>{const L=x.features[0];i.current.getMode()==="drag_circle"&&(i.current.setFeatureProperty(L.id,"isCircle",!0),L.properties.isCircle=!0,_e.getState().updateSettings({pathType:"orbit",spacing:10})),(L.properties.isRectangle||i.current.getMode()==="draw_rectangle")&&(i.current.setFeatureProperty(L.id,"isRectangle",!0),L.properties.isRectangle=!0);const q=wn(L);if(An(q,In(L.geometry.coordinates[0][0]),{units:"meters"})>500){const K=ga(q.geometry.coordinates,50,{steps:64,units:"meters"});K.id=L.id,K.properties={...L.properties,isCircle:!0},i.current.add(K),_e.getState().updateSettings({orbitRadius:50}),e(K)}else C(L),e(L);A("simple_select")}),n.current.on("draw.update",x=>{const L=x.features[0];C(L),e(L)}),n.current.on("draw.selectionchange",x=>{x.features.length>0?(C(x.features[0]),e(x.features[0]),$(!0)):$(!1)}),n.current.on("draw.delete",()=>e(null)),n.current.on("click",x=>{if(x.originalEvent._isDrag)return;if(R.current==="add_waypoint"){const{lng:q,lat:k}=x.lngLat;l({lng:q,lat:k});return}const L=n.current.queryRenderedFeatures(x.point,{layers:["waypoints-symbol"]});if(L.length){const q=L[0].properties.id;c(q,x.originalEvent.shiftKey)}else n.current.queryRenderedFeatures(x.point,{layers:["gl-draw-polygon-fill-static.cold","gl-draw-polygon-fill.hot"]}).length===0&&u([])});const S=x=>{if(!P.current)return;const L=P.current,q=x.point,k=Math.min(L.x,q.x),K=Math.max(L.x,q.x),M=Math.min(L.y,q.y),re=Math.max(L.y,q.y);m({left:k,top:M,width:K-k,height:re-M})},g=x=>{if(!P.current)return;const L=P.current,q=x.point;if(Math.abs(L.x-q.x)<5&&Math.abs(L.y-q.y)<5){P.current=null,m(null),n.current.dragPan.enable(),n.current.off("mousemove",S),n.current.off("mouseup",g);return}const k=[L,q],M=n.current.queryRenderedFeatures(k,{layers:["waypoints-symbol"]}).map(re=>re.properties.id);M.length>0&&u(M),P.current=null,m(null),n.current.dragPan.enable(),x.originalEvent._isDrag=!0,setTimeout(()=>{x.originalEvent&&delete x.originalEvent._isDrag},100),n.current.off("mousemove",S),n.current.off("mouseup",g)};n.current.on("mousedown",x=>{x.originalEvent.shiftKey&&(x.preventDefault(),n.current.dragPan.disable(),P.current=x.point,n.current.on("mousemove",S),n.current.on("mouseup",g))});const v=()=>{_.current||(n.current.getCanvas().style.cursor="pointer")},E=()=>{_.current||(n.current.getCanvas().style.cursor="")},N=x=>{if(i.current.getMode()!=="simple_select"&&i.current.getMode()!=="direct_select"||x.originalEvent.shiftKey||!x.originalEvent.altKey)return;x.preventDefault();const L=x.features[0];if(!L)return;n.current.dragPan.disable(),n.current.getCanvas().style.cursor="grabbing";const q=L.properties.id,k=_e.getState().waypoints,K=_e.getState().selectedIds,M=K.includes(q),re=M?K:[q],le=k.filter(te=>re.includes(te.id)).map(te=>({id:te.id,lng:te.lng,lat:te.lat}));_.current={ids:re,isMulti:M,initialWaypoints:le,startLngLat:x.lngLat},n.current.on("mousemove",j),n.current.on("mouseup",Q)},j=x=>{if(!_.current)return;const{lng:L,lat:q}=x.lngLat,{startLngLat:k,initialWaypoints:K}=_.current,M=L-k.lng,re=q-k.lat,le=n.current.getSource("waypoints"),te=n.current.getSource("mission-path"),De=_e.getState().waypoints,ze=_e.getState().selectedIds,me=De.map((be,mt)=>{const bt=K.find(gn=>gn.id===be.id);let ar=[be.lng,be.lat];return bt&&(ar=[bt.lng+M,bt.lat+re]),{type:"Feature",properties:{id:be.id,index:mt+1,selected:ze.includes(be.id),heading:be.heading||0},geometry:{type:"Point",coordinates:ar}}});if(le&&le.setData({type:"FeatureCollection",features:me}),te){const be=me.map(mt=>mt.geometry.coordinates);te.setData({type:"Feature",geometry:{type:"LineString",coordinates:be}})}},Q=x=>{if(!_.current)return;const{lng:L,lat:q}=x.lngLat,{startLngLat:k,ids:K}=_.current,M=L-k.lng,re=q-k.lat;_e.getState().moveWaypoints(K,M,re),_.current=null,n.current.dragPan.enable(),n.current.getCanvas().style.cursor="",x.originalEvent._isDrag=!0,n.current.off("mousemove",j),n.current.off("mouseup",Q)};n.current.on("mouseenter","waypoints-symbol",v),n.current.on("mouseleave","waypoints-symbol",E),n.current.on("mousedown","waypoints-symbol",N);const ge=()=>{console.log("Initializing Map Layers...");const x=(k,K)=>{if(n.current.hasImage(k))return;const M=new Image;M.src=K,M.onload=()=>{n.current.hasImage(k)||n.current.addImage(k,M)}};x("teardrop",aS),x("teardrop-selected",sS),n.current.getSource("mission-path")||n.current.addSource("mission-path",{type:"geojson",data:{type:"Feature",geometry:{type:"LineString",coordinates:[]}}}),n.current.getSource("footprints")||n.current.addSource("footprints",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),n.current.getSource("waypoints")||n.current.addSource("waypoints",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),n.current.getLayer("footprints-fill")||n.current.addLayer({id:"footprints-fill",type:"fill",source:"footprints",paint:{"fill-color":["get","color"],"fill-opacity":.15,"fill-outline-color":"rgba(0,0,0,0)"}}),n.current.getLayer("footprints-outline")||n.current.addLayer({id:"footprints-outline",type:"line",source:"footprints",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":["get","color"],"line-width":1,"line-opacity":.6}}),n.current.getLayer("mission-path-line")||n.current.addLayer({id:"mission-path-line",type:"line",source:"mission-path",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#3b82f6","line-width":3,"line-opacity":.8}}),n.current.getLayer("waypoints-symbol")||n.current.addLayer({id:"waypoints-symbol",type:"symbol",source:"waypoints",layout:{"icon-image":["case",["get","selected"],"teardrop-selected","teardrop"],"icon-size":["interpolate",["linear"],["zoom"],10,.5,15,.75,20,1],"icon-anchor":"center","icon-allow-overlap":!0,"icon-rotate":["get","heading"],"icon-rotation-alignment":"map","text-field":["to-string",["get","index"]],"text-font":["Open Sans Bold","Arial Unicode MS Bold"],"text-size":["interpolate",["linear"],["zoom"],10,9,15,11,20,13],"text-offset":[0,0],"text-anchor":"center","text-allow-overlap":!0,"text-rotation-alignment":"viewport"},paint:{"text-color":"#ffffff","text-halo-color":"#000000","text-halo-width":.5}});const L=_e.getState().waypoints,q=_e.getState().selectedIds;if(L.length>0){console.log("Initial waypoints found, updating source...",L.length);const k=L.map((M,re)=>({type:"Feature",properties:{id:M.id,index:re+1,selected:q.includes(M.id),heading:M.heading||0},geometry:{type:"Point",coordinates:[M.lng,M.lat]}}));n.current.getSource("waypoints").setData({type:"FeatureCollection",features:k});const K=L.map(M=>[M.lng,M.lat]);n.current.getSource("mission-path").setData({type:"Feature",geometry:{type:"LineString",coordinates:K}})}};n.current.loaded()?ge():n.current.on("load",ge);const Be=x=>{R.current==="add_waypoint"&&x.mode==="simple_select"||A(x.mode)};n.current.on("draw.modechange",Be);const vt=x=>{x.key==="Escape"&&(R.current!=="simple_select"?(i.current&&i.current.changeMode("simple_select"),A("simple_select")):u([]))};return window.addEventListener("keydown",vt),()=>{window.removeEventListener("keydown",vt)}},[]),oe.useEffect(()=>{if(!i.current||!n.current)return;const f=w,S=i.current.getMode();if(f==="add_waypoint")S!=="simple_select"&&i.current.changeMode("simple_select"),n.current.getCanvas().style.cursor="crosshair";else{if(S!==f)try{i.current.changeMode(f)}catch(g){console.warn("Failed to switch mode:",g)}n.current.getCanvas().style.cursor=""}},[w]),oe.useEffect(()=>{!n.current||!n.current.getLayer("waypoints-symbol")||(n.current.setLayoutProperty("waypoints-symbol","text-offset",[0,0]),n.current.setLayoutProperty("waypoints-symbol","text-anchor","center"),n.current.setLayoutProperty("waypoints-symbol","icon-anchor","center"),n.current.setLayoutProperty("waypoints-symbol","text-rotation-alignment","viewport"))},[]),oe.useEffect(()=>{if(!n.current||!n.current)return;const f=n.current.getSource("waypoints"),S=n.current.getSource("mission-path");if(f){const g=o.map((v,E)=>({type:"Feature",properties:{id:v.id,index:E+1,selected:a.includes(v.id),heading:v.heading||0},geometry:{type:"Point",coordinates:[v.lng,v.lat]}}));f.setData({type:"FeatureCollection",features:g})}if(S){const g=o.map(v=>[v.lng,v.lat]);S.setData({type:"Feature",geometry:{type:"LineString",coordinates:g}})}},[o,a]),oe.useEffect(()=>{if(!n.current||!n.current.getSource("footprints"))return;if(!y.showFootprints){n.current.getSource("footprints").setData({type:"FeatureCollection",features:[]});return}const f=o.map((S,g)=>{const v=S.heading||0;return{...tp({lng:S.lng,lat:S.lat},y.altitude,v,y.customFOV),properties:{index:g+1,color:y.footprintColor}}}).filter(S=>S!==null);n.current.getSource("footprints").setData({type:"FeatureCollection",features:f})},[o,y.showFootprints,y.altitude,y.customFOV,y.footprintColor]),oe.useEffect(()=>{y.orbitRadius>500&&_e.getState().updateSettings({orbitRadius:50})},[]);const B=()=>{i.current&&(i.current.trash(),e(null),$(!1))};return oe.useEffect(()=>{if(!i.current||!n.current)return;if(!t){i.current.getAll().features.length>0&&i.current.deleteAll();return}if(!i.current.getAll().features.some(g=>g.id===t.id)){console.log("Syncing polygon from prop:",t),i.current.deleteAll(),i.current.add(t);try{const g=vp(t);n.current.fitBounds(g,{padding:100})}catch(g){console.warn("Could not fit bounds:",g)}}},[t]),Ie.jsxs("div",{className:`relative w-full h-full ${w==="add_waypoint"?"force-crosshair":""}`,children:[Ie.jsx("style",{children:`
        .force-crosshair .mapboxgl-canvas-container {
          cursor: crosshair !important;
        }
        .force-crosshair .mapboxgl-canvas {
          cursor: crosshair !important;
        }
      `}),Ie.jsx("div",{ref:r,className:"w-full h-full"}),O&&Ie.jsx("div",{style:{position:"absolute",left:O.left,top:O.top,width:O.width,height:O.height,border:"2px solid #3b82f6",backgroundColor:"rgba(59, 130, 246, 0.2)",pointerEvents:"none",zIndex:20}}),Ie.jsx(oS,{currentMode:w,onModeChange:A,onDelete:B,canDelete:I})]})}export{yS as default};
