import{j as we,u as Fe,c as np}from"./index-CqlnPqzH.js";import{i as op,j as ip,k as ap,H as sp,l as up,T as cp,r as ae}from"./vendor-c268DabV.js";import{b as lp,i as vi,d as Hu,g as mi,m as wr,M as fp,e as da}from"./mapbox-yEoyp_b1.js";import{k as V,s as lt,n as Wr,o as It,q as Ze,r as U,_ as $t,u as Ct,v as bi,w as Z,x as ft,y as Ot,z as Ku,A as Ge,B as pp,C as Ju,D as dp,E as Yu,F as hp,G as Zu,H as Xt,I as Xu,J as Qu,K as yp,L as ec,M as gp,N as vp,O as mp,e as Sn,b as _n,p as En,P as ha,f as bp}from"./turf-QWijy95V.js";import{c as Tp}from"./utils-DK17MS9e.js";var Ti={exports:{}};const Sp=function(e,t){const r={drag:[],click:[],mousemove:[],mousedown:[],mouseup:[],mouseout:[],keydown:[],keyup:[],touchstart:[],touchmove:[],touchend:[],tap:[]},n={on:function(i,a,c){if(r[i]===void 0)throw new Error(`Invalid event type: ${i}`);r[i].push({selector:a,fn:c})},render:function(i){t.store.featureChanged(i)}},o=function(i,a){const c=r[i];let u=c.length;for(;u--;){const h=c[u];if(h.selector(a)){h.fn.call(n,a),t.store.render(),t.ui.updateMapClasses();break}}};return e.start.call(n),{render:e.render,stop:function(){e.stop&&e.stop()},trash:function(){e.trash&&(e.trash(),t.store.render())},combineFeatures:function(){e.combineFeatures&&e.combineFeatures()},uncombineFeatures:function(){e.uncombineFeatures&&e.uncombineFeatures()},drag:function(i){o("drag",i)},click:function(i){o("click",i)},mousemove:function(i){o("mousemove",i)},mousedown:function(i){o("mousedown",i)},mouseup:function(i){o("mouseup",i)},mouseout:function(i){o("mouseout",i)},keydown:function(i){o("keydown",i)},keyup:function(i){o("keyup",i)},touchstart:function(i){o("touchstart",i)},touchmove:function(i){o("touchmove",i)},touchend:function(i){o("touchend",i)},tap:function(i){o("tap",i)}}};var _p=Sp,G={classes:{CONTROL_BASE:"mapboxgl-ctrl",CONTROL_BUTTON:"mapbox-gl-draw_ctrl-draw-btn",CONTROL_BUTTON_LINE:"mapbox-gl-draw_line",CONTROL_BUTTON_POLYGON:"mapbox-gl-draw_polygon",CONTROL_BUTTON_POINT:"mapbox-gl-draw_point",CONTROL_BUTTON_TRASH:"mapbox-gl-draw_trash",CONTROL_BUTTON_COMBINE_FEATURES:"mapbox-gl-draw_combine",CONTROL_BUTTON_UNCOMBINE_FEATURES:"mapbox-gl-draw_uncombine",CONTROL_GROUP:"mapboxgl-ctrl-group",ACTIVE_BUTTON:"active",BOX_SELECT:"mapbox-gl-draw_boxselect"},sources:{HOT:"mapbox-gl-draw-hot",COLD:"mapbox-gl-draw-cold"},cursors:{ADD:"add",MOVE:"move",DRAG:"drag",POINTER:"pointer",NONE:"none"},types:{POLYGON:"polygon",LINE:"line_string",POINT:"point"},geojsonTypes:{FEATURE:"Feature",POLYGON:"Polygon",LINE_STRING:"LineString",POINT:"Point",FEATURE_COLLECTION:"FeatureCollection",MULTI_PREFIX:"Multi",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon"},modes:{DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select",STATIC:"static"},events:{CREATE:"draw.create",DELETE:"draw.delete",UPDATE:"draw.update",SELECTION_CHANGE:"draw.selectionchange",MODE_CHANGE:"draw.modechange",ACTIONABLE:"draw.actionable",RENDER:"draw.render",COMBINE_FEATURES:"draw.combine",UNCOMBINE_FEATURES:"draw.uncombine"},updateActions:{MOVE:"move",CHANGE_COORDINATES:"change_coordinates"},meta:{FEATURE:"feature",MIDPOINT:"midpoint",VERTEX:"vertex"},activeStates:{ACTIVE:"true",INACTIVE:"false"},interactions:["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate"],LAT_MIN:-90,LAT_RENDERED_MIN:-85,LAT_MAX:90,LAT_RENDERED_MAX:85,LNG_MIN:-270,LNG_MAX:270};const Ep=lp,Yo=G,ya={Point:0,LineString:1,Polygon:2};function wp(e,t){const r=ya[e.geometry.type]-ya[t.geometry.type];return r===0&&e.geometry.type===Yo.geojsonTypes.POLYGON?e.area-t.area:r}function Ap(e){return e.map(t=>(t.geometry.type===Yo.geojsonTypes.POLYGON&&(t.area=Ep.geometry({type:Yo.geojsonTypes.FEATURE,property:{},geometry:t.geometry})),t)).sort(wp).map(t=>(delete t.area,t))}var Ip=Ap;function $p(e,t=0){return[[e.point.x-t,e.point.y-t],[e.point.x+t,e.point.y+t]]}var Cp=$p;function Ft(e){if(this._items={},this._nums={},this._length=e?e.length:0,!!e)for(let t=0,r=e.length;t<r;t++)this.add(e[t]),e[t]!==void 0&&(typeof e[t]=="string"?this._items[e[t]]=t:this._nums[e[t]]=t)}Ft.prototype.add=function(e){return this.has(e)?this:(this._length++,typeof e=="string"?this._items[e]=this._length:this._nums[e]=this._length,this)};Ft.prototype.delete=function(e){return this.has(e)===!1?this:(this._length--,delete this._items[e],delete this._nums[e],this)};Ft.prototype.has=function(e){return typeof e!="string"&&typeof e!="number"?!1:this._items[e]!==void 0||this._nums[e]!==void 0};Ft.prototype.values=function(){const e=[];return Object.keys(this._items).forEach(t=>{e.push({k:t,v:this._items[t]})}),Object.keys(this._nums).forEach(t=>{e.push({k:JSON.parse(t),v:this._nums[t]})}),e.sort((t,r)=>t.v-r.v).map(t=>t.k)};Ft.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this};var zr=Ft;const Op=Ip,Fp=Cp,wn=G,Pp=zr,Mp=[wn.meta.FEATURE,wn.meta.MIDPOINT,wn.meta.VERTEX];var Hr={click:Lp,touch:Rp};function Lp(e,t,r){return tc(e,t,r,r.options.clickBuffer)}function Rp(e,t,r){return tc(e,t,r,r.options.touchBuffer)}function tc(e,t,r,n){if(r.map===null)return[];const o=e?Fp(e,n):t,i={};r.options.styles&&(i.layers=r.options.styles.map(h=>h.id));const a=r.map.queryRenderedFeatures(o,i).filter(h=>Mp.indexOf(h.properties.meta)!==-1),c=new Pp,u=[];return a.forEach(h=>{const y=h.properties.id;c.has(y)||(c.add(y),u.push(h))}),Op(u)}const Np=Hr,Vt=G;var xp=function(t,r){const n=Np.click(t,null,r),o={mouse:Vt.cursors.NONE};return n[0]&&(o.mouse=n[0].properties.active===Vt.activeStates.ACTIVE?Vt.cursors.MOVE:Vt.cursors.POINTER,o.feature=n[0].properties.meta),r.events.currentModeName().indexOf("draw")!==-1&&(o.mouse=Vt.cursors.ADD),r.ui.queueMapClasses(o),r.ui.updateMapClasses(),n[0]},rc=function(e,t){const r=e.x-t.x,n=e.y-t.y;return Math.sqrt(r*r+n*n)};const Bp=rc,Dp=4,Up=12,kp=500;var qp=function(t,r,n={}){const o=n.fineTolerance!=null?n.fineTolerance:Dp,i=n.grossTolerance!=null?n.grossTolerance:Up,a=n.interval!=null?n.interval:kp;t.point=t.point||r.point,t.time=t.time||r.time;const c=Bp(t.point,r.point);return c<o||c<i&&r.time-t.time<a};const jp=rc,Gp=25,Vp=250;var Wp=function(t,r,n={}){const o=n.tolerance!=null?n.tolerance:Gp,i=n.interval!=null?n.interval:Vp;return t.point=t.point||r.point,t.time=t.time||r.time,jp(t.point,r.point)<o&&r.time-t.time<i},nc={exports:{}},oc={exports:{}},ic={exports:{}},Zo=ic.exports=function(e,t){if(t||(t=16),e===void 0&&(e=128),e<=0)return"0";for(var r=Math.log(Math.pow(2,e))/Math.log(t),n=2;r===1/0;n*=2)r=Math.log(Math.pow(2,e/n))/Math.log(t)*n;for(var o=r-Math.floor(r),i="",n=0;n<Math.floor(r);n++){var a=Math.floor(Math.random()*t).toString(t);i=a+i}if(o){var c=Math.pow(t,o),a=Math.floor(Math.random()*c).toString(t);i=a+i}var u=parseInt(i,t);return u!==1/0&&u>=Math.pow(2,e)?Zo(e,t):i};Zo.rack=function(e,t,r){var n=function(i){var a=0;do{if(a++>10)if(r)e+=r;else throw new Error("too many ID collisions, use more bits");var c=Zo(e,t)}while(Object.hasOwnProperty.call(o,c));return o[c]=i,c},o=n.hats={};return n.get=function(i){return n.hats[i]},n.set=function(i,a){return n.hats[i]=a,n},n.bits=e||128,n.base=t||16,n};var Si=ic.exports;const zp=Si,Ar=G,Xe=function(e,t){this.ctx=e,this.properties=t.properties||{},this.coordinates=t.geometry.coordinates,this.id=t.id||zp(),this.type=t.geometry.type};Xe.prototype.changed=function(){this.ctx.store.featureChanged(this.id)};Xe.prototype.incomingCoords=function(e){this.setCoordinates(e)};Xe.prototype.setCoordinates=function(e){this.coordinates=e,this.changed()};Xe.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.coordinates))};Xe.prototype.setProperty=function(e,t){this.properties[e]=t};Xe.prototype.toGeoJSON=function(){return JSON.parse(JSON.stringify({id:this.id,type:Ar.geojsonTypes.FEATURE,properties:this.properties,geometry:{coordinates:this.getCoordinates(),type:this.type}}))};Xe.prototype.internal=function(e){const t={id:this.id,meta:Ar.meta.FEATURE,"meta:type":this.type,active:Ar.activeStates.INACTIVE,mode:e};if(this.ctx.options.userProperties)for(const r in this.properties)t[`user_${r}`]=this.properties[r];return{type:Ar.geojsonTypes.FEATURE,properties:t,geometry:{coordinates:this.getCoordinates(),type:this.type}}};var Kr=Xe;const ac=Kr,Qt=function(e,t){ac.call(this,e,t)};Qt.prototype=Object.create(ac.prototype);Qt.prototype.isValid=function(){return typeof this.coordinates[0]=="number"&&typeof this.coordinates[1]=="number"};Qt.prototype.updateCoordinate=function(e,t,r){arguments.length===3?this.coordinates=[t,r]:this.coordinates=[e,t],this.changed()};Qt.prototype.getCoordinate=function(){return this.getCoordinates()};var _i=Qt;const sc=Kr,pt=function(e,t){sc.call(this,e,t)};pt.prototype=Object.create(sc.prototype);pt.prototype.isValid=function(){return this.coordinates.length>1};pt.prototype.addCoordinate=function(e,t,r){this.changed();const n=parseInt(e,10);this.coordinates.splice(n,0,[t,r])};pt.prototype.getCoordinate=function(e){const t=parseInt(e,10);return JSON.parse(JSON.stringify(this.coordinates[t]))};pt.prototype.removeCoordinate=function(e){this.changed(),this.coordinates.splice(parseInt(e,10),1)};pt.prototype.updateCoordinate=function(e,t,r){const n=parseInt(e,10);this.coordinates[n]=[t,r],this.changed()};var Ei=pt;const uc=Kr,Ne=function(e,t){uc.call(this,e,t),this.coordinates=this.coordinates.map(r=>r.slice(0,-1))};Ne.prototype=Object.create(uc.prototype);Ne.prototype.isValid=function(){return this.coordinates.length===0?!1:this.coordinates.every(e=>e.length>2)};Ne.prototype.incomingCoords=function(e){this.coordinates=e.map(t=>t.slice(0,-1)),this.changed()};Ne.prototype.setCoordinates=function(e){this.coordinates=e,this.changed()};Ne.prototype.addCoordinate=function(e,t,r){this.changed();const n=e.split(".").map(i=>parseInt(i,10));this.coordinates[n[0]].splice(n[1],0,[t,r])};Ne.prototype.removeCoordinate=function(e){this.changed();const t=e.split(".").map(n=>parseInt(n,10)),r=this.coordinates[t[0]];r&&(r.splice(t[1],1),r.length<3&&this.coordinates.splice(t[0],1))};Ne.prototype.getCoordinate=function(e){const t=e.split(".").map(n=>parseInt(n,10)),r=this.coordinates[t[0]];return JSON.parse(JSON.stringify(r[t[1]]))};Ne.prototype.getCoordinates=function(){return this.coordinates.map(e=>e.concat([e[0]]))};Ne.prototype.updateCoordinate=function(e,t,r){this.changed();const n=e.split("."),o=parseInt(n[0],10),i=parseInt(n[1],10);this.coordinates[o]===void 0&&(this.coordinates[o]=[]),this.coordinates[o][i]=[t,r]};var wi=Ne;const cc=Kr,lc=G,Hp=Si,Kp={MultiPoint:_i,MultiLineString:Ei,MultiPolygon:wi},Jr=(e,t,r,n,o)=>{const i=r.split("."),a=parseInt(i[0],10),c=i[1]?i.slice(1).join("."):null;return e[a][t](c,n,o)},Ce=function(e,t){if(cc.call(this,e,t),delete this.coordinates,this.model=Kp[t.geometry.type],this.model===void 0)throw new TypeError(`${t.geometry.type} is not a valid type`);this.features=this._coordinatesToFeatures(t.geometry.coordinates)};Ce.prototype=Object.create(cc.prototype);Ce.prototype._coordinatesToFeatures=function(e){const t=this.model.bind(this);return e.map(r=>new t(this.ctx,{id:Hp(),type:lc.geojsonTypes.FEATURE,properties:{},geometry:{coordinates:r,type:this.type.replace("Multi","")}}))};Ce.prototype.isValid=function(){return this.features.every(e=>e.isValid())};Ce.prototype.setCoordinates=function(e){this.features=this._coordinatesToFeatures(e),this.changed()};Ce.prototype.getCoordinate=function(e){return Jr(this.features,"getCoordinate",e)};Ce.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.features.map(e=>e.type===lc.geojsonTypes.POLYGON?e.getCoordinates():e.coordinates)))};Ce.prototype.updateCoordinate=function(e,t,r){Jr(this.features,"updateCoordinate",e,t,r),this.changed()};Ce.prototype.addCoordinate=function(e,t,r){Jr(this.features,"addCoordinate",e,t,r),this.changed()};Ce.prototype.removeCoordinate=function(e){Jr(this.features,"removeCoordinate",e),this.changed()};Ce.prototype.getFeatures=function(){return this.features};var Ir=Ce;const Et=G,Jp=Hr,fc=_i,pc=Ei,dc=wi,hc=Ir,ne=oc.exports=function(e){this.map=e.map,this.drawConfig=JSON.parse(JSON.stringify(e.options||{})),this._ctx=e};ne.prototype.setSelected=function(e){return this._ctx.store.setSelected(e)};ne.prototype.setSelectedCoordinates=function(e){this._ctx.store.setSelectedCoordinates(e),e.reduce((t,r)=>(t[r.feature_id]===void 0&&(t[r.feature_id]=!0,this._ctx.store.get(r.feature_id).changed()),t),{})};ne.prototype.getSelected=function(){return this._ctx.store.getSelected()};ne.prototype.getSelectedIds=function(){return this._ctx.store.getSelectedIds()};ne.prototype.isSelected=function(e){return this._ctx.store.isSelected(e)};ne.prototype.getFeature=function(e){return this._ctx.store.get(e)};ne.prototype.select=function(e){return this._ctx.store.select(e)};ne.prototype.deselect=function(e){return this._ctx.store.deselect(e)};ne.prototype.deleteFeature=function(e,t={}){return this._ctx.store.delete(e,t)};ne.prototype.addFeature=function(e){return this._ctx.store.add(e)};ne.prototype.clearSelectedFeatures=function(){return this._ctx.store.clearSelected()};ne.prototype.clearSelectedCoordinates=function(){return this._ctx.store.clearSelectedCoordinates()};ne.prototype.setActionableState=function(e={}){const t={trash:e.trash||!1,combineFeatures:e.combineFeatures||!1,uncombineFeatures:e.uncombineFeatures||!1};return this._ctx.events.actionable(t)};ne.prototype.changeMode=function(e,t={},r={}){return this._ctx.events.changeMode(e,t,r)};ne.prototype.updateUIClasses=function(e){return this._ctx.ui.queueMapClasses(e)};ne.prototype.activateUIButton=function(e){return this._ctx.ui.setActiveButton(e)};ne.prototype.featuresAt=function(e,t,r="click"){if(r!=="click"&&r!=="touch")throw new Error("invalid buffer type");return Jp[r](e,t,this._ctx)};ne.prototype.newFeature=function(e){const t=e.geometry.type;return t===Et.geojsonTypes.POINT?new fc(this._ctx,e):t===Et.geojsonTypes.LINE_STRING?new pc(this._ctx,e):t===Et.geojsonTypes.POLYGON?new dc(this._ctx,e):new hc(this._ctx,e)};ne.prototype.isInstanceOf=function(e,t){if(e===Et.geojsonTypes.POINT)return t instanceof fc;if(e===Et.geojsonTypes.LINE_STRING)return t instanceof pc;if(e===Et.geojsonTypes.POLYGON)return t instanceof dc;if(e==="MultiFeature")return t instanceof hc;throw new Error(`Unknown feature class: ${e}`)};ne.prototype.doRender=function(e){return this._ctx.store.featureChanged(e)};var Yp=oc.exports;const se=nc.exports=Yp;se.prototype.onSetup=function(){};se.prototype.onDrag=function(){};se.prototype.onClick=function(){};se.prototype.onMouseMove=function(){};se.prototype.onMouseDown=function(){};se.prototype.onMouseUp=function(){};se.prototype.onMouseOut=function(){};se.prototype.onKeyUp=function(){};se.prototype.onKeyDown=function(){};se.prototype.onTouchStart=function(){};se.prototype.onTouchMove=function(){};se.prototype.onTouchEnd=function(){};se.prototype.onTap=function(){};se.prototype.onStop=function(){};se.prototype.onTrash=function(){};se.prototype.onCombineFeature=function(){};se.prototype.onUncombineFeature=function(){};se.prototype.toDisplayFeatures=function(){throw new Error("You must overwrite toDisplayFeatures")};var Zp=nc.exports;const Xp=Zp,yc={drag:"onDrag",click:"onClick",mousemove:"onMouseMove",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseout:"onMouseOut",keyup:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",tap:"onTap"},Qp=Object.keys(yc);var ed=function(e){const t=Object.keys(e);return function(r,n={}){let o={};const i=t.reduce((c,u)=>(c[u]=e[u],c),new Xp(r));function a(c){return function(u){i[c](o,u)}}return{start:function(){o=i.onSetup(n),Qp.forEach(c=>{const u=yc[c];let h=()=>!1;e[u]&&(h=()=>!0),this.on(c,h,a(u))})},stop:function(){i.onStop(o)},trash:function(){i.onTrash(o)},combineFeatures:function(){i.onCombineFeatures(o)},uncombineFeatures:function(){i.onUncombineFeatures(o)},render:function(c,u){i.toDisplayFeatures(o,c,u)}}}};const ga=_p,An=xp,va=Hr,ma=qp,ba=Wp,vt=G,td=ed;var rd=function(e){const t=Object.keys(e.options.modes).reduce((l,p)=>(l[p]=td(e.options.modes[p]),l),{});let r={},n={};const o={};let i=null,a=null;o.drag=function(l,p){p({point:l.point,time:new Date().getTime()})?(e.ui.queueMapClasses({mouse:vt.cursors.DRAG}),a.drag(l)):l.originalEvent.stopPropagation()},o.mousedrag=function(l){o.drag(l,p=>!ma(r,p))},o.touchdrag=function(l){o.drag(l,p=>!ba(n,p))},o.mousemove=function(l){if((l.originalEvent.buttons!==void 0?l.originalEvent.buttons:l.originalEvent.which)===1)return o.mousedrag(l);const S=An(l,e);l.featureTarget=S,a.mousemove(l)},o.mousedown=function(l){r={time:new Date().getTime(),point:l.point};const p=An(l,e);l.featureTarget=p,a.mousedown(l)},o.mouseup=function(l){const p=An(l,e);l.featureTarget=p,ma(r,{point:l.point,time:new Date().getTime()})?a.click(l):a.mouseup(l)},o.mouseout=function(l){a.mouseout(l)},o.touchstart=function(l){if(l.originalEvent.preventDefault(),!e.options.touchEnabled)return;n={time:new Date().getTime(),point:l.point};const p=va.touch(l,null,e)[0];l.featureTarget=p,a.touchstart(l)},o.touchmove=function(l){if(l.originalEvent.preventDefault(),!!e.options.touchEnabled)return a.touchmove(l),o.touchdrag(l)},o.touchend=function(l){if(l.originalEvent.preventDefault(),!e.options.touchEnabled)return;const p=va.touch(l,null,e)[0];l.featureTarget=p,ba(n,{time:new Date().getTime(),point:l.point})?a.tap(l):a.touchend(l)};const c=l=>!(l===8||l===46||l>=48&&l<=57);o.keydown=function(l){(l.srcElement||l.target).classList[0]==="mapboxgl-canvas"&&((l.keyCode===8||l.keyCode===46)&&e.options.controls.trash?(l.preventDefault(),a.trash()):c(l.keyCode)?a.keydown(l):l.keyCode===49&&e.options.controls.point?u(vt.modes.DRAW_POINT):l.keyCode===50&&e.options.controls.line_string?u(vt.modes.DRAW_LINE_STRING):l.keyCode===51&&e.options.controls.polygon&&u(vt.modes.DRAW_POLYGON))},o.keyup=function(l){c(l.keyCode)&&a.keyup(l)},o.zoomend=function(){e.store.changeZoom()},o.data=function(l){if(l.dataType==="style"){const{setup:p,map:S,options:w,store:A}=e;w.styles.some(P=>S.getLayer(P.id))||(p.addLayers(),A.setDirty(),A.render())}};function u(l,p,S={}){a.stop();const w=t[l];if(w===void 0)throw new Error(`${l} is not valid`);i=l;const A=w(e,p);a=ga(A,e),S.silent||e.map.fire(vt.events.MODE_CHANGE,{mode:l}),e.store.setDirty(),e.store.render()}const h={trash:!1,combineFeatures:!1,uncombineFeatures:!1};function y(l){let p=!1;Object.keys(l).forEach(S=>{if(h[S]===void 0)throw new Error("Invalid action type");h[S]!==l[S]&&(p=!0),h[S]=l[S]}),p&&e.map.fire(vt.events.ACTIONABLE,{actions:h})}return{start:function(){i=e.options.defaultMode,a=ga(t[i](e),e)},changeMode:u,actionable:y,currentModeName:function(){return i},currentModeRender:function(l,p){return a.render(l,p)},fire:function(l,p){o[l]&&o[l](p)},addEventListeners:function(){e.map.on("mousemove",o.mousemove),e.map.on("mousedown",o.mousedown),e.map.on("mouseup",o.mouseup),e.map.on("data",o.data),e.map.on("touchmove",o.touchmove),e.map.on("touchstart",o.touchstart),e.map.on("touchend",o.touchend),e.container.addEventListener("mouseout",o.mouseout),e.options.keybindings&&(e.container.addEventListener("keydown",o.keydown),e.container.addEventListener("keyup",o.keyup))},removeEventListeners:function(){e.map.off("mousemove",o.mousemove),e.map.off("mousedown",o.mousedown),e.map.off("mouseup",o.mouseup),e.map.off("data",o.data),e.map.off("touchmove",o.touchmove),e.map.off("touchstart",o.touchstart),e.map.off("touchend",o.touchend),e.container.removeEventListener("mouseout",o.mouseout),e.options.keybindings&&(e.container.removeEventListener("keydown",o.keydown),e.container.removeEventListener("keyup",o.keyup))},trash:function(l){a.trash(l)},combineFeatures:function(){a.combineFeatures()},uncombineFeatures:function(){a.uncombineFeatures()},getMode:function(){return i}}},gc={exports:{}};function nd(e,t,r){let n,o;function i(){n=!1,o&&(a.apply(r,o),o=!1)}function a(){n?o=arguments:(n=!0,e.apply(r,arguments),setTimeout(i,t))}return a}var od=nd;function id(e){return[].concat(e).filter(t=>t!==void 0)}var ad=id;const Pe=G;var sd=function(){const t=this;if(!(t.ctx.map&&t.ctx.map.getSource(Pe.sources.HOT)!==void 0))return h();const n=t.ctx.events.currentModeName();t.ctx.ui.queueMapClasses({mode:n});let o=[],i=[];t.isDirty?i=t.getAllIds():(o=t.getChangedIds().filter(y=>t.get(y)!==void 0),i=t.sources.hot.filter(y=>y.properties.id&&o.indexOf(y.properties.id)===-1&&t.get(y.properties.id)!==void 0).map(y=>y.properties.id)),t.sources.hot=[];const a=t.sources.cold.length;t.sources.cold=t.isDirty?[]:t.sources.cold.filter(y=>{const v=y.properties.id||y.properties.parent;return o.indexOf(v)===-1});const c=a!==t.sources.cold.length||i.length>0;o.forEach(y=>u(y,"hot")),i.forEach(y=>u(y,"cold"));function u(y,v){const p=t.get(y).internal(n);t.ctx.events.currentModeRender(p,S=>{t.sources[v].push(S)})}if(c&&t.ctx.map.getSource(Pe.sources.COLD).setData({type:Pe.geojsonTypes.FEATURE_COLLECTION,features:t.sources.cold}),t.ctx.map.getSource(Pe.sources.HOT).setData({type:Pe.geojsonTypes.FEATURE_COLLECTION,features:t.sources.hot}),t._emitSelectionChange&&(t.ctx.map.fire(Pe.events.SELECTION_CHANGE,{features:t.getSelected().map(y=>y.toGeoJSON()),points:t.getSelectedCoordinates().map(y=>({type:Pe.geojsonTypes.FEATURE,properties:{},geometry:{type:Pe.geojsonTypes.POINT,coordinates:y.coordinates}}))}),t._emitSelectionChange=!1),t._deletedFeaturesToEmit.length){const y=t._deletedFeaturesToEmit.map(v=>v.toGeoJSON());t._deletedFeaturesToEmit=[],t.ctx.map.fire(Pe.events.DELETE,{features:y})}h(),t.ctx.map.fire(Pe.events.RENDER,{});function h(){t.isDirty=!1,t.clearChangedIds()}};const ud=od,Yr=ad,In=zr,cd=sd,ld=G.interactions,K=gc.exports=function(e){this._features={},this._featureIds=new In,this._selectedFeatureIds=new In,this._selectedCoordinates=[],this._changedFeatureIds=new In,this._deletedFeaturesToEmit=[],this._emitSelectionChange=!1,this._mapInitialConfig={},this.ctx=e,this.sources={hot:[],cold:[]},this.render=ud(cd,16,this),this.isDirty=!1};K.prototype.createRenderBatch=function(){const e=this.render;let t=0;return this.render=function(){t++},()=>{this.render=e,t>0&&this.render()}};K.prototype.setDirty=function(){return this.isDirty=!0,this};K.prototype.featureChanged=function(e){return this._changedFeatureIds.add(e),this};K.prototype.getChangedIds=function(){return this._changedFeatureIds.values()};K.prototype.clearChangedIds=function(){return this._changedFeatureIds.clear(),this};K.prototype.getAllIds=function(){return this._featureIds.values()};K.prototype.add=function(e){return this.featureChanged(e.id),this._features[e.id]=e,this._featureIds.add(e.id),this};K.prototype.delete=function(e,t={}){return Yr(e).forEach(r=>{this._featureIds.has(r)&&(this._featureIds.delete(r),this._selectedFeatureIds.delete(r),t.silent||this._deletedFeaturesToEmit.indexOf(this._features[r])===-1&&this._deletedFeaturesToEmit.push(this._features[r]),delete this._features[r],this.isDirty=!0)}),vc.call(this,t),this};K.prototype.get=function(e){return this._features[e]};K.prototype.getAll=function(){return Object.keys(this._features).map(e=>this._features[e])};K.prototype.select=function(e,t={}){return Yr(e).forEach(r=>{this._selectedFeatureIds.has(r)||(this._selectedFeatureIds.add(r),this._changedFeatureIds.add(r),t.silent||(this._emitSelectionChange=!0))}),this};K.prototype.deselect=function(e,t={}){return Yr(e).forEach(r=>{this._selectedFeatureIds.has(r)&&(this._selectedFeatureIds.delete(r),this._changedFeatureIds.add(r),t.silent||(this._emitSelectionChange=!0))}),vc.call(this,t),this};K.prototype.clearSelected=function(e={}){return this.deselect(this._selectedFeatureIds.values(),{silent:e.silent}),this};K.prototype.setSelected=function(e,t={}){return e=Yr(e),this.deselect(this._selectedFeatureIds.values().filter(r=>e.indexOf(r)===-1),{silent:t.silent}),this.select(e.filter(r=>!this._selectedFeatureIds.has(r)),{silent:t.silent}),this};K.prototype.setSelectedCoordinates=function(e){return this._selectedCoordinates=e,this._emitSelectionChange=!0,this};K.prototype.clearSelectedCoordinates=function(){return this._selectedCoordinates=[],this._emitSelectionChange=!0,this};K.prototype.getSelectedIds=function(){return this._selectedFeatureIds.values()};K.prototype.getSelected=function(){return this._selectedFeatureIds.values().map(e=>this.get(e))};K.prototype.getSelectedCoordinates=function(){return this._selectedCoordinates.map(t=>({coordinates:this.get(t.feature_id).getCoordinate(t.coord_path)}))};K.prototype.isSelected=function(e){return this._selectedFeatureIds.has(e)};K.prototype.setFeatureProperty=function(e,t,r){this.get(e).setProperty(t,r),this.featureChanged(e)};function vc(e){const t=this._selectedCoordinates.filter(r=>this._selectedFeatureIds.has(r.feature_id));this._selectedCoordinates.length!==t.length&&!e.silent&&(this._emitSelectionChange=!0),this._selectedCoordinates=t}K.prototype.storeMapConfig=function(){ld.forEach(e=>{this.ctx.map[e]&&(this._mapInitialConfig[e]=this.ctx.map[e].isEnabled())})};K.prototype.restoreMapConfig=function(){Object.keys(this._mapInitialConfig).forEach(e=>{this._mapInitialConfig[e]?this.ctx.map[e].enable():this.ctx.map[e].disable()})};K.prototype.getInitialConfigValue=function(e){return this._mapInitialConfig[e]!==void 0?this._mapInitialConfig[e]:!0};var fd=gc.exports;const Ta=vi,Y=G,pd=["mode","feature","mouse"];var dd=function(e){const t={};let r=null,n={mode:null,feature:null,mouse:null},o={mode:null,feature:null,mouse:null};function i(){a({mode:null,feature:null,mouse:null}),c()}function a(p){o=Ta(o,p)}function c(){if(!e.container)return;const p=[],S=[];pd.forEach(w=>{o[w]!==n[w]&&(p.push(`${w}-${n[w]}`),o[w]!==null&&S.push(`${w}-${o[w]}`))}),p.length>0&&e.container.classList.remove.apply(e.container.classList,p),S.length>0&&e.container.classList.add.apply(e.container.classList,S),n=Ta(n,o)}function u(p,S={}){const w=document.createElement("button");return w.className=`${Y.classes.CONTROL_BUTTON} ${S.className}`,w.setAttribute("title",S.title),S.container.appendChild(w),w.addEventListener("click",A=>{if(A.preventDefault(),A.stopPropagation(),A.target===r){h();return}y(p),S.onActivate()},!0),w}function h(){r&&(r.classList.remove(Y.classes.ACTIVE_BUTTON),r=null)}function y(p){h();const S=t[p];S&&S&&p!=="trash"&&(S.classList.add(Y.classes.ACTIVE_BUTTON),r=S)}function v(){const p=e.options.controls,S=document.createElement("div");return S.className=`${Y.classes.CONTROL_GROUP} ${Y.classes.CONTROL_BASE}`,p&&(p[Y.types.LINE]&&(t[Y.types.LINE]=u(Y.types.LINE,{container:S,className:Y.classes.CONTROL_BUTTON_LINE,title:`LineString tool ${e.options.keybindings?"(l)":""}`,onActivate:()=>e.events.changeMode(Y.modes.DRAW_LINE_STRING)})),p[Y.types.POLYGON]&&(t[Y.types.POLYGON]=u(Y.types.POLYGON,{container:S,className:Y.classes.CONTROL_BUTTON_POLYGON,title:`Polygon tool ${e.options.keybindings?"(p)":""}`,onActivate:()=>e.events.changeMode(Y.modes.DRAW_POLYGON)})),p[Y.types.POINT]&&(t[Y.types.POINT]=u(Y.types.POINT,{container:S,className:Y.classes.CONTROL_BUTTON_POINT,title:`Marker tool ${e.options.keybindings?"(m)":""}`,onActivate:()=>e.events.changeMode(Y.modes.DRAW_POINT)})),p.trash&&(t.trash=u("trash",{container:S,className:Y.classes.CONTROL_BUTTON_TRASH,title:"Delete",onActivate:()=>{e.events.trash()}})),p.combine_features&&(t.combine_features=u("combineFeatures",{container:S,className:Y.classes.CONTROL_BUTTON_COMBINE_FEATURES,title:"Combine",onActivate:()=>{e.events.combineFeatures()}})),p.uncombine_features&&(t.uncombine_features=u("uncombineFeatures",{container:S,className:Y.classes.CONTROL_BUTTON_UNCOMBINE_FEATURES,title:"Uncombine",onActivate:()=>{e.events.uncombineFeatures()}}))),S}function l(){Object.keys(t).forEach(p=>{const S=t[p];S.parentNode&&S.parentNode.removeChild(S),delete t[p]})}return{setActiveButton:y,queueMapClasses:a,updateMapClasses:c,clearMapClasses:i,addButtons:v,removeButtons:l}};const hd=rd,yd=fd,gd=dd,Je=G,vd=vi;var md=function(e){let t=null,r=null;const n={onRemove:function(){return e.map.off("load",n.connect),clearInterval(r),n.removeLayers(),e.store.restoreMapConfig(),e.ui.removeButtons(),e.events.removeEventListeners(),e.ui.clearMapClasses(),e.map=null,e.container=null,e.store=null,t&&t.parentNode&&t.parentNode.removeChild(t),t=null,this},connect:function(){e.map.off("load",n.connect),clearInterval(r),n.addLayers(),e.store.storeMapConfig(),e.events.addEventListeners()},onAdd:function(o){{const i=o.fire;o.fire=function(a,c){let u=arguments;return i.length===1&&arguments.length!==1&&(u=[vd({},{type:a},c)]),i.apply(o,u)}}return e.map=o,e.events=hd(e),e.ui=gd(e),e.container=o.getContainer(),e.store=new yd(e),t=e.ui.addButtons(),e.options.boxSelect&&(o.boxZoom.disable(),o.dragPan.disable(),o.dragPan.enable()),o.loaded()?n.connect():(o.on("load",n.connect),r=setInterval(()=>{o.loaded()&&n.connect()},16)),e.events.start(),t},addLayers:function(){e.map.addSource(Je.sources.COLD,{data:{type:Je.geojsonTypes.FEATURE_COLLECTION,features:[]},type:"geojson"}),e.map.addSource(Je.sources.HOT,{data:{type:Je.geojsonTypes.FEATURE_COLLECTION,features:[]},type:"geojson"}),e.options.styles.forEach(o=>{e.map.addLayer(o)}),e.store.setDirty(!0),e.store.render()},removeLayers:function(){e.options.styles.forEach(o=>{e.map.getLayer(o.id)&&e.map.removeLayer(o.id)}),e.map.getSource(Je.sources.COLD)&&e.map.removeSource(Je.sources.COLD),e.map.getSource(Je.sources.HOT)&&e.map.removeSource(Je.sources.HOT)}};return e.setup=n,n},bd=[{id:"gl-draw-polygon-fill-inactive",type:"fill",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#3bb2d0","fill-outline-color":"#3bb2d0","fill-opacity":.1}},{id:"gl-draw-polygon-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"#fbb03b","fill-outline-color":"#fbb03b","fill-opacity":.1}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-stroke-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","active","true"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-polygon-and-line-vertex-stroke-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-color":"#fff"}},{id:"gl-draw-polygon-and-line-vertex-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-point-point-stroke-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-opacity":1,"circle-color":"#fff"}},{id:"gl-draw-point-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#3bb2d0"}},{id:"gl-draw-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["==","active","true"],["!=","meta","midpoint"]],paint:{"circle-radius":7,"circle-color":"#fff"}},{id:"gl-draw-point-active",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","true"]],paint:{"circle-radius":5,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","mode","static"],["==","$type","Polygon"]],paint:{"fill-color":"#404040","fill-outline-color":"#404040","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","mode","static"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-line-static",type:"line",filter:["all",["==","mode","static"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-point-static",type:"circle",filter:["all",["==","mode","static"],["==","$type","Point"]],paint:{"circle-radius":5,"circle-color":"#404040"}}];const mt=G;var Pt={isOfMetaType:function(e){return function(t){const r=t.featureTarget;return!r||!r.properties?!1:r.properties.meta===e}},isShiftMousedown:function(e){return!e.originalEvent||!e.originalEvent.shiftKey?!1:e.originalEvent.button===0},isActiveFeature:function(e){return!e.featureTarget||!e.featureTarget.properties?!1:e.featureTarget.properties.active===mt.activeStates.ACTIVE&&e.featureTarget.properties.meta===mt.meta.FEATURE},isInactiveFeature:function(e){return!e.featureTarget||!e.featureTarget.properties?!1:e.featureTarget.properties.active===mt.activeStates.INACTIVE&&e.featureTarget.properties.meta===mt.meta.FEATURE},noTarget:function(e){return e.featureTarget===void 0},isFeature:function(e){return!e.featureTarget||!e.featureTarget.properties?!1:e.featureTarget.properties.meta===mt.meta.FEATURE},isVertex:function(e){const t=e.featureTarget;return!t||!t.properties?!1:t.properties.meta===mt.meta.VERTEX},isShiftDown:function(e){return e.originalEvent?e.originalEvent.shiftKey===!0:!1},isEscapeKey:function(e){return e.keyCode===27},isEnterKey:function(e){return e.keyCode===13},true:function(){return!0}},Td=wt;function wt(e,t){this.x=e,this.y=t}wt.prototype={clone:function(){return new wt(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,r=e.y-this.y;return t*t+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[0]*this.x+e[1]*this.y,r=e[2]*this.x+e[3]*this.y;return this.x=t,this.y=r,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),r=Math.sin(e),n=t*this.x-r*this.y,o=r*this.x+t*this.y;return this.x=n,this.y=o,this},_rotateAround:function(e,t){var r=Math.cos(e),n=Math.sin(e),o=t.x+r*(this.x-t.x)-n*(this.y-t.y),i=t.y+n*(this.x-t.x)+r*(this.y-t.y);return this.x=o,this.y=i,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}};wt.convert=function(e){return e instanceof wt?e:Array.isArray(e)?new wt(e[0],e[1]):e};const Sd=Td;function _d(e,t){const r=t.getBoundingClientRect();return new Sd(e.clientX-r.left-(t.clientLeft||0),e.clientY-r.top-(t.clientTop||0))}var Ed=_d;const Wt=G;var Zr=function(e,t,r,n){return{type:Wt.geojsonTypes.FEATURE,properties:{meta:Wt.meta.VERTEX,parent:e,coord_path:r,active:n?Wt.activeStates.ACTIVE:Wt.activeStates.INACTIVE},geometry:{type:Wt.geojsonTypes.POINT,coordinates:t}}};const st=G;var wd=function(e,t,r,n){const o=t.geometry.coordinates,i=r.geometry.coordinates;if(o[1]>st.LAT_RENDERED_MAX||o[1]<st.LAT_RENDERED_MIN||i[1]>st.LAT_RENDERED_MAX||i[1]<st.LAT_RENDERED_MIN)return null;const a=n.project([o[0],o[1]]),c=n.project([i[0],i[1]]),u=n.unproject([(a.x+c.x)/2,(a.y+c.y)/2]);return{type:st.geojsonTypes.FEATURE,properties:{meta:st.meta.MIDPOINT,parent:e,lng:u.lng,lat:u.lat,coord_path:r.properties.coord_path},geometry:{type:st.geojsonTypes.POINT,coordinates:[u.lng,u.lat]}}};const Sa=Zr,Ad=wd,bt=G;function mc(e,t={},r=null){const{type:n,coordinates:o}=e.geometry,i=e.properties&&e.properties.id;let a=[];n===bt.geojsonTypes.POINT?a.push(Sa(i,o,r,u(r))):n===bt.geojsonTypes.POLYGON?o.forEach((y,v)=>{c(y,r!==null?`${r}.${v}`:String(v))}):n===bt.geojsonTypes.LINE_STRING?c(o,r):n.indexOf(bt.geojsonTypes.MULTI_PREFIX)===0&&h();function c(y,v){let l="",p=null;y.forEach((S,w)=>{const A=v!=null?`${v}.${w}`:String(w),N=Sa(i,S,A,u(A));if(t.midpoints&&p){const m=Ad(i,p,N,t.map);m&&a.push(m)}p=N;const P=JSON.stringify(S);l!==P&&a.push(N),w===0&&(l=P)})}function u(y){return t.selectedPaths?t.selectedPaths.indexOf(y)!==-1:!1}function h(){const y=n.replace(bt.geojsonTypes.MULTI_PREFIX,"");o.forEach((v,l)=>{const p={type:bt.geojsonTypes.FEATURE,properties:e.properties,geometry:{type:y,coordinates:v}};a=a.concat(mc(p,t,l))})}return a}var Xr=mc,Mt={enable(e){setTimeout(()=>{!e.map||!e.map.doubleClickZoom||!e._ctx||!e._ctx.store||!e._ctx.store.getInitialConfigValue||e._ctx.store.getInitialConfigValue("doubleClickZoom")&&e.map.doubleClickZoom.enable()},0)},disable(e){setTimeout(()=>{!e.map||!e.map.doubleClickZoom||e.map.doubleClickZoom.disable()},0)}},Qr={exports:{}},Id=function e(t){switch(t&&t.type||null){case"FeatureCollection":return t.features=t.features.reduce(function(r,n){return r.concat(e(n))},[]),t;case"Feature":return t.geometry?e(t.geometry).map(function(r){var n={type:"Feature",properties:JSON.parse(JSON.stringify(t.properties)),geometry:r};return t.id!==void 0&&(n.id=t.id),n}):t;case"MultiPoint":return t.coordinates.map(function(r){return{type:"Point",coordinates:r}});case"MultiPolygon":return t.coordinates.map(function(r){return{type:"Polygon",coordinates:r}});case"MultiLineString":return t.coordinates.map(function(r){return{type:"LineString",coordinates:r}});case"GeometryCollection":return t.geometries.map(e).reduce(function(r,n){return r.concat(n)},[]);case"Point":case"Polygon":case"LineString":return[t]}},$d=function(t){return r(t);function r(n){return Array.isArray(n)&&n.length&&typeof n[0]=="number"?[n]:n.reduce(function(o,i){return Array.isArray(i)&&Array.isArray(i[0])?o.concat(r(i)):(o.push(i),o)},[])}},Cd=Hu,Od=Id,Fd=$d,Pd=function(e){if(!e)return[];var t=Od(Cd(e)),r=[];return t.features.forEach(function(n){n.geometry&&(r=r.concat(Fd(n.geometry.coordinates)))}),r},bc=Function.prototype.toString,_t=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,Xo,$r;if(typeof _t=="function"&&typeof Object.defineProperty=="function")try{Xo=Object.defineProperty({},"length",{get:function(){throw $r}}),$r={},_t(function(){throw 42},null,Xo)}catch(e){e!==$r&&(_t=null)}else _t=null;var Md=/^\s*class\b/,Qo=function(t){try{var r=bc.call(t);return Md.test(r)}catch{return!1}},$n=function(t){try{return Qo(t)?!1:(bc.call(t),!0)}catch{return!1}},Cr=Object.prototype.toString,Ld="[object Object]",Rd="[object Function]",Nd="[object GeneratorFunction]",xd="[object HTMLAllCollection]",Bd="[object HTML document.all class]",Dd="[object HTMLCollection]",Ud=typeof Symbol=="function"&&!!Symbol.toStringTag,kd=!(0 in[,]),ei=function(){return!1};if(typeof document=="object"){var qd=document.all;Cr.call(qd)===Cr.call(document.all)&&(ei=function(t){if((kd||!t)&&(typeof t>"u"||typeof t=="object"))try{var r=Cr.call(t);return(r===xd||r===Bd||r===Dd||r===Ld)&&t("")==null}catch{}return!1})}var en=_t?function(t){if(ei(t))return!0;if(!t||typeof t!="function"&&typeof t!="object")return!1;try{_t(t,null,Xo)}catch(r){if(r!==$r)return!1}return!Qo(t)&&$n(t)}:function(t){if(ei(t))return!0;if(!t||typeof t!="function"&&typeof t!="object")return!1;if(Ud)return $n(t);if(Qo(t))return!1;var r=Cr.call(t);return r!==Rd&&r!==Nd&&!/^\[object HTML/.test(r)?!1:$n(t)},jd=en,Gd=Object.prototype.toString,Tc=Object.prototype.hasOwnProperty,Vd=function(t,r,n){for(var o=0,i=t.length;o<i;o++)Tc.call(t,o)&&(n==null?r(t[o],o,t):r.call(n,t[o],o,t))},Wd=function(t,r,n){for(var o=0,i=t.length;o<i;o++)n==null?r(t.charAt(o),o,t):r.call(n,t.charAt(o),o,t)},zd=function(t,r,n){for(var o in t)Tc.call(t,o)&&(n==null?r(t[o],o,t):r.call(n,t[o],o,t))};function Hd(e){return Gd.call(e)==="[object Array]"}var Ai=function(t,r,n){if(!jd(r))throw new TypeError("iterator must be a function");var o;arguments.length>=3&&(o=n),Hd(t)?Vd(t,r,o):typeof t=="string"?Wd(t,r,o):zd(t,r,o)},Sc=["Float16Array","Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"],Cn=Sc,Kd=typeof globalThis>"u"?window:globalThis,er=function(){for(var t=[],r=0;r<Cn.length;r++)typeof Kd[Cn[r]]=="function"&&(t[t.length]=Cn[r]);return t},Pr=Ai,Jd=er,_a=Ze,Ii=V,Or=Wr,fr=It,Yd=Ii("Object.prototype.toString"),_c=lt(),Ea=typeof globalThis>"u"?window:globalThis,ti=Jd(),$i=Ii("String.prototype.slice"),Zd=Ii("Array.prototype.indexOf",!0)||function(t,r){for(var n=0;n<t.length;n+=1)if(t[n]===r)return n;return-1},Mr={__proto__:null};_c&&Or&&fr?Pr(ti,function(e){var t=new Ea[e];if(Symbol.toStringTag in t&&fr){var r=fr(t),n=Or(r,Symbol.toStringTag);if(!n&&r){var o=fr(r);n=Or(o,Symbol.toStringTag)}Mr["$"+e]=_a(n.get)}}):Pr(ti,function(e){var t=new Ea[e],r=t.slice||t.set;r&&(Mr["$"+e]=_a(r))});var Xd=function(t){var r=!1;return Pr(Mr,function(n,o){if(!r)try{"$"+n(t)===o&&(r=$i(o,1))}catch{}}),r},Qd=function(t){var r=!1;return Pr(Mr,function(n,o){if(!r)try{n(t),r=$i(o,1)}catch{}}),r},Lt=function(t){if(!t||typeof t!="object")return!1;if(!_c){var r=$i(Yd(t),8,-1);return Zd(ti,r)>-1?r:r!=="Object"?!1:Qd(t)}return Or?Xd(t):null};const eh={},th=Object.freeze(Object.defineProperty({__proto__:null,default:eh},Symbol.toStringTag,{value:"Module"})),ri=mi(th);var Ci=typeof Map=="function"&&Map.prototype,On=Object.getOwnPropertyDescriptor&&Ci?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,Lr=Ci&&On&&typeof On.get=="function"?On.get:null,wa=Ci&&Map.prototype.forEach,Oi=typeof Set=="function"&&Set.prototype,Fn=Object.getOwnPropertyDescriptor&&Oi?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,Rr=Oi&&Fn&&typeof Fn.get=="function"?Fn.get:null,Aa=Oi&&Set.prototype.forEach,rh=typeof WeakMap=="function"&&WeakMap.prototype,Jt=rh?WeakMap.prototype.has:null,nh=typeof WeakSet=="function"&&WeakSet.prototype,Yt=nh?WeakSet.prototype.has:null,oh=typeof WeakRef=="function"&&WeakRef.prototype,Ia=oh?WeakRef.prototype.deref:null,ih=Boolean.prototype.valueOf,ah=Object.prototype.toString,sh=Function.prototype.toString,uh=String.prototype.match,Fi=String.prototype.slice,Ye=String.prototype.replace,ch=String.prototype.toUpperCase,$a=String.prototype.toLowerCase,Ec=RegExp.prototype.test,Ca=Array.prototype.concat,Me=Array.prototype.join,lh=Array.prototype.slice,Oa=Math.floor,ni=typeof BigInt=="function"?BigInt.prototype.valueOf:null,Pn=Object.getOwnPropertySymbols,oi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,At=typeof Symbol=="function"&&typeof Symbol.iterator=="object",Zt=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===At||!0)?Symbol.toStringTag:null,wc=Object.prototype.propertyIsEnumerable,Fa=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null);function Pa(e,t){if(e===1/0||e===-1/0||e!==e||e&&e>-1e3&&e<1e3||Ec.call(/e/,t))return t;var r=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof e=="number"){var n=e<0?-Oa(-e):Oa(e);if(n!==e){var o=String(n),i=Fi.call(t,o.length+1);return Ye.call(o,r,"$&_")+"."+Ye.call(Ye.call(i,/([0-9]{3})/g,"$&_"),/_$/,"")}}return Ye.call(t,r,"$&_")}var ii=ri,Ma=ii.custom,La=$c(Ma)?Ma:null,Ac={__proto__:null,double:'"',single:"'"},fh={__proto__:null,double:/(["\\])/g,single:/(['\\])/g},ph=function e(t,r,n,o){var i=r||{};if(je(i,"quoteStyle")&&!je(Ac,i.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(je(i,"maxStringLength")&&(typeof i.maxStringLength=="number"?i.maxStringLength<0&&i.maxStringLength!==1/0:i.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var a=je(i,"customInspect")?i.customInspect:!0;if(typeof a!="boolean"&&a!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(je(i,"indent")&&i.indent!==null&&i.indent!=="	"&&!(parseInt(i.indent,10)===i.indent&&i.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(je(i,"numericSeparator")&&typeof i.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var c=i.numericSeparator;if(typeof t>"u")return"undefined";if(t===null)return"null";if(typeof t=="boolean")return t?"true":"false";if(typeof t=="string")return Oc(t,i);if(typeof t=="number"){if(t===0)return 1/0/t>0?"0":"-0";var u=String(t);return c?Pa(t,u):u}if(typeof t=="bigint"){var h=String(t)+"n";return c?Pa(t,h):h}var y=typeof i.depth>"u"?5:i.depth;if(typeof n>"u"&&(n=0),n>=y&&y>0&&typeof t=="object")return ai(t)?"[Array]":"[Object]";var v=Fh(i,n);if(typeof o>"u")o=[];else if(Cc(o,t)>=0)return"[Circular]";function l(E,x,j){if(x&&(o=lh.call(o),o.push(x)),j){var X={depth:i.depth};return je(i,"quoteStyle")&&(X.quoteStyle=i.quoteStyle),e(E,X,n+1,o)}return e(E,i,n+1,o)}if(typeof t=="function"&&!Ra(t)){var p=Sh(t),S=pr(t,l);return"[Function"+(p?": "+p:" (anonymous)")+"]"+(S.length>0?" { "+Me.call(S,", ")+" }":"")}if($c(t)){var w=At?Ye.call(String(t),/^(Symbol\(.*\))_[^)]*$/,"$1"):oi.call(t);return typeof t=="object"&&!At?zt(w):w}if($h(t)){for(var A="<"+$a.call(String(t.nodeName)),N=t.attributes||[],P=0;P<N.length;P++)A+=" "+N[P].name+"="+Ic(dh(N[P].value),"double",i);return A+=">",t.childNodes&&t.childNodes.length&&(A+="..."),A+="</"+$a.call(String(t.nodeName))+">",A}if(ai(t)){if(t.length===0)return"[]";var m=pr(t,l);return v&&!Oh(m)?"["+si(m,v)+"]":"[ "+Me.call(m,", ")+" ]"}if(yh(t)){var I=pr(t,l);return!("cause"in Error.prototype)&&"cause"in t&&!wc.call(t,"cause")?"{ ["+String(t)+"] "+Me.call(Ca.call("[cause]: "+l(t.cause),I),", ")+" }":I.length===0?"["+String(t)+"]":"{ ["+String(t)+"] "+Me.call(I,", ")+" }"}if(typeof t=="object"&&a){if(La&&typeof t[La]=="function"&&ii)return ii(t,{depth:y-n});if(a!=="symbol"&&typeof t.inspect=="function")return t.inspect()}if(_h(t)){var $=[];return wa&&wa.call(t,function(E,x){$.push(l(x,t,!0)+" => "+l(E,t))}),Na("Map",Lr.call(t),$,v)}if(Ah(t)){var L=[];return Aa&&Aa.call(t,function(E){L.push(l(E,t))}),Na("Set",Rr.call(t),L,v)}if(Eh(t))return Mn("WeakMap");if(Ih(t))return Mn("WeakSet");if(wh(t))return Mn("WeakRef");if(vh(t))return zt(l(Number(t)));if(bh(t))return zt(l(ni.call(t)));if(mh(t))return zt(ih.call(t));if(gh(t))return zt(l(String(t)));if(typeof window<"u"&&t===window)return"{ [object Window] }";if(typeof globalThis<"u"&&t===globalThis||typeof window<"u"&&t===window)return"{ [object globalThis] }";if(!hh(t)&&!Ra(t)){var O=pr(t,l),F=Fa?Fa(t)===Object.prototype:t instanceof Object||t.constructor===Object,f=t instanceof Object?"":"null prototype",_=!F&&Zt&&Object(t)===t&&Zt in t?Fi.call(Qe(t),8,-1):f?"Object":"",g=F||typeof t.constructor!="function"?"":t.constructor.name?t.constructor.name+" ":"",b=g+(_||f?"["+Me.call(Ca.call([],_||[],f||[]),": ")+"] ":"");return O.length===0?b+"{}":v?b+"{"+si(O,v)+"}":b+"{ "+Me.call(O,", ")+" }"}return String(t)};function Ic(e,t,r){var n=r.quoteStyle||t,o=Ac[n];return o+e+o}function dh(e){return Ye.call(String(e),/"/g,"&quot;")}function dt(e){return!Zt||!(typeof e=="object"&&(Zt in e||typeof e[Zt]<"u"))}function ai(e){return Qe(e)==="[object Array]"&&dt(e)}function hh(e){return Qe(e)==="[object Date]"&&dt(e)}function Ra(e){return Qe(e)==="[object RegExp]"&&dt(e)}function yh(e){return Qe(e)==="[object Error]"&&dt(e)}function gh(e){return Qe(e)==="[object String]"&&dt(e)}function vh(e){return Qe(e)==="[object Number]"&&dt(e)}function mh(e){return Qe(e)==="[object Boolean]"&&dt(e)}function $c(e){if(At)return e&&typeof e=="object"&&e instanceof Symbol;if(typeof e=="symbol")return!0;if(!e||typeof e!="object"||!oi)return!1;try{return oi.call(e),!0}catch{}return!1}function bh(e){if(!e||typeof e!="object"||!ni)return!1;try{return ni.call(e),!0}catch{}return!1}var Th=Object.prototype.hasOwnProperty||function(e){return e in this};function je(e,t){return Th.call(e,t)}function Qe(e){return ah.call(e)}function Sh(e){if(e.name)return e.name;var t=uh.call(sh.call(e),/^function\s*([\w$]+)/);return t?t[1]:null}function Cc(e,t){if(e.indexOf)return e.indexOf(t);for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}function _h(e){if(!Lr||!e||typeof e!="object")return!1;try{Lr.call(e);try{Rr.call(e)}catch{return!0}return e instanceof Map}catch{}return!1}function Eh(e){if(!Jt||!e||typeof e!="object")return!1;try{Jt.call(e,Jt);try{Yt.call(e,Yt)}catch{return!0}return e instanceof WeakMap}catch{}return!1}function wh(e){if(!Ia||!e||typeof e!="object")return!1;try{return Ia.call(e),!0}catch{}return!1}function Ah(e){if(!Rr||!e||typeof e!="object")return!1;try{Rr.call(e);try{Lr.call(e)}catch{return!0}return e instanceof Set}catch{}return!1}function Ih(e){if(!Yt||!e||typeof e!="object")return!1;try{Yt.call(e,Yt);try{Jt.call(e,Jt)}catch{return!0}return e instanceof WeakSet}catch{}return!1}function $h(e){return!e||typeof e!="object"?!1:typeof HTMLElement<"u"&&e instanceof HTMLElement?!0:typeof e.nodeName=="string"&&typeof e.getAttribute=="function"}function Oc(e,t){if(e.length>t.maxStringLength){var r=e.length-t.maxStringLength,n="... "+r+" more character"+(r>1?"s":"");return Oc(Fi.call(e,0,t.maxStringLength),t)+n}var o=fh[t.quoteStyle||"single"];o.lastIndex=0;var i=Ye.call(Ye.call(e,o,"\\$1"),/[\x00-\x1f]/g,Ch);return Ic(i,"single",t)}function Ch(e){var t=e.charCodeAt(0),r={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return r?"\\"+r:"\\x"+(t<16?"0":"")+ch.call(t.toString(16))}function zt(e){return"Object("+e+")"}function Mn(e){return e+" { ? }"}function Na(e,t,r,n){var o=n?si(r,n):Me.call(r,", ");return e+" ("+t+") {"+o+"}"}function Oh(e){for(var t=0;t<e.length;t++)if(Cc(e[t],`
`)>=0)return!1;return!0}function Fh(e,t){var r;if(e.indent==="	")r="	";else if(typeof e.indent=="number"&&e.indent>0)r=Me.call(Array(e.indent+1)," ");else return null;return{base:r,prev:Me.call(Array(t+1),r)}}function si(e,t){if(e.length===0)return"";var r=`
`+t.prev+t.base;return r+Me.call(e,","+r)+`
`+t.prev}function pr(e,t){var r=ai(e),n=[];if(r){n.length=e.length;for(var o=0;o<e.length;o++)n[o]=je(e,o)?t(e[o],e):""}var i=typeof Pn=="function"?Pn(e):[],a;if(At){a={};for(var c=0;c<i.length;c++)a["$"+i[c]]=i[c]}for(var u in e)je(e,u)&&(r&&String(Number(u))===u&&u<e.length||At&&a["$"+u]instanceof Symbol||(Ec.call(/[^\w$]/,u)?n.push(t(u,e)+": "+t(e[u],e)):n.push(u+": "+t(e[u],e))));if(typeof Pn=="function")for(var h=0;h<i.length;h++)wc.call(e,i[h])&&n.push("["+t(i[h])+"]: "+t(e[i[h]],e));return n}var tn=function(t){return typeof t=="string"||typeof t=="symbol"},et=function(t){return!!t&&(typeof t=="function"||typeof t=="object")},xa=U,Ph=ph,Mh=tn,Lh=et,Rh=function(t,r){if(!Lh(t))throw new xa("Assertion failed: Type(O) is not Object");if(!Mh(r))throw new xa("Assertion failed: P is not a Property Key, got "+Ph(r));return t[r]},Nh=$t,Ve=function(t){return(typeof t=="number"||typeof t=="bigint")&&!Nh(t)&&t!==1/0&&t!==-1/0},xh=bi,Bh=Ct,Dh=$t,Uh=Ve,rn=function(t){if(typeof t!="number"||Dh(t)||!Uh(t))return!1;var r=xh(t);return Bh(r)===r},kh=Ze,Fc=V,qh=Z,ui=qh("%ArrayBuffer%",!0),Fr=Fc("ArrayBuffer.prototype.byteLength",!0),jh=Fc("Object.prototype.toString"),Ba=!!ui&&!Fr&&new ui(0).slice,Da=!!Ba&&kh(Ba),Rt=Fr||Da?function(t){if(!t||typeof t!="object")return!1;try{return Fr?Fr(t):Da(t,0),!0}catch{return!1}}:ui?function(t){return jh(t)==="[object ArrayBuffer]"}:function(t){return!1},Gh=V,Ua=Gh("ArrayBuffer.prototype.byteLength",!0),Vh=Rt,Pc=function(t){return Vh(t)?Ua?Ua(t):t.byteLength:NaN},Wh=V,ka=Wh("SharedArrayBuffer.prototype.byteLength",!0),tr=ka?function(t){if(!t||typeof t!="object")return!1;try{return ka(t),!0}catch{return!1}}:function(t){return!1},zh=U,Hh=Pc,Kh=er(),Jh=V,Yh=Rt,Zh=tr,Xh=Jh("SharedArrayBuffer.prototype.byteLength",!0),Nt=function(t){var r=Zh(t);if(!Yh(t)&&!r)throw new zh("Assertion failed: `arrayBuffer` must be an Object with an [[ArrayBufferData]] internal slot");if((r?Xh:Hh)(t)===0)try{new window[Kh[0]](t)}catch(n){return!!n&&n.name==="TypeError"}return!1},Ln,qa;function Mc(){if(qa)return Ln;qa=1;var e=U,t=ft,r=et,n=tn;return Ln=function(i,a){if(!r(i))throw new e("Assertion failed: `O` must be an Object");if(!n(a))throw new e("Assertion failed: `P` must be a Property Key");return t(i,a)},Ln}var Qh=Z,Lc=Qh("%Array%"),ey=!Lc.isArray&&V("Object.prototype.toString"),Rc=Lc.isArray||function(t){return ey(t)==="[object Array]"},Pi=Rc,Rn,ja;function Nc(){return ja||(ja=1,Rn=function(t){return t==="BIGUINT64"||t==="BIGINT64"}),Rn}var Nn,Ga;function ty(){return Ga||(Ga=1,Nn=function(t){return t==="UINT8"||t==="UINT8C"||t==="UINT16"||t==="UINT32"||t==="BIGUINT64"}),Nn}var xn,Va;function ry(){if(Va)return xn;Va=1;var e=Ot;return xn=function(r){var n=r[3]&128?-1:1,o=(r[3]&127)<<1|r[2]>>7,i=(r[2]&127)<<16|r[1]<<8|r[0];return o===0&&i===0?n===1?0:-0:o===255&&i===0?n===1?1/0:-1/0:o===255&&i!==0?NaN:(o-=127,o===-127?n*i*e(2,-149):n*(1+i*e(2,-23))*e(2,o))},xn}var Bn,Wa;function ny(){if(Wa)return Bn;Wa=1;var e=Ot;return Bn=function(r){var n=r[7]&128?-1:1,o=(r[7]&127)<<4|(r[6]&240)>>4,i=(r[6]&15)*281474976710656+r[5]*1099511627776+r[4]*4294967296+r[3]*16777216+r[2]*65536+r[1]*256+r[0];return o===0&&i===0?n*0:o===2047&&i!==0?NaN:o===2047&&i===0?n*(1/0):(o-=1023,o===-1023?n*i*5e-324:n*(1+i/4503599627370496)*e(2,o))},Bn}var Dn,za;function oy(){if(za)return Dn;za=1;var e=Z,t=Ot,r=e("%Number%"),n=e("%BigInt%",!0);return Dn=function(i,a,c,u){for(var h=u?n:r,y=h(0),v=0;v<i.length;v++)y+=h(i[v]*t(2,8*v));if(!c){var l=a*8;i[a-1]&128&&(y-=h(t(2,l)))}return y},Dn}var Un,Ha;function iy(){return Ha||(Ha=1,Un=function(t,r){for(var n=0;n<t.length;n+=1)if(!r(t[n],n,t))return!1;return!0}),Un}var kn,Ka;function ay(){return Ka||(Ka=1,kn=function(t){return typeof t=="number"&&t>=0&&t<=255&&(t|0)===t}),kn}var xt={__proto__:null,name:{__proto__:null,$Int8Array:"INT8",$Uint8Array:"UINT8",$Uint8ClampedArray:"UINT8C",$Int16Array:"INT16",$Uint16Array:"UINT16",$Int32Array:"INT32",$Uint32Array:"UINT32",$BigInt64Array:"BIGINT64",$BigUint64Array:"BIGUINT64",$Float32Array:"FLOAT32",$Float64Array:"FLOAT64"},size:{__proto__:null,$INT8:1,$UINT8:1,$UINT8C:1,$INT16:2,$UINT16:2,$INT32:4,$UINT32:4,$BIGINT64:8,$BIGUINT64:8,$FLOAT32:4,$FLOAT64:8},choices:'"INT8", "UINT8", "UINT8C", "INT16", "UINT16", "INT32", "UINT32", "BIGINT64", "BIGUINT64", "FLOAT32", or "FLOAT64"'},qn,Ja;function sy(){if(Ja)return qn;Ja=1;var e=Z,t=V,r=Ku,n=Ge,o=U,i=e("%BigInt%",!0),a=Mc(),c=Pi,u=Nc(),h=ty(),y=ry(),v=ny(),l=oy(),p=iy(),S=ay(),w=t("Array.prototype.reverse"),A=t("Array.prototype.slice"),N=xt;return qn=function(m,I,$){if(!a(N.size,"$"+m))throw new o("Assertion failed: `type` must be a TypedArray element type");if(!c(I)||!p(I,S))throw new o("Assertion failed: `rawBytes` must be an Array of bytes");if(typeof $!="boolean")throw new o("Assertion failed: `isLittleEndian` must be a Boolean");var L=N.size["$"+m];if(I.length!==L)throw new r("Assertion failed: `rawBytes` must have a length of "+L+" for type "+m);var O=u(m);if(O&&!i)throw new n("this environment does not support BigInts");return I=A(I,0,L),$||w(I),m==="FLOAT32"?y(I):m==="FLOAT64"?v(I):l(I,L,h(m),O)},qn}var jn,Ya;function uy(){if(Ya)return jn;Ya=1;var e={}.toString;return jn=Array.isArray||function(t){return e.call(t)=="[object Array]"},jn}var Gn,Za;function cy(){if(Za)return Gn;Za=1;var e=Z,t=e("%Array.prototype.concat%"),r=Ze,n=V,o=n("Array.prototype.slice"),i=pp(),a=i&&Symbol.isConcatSpreadable,c=[],u=a?r.apply(t,c):null,h=a?uy():null;return Gn=a?function(v){for(var l=0;l<arguments.length;l+=1){var p=arguments[l];if(p&&typeof p=="object"&&typeof p[a]=="boolean"){c[a]||(c[a]=!0);var S=h(p)?o(p):[p];S[a]=!0,arguments[l]=S}}return u(arguments)}:r(t,c),Gn}var ly=Lt,Bt=function(t){return!!ly(t)},fy=U,py=V,dy=py("TypedArray.prototype.buffer",!0),hy=Bt,rr=dy||function(t){if(!hy(t))throw new fy("Not a Typed Array");return t.buffer},Vn,Xa;function xc(){if(Xa)return Vn;Xa=1;var e=Z,t=e("%Uint8Array%",!0),r=e("%Uint32Array%",!0),n=rr,o=r&&new r([305419896]),i=o&&new t(n(o));return Vn=i?i[0]===120?"little":i[0]===18?"big":i[0]===52?"mixed":"unknown":"indeterminate",Vn}var yy=Z,gy=Ge,ke=U,vy=V,my=rn,by=yy("%Uint8Array%",!0),Wn=vy("Array.prototype.slice"),Ty=Nt,Sy=sy(),_y=Rt,Ey=tr,Qa=cy(),dr=xt,wy=xc(),Ay=function(t,r,n,o,i){var a=Ey(t);if(!_y(t)&&!a)throw new ke("Assertion failed: `arrayBuffer` must be an ArrayBuffer or a SharedArrayBuffer");if(!my(r))throw new ke("Assertion failed: `byteIndex` must be an integer");if(typeof n!="string"||typeof dr.size["$"+n]!="number")throw new ke("Assertion failed: `type` must be one of "+dr.choices);if(typeof o!="boolean")throw new ke("Assertion failed: `isTypedArray` must be a boolean");if(i!=="SEQ-CST"&&i!=="UNORDERED")throw new ke("Assertion failed: `order` must be either `SEQ-CST` or `UNORDERED`");if(arguments.length>5&&typeof arguments[5]!="boolean")throw new ke("Assertion failed: `isLittleEndian` must be a boolean, if present");if(Ty(t))throw new ke("Assertion failed: `arrayBuffer` is detached");if(r<0)throw new ke("Assertion failed: `byteIndex` must be non-negative");var c=dr.size["$"+n];if(!c)throw new ke("Assertion failed: `type` must be one of "+dr.choices);var u;if(a)throw new gy("SharedArrayBuffer is not supported by this implementation");u=Wn(new by(t,r),0,c);var h=arguments.length>5?arguments[5]:wy==="little",y=h?Wn(Qa([0,0,0,0,0,0,0,0],u),-c):Wn(Qa(u,[0,0,0,0,0,0,0,0]),0,c);return Sy(n,y,h)},es=$t,Bc=function(t,r){return t===r?t===0?1/t===1/r:!0:es(t)&&es(r)},hr=U,Iy=et,$y=tn,ts=Bc,rs=function(){try{return delete[].length,!0}catch{return!1}}(),Cy=function(t,r,n,o){if(!Iy(t))throw new hr("Assertion failed: `O` must be an Object");if(!$y(r))throw new hr("Assertion failed: `P` must be a Property Key");if(typeof o!="boolean")throw new hr("Assertion failed: `Throw` must be a Boolean");if(o){if(t[r]=n,rs&&!ts(t[r],n))throw new hr("Attempted to assign to readonly property.");return!0}try{return t[r]=n,rs?ts(t[r],n):!0}catch{return!1}},zn,ns;function Oy(){if(ns)return zn;ns=1;var e=Z,t=e("%BigInt%",!0),r=U,n=Ge;return zn=function(i){if(typeof i!="string")throw new r("`argument` must be a string");if(!t)throw new n("BigInts are not supported in this environment");try{return t(i)}catch{return}},zn}var Hn,os;function Fy(){return os||(os=1,Hn=function(t){return t===null||typeof t!="function"&&typeof t!="object"}),Hn}var yr={exports:{}},Kn,is;function nn(){if(is)return Kn;is=1;var e=V,t=Ju,r=e("RegExp.prototype.exec"),n=U;return Kn=function(i){if(!t(i))throw new n("`regex` must be a RegExp");return function(c){return r(i,c)!==null}},Kn}var as;function Dc(){if(as)return yr.exports;as=1;var e=V,t=e("Object.prototype.toString"),r=dp()(),n=nn();if(r){var o=e("Symbol.prototype.toString"),i=n(/^Symbol\(.*\)$/),a=function(u){return typeof u.valueOf()!="symbol"?!1:i(o(u))};yr.exports=function(u){if(typeof u=="symbol")return!0;if(!u||typeof u!="object"||t(u)!=="[object Symbol]")return!1;try{return a(u)}catch{return!1}}}else yr.exports=function(u){return!1};return yr.exports}var Jn,ss;function Py(){if(ss)return Jn;ss=1;var e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol",t=Fy(),r=en,n=Yu,o=Dc(),i=function(u,h){if(typeof u>"u"||u===null)throw new TypeError("Cannot call method on "+u);if(typeof h!="string"||h!=="number"&&h!=="string")throw new TypeError('hint must be "string" or "number"');var y=h==="string"?["toString","valueOf"]:["valueOf","toString"],v,l,p;for(p=0;p<y.length;++p)if(v=u[y[p]],r(v)&&(l=v.call(u),t(l)))return l;throw new TypeError("No default value")},a=function(u,h){var y=u[h];if(y!==null&&typeof y<"u"){if(!r(y))throw new TypeError(y+" returned for property "+String(h)+" of object "+u+" is not a function");return y}};return Jn=function(u){if(t(u))return u;var h="default";arguments.length>1&&(arguments[1]===String?h="string":arguments[1]===Number&&(h="number"));var y;if(e&&(Symbol.toPrimitive?y=a(u,Symbol.toPrimitive):o(u)&&(y=Symbol.prototype.valueOf)),typeof y<"u"){var v=y.call(u,h);if(t(v))return v;throw new TypeError("unable to convert exotic object to primitive")}return h==="default"&&(n(u)||o(u))&&(h="string"),i(u,h==="default"?"number":h)},Jn}var Yn,us;function Uc(){if(us)return Yn;us=1;var e=Py();return Yn=function(r){return arguments.length>1?e(r,arguments[1]):e(r)},Yn}var Zn,cs;function kc(){if(cs)return Zn;cs=1;var e=Z,t=e("%BigInt%",!0),r=e("%Number%"),n=U,o=Ge,i=Oy(),a=Uc();return Zn=function(u){if(!t)throw new o("BigInts are not supported in this environment");var h=a(u,r);if(h==null)throw new n("Cannot convert null or undefined to a BigInt");if(typeof h=="boolean")return t(h?1:0);if(typeof h=="number")throw new n("Cannot convert a Number value to a BigInt");if(typeof h=="string"){var y=i(h);if(typeof y>"u")throw new n("Failed to parse String to BigInt");return y}if(typeof h=="symbol")throw new n("Cannot convert a Symbol value to a BigInt");if(typeof h!="bigint")throw new o("Assertion failed: unknown primitive type");return h},Zn}var Xn,ls;function qc(){if(ls)return Xn;ls=1;var e=Z,t=e("%BigInt%",!0),r=Ku,n=U,o=t&&t(0);return Xn=function(a,c){if(typeof a!="bigint"||typeof c!="bigint")throw new n("Assertion failed: `n` and `d` arguments must be BigInts");if(c===o)throw new r("Division by zero");return a===o?o:a%c},Xn}var Qn,fs;function jc(){return fs||(fs=1,Qn=function(t,r,n){var o=t(r,n);return o>=0?o:o+n}),Qn}var eo,ps;function My(){if(ps)return eo;ps=1;var e=Z,t=e("%BigInt%",!0),r=Ot,n=kc(),o=qc(),i=jc(),a=t&&BigInt(r(2,32))*BigInt(r(2,31)),c=t&&BigInt(r(2,32))*BigInt(r(2,32));return eo=function(h){var y=n(h),v=i(o,y,c);return v>=a?v-c:v},eo}var to,ds;function Ly(){if(ds)return to;ds=1;var e=Z,t=e("%BigInt%",!0),r=Ot,n=kc(),o=qc(),i=jc(),a=t&&BigInt(r(2,32))*BigInt(r(2,32));return to=function(u){var h=n(u),y=i(o,h,a);return y},to}var ro,hs;function Ry(){if(hs)return ro;hs=1;var e=Ct;return ro=function(r,n){var o=r%n;return e(o>=0?o:o+n)},ro}var no,ys;function Ny(){return ys||(ys=1,no=Ry()),no}var oo,gs;function Dt(){if(gs)return oo;gs=1;var e=Ny();return oo=function(r,n){return e(r,n)},oo}var io,vs;function xy(){return vs||(vs=1,io=function(t){return t===null||typeof t!="function"&&typeof t!="object"}),io}var ao,ms;function Gc(){if(ms)return ao;ms=1;var e=U;return ao=function(r){if(r==null)throw new e(arguments.length>0&&arguments[1]||"Cannot call method on "+r);return r},ao}var By=Z,Dy=By("%String%"),Uy=U,Vc=function(t){if(typeof t=="symbol")throw new Uy("Cannot convert a Symbol value to a string");return Dy(t)},so,bs;function Wc(){if(bs)return so;bs=1;var e=Gc(),t=Vc,r=V,n=r("String.prototype.replace"),o=/^\s$/.test(""),i=o?/^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/:/^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/,a=o?/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+$/:/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+$/;return so=function(){var u=t(e(this));return n(n(u,i,""),a,"")},so}var uo,Ts;function zc(){if(Ts)return uo;Ts=1;var e=Wc(),t="",r="";return uo=function(){return String.prototype.trim&&t.trim()===t&&r.trim()===r&&("_"+r).trim()==="_"+r&&(r+"_").trim()===r+"_"?String.prototype.trim:e},uo}var co,Ss;function ky(){if(Ss)return co;Ss=1;var e=Zu(),t=hp,r=zc();return co=function(){var o=r();return String.prototype.trim!==o&&(e?t(String.prototype,"trim",o,!0):t(String.prototype,"trim",o)),o},co}var lo,_s;function qy(){if(_s)return lo;_s=1;var e=Ze,t=Xt,r=Gc(),n=Wc(),o=zc(),i=ky(),a=e(o()),c=function(h){return r(h),a(h)};return t(c,{getPolyfill:o,implementation:n,shim:i}),lo=c,lo}var fo,Es;function jy(){if(Es)return fo;Es=1;var e=Z,t=e("%RegExp%"),r=U,n=e("%parseInt%"),o=V,i=nn(),a=o("String.prototype.slice"),c=i(/^0b[01]+$/i),u=i(/^0o[0-7]+$/i),h=i(/^[-+]0x[0-9a-f]+$/i),y=["","",""].join(""),v=new t("["+y+"]","g"),l=i(v),p=qy();return fo=function S(w){if(typeof w!="string")throw new r("Assertion failed: `argument` is not a String");if(c(w))return+n(a(w,2),2);if(u(w))return+n(a(w,2),8);if(l(w)||h(w))return NaN;var A=p(w);return A!==w?S(A):+w},fo}var Gy=Z,ws=U,Vy=Gy("%Number%"),Wy=xy(),zy=Uc(),Hy=jy(),tt=function(t){var r=Wy(t)?t:zy(t,Vy);if(typeof r=="symbol")throw new ws("Cannot convert a Symbol value to a number");if(typeof r=="bigint")throw new ws("Conversion from 'BigInt' to 'number' is not allowed.");return typeof r=="string"?Hy(r):+r},Ky=Ct,Mi=function(t){return typeof t=="bigint"?t:Ky(t)},As=Mi,Jy=U,ht=function(t){if(typeof t!="number"&&typeof t!="bigint")throw new Jy("argument must be a Number or a BigInt");var r=t<0?-As(-t):As(t);return r===0?0:r},po,Is;function Yy(){if(Is)return po;Is=1;var e=Dt(),t=tt,r=ht,n=Ve,o=65536;return po=function(a){var c=t(a);if(!n(c)||c===0)return 0;var u=r(c),h=e(u,o);return h>=32768?h-o:h},po}var ho,$s;function Zy(){if($s)return ho;$s=1;var e=Dt(),t=tt,r=ht,n=Ve,o=2147483648,i=4294967296;return ho=function(c){var u=t(c);if(!n(u)||u===0)return 0;var h=r(u),y=e(h,i),v=y>=o?y-i:y;return v===0?0:v},ho}var yo,Cs;function Xy(){if(Cs)return yo;Cs=1;var e=Dt(),t=tt,r=ht,n=Ve;return yo=function(i){var a=t(i);if(!n(a)||a===0)return 0;var c=r(a),u=e(c,256);return u>=128?u-256:u},yo}var go,Os;function Qy(){if(Os)return go;Os=1;var e=Dt(),t=tt,r=ht,n=Ve,o=65536;return go=function(a){var c=t(a);if(!n(c)||c===0)return 0;var u=r(c),h=e(u,o);return h===0?0:h},go}var vo,Fs;function eg(){if(Fs)return vo;Fs=1;var e=Dt(),t=tt,r=ht,n=Ve,o=4294967296;return vo=function(a){var c=t(a);if(!n(c)||c===0)return 0;var u=r(c),h=e(u,o);return h===0?0:h},vo}var mo,Ps;function tg(){if(Ps)return mo;Ps=1;var e=Ve,t=Dt(),r=tt,n=ht;return mo=function(i){var a=r(i);if(!e(a)||a===0)return 0;var c=n(a),u=t(c,256);return u},mo}var bo,Ms;function rg(){if(Ms)return bo;Ms=1;var e=U,t=Qu,r=Xu;return bo=function(o,i,a){if(typeof o!="number"||typeof i!="number"||typeof a!="number"||!(i<=a))throw new e("Assertion failed: all three arguments must be MVs, and `lower` must be `<= upper`");return r(t(i,o),a)},bo}var To,Ls;function ng(){if(Ls)return To;Ls=1;var e=rg(),t=tt,r=Mi,n=$t;return To=function(i){var a=t(i);if(n(a))return 0;var c=e(a,0,255),u=r(c);return c<u+.5?u:c>u+.5?u+1:u%2===0?u:u+1},To}var So,Rs;function Hc(){return Rs||(Rs=1,So=function(t){return t===0&&1/t===-1/0}),So}var _o,Ns;function og(){if(Ns)return _o;Ns=1;var e=bi,t=Ct,r=Ot,n=Ve,o=$t,i=Hc(),a=34028234663852886e22;return _o=function(u,h){if(o(u))return h?[0,0,192,127]:[127,192,0,0];var y;if(u===0)return y=i(u)?128:0,h?[0,0,0,y]:[y,0,0,0];if(e(u)>a||!n(u))return y=u<0?255:127,h?[0,0,128,y]:[y,128,0,0];var v=u<0?1:0;u=e(u);for(var l=0;u>=2;)l+=1,u/=2;for(;u<1;)l-=1,u*=2;var p=u-1;p*=r(2,23)+.5,p=t(p),l+=127,l<<=23;var S=v<<31|l|p,w=S&255;S>>=8;var A=S&255;S>>=8;var N=S&255;S>>=8;var P=S&255;return h?[w,A,N,P]:[P,N,A,w]},_o}var Eo,xs;function ig(){if(xs)return Eo;xs=1;var e=1075,t=54;return Eo=function(n){var o="";if(n===0)return o;for(var i=e,a,c=0;c<e;c+=1)if(a=n*2,a>=1?(n=a-1,o+="1",i===e&&(i=c)):(n=a,o+="0"),a===1||c-i>t)return o;return o},Eo}var wo,Bs;function ag(){if(Bs)return wo;Bs=1;var e=Ct;return wo=function(r){for(var n="",o;r>0;)o=r/2,r=e(o),o===r?n="0"+n:n="1"+n;return n},wo}var Ao,Ds;function sg(){if(Ds)return Ao;Ds=1;var e=Z,t=e("%parseInt%"),r=bi,n=Ct,o=Hc(),i=V,a=i("String.prototype.indexOf"),c=i("String.prototype.slice"),u=ig(),h=ag(),y=1023,v="11111111111",l="00000000000",p=l+l+l+l+"0000000";return Ao=function(w,A){var N=w<0||o(w)?"1":"0",P,m;if(isNaN(w))P=v,m="1"+p;else if(!isFinite(w))P=v,m="0"+p;else if(w===0)P=l,m="0"+p;else{w=r(w);var I=n(w),$=h(I),L=u(w-I),O;if($)P=$.length-1;else{var F=a(L,"1");F>-1&&(O=F+1),P=-O}m=$+L,P<0?(P<=-y&&(O=y-1),m=c(m,O)):m=c(m,1),P=c(l+h(P+y),-11),m=c(m+p+"0",0,52)}for(var f=N+P+m,_=[],g=0;g<8;g++){var b=A?8-g-1:g;_[b]=t(c(f,g*8,(g+1)*8),2)}return _},Ao}var Io,Us;function ug(){if(Us)return Io;Us=1;var e=Z,t=e("%Number%"),r=e("%BigInt%",!0);return Io=function(o,i,a){var c=typeof o=="bigint"?r:t;o<0&&(o>>>=0);for(var u=[],h=0;h<i;h++)u[a?h:i-1-h]=t(o&c(255)),o>>=c(8);return u},Io}var $o,ks;function cg(){if(ks)return $o;ks=1;var e=U,t=Mc(),r=My(),n=Ly(),o=Yy(),i=Zy(),a=Xy(),c=Qy(),u=eg(),h=tg(),y=ng(),v=og(),l=sg(),p=ug(),S=xt,w={__proto__:null,$INT8:a,$UINT8:h,$UINT8C:y,$INT16:o,$UINT16:c,$INT32:i,$UINT32:u,$BIGINT64:r,$BIGUINT64:n};return $o=function(N,P,m){if(typeof N!="string"||!t(S.size,"$"+N))throw new e("Assertion failed: `type` must be a TypedArray element type");if(typeof P!="number"&&typeof P!="bigint")throw new e("Assertion failed: `value` must be a Number or a BigInt");if(typeof m!="boolean")throw new e("Assertion failed: `isLittleEndian` must be a Boolean");if(N==="FLOAT32")return v(P,m);if(N==="FLOAT64")return l(P,m);var I=S.size["$"+N],$=w["$"+N],L=$(P);return p(L,I,m)},$o}var Co,qs;function lg(){return qs||(qs=1,Co=function(t,r){for(var n=0;n<t.length;n+=1)r(t[n],n,t)}),Co}var fg=Z,pg=Ge,qe=U,dg=rn,hg=fg("%Uint8Array%",!0),yg=Nc(),gg=Nt,vg=cg(),mg=Rt,bg=tr,Tg=ft,Oo=xt,Sg=xc(),_g=lg(),Eg=function(t,r,n,o,i,a){var c=bg(t);if(!mg(t)&&!c)throw new qe("Assertion failed: `arrayBuffer` must be an ArrayBuffer or a SharedArrayBuffer");if(!dg(r)||r<0)throw new qe("Assertion failed: `byteIndex` must be a non-negative integer");if(typeof n!="string"||!Tg(Oo.size,"$"+n))throw new qe("Assertion failed: `type` must be one of "+Oo.choices);if(typeof o!="number"&&typeof o!="bigint")throw new qe("Assertion failed: `value` must be a Number or a BigInt");if(typeof i!="boolean")throw new qe("Assertion failed: `isTypedArray` must be a boolean");if(a!=="SEQ-CST"&&a!=="UNORDERED"&&a!=="INIT")throw new qe('Assertion failed: `order` must be `"SEQ-CST"`, `"UNORDERED"`, or `"INIT"`');if(arguments.length>6&&typeof arguments[6]!="boolean")throw new qe("Assertion failed: `isLittleEndian` must be a boolean, if present");if(gg(t))throw new qe("Assertion failed: ArrayBuffer is detached");if(yg(n)?typeof o!="bigint":typeof o!="number")throw new qe("Assertion failed: `value` must be a BigInt if type is ~BIGINT64~ or ~BIGUINT64~, otherwise a Number");var u=Oo.size["$"+n],h=arguments.length>6?arguments[6]:Sg==="little",y=vg(n,o,h);if(c)throw new pg("SharedArrayBuffer is not supported by this implementation");var v=new hg(t,r,u);_g(y,function(l,p){v[p]=l})},wg=tt,Ag=ht,Ig=$t,$g=Ve,Cg=function(t){var r=wg(t);return Ig(r)||r===0?0:$g(r)?Ag(r):r},Og=Ge,Fg=U,Pg=rn,Mg=Lt,js=xt,Li=function(t){var r=Mg(t);if(!r)throw new Fg("Assertion failed: `O` must be a TypedArray");var n=js.size["$"+js.name["$"+r]];if(!Pg(n)||n<0)throw new Og("Assertion failed: Unknown TypedArray type `"+r+"`");return n},Lg=Ge,Rg=U,Ng=Lt,xg=xt,Bg=function(t){var r=Ng(t);if(!r)throw new Rg("Assertion failed: `O` must be a TypedArray");var n=xg.name["$"+r];if(typeof n!="string")throw new Lg("Assertion failed: Unknown TypedArray type `"+r+"`");return n},ci={exports:{}},Dg=Z,Fo,Gs;function Ri(){if(Gs)return Fo;Gs=1;var e=U,t=ft,r={__proto__:null,"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};return Fo=function(o){if(!o||typeof o!="object")return!1;for(var i in o)if(t(o,i)&&!r[i])return!1;var a=t(o,"[[Value]]")||t(o,"[[Writable]]"),c=t(o,"[[Get]]")||t(o,"[[Set]]");if(a&&c)throw new e("Property Descriptors may not be both accessor and data descriptors");return!0},Fo}var Po,Vs;function Ug(){if(Vs)return Po;Vs=1;var e=Zu,t=yp,r=e.hasArrayLengthDefineBug(),n=r&&Rc,o=V,i=o("Object.prototype.propertyIsEnumerable");return Po=function(c,u,h,y,v,l){if(!t){if(!c(l)||!l["[[Configurable]]"]||!l["[[Writable]]"]||v in y&&i(y,v)!==!!l["[[Enumerable]]"])return!1;var p=l["[[Value]]"];return y[v]=p,u(y[v],p)}return r&&v==="length"&&"[[Value]]"in l&&n(y)&&y.length!==l["[[Value]]"]?(y.length=l["[[Value]]"],y.length===l["[[Value]]"]):(t(y,v,h(l)),!0)},Po}var Mo,Ws;function kg(){return Ws||(Ws=1,Mo=function(t){if(typeof t>"u")return t;var r={};return"[[Value]]"in t&&(r.value=t["[[Value]]"]),"[[Writable]]"in t&&(r.writable=!!t["[[Writable]]"]),"[[Get]]"in t&&(r.get=t["[[Get]]"]),"[[Set]]"in t&&(r.set=t["[[Set]]"]),"[[Enumerable]]"in t&&(r.enumerable=!!t["[[Enumerable]]"]),"[[Configurable]]"in t&&(r.configurable=!!t["[[Configurable]]"]),r}),Mo}var Lo,zs;function qg(){if(zs)return Lo;zs=1;var e=U,t=Ri(),r=kg();return Lo=function(o){if(typeof o<"u"&&!t(o))throw new e("Assertion failed: `Desc` must be a Property Descriptor");return r(o)},Lo}var Ro,Hs;function jg(){if(Hs)return Ro;Hs=1;var e=U,t=ft,r=Ri();return Ro=function(o){if(typeof o>"u")return!1;if(!r(o))throw new e("Assertion failed: `Desc` must be a Property Descriptor");return!(!t(o,"[[Value]]")&&!t(o,"[[Writable]]"))},Ro}var Kc=en,No,Ks;function Gg(){return Ks||(Ks=1,No=function(t){return!!t}),No}var xo,Js;function Vg(){if(Js)return xo;Js=1;var e=ft,t=U,r=et,n=Kc,o=Gg();return xo=function(a){if(!r(a))throw new t("ToPropertyDescriptor requires an object");var c={};if(e(a,"enumerable")&&(c["[[Enumerable]]"]=o(a.enumerable)),e(a,"configurable")&&(c["[[Configurable]]"]=o(a.configurable)),e(a,"value")&&(c["[[Value]]"]=a.value),e(a,"writable")&&(c["[[Writable]]"]=o(a.writable)),e(a,"get")){var u=a.get;if(typeof u<"u"&&!n(u))throw new t("getter must be a function");c["[[Get]]"]=u}if(e(a,"set")){var h=a.set;if(typeof h<"u"&&!n(h))throw new t("setter must be a function");c["[[Set]]"]=h}if((e(c,"[[Get]]")||e(c,"[[Set]]"))&&(e(c,"[[Value]]")||e(c,"[[Writable]]")))throw new t("Invalid property descriptor. Cannot both specify accessors and a value or writable attribute");return c},xo}var Bo,Ys;function Wg(){if(Ys)return Bo;Ys=1;var e=U,t=et,r=Ri(),n=Ug(),o=qg(),i=jg(),a=tn,c=Bc,u=Vg();return Bo=function(y,v,l){if(!t(y))throw new e("Assertion failed: Type(O) is not Object");if(!a(v))throw new e("Assertion failed: P is not a Property Key");var p=r(l)?l:u(l);if(!r(p))throw new e("Assertion failed: Desc is not a valid Property Descriptor");return n(i,c,o,y,v,p)},Bo}var zg=Dg,Zs=zg("%Reflect.construct%",!0),Nr=Wg();try{Nr({},"",{"[[Get]]":function(){}})}catch{Nr=null}if(Nr&&Zs){var Xs={},Qs={};Nr(Qs,"length",{"[[Get]]":function(){throw Xs},"[[Enumerable]]":!0}),ci.exports=function(t){try{Zs(t,Qs)}catch(r){return r===Xs}}}else ci.exports=function(t){return typeof t=="function"&&!!t.prototype};var Jc=ci.exports,Hg=Z,eu=Hg("%Symbol.species%",!0),Do=U,tu=et,Kg=Jc,Jg=function(t,r){if(!tu(t))throw new Do("Assertion failed: Type(O) is not Object");var n=t.constructor;if(typeof n>"u")return r;if(!tu(n))throw new Do("O.constructor is not an Object");var o=eu?n[eu]:void 0;if(o==null)return r;if(Kg(o))return o;throw new Do("no constructor found")},Yg=U,Yc=V,ru=Yc("%ArrayBuffer.prototype.resizable%",!0),nu=Yc("%SharedArrayBuffer.prototype.growable%",!0),Zg=Rt,Xg=tr,Zc=function(t){var r=Zg(t),n=Xg(t);if(!r&&!n)throw new Yg("Assertion failed: `arrayBuffer` must be an ArrayBuffer or SharedArrayBuffer");return r&&ru?!ru(t):n&&nu?!nu(t):!0},Qg=rn,ou=ft,ev=Bt,tv=Qg,Xc=function(t){return!!t&&typeof t=="object"&&ou(t,"[[Object]]")&&ou(t,"[[CachedBufferByteLength]]")&&(tv(t["[[CachedBufferByteLength]]"])&&t["[[CachedBufferByteLength]]"]>=0||t["[[CachedBufferByteLength]]"]==="DETACHED")&&ev(t["[[Object]]"])},rv=et,Qc=V,nv=Qc("String.prototype.valueOf"),ov=function(t){try{return nv(t),!0}catch{return!1}},iv=Qc("Object.prototype.toString"),av="[object String]",sv=lt(),uv=function(t){return typeof t=="string"?!0:!t||typeof t!="object"?!1:sv?ov(t):iv(t)===av},el=V,cv=el("Number.prototype.toString"),lv=function(t){try{return cv(t),!0}catch{return!1}},fv=el("Object.prototype.toString"),pv="[object Number]",dv=lt(),hv=function(t){return typeof t=="number"?!0:!t||typeof t!="object"?!1:dv?lv(t):fv(t)===pv},tl=V,yv=tl("Boolean.prototype.toString"),gv=tl("Object.prototype.toString"),vv=function(t){try{return yv(t),!0}catch{return!1}},mv="[object Boolean]",bv=lt(),Tv=function(t){return typeof t=="boolean"?!0:t===null||typeof t!="object"?!1:bv?vv(t):gv(t)===mv},li={exports:{}},iu=typeof BigInt<"u"&&BigInt,Sv=function(){return typeof iu=="function"&&typeof BigInt=="function"&&typeof iu(42)=="bigint"&&typeof BigInt(42)=="bigint"},_v=Sv();if(_v){var Ev=BigInt.prototype.valueOf,wv=function(t){try{return Ev.call(t),!0}catch{}return!1};li.exports=function(t){return t===null||typeof t>"u"||typeof t=="boolean"||typeof t=="string"||typeof t=="number"||typeof t=="symbol"||typeof t=="function"?!1:typeof t=="bigint"?!0:wv(t)}}else li.exports=function(t){return!1};var Av=li.exports,Iv=uv,$v=hv,Cv=Tv,Ov=Dc(),Fv=Av,Pv=function(t){if(t==null||typeof t!="object"&&typeof t!="function")return null;if(Iv(t))return"String";if($v(t))return"Number";if(Cv(t))return"Boolean";if(Ov(t))return"Symbol";if(Fv(t))return"BigInt"},Ni=typeof Map=="function"&&Map.prototype?Map:null,Mv=typeof Set=="function"&&Set.prototype?Set:null,xr;Ni||(xr=function(t){return!1});var rl=Ni?Map.prototype.has:null,au=Mv?Set.prototype.has:null;!xr&&!rl&&(xr=function(t){return!1});var Lv=xr||function(t){if(!t||typeof t!="object")return!1;try{if(rl.call(t),au)try{au.call(t)}catch{return!0}return t instanceof Ni}catch{}return!1},Rv=typeof Map=="function"&&Map.prototype?Map:null,xi=typeof Set=="function"&&Set.prototype?Set:null,Br;xi||(Br=function(t){return!1});var su=Rv?Map.prototype.has:null,nl=xi?Set.prototype.has:null;!Br&&!nl&&(Br=function(t){return!1});var Nv=Br||function(t){if(!t||typeof t!="object")return!1;try{if(nl.call(t),su)try{su.call(t)}catch{return!0}return t instanceof xi}catch{}return!1},Dr=typeof WeakMap=="function"&&WeakMap.prototype?WeakMap:null,uu=typeof WeakSet=="function"&&WeakSet.prototype?WeakSet:null,Ur;Dr||(Ur=function(t){return!1});var fi=Dr?Dr.prototype.has:null,Uo=uu?uu.prototype.has:null;!Ur&&!fi&&(Ur=function(t){return!1});var xv=Ur||function(t){if(!t||typeof t!="object")return!1;try{if(fi.call(t,fi),Uo)try{Uo.call(t,Uo)}catch{return!0}return t instanceof Dr}catch{}return!1},pi={exports:{}},Bv=Z,ol=V,Dv=Bv("%WeakSet%",!0),ko=ol("WeakSet.prototype.has",!0);if(ko){var qo=ol("WeakMap.prototype.has",!0);pi.exports=function(t){if(!t||typeof t!="object")return!1;try{if(ko(t,ko),qo)try{qo(t,qo)}catch{return!0}return t instanceof Dv}catch{}return!1}}else pi.exports=function(t){return!1};var Uv=pi.exports,kv=Lv,qv=Nv,jv=xv,Gv=Uv,Vv=function(t){if(t&&typeof t=="object"){if(kv(t))return"Map";if(qv(t))return"Set";if(jv(t))return"WeakMap";if(Gv(t))return"WeakSet"}return!1},Wv={}.toString,zv=Array.isArray||function(e){return Wv.call(e)=="[object Array]"},Hv=V,Kv=Hv("WeakRef.prototype.deref",!0),Jv=typeof WeakRef>"u"?function(t){return!1}:function(t){if(!t||typeof t!="object")return!1;try{return Kv(t),!0}catch{return!1}},Yv=V,cu=Yv("FinalizationRegistry.prototype.register",!0),Zv=cu?function(t){if(!t||typeof t!="object")return!1;try{return cu(t,{},null),!0}catch{return!1}}:function(t){return!1},il=en,Xv=ft,Qv=ec(),Bi=V,al=Bi("Function.prototype.toString"),sl=Bi("String.prototype.match"),jo=Bi("Object.prototype.toString"),em=/^class /,tm=function(t){if(il(t)||typeof t!="function")return!1;try{var r=sl(al(t),em);return!!r}catch{}return!1},rm=/\s*function\s+([^(\s]*)\s*/,nm=!(0 in[,]),om="[object Object]",im="[object HTMLAllCollection]",am=Function.prototype,ul=function(){return!1};if(typeof document=="object"){var sm=document.all;jo(sm)===jo(document.all)&&(ul=function(t){if((nm||!t)&&(typeof t>"u"||typeof t=="object"))try{var r=jo(t);return(r===im||r===om)&&t("")==null}catch{}return!1})}var cl=function(){if(ul(this)||!tm(this)&&!il(this))throw new TypeError("Function.prototype.name sham getter called on non-function");if(Qv&&Xv(this,"name"))return this.name;if(this===am)return"";var t=al(this),r=sl(t,rm),n=r&&r[1];return n},um=cl,ll=function(){return um},cm=Xt.supportsDescriptors,lm=ec(),fm=ll,lu=Object.defineProperty,pm=TypeError,dm=function(){var t=fm();if(lm)return t;if(!cm)throw new pm("Shimming Function.prototype.name support requires ES5 property descriptor support.");var r=Function.prototype;return lu(r,"name",{configurable:!0,enumerable:!1,get:function(){var n=t.call(this);return this!==r&&lu(this,"name",{configurable:!0,enumerable:!1,value:n,writable:!1}),n}}),t},hm=Xt,ym=Ze,fl=cl,gm=ll,vm=dm,pl=ym(fl);hm(pl,{getPolyfill:gm,implementation:fl,shim:vm});var mm=pl,Go,fu;function bm(){if(fu)return Go;fu=1;const e=(function*(){}).constructor;return Go=()=>e,Go}var dl=V,Tm=nn(),Sm=Tm(/^\s*(?:function)?\*/),_m=lt(),pu=It,Em=dl("Object.prototype.toString"),wm=dl("Function.prototype.toString"),Am=bm(),Im=function(t){if(typeof t!="function")return!1;if(Sm(wm(t)))return!0;if(!_m){var r=Em(t);return r==="[object GeneratorFunction]"}if(!pu)return!1;var n=Am();return n&&pu(t)===n.prototype},Vo,du;function $m(){if(du)return Vo;du=1;const e=(async function(){}).constructor;return Vo=()=>e,Vo}var hl=V,Cm=nn(),Om=hl("Object.prototype.toString"),Fm=hl("Function.prototype.toString"),Pm=Cm(/^\s*async(?:\s+function(?:\s+|\()|\s*\()/),Mm=lt(),hu=It,Lm=$m(),Rm=function(t){if(typeof t!="function")return!1;if(Pm(Fm(t)))return!0;if(!Mm){var r=Om(t);return r==="[object AsyncFunction]"}if(!hu)return!1;var n=Lm();return n&&n.prototype===hu(t)},Nm=Pv,xm=Vv,Bm=Lt,Dm=zv,Um=Yu,km=Ju,qm=Jv,jm=Zv,Gm=mm,Vm=Im,Wm=Rm,zm=V,Hm=lt(),Wo=Hm&&Symbol.toStringTag,Km=Object,yu=zm("Promise.prototype.then",!0),Jm=function(t){if(!t||typeof t!="object"||!yu)return!1;try{return yu(t,null,function(){}),!0}catch{}return!1},gu=function(t){return!!t&&t!=="BigInt"&&t!=="Boolean"&&t!=="Null"&&t!=="Number"&&t!=="String"&&t!=="Symbol"&&t!=="Undefined"&&t!=="Math"&&t!=="JSON"&&t!=="Reflect"&&t!=="Atomics"&&t!=="Map"&&t!=="Set"&&t!=="WeakMap"&&t!=="WeakSet"&&t!=="BigInt64Array"&&t!=="BigUint64Array"&&t!=="Float32Array"&&t!=="Float64Array"&&t!=="Int16Array"&&t!=="Int32Array"&&t!=="Int8Array"&&t!=="Uint16Array"&&t!=="Uint32Array"&&t!=="Uint8Array"&&t!=="Uint8ClampedArray"&&t!=="Array"&&t!=="Date"&&t!=="FinalizationRegistry"&&t!=="Promise"&&t!=="RegExp"&&t!=="WeakRef"&&t!=="Function"&&t!=="GeneratorFunction"&&t!=="AsyncFunction"},Ym=function(t){if(t==null)return t;var r=Nm(Km(t))||xm(t)||Bm(t);if(r)return r;if(Dm(t))return"Array";if(Um(t))return"Date";if(km(t))return"RegExp";if(qm(t))return"WeakRef";if(jm(t))return"FinalizationRegistry";if(typeof t=="function")return Vm(t)?"GeneratorFunction":Wm(t)?"AsyncFunction":"Function";if(Jm(t))return"Promise";if(Wo&&Wo in t){var n=t[Wo];if(gu(n))return n}if(typeof t.constructor=="function"){var o=Gm(t.constructor);if(gu(o))return o}return"Object"},Zm=Z,Xm=Kc,Qm=rv,eb=Ym,tb=U,vu=It,rb=gp,nb=function(t){if(!Qm(t))throw new tb("Reflect.getPrototypeOf called on non-object");if(vu)return vu(t);var r=eb(t);if(r){var n=Zm("%"+r+".prototype%",!0);if(n)return n}return Xm(t.constructor)?t.constructor.prototype:t instanceof Object?rb.prototype:null},ob=nb,mu=It,yl=function(){return typeof Reflect=="object"&&Reflect&&Reflect.getPrototypeOf?Reflect.getPrototypeOf:mu?function(r){return mu(r)}:ob},gl=Ai,ib=Ze,ab=yl(),sb=er(),di={__proto__:null},gr=Wr,bu=Object.defineProperty;if(gr){var ub=function(e){return e.byteOffset};gl(sb,function(e){if(typeof window[e]=="function"||typeof window[e]=="object"){var t=window[e].prototype,r=gr(t,"byteOffset");if(!r){var n=ab(t);r=gr(n,"byteOffset")}if(r&&r.get)di[e]=ib(r.get);else if(bu){var o=new window[e](2);r=gr(o,"byteOffset"),r&&r.configurable&&bu(o,"length",{value:3}),o.length===2&&(di[e]=ub)}}})}var cb=function(t){var r;return gl(di,function(n){if(typeof r!="number")try{var o=n(t);typeof o=="number"&&(r=o)}catch{}}),r},lb=Bt,Di=function(t){return lb(t)?cb(t):!1},fb=Ze,vl=Ai,vr=Wr,pb=Bt,db=Sc,hb=yl(),hi={__proto__:null},Tu=Object.defineProperty;if(vr){var yb=function(e){return e.length};vl(db,function(e){var t=window[e];if(typeof t=="function"||typeof t=="object"){var r=t.prototype,n=vr(r,"length");if(!n){var o=hb(r);n=vr(o,"length")}if(n&&n.get)hi["$"+e]=fb(n.get);else if(Tu){var i=new window[e](2);n=vr(i,"length"),n&&n.configurable&&Tu(i,"length",{value:3}),i.length===2&&(hi["$"+e]=yb)}}})}var gb=function(t){var r;return vl(hi,function(n){if(typeof r!="number")try{var o=n(t);typeof o=="number"&&(r=o)}catch{}}),r},ml=function(t){return pb(t)?gb(t):!1},Su=U,vb=Nt,mb=Zc,bb=Li,Tb=Xc,_u=rr,Sb=Di,_b=ml,Ui=function(t){if(!Tb(t))throw new Su("Assertion failed: `taRecord` must be a TypedArray With Buffer Witness Record");var r=t["[[Object]]"],n=t["[[CachedBufferByteLength]]"];if(vb(_u(r))&&n!=="DETACHED")throw new Su("Assertion failed: typed array is detached only if the byte length is ~DETACHED~");if(n==="DETACHED")return!0;var o=Sb(r),i=mb(_u(r)),a,c=i?_b(r):"AUTO";if(c==="AUTO")a=n;else{var u=bb(r);a=o+c*u}return o>n||a>n},mr=U,Eb=Mi,wb=Zc,Ab=Ui,Ib=Li,$b=Xc,Cb=rr,Ob=Di,Fb=ml,Pb=function(t){if(!$b(t))throw new mr("Assertion failed: `taRecord` must be a TypedArray With Buffer Witness Record");if(Ab(t))throw new mr("Assertion failed: `taRecord` is out of bounds");var r=t["[[Object]]"],n=wb(Cb(r)),o=n?Fb(r):"AUTO";if(o!=="AUTO")return o;if(n)throw new mr("Assertion failed: array buffer is not fixed length");var i=Ob(r),a=Ib(r),c=t["[[CachedBufferByteLength]]"];if(c==="DETACHED")throw new mr("Assertion failed: typed array is detached");return Eb((c-i)/a)},zo=U,Mb=Nt,Lb=Rt,Rb=tr,Nb=Pc,xb=V,Bb=xb("SharedArrayBuffer.prototype.byteLength",!0),Db=function(t,r){var n=Rb(t);if(!Lb(t)&&!n)throw new zo("Assertion failed: `arrayBuffer` must be an ArrayBuffer or a SharedArrayBuffer");if(r!=="SEQ-CST"&&r!=="UNORDERED")throw new zo("Assertion failed: `order` must be ~SEQ-CST~ or ~UNORDERED~");if(Mb(t))throw new zo("Assertion failed: `arrayBuffer` must not be detached");return n?Bb(t):Nb(t)},Eu=U,Ub=Db,kb=Nt,qb=Bt,jb=rr,Gb=function(t,r){if(!qb(t))throw new Eu("Assertion failed: `obj` must be a Typed Array");if(r!=="SEQ-CST"&&r!=="UNORDERED")throw new Eu("Assertion failed: `order` must be ~SEQ-CST~ or ~UNORDERED~");var n=jb(t),o=kb(n)?"DETACHED":Ub(n,r);return{"[[Object]]":t,"[[CachedBufferByteLength]]":o}},br=U,Vb=et,Wb=Ui,zb=Gb,Hb=Bt,bl=function(t,r){if(r!=="SEQ-CST"&&r!=="UNORDERED")throw new br("Assertion failed: `order` must be ~SEQ-CST~ or ~UNORDERED~");if(!Vb(t))throw new br("Assertion failed: `O` must be an Object");if(!Hb(t))throw new br("Assertion failed: `O` must be a Typed Array");var n=zb(t,r);if(Wb(n))throw new br("`O` must be in-bounds and backed by a non-detached buffer");return n},Kb=Ge,Tr=U,Jb=Pi,Yb=Jc,Zb=Ui,Xb=Pb,Qb=bl,e0=er(),t0=function(t,r){if(!Yb(t))throw new Tr("Assertion failed: `constructor` must be a constructor");if(!Jb(r))throw new Tr("Assertion failed: `argumentList` must be a List");if(e0.length===0)throw new Kb("Assertion failed: Typed Arrays are not supported in this environment");var n;r.length===0?n=new t:r.length===1?n=new t(r[0]):r.length===2?n=new t(r[0],r[1]):n=new t(r[0],r[1],r[2]);var o=Qb(n,"SEQ-CST");if(r.length===1&&typeof r[0]=="number"){if(Zb(o))throw new Tr("new Typed Array is out of bounds");var i=Xb(o);if(i<r[0])throw new Tr("`argumentList[0]` must be <= `newTypedArray.length`")}return n},Te=Z,r0={__proto__:null,$Int8Array:Te("%Int8Array%",!0),$Uint8Array:Te("%Uint8Array%",!0),$Uint8ClampedArray:Te("%Uint8ClampedArray%",!0),$Int16Array:Te("%Int16Array%",!0),$Uint16Array:Te("%Uint16Array%",!0),$Int32Array:Te("%Int32Array%",!0),$Uint32Array:Te("%Uint32Array%",!0),$BigInt64Array:Te("%BigInt64Array%",!0),$BigUint64Array:Te("%BigUint64Array%",!0),$Float16Array:Te("%Float16Array%",!0),$Float32Array:Te("%Float32Array%",!0),$Float64Array:Te("%Float64Array%",!0)},n0=function(t){return r0["$"+t]},wu=Ge,Au=U,o0=Lt,i0=er(),a0=Pi,s0=Jg,u0=t0,c0=n0,l0=function(t,r){if(i0.length===0)throw new wu("Assertion failed: Typed Arrays are not supported in this environment");var n=o0(t);if(!n)throw new Au("Assertion failed: exemplar must be a TypedArray");if(!a0(r))throw new Au("Assertion failed: `argumentList` must be a List");var o=c0(n);if(typeof o!="function")throw new wu("Assertion failed: `constructor` of `exemplar` ("+n+") must exist. Please report this!");var i=s0(t,o);return u0(i,r)},f0=U,p0=Rh,d0=Ay,h0=Nt,Ho=Qu,Iu=Xu,y0=Cy,g0=Eg,$u=Cg,Cu=Vc,v0=Li,Ou=Bg,m0=l0,b0=bl,Ko=rr,Fu=Di,Tl=function(t,r){var n=this;b0(n,"SEQ-CST");var o=n.length,i=$u(t),a;i===-1/0?a=0:i<0?a=Ho(o+i,0):a=Iu(i,o);var c=typeof r>"u"?o:$u(r),u;c===-1/0?u=0:c<0?u=Ho(o+c,0):u=Iu(c,o);var h=Ho(u-a,0),y=m0(n,[h]);if(h>0){if(h0(Ko(n)))throw new f0("Cannot use a Typed Array with an underlying ArrayBuffer that is detached");var v=Ou(n),l=Ou(y);if(v===l)for(var p=Ko(n),S=Ko(y),w=v0(n),A=Fu(n),N=a*w+A,P=Fu(y),m=P+h*w;P<m;){var I=d0(p,N,"UINT8",!0,"UNORDERED");g0(S,P,"UINT8",I,!0,"UNORDERED"),N+=1,P+=1}else for(var $=0;a<u;){var L=Cu(a),O=p0(n,L);y0(y,Cu($),O,!0),a+=1,$+=1}}return y},T0=Tl,Sl=function(){return typeof Uint8Array=="function"&&Uint8Array.prototype.slice||T0},S0=Xt,_0=It,E0=Sl,w0=function(){if(typeof Uint8Array=="function"){var t=E0(),r=_0(Uint8Array.prototype);S0(r,{slice:t},{slice:function(){return r.slice!==t}})}return t},A0=Xt,I0=Ze,$0=Tl,_l=Sl,C0=w0,El=I0(_l());A0(El,{getPolyfill:_l,implementation:$0,shim:C0});var O0=El,wl=Lt,Al=O0,Pu=Wr;function Ut(e){return Object.prototype.toString.call(e)}function F0(e){return Ut(e)==="[object Date]"}function P0(e){return Ut(e)==="[object RegExp]"}function M0(e){return Ut(e)==="[object Error]"}function L0(e){return Ut(e)==="[object Boolean]"}function R0(e){return Ut(e)==="[object Number]"}function N0(e){return Ut(e)==="[object String]"}var Il=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};function on(e,t){if(e.forEach)return e.forEach(t);for(var r=0;r<e.length;r++)t(e[r],r,e)}var an=Object.keys||function(t){var r=[];for(var n in t)r[r.length]=n;return r},x0=Object.prototype.propertyIsEnumerable,Mu=Object.getOwnPropertySymbols;function sn(e){var t=an(e);if(Mu)for(var r=Mu(e),n=0;n<r.length;n++)x0.call(e,r[n])&&(t[t.length]=r[n]);return t}var un=Object.prototype.hasOwnProperty||function(e,t){return t in e};function B0(e,t){if(typeof Pu!="function")return!0;var r=Pu(e,t);return!r||!r.writable}function $l(e,t){if(typeof e=="object"&&e!==null){var r;if(Il(e))r=[];else if(F0(e))r=new Date(e.getTime?e.getTime():e);else if(P0(e))r=new RegExp(e);else if(M0(e))r={message:e.message};else if(L0(e)||R0(e)||N0(e))r=Object(e);else{var n=wl(e);if(n)return Al(e);if(Object.create&&Object.getPrototypeOf)r=Object.create(Object.getPrototypeOf(e));else if(e.constructor===Object)r={};else{var o=e.constructor&&e.constructor.prototype||e.__proto__||{},i=function(){};i.prototype=o,r=new i}}var a=t.includeSymbols?sn:an;return on(a(e),function(c){r[c]=e[c]}),r}return e}var ki={__proto__:null};function Cl(e,t){var r=[],n=[],o=!0,i=arguments.length>2?arguments[2]:ki,a=i.includeSymbols?sn:an,c=!!i.immutable;return function u(h){var y=c?$l(h,i):h,v={__proto__:null},l=!0,p={node:y,node_:h,path:[].concat(r),parent:n[n.length-1],parents:n,key:r[r.length-1],removedKeys:{__proto__:null},isRoot:r.length===0,level:r.length,circular:null,update:function(A,N){p.isRoot||(p.parent.node[p.key]=A),p.node=A,N&&(l=!1)},delete:function(A){delete p.parent.node[p.key],p.parent.removedKeys[p.key]=!0,A&&(l=!1)},remove:function(A){Il(p.parent.node)?(p.parent.node.splice(p.key,1),p.parent.removedKeys[p.key]=!0,A&&(l=!1)):p.delete(A)},keys:null,before:function(A){v.before=A},after:function(A){v.after=A},pre:function(A){v.pre=A},post:function(A){v.post=A},stop:function(){o=!1},block:function(){l=!1}};if(!o)return p;function S(){if(typeof p.node=="object"&&p.node!==null){(!p.keys||p.node_!==p.node)&&(p.keys=a(p.node)),p.isLeaf=p.keys.length===0;for(var A=0;A<n.length;A++)if(n[A].node_===h){p.circular=n[A];break}}else p.isLeaf=!0,p.keys=null;p.notLeaf=!p.isLeaf,p.notRoot=!p.isRoot}S();var w=t.call(p,p.node);return w!==void 0&&p.update&&p.update(w),v.before&&v.before.call(p,p.node),l&&(typeof p.node=="object"&&p.node!==null&&!p.circular&&(n[n.length]=p,S(),on(p.keys,function(A,N){var P=N-1 in p.removedKeys;P&&(A=p.keys[N-1]),r[r.length]=A,v.pre&&v.pre.call(p,p.node[A],A);var m=u(p.node[A]);c&&un.call(p.node,A)&&!B0(p.node,A)&&!P&&(p.node[A]=m.node),m.isLast=N===p.keys.length-1,m.isFirst=N===0,v.post&&v.post.call(p,m),r.pop()}),n.pop()),v.after&&v.after.call(p,p.node)),p}(e).node}function Se(e){this.options=arguments.length>1?arguments[1]:ki,this.value=e}Se.prototype.get=function(e){for(var t=this.value,r=0;t&&r<e.length;r++){var n=e[r];if(!un.call(t,n)||!this.options.includeSymbols&&typeof n=="symbol")return;t=t[n]}return t};Se.prototype.has=function(e){var t=this.value;if(!t&&e.length>0)return!1;for(var r=0;t&&r<e.length;r++){var n=e[r];if(!un.call(t,n)||!this.options.includeSymbols&&typeof n=="symbol")return!1;t=t[n]}return!0};Se.prototype.set=function(e,t){for(var r=this.value,n=0;n<e.length-1;n++){var o=e[n];un.call(r,o)||(r[o]={}),r=r[o]}return r[e[n]]=t,t};Se.prototype.map=function(e){return Cl(this.value,e,{__proto__:null,immutable:!0,includeSymbols:!!this.options.includeSymbols})};Se.prototype.forEach=function(e){return this.value=Cl(this.value,e,this.options),this.value};Se.prototype.reduce=function(e,t){var r=arguments.length===1,n=r?this.value:t;return this.forEach(function(o){(!this.isRoot||!r)&&(n=e.call(this,n,o))}),n};Se.prototype.paths=function(){var e=[];return this.forEach(function(){e[e.length]=this.path}),e};Se.prototype.nodes=function(){var e=[];return this.forEach(function(){e[e.length]=this.node}),e};Se.prototype.clone=function(){var e=[],t=[],r=this.options;return wl(this.value)?Al(this.value):function n(o){for(var i=0;i<e.length;i++)if(e[i]===o)return t[i];if(typeof o=="object"&&o!==null){var a=$l(o,r);e[e.length]=o,t[t.length]=a;var c=r.includeSymbols?sn:an;return on(c(o),function(u){a[u]=n(o[u])}),e.pop(),t.pop(),a}return o}(this.value)};function Ol(e){var t=arguments.length>1?arguments[1]:ki;return new Se(e,t)}on(sn(Se.prototype),function(e){Ol[e]=function(t){var r=[].slice.call(arguments,1),n=new Se(t);return n[e].apply(n,r)}});var D0=Ol,U0=he;function he(e){if(!(this instanceof he))return new he(e);this._bbox=e||[1/0,1/0,-1/0,-1/0],this._valid=!!e}he.prototype.include=function(e){return this._valid=!0,this._bbox[0]=Math.min(this._bbox[0],e[0]),this._bbox[1]=Math.min(this._bbox[1],e[1]),this._bbox[2]=Math.max(this._bbox[2],e[0]),this._bbox[3]=Math.max(this._bbox[3],e[1]),this};he.prototype.equals=function(e){var t;return e instanceof he?t=e.bbox():t=e,this._bbox[0]==t[0]&&this._bbox[1]==t[1]&&this._bbox[2]==t[2]&&this._bbox[3]==t[3]};he.prototype.center=function(e){return this._valid?[(this._bbox[0]+this._bbox[2])/2,(this._bbox[1]+this._bbox[3])/2]:null};he.prototype.union=function(e){this._valid=!0;var t;return e instanceof he?t=e.bbox():t=e,this._bbox[0]=Math.min(this._bbox[0],t[0]),this._bbox[1]=Math.min(this._bbox[1],t[1]),this._bbox[2]=Math.max(this._bbox[2],t[2]),this._bbox[3]=Math.max(this._bbox[3],t[3]),this};he.prototype.bbox=function(){return this._valid?this._bbox:null};he.prototype.contains=function(e){if(!e)return this._fastContains();if(!this._valid)return null;var t=e[0],r=e[1];return this._bbox[0]<=t&&this._bbox[1]<=r&&this._bbox[2]>=t&&this._bbox[3]>=r};he.prototype.intersect=function(e){if(!this._valid)return null;var t;return e instanceof he?t=e.bbox():t=e,!(this._bbox[0]>t[2]||this._bbox[2]<t[0]||this._bbox[3]<t[1]||this._bbox[1]>t[3])};he.prototype._fastContains=function(){if(!this._valid)return new Function("return null;");var e="return "+this._bbox[0]+"<= ll[0] &&"+this._bbox[1]+"<= ll[1] &&"+this._bbox[2]+">= ll[0] &&"+this._bbox[3]+">= ll[1]";return new Function("ll",e)};he.prototype.polygon=function(){return this._valid?{type:"Polygon",coordinates:[[[this._bbox[0],this._bbox[1]],[this._bbox[2],this._bbox[1]],[this._bbox[2],this._bbox[3]],[this._bbox[0],this._bbox[3]],[this._bbox[0],this._bbox[1]]]]}:null};var k0=Pd,q0=D0,j0=U0,Fl={features:["FeatureCollection"],coordinates:["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],geometry:["Feature"],geometries:["GeometryCollection"]},G0=Object.keys(Fl);Qr.exports=function(e){return qi(e).bbox()};Qr.exports.polygon=function(e){return qi(e).polygon()};Qr.exports.bboxify=function(e){return q0(e).map(function(t){if(t){var r=G0.some(function(n){return t[n]?Fl[n].indexOf(t.type)!==-1:!1});r&&(t.bbox=qi(t).bbox(),this.update(t))}})};function qi(e){for(var t=j0(),r=k0(e),n=0;n<r.length;n++)t.include(r[n]);return t}var V0=Qr.exports;const W0=V0,z0=G,{LAT_MIN:Sr,LAT_MAX:_r,LAT_RENDERED_MIN:Lu,LAT_RENDERED_MAX:Ru,LNG_MIN:Nu,LNG_MAX:xu}=z0;var ji=function(e,t){let r=Sr,n=_r,o=Sr,i=_r,a=xu,c=Nu;e.forEach(h=>{const y=W0(h),v=y[1],l=y[3],p=y[0],S=y[2];v>r&&(r=v),l<n&&(n=l),l>o&&(o=l),v<i&&(i=v),p<a&&(a=p),S>c&&(c=S)});const u=t;return r+u.lat>Ru&&(u.lat=Ru-r),o+u.lat>_r&&(u.lat=_r-o),n+u.lat<Lu&&(u.lat=Lu-n),i+u.lat<Sr&&(u.lat=Sr-i),a+u.lng<=Nu&&(u.lng+=Math.ceil(Math.abs(u.lng)/360)*360),c+u.lng>=xu&&(u.lng-=Math.ceil(Math.abs(u.lng)/360)*360),u};const H0=ji,Tt=G;var cn=function(e,t){const r=H0(e.map(n=>n.toGeoJSON()),t);e.forEach(n=>{const o=n.getCoordinates(),i=h=>{const y={lng:h[0]+r.lng,lat:h[1]+r.lat};return[y.lng,y.lat]},a=h=>h.map(y=>i(y)),c=h=>h.map(y=>a(y));let u;n.type===Tt.geojsonTypes.POINT?u=i(o):n.type===Tt.geojsonTypes.LINE_STRING||n.type===Tt.geojsonTypes.MULTI_POINT?u=o.map(i):n.type===Tt.geojsonTypes.POLYGON||n.type===Tt.geojsonTypes.MULTI_LINE_STRING?u=o.map(a):n.type===Tt.geojsonTypes.MULTI_POLYGON&&(u=o.map(c)),n.incomingCoords(u)})};const ct=Pt,Gi=Ed,K0=Xr,J0=zr,kr=Mt,Y0=cn,re=G,z={};z.onSetup=function(e){const t={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoveing:!1,canDragMove:!1,initiallySelectedFeatureIds:e.featureIds||[]};return this.setSelected(t.initiallySelectedFeatureIds.filter(r=>this.getFeature(r)!==void 0)),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),t};z.fireUpdate=function(){this.map.fire(re.events.UPDATE,{action:re.updateActions.MOVE,features:this.getSelected().map(e=>e.toGeoJSON())})};z.fireActionable=function(){const e=this.getSelected(),t=e.filter(i=>this.isInstanceOf("MultiFeature",i));let r=!1;if(e.length>1){r=!0;const i=e[0].type.replace("Multi","");e.forEach(a=>{a.type.replace("Multi","")!==i&&(r=!1)})}const n=t.length>0,o=e.length>0;this.setActionableState({combineFeatures:r,uncombineFeatures:n,trash:o})};z.getUniqueIds=function(e){return e.length?e.map(r=>r.properties.id).filter(r=>r!==void 0).reduce((r,n)=>(r.add(n),r),new J0).values():[]};z.stopExtendedInteractions=function(e){e.boxSelectElement&&(e.boxSelectElement.parentNode&&e.boxSelectElement.parentNode.removeChild(e.boxSelectElement),e.boxSelectElement=null),this.map.dragPan.enable(),e.boxSelecting=!1,e.canBoxSelect=!1,e.dragMoving=!1,e.canDragMove=!1};z.onStop=function(){kr.enable(this)};z.onMouseMove=function(e){return this.stopExtendedInteractions(e)};z.onMouseOut=function(e){if(e.dragMoving)return this.fireUpdate()};z.onTap=z.onClick=function(e,t){if(ct.noTarget(t))return this.clickAnywhere(e,t);if(ct.isOfMetaType(re.meta.VERTEX)(t))return this.clickOnVertex(e,t);if(ct.isFeature(t))return this.clickOnFeature(e,t)};z.clickAnywhere=function(e){const t=this.getSelectedIds();t.length&&(this.clearSelectedFeatures(),t.forEach(r=>this.doRender(r))),kr.enable(this),this.stopExtendedInteractions(e)};z.clickOnVertex=function(e,t){this.changeMode(re.modes.DIRECT_SELECT,{featureId:t.featureTarget.properties.parent,coordPath:t.featureTarget.properties.coord_path,startPos:t.lngLat}),this.updateUIClasses({mouse:re.cursors.MOVE})};z.startOnActiveFeature=function(e,t){this.stopExtendedInteractions(e),this.map.dragPan.disable(),this.doRender(t.featureTarget.properties.id),e.canDragMove=!0,e.dragMoveLocation=t.lngLat};z.clickOnFeature=function(e,t){kr.disable(this),this.stopExtendedInteractions(e);const r=ct.isShiftDown(t),n=this.getSelectedIds(),o=t.featureTarget.properties.id,i=this.isSelected(o);if(!r&&i&&this.getFeature(o).type!==re.geojsonTypes.POINT)return this.changeMode(re.modes.DIRECT_SELECT,{featureId:o});i&&r?(this.deselect(o),this.updateUIClasses({mouse:re.cursors.POINTER}),n.length===1&&kr.enable(this)):!i&&r?(this.select(o),this.updateUIClasses({mouse:re.cursors.MOVE})):!i&&!r&&(n.forEach(a=>this.doRender(a)),this.setSelected(o),this.updateUIClasses({mouse:re.cursors.MOVE})),this.doRender(o)};z.onMouseDown=function(e,t){if(ct.isActiveFeature(t))return this.startOnActiveFeature(e,t);if(this.drawConfig.boxSelect&&ct.isShiftMousedown(t))return this.startBoxSelect(e,t)};z.startBoxSelect=function(e,t){this.stopExtendedInteractions(e),this.map.dragPan.disable(),e.boxSelectStartLocation=Gi(t.originalEvent,this.map.getContainer()),e.canBoxSelect=!0};z.onTouchStart=function(e,t){if(ct.isActiveFeature(t))return this.startOnActiveFeature(e,t)};z.onDrag=function(e,t){if(e.canDragMove)return this.dragMove(e,t);if(this.drawConfig.boxSelect&&e.canBoxSelect)return this.whileBoxSelect(e,t)};z.whileBoxSelect=function(e,t){e.boxSelecting=!0,this.updateUIClasses({mouse:re.cursors.ADD}),e.boxSelectElement||(e.boxSelectElement=document.createElement("div"),e.boxSelectElement.classList.add(re.classes.BOX_SELECT),this.map.getContainer().appendChild(e.boxSelectElement));const r=Gi(t.originalEvent,this.map.getContainer()),n=Math.min(e.boxSelectStartLocation.x,r.x),o=Math.max(e.boxSelectStartLocation.x,r.x),i=Math.min(e.boxSelectStartLocation.y,r.y),a=Math.max(e.boxSelectStartLocation.y,r.y),c=`translate(${n}px, ${i}px)`;e.boxSelectElement.style.transform=c,e.boxSelectElement.style.WebkitTransform=c,e.boxSelectElement.style.width=`${o-n}px`,e.boxSelectElement.style.height=`${a-i}px`};z.dragMove=function(e,t){e.dragMoving=!0,t.originalEvent.stopPropagation();const r={lng:t.lngLat.lng-e.dragMoveLocation.lng,lat:t.lngLat.lat-e.dragMoveLocation.lat};Y0(this.getSelected(),r),e.dragMoveLocation=t.lngLat};z.onMouseUp=function(e,t){if(e.dragMoving)this.fireUpdate();else if(e.boxSelecting){const r=[e.boxSelectStartLocation,Gi(t.originalEvent,this.map.getContainer())],n=this.featuresAt(null,r,"click"),o=this.getUniqueIds(n).filter(i=>!this.isSelected(i));o.length&&(this.select(o),o.forEach(i=>this.doRender(i)),this.updateUIClasses({mouse:re.cursors.MOVE}))}this.stopExtendedInteractions(e)};z.toDisplayFeatures=function(e,t,r){t.properties.active=this.isSelected(t.properties.id)?re.activeStates.ACTIVE:re.activeStates.INACTIVE,r(t),this.fireActionable(),!(t.properties.active!==re.activeStates.ACTIVE||t.geometry.type===re.geojsonTypes.POINT)&&K0(t).forEach(r)};z.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()};z.onCombineFeatures=function(){const e=this.getSelected();if(e.length===0||e.length<2)return;const t=[],r=[],n=e[0].type.replace("Multi","");for(let o=0;o<e.length;o++){const i=e[o];if(i.type.replace("Multi","")!==n)return;i.type.includes("Multi")?i.getCoordinates().forEach(a=>{t.push(a)}):t.push(i.getCoordinates()),r.push(i.toGeoJSON())}if(r.length>1){const o=this.newFeature({type:re.geojsonTypes.FEATURE,properties:r[0].properties,geometry:{type:`Multi${n}`,coordinates:t}});this.addFeature(o),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([o.id]),this.map.fire(re.events.COMBINE_FEATURES,{createdFeatures:[o.toGeoJSON()],deletedFeatures:r})}this.fireActionable()};z.onUncombineFeatures=function(){const e=this.getSelected();if(e.length===0)return;const t=[],r=[];for(let n=0;n<e.length;n++){const o=e[n];this.isInstanceOf("MultiFeature",o)&&(o.getFeatures().forEach(i=>{this.addFeature(i),i.properties=o.properties,t.push(i.toGeoJSON()),this.select([i.id])}),this.deleteFeature(o.id,{silent:!0}),r.push(o.toGeoJSON()))}t.length>1&&this.map.fire(re.events.UNCOMBINE_FEATURES,{createdFeatures:t,deletedFeatures:r}),this.fireActionable()};var Z0=z;const{noTarget:Pl,isOfMetaType:Ml,isInactiveFeature:Ll,isShiftDown:Bu}=Pt,X0=Xr,Q0=ji,Rl=Mt,de=G,ln=Pt,eT=cn,Nl=Ml(de.meta.VERTEX),tT=Ml(de.meta.MIDPOINT),W={};W.fireUpdate=function(){this.map.fire(de.events.UPDATE,{action:de.updateActions.CHANGE_COORDINATES,features:this.getSelected().map(e=>e.toGeoJSON())})};W.fireActionable=function(e){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:e.selectedCoordPaths.length>0})};W.startDragging=function(e,t){this.map.dragPan.disable(),e.canDragMove=!0,e.dragMoveLocation=t.lngLat};W.stopDragging=function(e){this.map.dragPan.enable(),e.dragMoving=!1,e.canDragMove=!1,e.dragMoveLocation=null};W.onVertex=function(e,t){this.startDragging(e,t);const r=t.featureTarget.properties,n=e.selectedCoordPaths.indexOf(r.coord_path);!Bu(t)&&n===-1?e.selectedCoordPaths=[r.coord_path]:Bu(t)&&n===-1&&e.selectedCoordPaths.push(r.coord_path);const o=this.pathsToCoordinates(e.featureId,e.selectedCoordPaths);this.setSelectedCoordinates(o)};W.onMidpoint=function(e,t){this.startDragging(e,t);const r=t.featureTarget.properties;e.feature.addCoordinate(r.coord_path,r.lng,r.lat),this.fireUpdate(),e.selectedCoordPaths=[r.coord_path]};W.pathsToCoordinates=function(e,t){return t.map(r=>({feature_id:e,coord_path:r}))};W.onFeature=function(e,t){e.selectedCoordPaths.length===0?this.startDragging(e,t):this.stopDragging(e)};W.dragFeature=function(e,t,r){eT(this.getSelected(),r),e.dragMoveLocation=t.lngLat};W.dragVertex=function(e,t,r){const n=e.selectedCoordPaths.map(a=>e.feature.getCoordinate(a)),o=n.map(a=>({type:de.geojsonTypes.FEATURE,properties:{},geometry:{type:de.geojsonTypes.POINT,coordinates:a}})),i=Q0(o,r);for(let a=0;a<n.length;a++){const c=n[a];e.feature.updateCoordinate(e.selectedCoordPaths[a],c[0]+i.lng,c[1]+i.lat)}};W.clickNoTarget=function(){this.changeMode(de.modes.SIMPLE_SELECT)};W.clickInactive=function(){this.changeMode(de.modes.SIMPLE_SELECT)};W.clickActiveFeature=function(e){e.selectedCoordPaths=[],this.clearSelectedCoordinates(),e.feature.changed()};W.onSetup=function(e){const t=e.featureId,r=this.getFeature(t);if(!r)throw new Error("You must provide a featureId to enter direct_select mode");if(r.type===de.geojsonTypes.POINT)throw new TypeError("direct_select mode doesn't handle point features");const n={featureId:t,feature:r,dragMoveLocation:e.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:e.coordPath?[e.coordPath]:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(t,n.selectedCoordPaths)),this.setSelected(t),Rl.disable(this),this.setActionableState({trash:!0}),n};W.onStop=function(){Rl.enable(this),this.clearSelectedCoordinates()};W.toDisplayFeatures=function(e,t,r){e.featureId===t.properties.id?(t.properties.active=de.activeStates.ACTIVE,r(t),X0(t,{map:this.map,midpoints:!0,selectedPaths:e.selectedCoordPaths}).forEach(r)):(t.properties.active=de.activeStates.INACTIVE,r(t)),this.fireActionable(e)};W.onTrash=function(e){e.selectedCoordPaths.sort().reverse().forEach(t=>e.feature.removeCoordinate(t)),this.fireUpdate(),e.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(e),e.feature.isValid()===!1&&(this.deleteFeature([e.featureId]),this.changeMode(de.modes.SIMPLE_SELECT,{}))};W.onMouseMove=function(e,t){const r=ln.isActiveFeature(t),n=Nl(t),o=e.selectedCoordPaths.length===0;r&&o?this.updateUIClasses({mouse:de.cursors.MOVE}):n&&!o?this.updateUIClasses({mouse:de.cursors.MOVE}):this.updateUIClasses({mouse:de.cursors.NONE}),this.stopDragging(e)};W.onMouseOut=function(e){e.dragMoving&&this.fireUpdate()};W.onTouchStart=W.onMouseDown=function(e,t){if(Nl(t))return this.onVertex(e,t);if(ln.isActiveFeature(t))return this.onFeature(e,t);if(tT(t))return this.onMidpoint(e,t)};W.onDrag=function(e,t){if(e.canDragMove!==!0)return;e.dragMoving=!0,t.originalEvent.stopPropagation();const r={lng:t.lngLat.lng-e.dragMoveLocation.lng,lat:t.lngLat.lat-e.dragMoveLocation.lat};e.selectedCoordPaths.length>0?this.dragVertex(e,t,r):this.dragFeature(e,t,r),e.dragMoveLocation=t.lngLat};W.onClick=function(e,t){if(Pl(t))return this.clickNoTarget(e,t);if(ln.isActiveFeature(t))return this.clickActiveFeature(e,t);if(Ll(t))return this.clickInactive(e,t);this.stopDragging(e)};W.onTap=function(e,t){if(Pl(t))return this.clickNoTarget(e,t);if(ln.isActiveFeature(t))return this.clickActiveFeature(e,t);if(Ll(t))return this.clickInactive(e,t)};W.onTouchEnd=W.onMouseUp=function(e){e.dragMoving&&this.fireUpdate(),this.stopDragging(e)};var rT=W;const Du=Pt,Le=G,Re={};Re.onSetup=function(){const e=this.newFeature({type:Le.geojsonTypes.FEATURE,properties:{},geometry:{type:Le.geojsonTypes.POINT,coordinates:[]}});return this.addFeature(e),this.clearSelectedFeatures(),this.updateUIClasses({mouse:Le.cursors.ADD}),this.activateUIButton(Le.types.POINT),this.setActionableState({trash:!0}),{point:e}};Re.stopDrawingAndRemove=function(e){this.deleteFeature([e.point.id],{silent:!0}),this.changeMode(Le.modes.SIMPLE_SELECT)};Re.onTap=Re.onClick=function(e,t){this.updateUIClasses({mouse:Le.cursors.MOVE}),e.point.updateCoordinate("",t.lngLat.lng,t.lngLat.lat),this.map.fire(Le.events.CREATE,{features:[e.point.toGeoJSON()]}),this.changeMode(Le.modes.SIMPLE_SELECT,{featureIds:[e.point.id]})};Re.onStop=function(e){this.activateUIButton(),e.point.getCoordinate().length||this.deleteFeature([e.point.id],{silent:!0})};Re.toDisplayFeatures=function(e,t,r){const n=t.properties.id===e.point.id;if(t.properties.active=n?Le.activeStates.ACTIVE:Le.activeStates.INACTIVE,!n)return r(t)};Re.onTrash=Re.stopDrawingAndRemove;Re.onKeyUp=function(e,t){if(Du.isEscapeKey(t)||Du.isEnterKey(t))return this.stopDrawingAndRemove(e,t)};var nT=Re;function oT(e,t){return e.lngLat?e.lngLat.lng===t[0]&&e.lngLat.lat===t[1]:!1}var xl=oT;const qr=Pt,Bl=Mt,oe=G,iT=xl,Uu=Zr,Ae={};Ae.onSetup=function(){const e=this.newFeature({type:oe.geojsonTypes.FEATURE,properties:{},geometry:{type:oe.geojsonTypes.POLYGON,coordinates:[[]]}});return this.addFeature(e),this.clearSelectedFeatures(),Bl.disable(this),this.updateUIClasses({mouse:oe.cursors.ADD}),this.activateUIButton(oe.types.POLYGON),this.setActionableState({trash:!0}),{polygon:e,currentVertexPosition:0}};Ae.clickAnywhere=function(e,t){if(e.currentVertexPosition>0&&iT(t,e.polygon.coordinates[0][e.currentVertexPosition-1]))return this.changeMode(oe.modes.SIMPLE_SELECT,{featureIds:[e.polygon.id]});this.updateUIClasses({mouse:oe.cursors.ADD}),e.polygon.updateCoordinate(`0.${e.currentVertexPosition}`,t.lngLat.lng,t.lngLat.lat),e.currentVertexPosition++,e.polygon.updateCoordinate(`0.${e.currentVertexPosition}`,t.lngLat.lng,t.lngLat.lat)};Ae.clickOnVertex=function(e){return this.changeMode(oe.modes.SIMPLE_SELECT,{featureIds:[e.polygon.id]})};Ae.onMouseMove=function(e,t){e.polygon.updateCoordinate(`0.${e.currentVertexPosition}`,t.lngLat.lng,t.lngLat.lat),qr.isVertex(t)&&this.updateUIClasses({mouse:oe.cursors.POINTER})};Ae.onTap=Ae.onClick=function(e,t){return qr.isVertex(t)?this.clickOnVertex(e,t):this.clickAnywhere(e,t)};Ae.onKeyUp=function(e,t){qr.isEscapeKey(t)?(this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(oe.modes.SIMPLE_SELECT)):qr.isEnterKey(t)&&this.changeMode(oe.modes.SIMPLE_SELECT,{featureIds:[e.polygon.id]})};Ae.onStop=function(e){this.updateUIClasses({mouse:oe.cursors.NONE}),Bl.enable(this),this.activateUIButton(),this.getFeature(e.polygon.id)!==void 0&&(e.polygon.removeCoordinate(`0.${e.currentVertexPosition}`),e.polygon.isValid()?this.map.fire(oe.events.CREATE,{features:[e.polygon.toGeoJSON()]}):(this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(oe.modes.SIMPLE_SELECT,{},{silent:!0})))};Ae.toDisplayFeatures=function(e,t,r){const n=t.properties.id===e.polygon.id;if(t.properties.active=n?oe.activeStates.ACTIVE:oe.activeStates.INACTIVE,!n)return r(t);if(t.geometry.coordinates.length===0)return;const o=t.geometry.coordinates[0].length;if(!(o<3)){if(t.properties.meta=oe.meta.FEATURE,r(Uu(e.polygon.id,t.geometry.coordinates[0][0],"0.0",!1)),o>3){const i=t.geometry.coordinates[0].length-3;r(Uu(e.polygon.id,t.geometry.coordinates[0][i],`0.${i}`,!1))}if(o<=4){const i=[[t.geometry.coordinates[0][0][0],t.geometry.coordinates[0][0][1]],[t.geometry.coordinates[0][1][0],t.geometry.coordinates[0][1][1]]];if(r({type:oe.geojsonTypes.FEATURE,properties:t.properties,geometry:{coordinates:i,type:oe.geojsonTypes.LINE_STRING}}),o===3)return}return r(t)}};Ae.onTrash=function(e){this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(oe.modes.SIMPLE_SELECT)};var aT=Ae;const jr=Pt,ku=xl,Dl=Mt,le=G,sT=Zr,Ie={};Ie.onSetup=function(e){e=e||{};const t=e.featureId;let r,n,o="forward";if(t){if(r=this.getFeature(t),!r)throw new Error("Could not find a feature with the provided featureId");let i=e.from;if(i&&i.type==="Feature"&&i.geometry&&i.geometry.type==="Point"&&(i=i.geometry),i&&i.type==="Point"&&i.coordinates&&i.coordinates.length===2&&(i=i.coordinates),!i||!Array.isArray(i))throw new Error("Please use the `from` property to indicate which point to continue the line from");const a=r.coordinates.length-1;if(r.coordinates[a][0]===i[0]&&r.coordinates[a][1]===i[1])n=a+1,r.addCoordinate(n,...r.coordinates[a]);else if(r.coordinates[0][0]===i[0]&&r.coordinates[0][1]===i[1])o="backwards",n=0,r.addCoordinate(n,...r.coordinates[0]);else throw new Error("`from` should match the point at either the start or the end of the provided LineString")}else r=this.newFeature({type:le.geojsonTypes.FEATURE,properties:{},geometry:{type:le.geojsonTypes.LINE_STRING,coordinates:[]}}),n=0,this.addFeature(r);return this.clearSelectedFeatures(),Dl.disable(this),this.updateUIClasses({mouse:le.cursors.ADD}),this.activateUIButton(le.types.LINE),this.setActionableState({trash:!0}),{line:r,currentVertexPosition:n,direction:o}};Ie.clickAnywhere=function(e,t){if(e.currentVertexPosition>0&&ku(t,e.line.coordinates[e.currentVertexPosition-1])||e.direction==="backwards"&&ku(t,e.line.coordinates[e.currentVertexPosition+1]))return this.changeMode(le.modes.SIMPLE_SELECT,{featureIds:[e.line.id]});this.updateUIClasses({mouse:le.cursors.ADD}),e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat),e.direction==="forward"?(e.currentVertexPosition++,e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat)):e.line.addCoordinate(0,t.lngLat.lng,t.lngLat.lat)};Ie.clickOnVertex=function(e){return this.changeMode(le.modes.SIMPLE_SELECT,{featureIds:[e.line.id]})};Ie.onMouseMove=function(e,t){e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat),jr.isVertex(t)&&this.updateUIClasses({mouse:le.cursors.POINTER})};Ie.onTap=Ie.onClick=function(e,t){if(jr.isVertex(t))return this.clickOnVertex(e,t);this.clickAnywhere(e,t)};Ie.onKeyUp=function(e,t){jr.isEnterKey(t)?this.changeMode(le.modes.SIMPLE_SELECT,{featureIds:[e.line.id]}):jr.isEscapeKey(t)&&(this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(le.modes.SIMPLE_SELECT))};Ie.onStop=function(e){Dl.enable(this),this.activateUIButton(),this.getFeature(e.line.id)!==void 0&&(e.line.removeCoordinate(`${e.currentVertexPosition}`),e.line.isValid()?this.map.fire(le.events.CREATE,{features:[e.line.toGeoJSON()]}):(this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(le.modes.SIMPLE_SELECT,{},{silent:!0})))};Ie.onTrash=function(e){this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(le.modes.SIMPLE_SELECT)};Ie.toDisplayFeatures=function(e,t,r){const n=t.properties.id===e.line.id;if(t.properties.active=n?le.activeStates.ACTIVE:le.activeStates.INACTIVE,!n)return r(t);t.geometry.coordinates.length<2||(t.properties.meta=le.meta.FEATURE,r(sT(e.line.id,t.geometry.coordinates[e.direction==="forward"?t.geometry.coordinates.length-2:1],`${e.direction==="forward"?t.geometry.coordinates.length-2:1}`,!1)),r(t))};var uT=Ie,Ul={simple_select:Z0,direct_select:rT,draw_point:nT,draw_polygon:aT,draw_line_string:uT};const Ht=vi,yi=G,cT={defaultMode:yi.modes.SIMPLE_SELECT,keybindings:!0,touchEnabled:!0,clickBuffer:2,touchBuffer:25,boxSelect:!0,displayControlsDefault:!0,styles:bd,modes:Ul,controls:{},userProperties:!1},lT={point:!0,line_string:!0,polygon:!0,trash:!0,combine_features:!0,uncombine_features:!0},fT={point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1};function qu(e,t){return e.map(r=>r.source?r:Ht(r,{id:`${r.id}.${t}`,source:t==="hot"?yi.sources.HOT:yi.sources.COLD}))}var pT=function(e={}){let t=Ht(e);return e.controls||(t.controls={}),e.displayControlsDefault===!1?t.controls=Ht(fT,e.controls):t.controls=Ht(lT,e.controls),t=Ht(cT,t),t.styles=qu(t.styles,"cold").concat(qu(t.styles,"hot")),t},Gr={exports:{}};Gr.exports;(function(e,t){var r=200,n="__lodash_hash_undefined__",o=1,i=2,a=9007199254740991,c="[object Arguments]",u="[object Array]",h="[object AsyncFunction]",y="[object Boolean]",v="[object Date]",l="[object Error]",p="[object Function]",S="[object GeneratorFunction]",w="[object Map]",A="[object Number]",N="[object Null]",P="[object Object]",m="[object Promise]",I="[object Proxy]",$="[object RegExp]",L="[object Set]",O="[object String]",F="[object Symbol]",f="[object Undefined]",_="[object WeakMap]",g="[object ArrayBuffer]",b="[object DataView]",E="[object Float32Array]",x="[object Float64Array]",j="[object Int8Array]",X="[object Int16Array]",ge="[object Int32Array]",xe="[object Uint8Array]",yt="[object Uint8ClampedArray]",B="[object Uint16Array]",M="[object Uint32Array]",k=/[\\^$.*+?()[\]{}|]/g,q=/^\[object .+?Constructor\]$/,te=/^(?:0|[1-9]\d*)$/,R={};R[E]=R[x]=R[j]=R[X]=R[ge]=R[xe]=R[yt]=R[B]=R[M]=!0,R[c]=R[u]=R[g]=R[y]=R[b]=R[v]=R[l]=R[p]=R[w]=R[A]=R[P]=R[$]=R[L]=R[O]=R[_]=!1;var fe=typeof window=="object"&&window&&window.Object===Object&&window,ye=typeof self=="object"&&self&&self.Object===Object&&self,ee=fe||ye||Function("return this")(),_e=t&&!t.nodeType&&t,We=_e&&!0&&e&&!e.nodeType&&e,Be=We&&We.exports===_e,dn=Be&&fe.process,Hi=function(){try{return dn&&dn.binding&&dn.binding("util")}catch{}}(),Ki=Hi&&Hi.isTypedArray;function zl(s,d){for(var T=-1,C=s==null?0:s.length,H=0,D=[];++T<C;){var Q=s[T];d(Q,T,s)&&(D[H++]=Q)}return D}function Hl(s,d){for(var T=-1,C=d.length,H=s.length;++T<C;)s[H+T]=d[T];return s}function Kl(s,d){for(var T=-1,C=s==null?0:s.length;++T<C;)if(d(s[T],T,s))return!0;return!1}function Jl(s,d){for(var T=-1,C=Array(s);++T<s;)C[T]=d(T);return C}function Yl(s){return function(d){return s(d)}}function Zl(s,d){return s.has(d)}function Xl(s,d){return s==null?void 0:s[d]}function Ql(s){var d=-1,T=Array(s.size);return s.forEach(function(C,H){T[++d]=[H,C]}),T}function ef(s,d){return function(T){return s(d(T))}}function tf(s){var d=-1,T=Array(s.size);return s.forEach(function(C){T[++d]=C}),T}var rf=Array.prototype,nf=Function.prototype,nr=Object.prototype,hn=ee["__core-js_shared__"],Ji=nf.toString,Oe=nr.hasOwnProperty,Yi=function(){var s=/[^.]+$/.exec(hn&&hn.keys&&hn.keys.IE_PROTO||"");return s?"Symbol(src)_1."+s:""}(),Zi=nr.toString,of=RegExp("^"+Ji.call(Oe).replace(k,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Xi=Be?ee.Buffer:void 0,or=ee.Symbol,Qi=ee.Uint8Array,ea=nr.propertyIsEnumerable,af=rf.splice,rt=or?or.toStringTag:void 0,ta=Object.getOwnPropertySymbols,sf=Xi?Xi.isBuffer:void 0,uf=ef(Object.keys,Object),yn=gt(ee,"DataView"),kt=gt(ee,"Map"),gn=gt(ee,"Promise"),vn=gt(ee,"Set"),mn=gt(ee,"WeakMap"),qt=gt(Object,"create"),cf=it(yn),lf=it(kt),ff=it(gn),pf=it(vn),df=it(mn),ra=or?or.prototype:void 0,bn=ra?ra.valueOf:void 0;function nt(s){var d=-1,T=s==null?0:s.length;for(this.clear();++d<T;){var C=s[d];this.set(C[0],C[1])}}function hf(){this.__data__=qt?qt(null):{},this.size=0}function yf(s){var d=this.has(s)&&delete this.__data__[s];return this.size-=d?1:0,d}function gf(s){var d=this.__data__;if(qt){var T=d[s];return T===n?void 0:T}return Oe.call(d,s)?d[s]:void 0}function vf(s){var d=this.__data__;return qt?d[s]!==void 0:Oe.call(d,s)}function mf(s,d){var T=this.__data__;return this.size+=this.has(s)?0:1,T[s]=qt&&d===void 0?n:d,this}nt.prototype.clear=hf,nt.prototype.delete=yf,nt.prototype.get=gf,nt.prototype.has=vf,nt.prototype.set=mf;function De(s){var d=-1,T=s==null?0:s.length;for(this.clear();++d<T;){var C=s[d];this.set(C[0],C[1])}}function bf(){this.__data__=[],this.size=0}function Tf(s){var d=this.__data__,T=ar(d,s);if(T<0)return!1;var C=d.length-1;return T==C?d.pop():af.call(d,T,1),--this.size,!0}function Sf(s){var d=this.__data__,T=ar(d,s);return T<0?void 0:d[T][1]}function _f(s){return ar(this.__data__,s)>-1}function Ef(s,d){var T=this.__data__,C=ar(T,s);return C<0?(++this.size,T.push([s,d])):T[C][1]=d,this}De.prototype.clear=bf,De.prototype.delete=Tf,De.prototype.get=Sf,De.prototype.has=_f,De.prototype.set=Ef;function ot(s){var d=-1,T=s==null?0:s.length;for(this.clear();++d<T;){var C=s[d];this.set(C[0],C[1])}}function wf(){this.size=0,this.__data__={hash:new nt,map:new(kt||De),string:new nt}}function Af(s){var d=sr(this,s).delete(s);return this.size-=d?1:0,d}function If(s){return sr(this,s).get(s)}function $f(s){return sr(this,s).has(s)}function Cf(s,d){var T=sr(this,s),C=T.size;return T.set(s,d),this.size+=T.size==C?0:1,this}ot.prototype.clear=wf,ot.prototype.delete=Af,ot.prototype.get=If,ot.prototype.has=$f,ot.prototype.set=Cf;function ir(s){var d=-1,T=s==null?0:s.length;for(this.__data__=new ot;++d<T;)this.add(s[d])}function Of(s){return this.__data__.set(s,n),this}function Ff(s){return this.__data__.has(s)}ir.prototype.add=ir.prototype.push=Of,ir.prototype.has=Ff;function ze(s){var d=this.__data__=new De(s);this.size=d.size}function Pf(){this.__data__=new De,this.size=0}function Mf(s){var d=this.__data__,T=d.delete(s);return this.size=d.size,T}function Lf(s){return this.__data__.get(s)}function Rf(s){return this.__data__.has(s)}function Nf(s,d){var T=this.__data__;if(T instanceof De){var C=T.__data__;if(!kt||C.length<r-1)return C.push([s,d]),this.size=++T.size,this;T=this.__data__=new ot(C)}return T.set(s,d),this.size=T.size,this}ze.prototype.clear=Pf,ze.prototype.delete=Mf,ze.prototype.get=Lf,ze.prototype.has=Rf,ze.prototype.set=Nf;function xf(s,d){var T=ur(s),C=!T&&Zf(s),H=!T&&!C&&Tn(s),D=!T&&!C&&!H&&fa(s),Q=T||C||H||D,ie=Q?Jl(s.length,String):[],ue=ie.length;for(var J in s)Oe.call(s,J)&&!(Q&&(J=="length"||H&&(J=="offset"||J=="parent")||D&&(J=="buffer"||J=="byteLength"||J=="byteOffset")||zf(J,ue)))&&ie.push(J);return ie}function ar(s,d){for(var T=s.length;T--;)if(sa(s[T][0],d))return T;return-1}function Bf(s,d,T){var C=d(s);return ur(s)?C:Hl(C,T(s))}function jt(s){return s==null?s===void 0?f:N:rt&&rt in Object(s)?Vf(s):Yf(s)}function na(s){return Gt(s)&&jt(s)==c}function oa(s,d,T,C,H){return s===d?!0:s==null||d==null||!Gt(s)&&!Gt(d)?s!==s&&d!==d:Df(s,d,T,C,oa,H)}function Df(s,d,T,C,H,D){var Q=ur(s),ie=ur(d),ue=Q?u:He(s),J=ie?u:He(d);ue=ue==c?P:ue,J=J==c?P:J;var ve=ue==P,Ee=J==P,ce=ue==J;if(ce&&Tn(s)){if(!Tn(d))return!1;Q=!0,ve=!1}if(ce&&!ve)return D||(D=new ze),Q||fa(s)?ia(s,d,T,C,H,D):jf(s,d,ue,T,C,H,D);if(!(T&o)){var me=ve&&Oe.call(s,"__wrapped__"),be=Ee&&Oe.call(d,"__wrapped__");if(me||be){var Ke=me?s.value():s,Ue=be?d.value():d;return D||(D=new ze),H(Ke,Ue,T,C,D)}}return ce?(D||(D=new ze),Gf(s,d,T,C,H,D)):!1}function Uf(s){if(!la(s)||Kf(s))return!1;var d=ua(s)?of:q;return d.test(it(s))}function kf(s){return Gt(s)&&ca(s.length)&&!!R[jt(s)]}function qf(s){if(!Jf(s))return uf(s);var d=[];for(var T in Object(s))Oe.call(s,T)&&T!="constructor"&&d.push(T);return d}function ia(s,d,T,C,H,D){var Q=T&o,ie=s.length,ue=d.length;if(ie!=ue&&!(Q&&ue>ie))return!1;var J=D.get(s);if(J&&D.get(d))return J==d;var ve=-1,Ee=!0,ce=T&i?new ir:void 0;for(D.set(s,d),D.set(d,s);++ve<ie;){var me=s[ve],be=d[ve];if(C)var Ke=Q?C(be,me,ve,d,s,D):C(me,be,ve,s,d,D);if(Ke!==void 0){if(Ke)continue;Ee=!1;break}if(ce){if(!Kl(d,function(Ue,at){if(!Zl(ce,at)&&(me===Ue||H(me,Ue,T,C,D)))return ce.push(at)})){Ee=!1;break}}else if(!(me===be||H(me,be,T,C,D))){Ee=!1;break}}return D.delete(s),D.delete(d),Ee}function jf(s,d,T,C,H,D,Q){switch(T){case b:if(s.byteLength!=d.byteLength||s.byteOffset!=d.byteOffset)return!1;s=s.buffer,d=d.buffer;case g:return!(s.byteLength!=d.byteLength||!D(new Qi(s),new Qi(d)));case y:case v:case A:return sa(+s,+d);case l:return s.name==d.name&&s.message==d.message;case $:case O:return s==d+"";case w:var ie=Ql;case L:var ue=C&o;if(ie||(ie=tf),s.size!=d.size&&!ue)return!1;var J=Q.get(s);if(J)return J==d;C|=i,Q.set(s,d);var ve=ia(ie(s),ie(d),C,H,D,Q);return Q.delete(s),ve;case F:if(bn)return bn.call(s)==bn.call(d)}return!1}function Gf(s,d,T,C,H,D){var Q=T&o,ie=aa(s),ue=ie.length,J=aa(d),ve=J.length;if(ue!=ve&&!Q)return!1;for(var Ee=ue;Ee--;){var ce=ie[Ee];if(!(Q?ce in d:Oe.call(d,ce)))return!1}var me=D.get(s);if(me&&D.get(d))return me==d;var be=!0;D.set(s,d),D.set(d,s);for(var Ke=Q;++Ee<ue;){ce=ie[Ee];var Ue=s[ce],at=d[ce];if(C)var pa=Q?C(at,Ue,ce,d,s,D):C(Ue,at,ce,s,d,D);if(!(pa===void 0?Ue===at||H(Ue,at,T,C,D):pa)){be=!1;break}Ke||(Ke=ce=="constructor")}if(be&&!Ke){var cr=s.constructor,lr=d.constructor;cr!=lr&&"constructor"in s&&"constructor"in d&&!(typeof cr=="function"&&cr instanceof cr&&typeof lr=="function"&&lr instanceof lr)&&(be=!1)}return D.delete(s),D.delete(d),be}function aa(s){return Bf(s,ep,Wf)}function sr(s,d){var T=s.__data__;return Hf(d)?T[typeof d=="string"?"string":"hash"]:T.map}function gt(s,d){var T=Xl(s,d);return Uf(T)?T:void 0}function Vf(s){var d=Oe.call(s,rt),T=s[rt];try{s[rt]=void 0;var C=!0}catch{}var H=Zi.call(s);return C&&(d?s[rt]=T:delete s[rt]),H}var Wf=ta?function(s){return s==null?[]:(s=Object(s),zl(ta(s),function(d){return ea.call(s,d)}))}:tp,He=jt;(yn&&He(new yn(new ArrayBuffer(1)))!=b||kt&&He(new kt)!=w||gn&&He(gn.resolve())!=m||vn&&He(new vn)!=L||mn&&He(new mn)!=_)&&(He=function(s){var d=jt(s),T=d==P?s.constructor:void 0,C=T?it(T):"";if(C)switch(C){case cf:return b;case lf:return w;case ff:return m;case pf:return L;case df:return _}return d});function zf(s,d){return d=d??a,!!d&&(typeof s=="number"||te.test(s))&&s>-1&&s%1==0&&s<d}function Hf(s){var d=typeof s;return d=="string"||d=="number"||d=="symbol"||d=="boolean"?s!=="__proto__":s===null}function Kf(s){return!!Yi&&Yi in s}function Jf(s){var d=s&&s.constructor,T=typeof d=="function"&&d.prototype||nr;return s===T}function Yf(s){return Zi.call(s)}function it(s){if(s!=null){try{return Ji.call(s)}catch{}try{return s+""}catch{}}return""}function sa(s,d){return s===d||s!==s&&d!==d}var Zf=na(function(){return arguments}())?na:function(s){return Gt(s)&&Oe.call(s,"callee")&&!ea.call(s,"callee")},ur=Array.isArray;function Xf(s){return s!=null&&ca(s.length)&&!ua(s)}var Tn=sf||rp;function Qf(s,d){return oa(s,d)}function ua(s){if(!la(s))return!1;var d=jt(s);return d==p||d==S||d==h||d==I}function ca(s){return typeof s=="number"&&s>-1&&s%1==0&&s<=a}function la(s){var d=typeof s;return s!=null&&(d=="object"||d=="function")}function Gt(s){return s!=null&&typeof s=="object"}var fa=Ki?Yl(Ki):kf;function ep(s){return Xf(s)?xf(s):qf(s)}function tp(){return[]}function rp(){return!1}e.exports=Qf})(Gr,Gr.exports);var dT=Gr.exports,hT=function(e,t){return e.length!==t.length?!1:JSON.stringify(e.map(r=>r).sort())===JSON.stringify(t.map(r=>r).sort())},kl={},gi={exports:{}};(function(e,t){var r={env:{},argv:[]},n=function(){var o=function(P,m,I,$){for(I=I||{},$=P.length;$--;I[P[$]]=m);return I},i=[1,12],a=[1,13],c=[1,9],u=[1,10],h=[1,11],y=[1,14],v=[1,15],l=[14,18,22,24],p=[18,22],S=[22,24],w={trace:function(){},yy:{},symbols_:{error:2,JSONString:3,STRING:4,JSONNumber:5,NUMBER:6,JSONNullLiteral:7,NULL:8,JSONBooleanLiteral:9,TRUE:10,FALSE:11,JSONText:12,JSONValue:13,EOF:14,JSONObject:15,JSONArray:16,"{":17,"}":18,JSONMemberList:19,JSONMember:20,":":21,",":22,"[":23,"]":24,JSONElementList:25,$accept:0,$end:1},terminals_:{2:"error",4:"STRING",6:"NUMBER",8:"NULL",10:"TRUE",11:"FALSE",14:"EOF",17:"{",18:"}",21:":",22:",",23:"[",24:"]"},productions_:[0,[3,1],[5,1],[7,1],[9,1],[9,1],[12,2],[13,1],[13,1],[13,1],[13,1],[13,1],[13,1],[15,2],[15,3],[20,3],[19,1],[19,3],[16,2],[16,3],[25,1],[25,3]],performAction:function(m,I,$,L,O,F,f){var _=F.length-1;switch(O){case 1:this.$=m.replace(/\\(\\|")/g,"$1").replace(/\\n/g,`
`).replace(/\\r/g,"\r").replace(/\\t/g,"	").replace(/\\v/g,"\v").replace(/\\f/g,"\f").replace(/\\b/g,"\b");break;case 2:this.$=Number(m);break;case 3:this.$=null;break;case 4:this.$=!0;break;case 5:this.$=!1;break;case 6:return this.$=F[_-1];case 13:this.$={},Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 14:case 19:this.$=F[_-1],Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 15:this.$=[F[_-2],F[_]];break;case 16:this.$={},this.$[F[_][0]]=F[_][1];break;case 17:this.$=F[_-2],F[_-2][F[_][0]]!==void 0&&(this.$.__duplicateProperties__||Object.defineProperty(this.$,"__duplicateProperties__",{value:[],enumerable:!1}),this.$.__duplicateProperties__.push(F[_][0])),F[_-2][F[_][0]]=F[_][1];break;case 18:this.$=[],Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 20:this.$=[F[_]];break;case 21:this.$=F[_-2],F[_-2].push(F[_]);break}},table:[{3:5,4:i,5:6,6:a,7:3,8:c,9:4,10:u,11:h,12:1,13:2,15:7,16:8,17:y,23:v},{1:[3]},{14:[1,16]},o(l,[2,7]),o(l,[2,8]),o(l,[2,9]),o(l,[2,10]),o(l,[2,11]),o(l,[2,12]),o(l,[2,3]),o(l,[2,4]),o(l,[2,5]),o([14,18,21,22,24],[2,1]),o(l,[2,2]),{3:20,4:i,18:[1,17],19:18,20:19},{3:5,4:i,5:6,6:a,7:3,8:c,9:4,10:u,11:h,13:23,15:7,16:8,17:y,23:v,24:[1,21],25:22},{1:[2,6]},o(l,[2,13]),{18:[1,24],22:[1,25]},o(p,[2,16]),{21:[1,26]},o(l,[2,18]),{22:[1,28],24:[1,27]},o(S,[2,20]),o(l,[2,14]),{3:20,4:i,20:29},{3:5,4:i,5:6,6:a,7:3,8:c,9:4,10:u,11:h,13:30,15:7,16:8,17:y,23:v},o(l,[2,19]),{3:5,4:i,5:6,6:a,7:3,8:c,9:4,10:u,11:h,13:31,15:7,16:8,17:y,23:v},o(p,[2,17]),o(p,[2,15]),o(S,[2,21])],defaultActions:{16:[2,6]},parseError:function(m,I){if(I.recoverable)this.trace(m);else{let $=function(L,O){this.message=L,this.hash=O};throw $.prototype=Error,new $(m,I)}},parse:function(m){var I=this,$=[0],L=[null],O=[],F=this.table,f="",_=0,g=0,b=2,E=1,x=O.slice.call(arguments,1),j=Object.create(this.lexer),X={yy:{}};for(var ge in this.yy)Object.prototype.hasOwnProperty.call(this.yy,ge)&&(X.yy[ge]=this.yy[ge]);j.setInput(m,X.yy),X.yy.lexer=j,X.yy.parser=this,typeof j.yylloc>"u"&&(j.yylloc={});var xe=j.yylloc;O.push(xe);var yt=j.options&&j.options.ranges;typeof X.yy.parseError=="function"?this.parseError=X.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var B=function(){var Be;return Be=j.lex()||E,typeof Be!="number"&&(Be=I.symbols_[Be]||Be),Be},M,k,q,te,R={},fe,ye,ee,_e;;){if(k=$[$.length-1],this.defaultActions[k]?q=this.defaultActions[k]:((M===null||typeof M>"u")&&(M=B()),q=F[k]&&F[k][M]),typeof q>"u"||!q.length||!q[0]){var We="";_e=[];for(fe in F[k])this.terminals_[fe]&&fe>b&&_e.push("'"+this.terminals_[fe]+"'");j.showPosition?We="Parse error on line "+(_+1)+`:
`+j.showPosition()+`
Expecting `+_e.join(", ")+", got '"+(this.terminals_[M]||M)+"'":We="Parse error on line "+(_+1)+": Unexpected "+(M==E?"end of input":"'"+(this.terminals_[M]||M)+"'"),this.parseError(We,{text:j.match,token:this.terminals_[M]||M,line:j.yylineno,loc:xe,expected:_e})}if(q[0]instanceof Array&&q.length>1)throw new Error("Parse Error: multiple actions possible at state: "+k+", token: "+M);switch(q[0]){case 1:$.push(M),L.push(j.yytext),O.push(j.yylloc),$.push(q[1]),M=null,g=j.yyleng,f=j.yytext,_=j.yylineno,xe=j.yylloc;break;case 2:if(ye=this.productions_[q[1]][1],R.$=L[L.length-ye],R._$={first_line:O[O.length-(ye||1)].first_line,last_line:O[O.length-1].last_line,first_column:O[O.length-(ye||1)].first_column,last_column:O[O.length-1].last_column},yt&&(R._$.range=[O[O.length-(ye||1)].range[0],O[O.length-1].range[1]]),te=this.performAction.apply(R,[f,g,_,X.yy,q[1],L,O].concat(x)),typeof te<"u")return te;ye&&($=$.slice(0,-1*ye*2),L=L.slice(0,-1*ye),O=O.slice(0,-1*ye)),$.push(this.productions_[q[1]][0]),L.push(R.$),O.push(R._$),ee=F[$[$.length-2]][$[$.length-1]],$.push(ee);break;case 3:return!0}}return!0}},A=function(){var P={EOF:1,parseError:function(I,$){if(this.yy.parser)this.yy.parser.parseError(I,$);else throw new Error(I)},setInput:function(m,I){return this.yy=I||this.yy||{},this._input=m,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var m=this._input[0];this.yytext+=m,this.yyleng++,this.offset++,this.match+=m,this.matched+=m;var I=m.match(/(?:\r\n?|\n).*/g);return I?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),m},unput:function(m){var I=m.length,$=m.split(/(?:\r\n?|\n)/g);this._input=m+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-I),this.offset-=I;var L=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),$.length-1&&(this.yylineno-=$.length-1);var O=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:$?($.length===L.length?this.yylloc.first_column:0)+L[L.length-$.length].length-$[0].length:this.yylloc.first_column-I},this.options.ranges&&(this.yylloc.range=[O[0],O[0]+this.yyleng-I]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(m){this.unput(this.match.slice(m))},pastInput:function(){var m=this.matched.substr(0,this.matched.length-this.match.length);return(m.length>20?"...":"")+m.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var m=this.match;return m.length<20&&(m+=this._input.substr(0,20-m.length)),(m.substr(0,20)+(m.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var m=this.pastInput(),I=new Array(m.length+1).join("-");return m+this.upcomingInput()+`
`+I+"^"},test_match:function(m,I){var $,L,O;if(this.options.backtrack_lexer&&(O={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(O.yylloc.range=this.yylloc.range.slice(0))),L=m[0].match(/(?:\r\n?|\n).*/g),L&&(this.yylineno+=L.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:L?L[L.length-1].length-L[L.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+m[0].length},this.yytext+=m[0],this.match+=m[0],this.matches=m,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(m[0].length),this.matched+=m[0],$=this.performAction.call(this,this.yy,this,I,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),$)return $;if(this._backtrack){for(var F in O)this[F]=O[F];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var m,I,$,L;this._more||(this.yytext="",this.match="");for(var O=this._currentRules(),F=0;F<O.length;F++)if($=this._input.match(this.rules[O[F]]),$&&(!I||$[0].length>I[0].length)){if(I=$,L=F,this.options.backtrack_lexer){if(m=this.test_match($,O[F]),m!==!1)return m;if(this._backtrack){I=!1;continue}else return!1}else if(!this.options.flex)break}return I?(m=this.test_match(I,O[L]),m!==!1?m:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var I=this.next();return I||this.lex()},begin:function(I){this.conditionStack.push(I)},popState:function(){var I=this.conditionStack.length-1;return I>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(I){return I=this.conditionStack.length-1-Math.abs(I||0),I>=0?this.conditionStack[I]:"INITIAL"},pushState:function(I){this.begin(I)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(I,$,L,O){switch(L){case 0:break;case 1:return 6;case 2:return $.yytext=$.yytext.substr(1,$.yyleng-2),4;case 3:return 17;case 4:return 18;case 5:return 23;case 6:return 24;case 7:return 22;case 8:return 21;case 9:return 10;case 10:return 11;case 11:return 8;case 12:return 14;case 13:return"INVALID"}},rules:[/^(?:\s+)/,/^(?:(-?([0-9]|[1-9][0-9]+))(\.[0-9]+)?([eE][-+]?[0-9]+)?\b)/,/^(?:"(?:\\[\\"bfnrt\/]|\\u[a-fA-F0-9]{4}|[^\\\0-\x09\x0a-\x1f"])*")/,/^(?:\{)/,/^(?:\})/,/^(?:\[)/,/^(?:\])/,/^(?:,)/,/^(?::)/,/^(?:true\b)/,/^(?:false\b)/,/^(?:null\b)/,/^(?:$)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13],inclusive:!0}}};return P}();w.lexer=A;function N(){this.yy={}}return N.prototype=w,w.Parser=N,new N}();typeof Tp<"u"&&(t.parser=n,t.Parser=n.Parser,t.parse=function(){return n.parse.apply(n,arguments)},t.main=function(i){i[1]||(console.log("Usage: "+i[0]+" FILE"),r.exit(1));var a=ri.readFileSync(ri.normalize(i[1]),"utf8");return t.parser.parse(a)},require.main===e&&t.main(r.argv.slice(1)))})(gi,gi.exports);var yT=gi.exports,ql={};function Jo(e){return e*Math.PI/180}function ju(e){var t=0;if(e.length>2)for(var r,n,o=0;o<e.length-1;o++)r=e[o],n=e[o+1],t+=Jo(n[0]-r[0])*(2+Math.sin(Jo(r[1]))+Math.sin(Jo(n[1])));return t>=0}function Gu(e){if(e&&e.length>0){if(ju(e[0]))return!1;var t=e.slice(1,e.length);if(!t.every(ju))return!1}return!0}function gT(e){if(e.type==="Polygon")return Gu(e.coordinates);if(e.type==="MultiPolygon")return e.coordinates.every(Gu)}var vT=function(t,r){gT(t)||r.push({message:"Polygons and MultiPolygons should follow the right-hand rule",level:"message",line:t.__line__})},Vu=vT;function mT(e,t){var r=[],n=0,o=10,i=6;function a(f){if((!t||t.noDuplicateMembers!==!1)&&f.__duplicateProperties__&&r.push({message:"An object contained duplicate members, making parsing ambigous: "+f.__duplicateProperties__.join(", "),line:f.__line__}),!u(f,"type","string"))if(O[f.type])f&&O[f.type](f);else{var _=F[f.type.toLowerCase()];_!==void 0?r.push({message:"Expected "+_+" but got "+f.type+" (case sensitive)",line:f.__line__}):r.push({message:"The type "+f.type+" is unknown",line:f.__line__})}}function c(f,_){return f.every(function(g){return g!==null&&typeof g===_})}function u(f,_,g){if(typeof f[_]>"u")return r.push({message:'"'+_+'" member required',line:f.__line__});if(g==="array"){if(!Array.isArray(f[_]))return r.push({message:'"'+_+'" member should be an array, but is an '+typeof f[_]+" instead",line:f.__line__})}else{if(g==="object"&&f[_]&&f[_].constructor!==Object)return r.push({message:'"'+_+'" member should be '+g+", but is an "+f[_].constructor.name+" instead",line:f.__line__});if(g&&typeof f[_]!==g)return r.push({message:'"'+_+'" member should be '+g+", but is an "+typeof f[_]+" instead",line:f.__line__})}}function h(f){if(l(f),p(f),f.properties!==void 0&&r.push({message:'FeatureCollection object cannot contain a "properties" member',line:f.__line__}),f.coordinates!==void 0&&r.push({message:'FeatureCollection object cannot contain a "coordinates" member',line:f.__line__}),!u(f,"features","array")){if(!c(f.features,"object"))return r.push({message:"Every feature must be an object",line:f.__line__});f.features.forEach(L)}}function y(f,_){if(!Array.isArray(f))return r.push({message:"position should be an array, is a "+typeof f+" instead",line:f.__line__||_});if(f.length<2)return r.push({message:"position must have 2 or more elements",line:f.__line__||_});if(f.length>3)return r.push({message:"position should not have more than 3 elements",level:"message",line:f.__line__||_});if(!c(f,"number"))return r.push({message:"each element in a position must be a number",line:f.__line__||_});if(t&&t.precisionWarning){if(n===o)return n+=1,r.push({message:"truncated warnings: we've encountered coordinate precision warning "+o+" times, no more warnings will be reported",level:"message",line:f.__line__||_});n<o&&f.forEach(function(g){var b=0,E=String(g).split(".")[1];if(E!==void 0&&(b=E.length),b>i)return n+=1,r.push({message:"precision of coordinates should be reduced",level:"message",line:f.__line__||_})})}}function v(f,_,g,b){if(b===void 0&&f.__line__!==void 0&&(b=f.__line__),g===0)return y(f,b);if(g===1&&_){if(_==="LinearRing"){if(!Array.isArray(f[f.length-1]))return r.push({message:"a number was found where a coordinate array should have been found: this needs to be nested more deeply",line:b}),!0;if(f.length<4&&r.push({message:"a LinearRing of coordinates needs to have four or more positions",line:b}),f.length&&(f[f.length-1].length!==f[0].length||!f[f.length-1].every(function(x,j){return f[0][j]===x})))return r.push({message:"the first and last positions in a LinearRing of coordinates must be the same",line:b}),!0}else if(_==="Line"&&f.length<2)return r.push({message:"a line needs to have two or more coordinates to be valid",line:b})}if(!Array.isArray(f))r.push({message:"a number was found where a coordinate array should have been found: this needs to be nested more deeply",line:b});else{var E=f.map(function(x){return v(x,_,g-1,x.__line__||b)});return E.some(function(x){return x})}}function l(f){if(f.crs){var _="urn:ogc:def:crs:OGC:1.3:CRS84";typeof f.crs=="object"&&f.crs.properties&&f.crs.properties.name===_?r.push({message:"old-style crs member is not recommended, this object is equivalent to the default and should be removed",line:f.__line__}):r.push({message:"old-style crs member is not recommended",line:f.__line__})}}function p(f){if(f.bbox){if(Array.isArray(f.bbox))return c(f.bbox,"number")||r.push({message:"each element in a bbox member must be a number",line:f.bbox.__line__}),f.bbox.length===4||f.bbox.length===6||r.push({message:"bbox must contain 4 elements (for 2D) or 6 elements (for 3D)",line:f.bbox.__line__}),r.length;r.push({message:"bbox member must be an array of numbers, but is a "+typeof f.bbox,line:f.__line__})}}function S(f){f.properties!==void 0&&r.push({message:'geometry object cannot contain a "properties" member',line:f.__line__}),f.geometry!==void 0&&r.push({message:'geometry object cannot contain a "geometry" member',line:f.__line__}),f.features!==void 0&&r.push({message:'geometry object cannot contain a "features" member',line:f.__line__})}function w(f){l(f),p(f),S(f),u(f,"coordinates","array")||y(f.coordinates)}function A(f){l(f),p(f),u(f,"coordinates","array")||v(f.coordinates,"LinearRing",2)||Vu(f,r)}function N(f){l(f),p(f),u(f,"coordinates","array")||v(f.coordinates,"LinearRing",3)||Vu(f,r)}function P(f){l(f),p(f),u(f,"coordinates","array")||v(f.coordinates,"Line",1)}function m(f){l(f),p(f),u(f,"coordinates","array")||v(f.coordinates,"Line",2)}function I(f){l(f),p(f),u(f,"coordinates","array")||v(f.coordinates,"",1)}function $(f){l(f),p(f),u(f,"geometries","array")||(c(f.geometries,"object")||r.push({message:"The geometries array in a GeometryCollection must contain only geometry objects",line:f.__line__}),f.geometries.length===1&&r.push({message:"GeometryCollection with a single geometry should be avoided in favor of single part or a single object of multi-part type",line:f.geometries.__line__}),f.geometries.forEach(function(_){_&&(_.type==="GeometryCollection"&&r.push({message:"GeometryCollection should avoid nested geometry collections",line:f.geometries.__line__}),a(_))}))}function L(f){l(f),p(f),f.id!==void 0&&typeof f.id!="string"&&typeof f.id!="number"&&r.push({message:'Feature "id" member must have a string or number value',line:f.__line__}),f.features!==void 0&&r.push({message:'Feature object cannot contain a "features" member',line:f.__line__}),f.coordinates!==void 0&&r.push({message:'Feature object cannot contain a "coordinates" member',line:f.__line__}),f.type!=="Feature"&&r.push({message:"GeoJSON features must have a type=feature member",line:f.__line__}),u(f,"properties","object"),u(f,"geometry","object")||f.geometry&&a(f.geometry)}var O={Point:w,Feature:L,MultiPoint:I,LineString:P,MultiLineString:m,FeatureCollection:h,GeometryCollection:$,Polygon:A,MultiPolygon:N},F=Object.keys(O).reduce(function(f,_){return f[_.toLowerCase()]=_,f},{});return typeof e!="object"||e===null||e===void 0?(r.push({message:"The root of a GeoJSON object must be an object.",line:0}),r):(a(e),r.forEach(function(f){({}).hasOwnProperty.call(f,"line")&&f.line===void 0&&delete f.line}),r)}ql.hint=mT;var bT=yT,TT=ql;function ST(e,t){var r,n=[];if(typeof e=="object")r=e;else if(typeof e=="string")try{r=bT.parse(e)}catch(a){var o=a.message.match(/line (\d+)/),i=parseInt(o[1],10);return[{line:i-1,message:a.message,error:a}]}else return[{message:"Expected string or object as input",line:0}];return n=n.concat(TT.hint(r,t)),n}kl.hint=ST;const _T=dT,ET=Hu,wT=Si,AT=Hr,IT=hT,$T=kl,pe=G,CT=zr,OT={Polygon:wi,LineString:Ei,Point:_i,MultiPolygon:Ir,MultiLineString:Ir,MultiPoint:Ir};var FT=function(e,t){return t.modes=pe.modes,t.getFeatureIdsAt=function(r){return AT.click({point:r},null,e).map(o=>o.properties.id)},t.getSelectedIds=function(){return e.store.getSelectedIds()},t.getSelected=function(){return{type:pe.geojsonTypes.FEATURE_COLLECTION,features:e.store.getSelectedIds().map(r=>e.store.get(r)).map(r=>r.toGeoJSON())}},t.getSelectedPoints=function(){return{type:pe.geojsonTypes.FEATURE_COLLECTION,features:e.store.getSelectedCoordinates().map(r=>({type:pe.geojsonTypes.FEATURE,properties:{},geometry:{type:pe.geojsonTypes.POINT,coordinates:r.coordinates}}))}},t.set=function(r){if(r.type===void 0||r.type!==pe.geojsonTypes.FEATURE_COLLECTION||!Array.isArray(r.features))throw new Error("Invalid FeatureCollection");const n=e.store.createRenderBatch();let o=e.store.getAllIds().slice();const i=t.add(r),a=new CT(i);return o=o.filter(c=>!a.has(c)),o.length&&t.delete(o),n(),i},t.add=function(r){const n=$T.hint(r,{precisionWarning:!1}).filter(a=>a.level!=="message");if(n.length)throw new Error(n[0].message);const i=JSON.parse(JSON.stringify(ET(r))).features.map(a=>{if(a.id=a.id||wT(),a.geometry===null)throw new Error("Invalid geometry: null");if(e.store.get(a.id)===void 0||e.store.get(a.id).type!==a.geometry.type){const c=OT[a.geometry.type];if(c===void 0)throw new Error(`Invalid geometry type: ${a.geometry.type}.`);const u=new c(e,a);e.store.add(u)}else{const c=e.store.get(a.id);c.properties=a.properties,_T(c.getCoordinates(),a.geometry.coordinates)||c.incomingCoords(a.geometry.coordinates)}return a.id});return e.store.render(),i},t.get=function(r){const n=e.store.get(r);if(n)return n.toGeoJSON()},t.getAll=function(){return{type:pe.geojsonTypes.FEATURE_COLLECTION,features:e.store.getAll().map(r=>r.toGeoJSON())}},t.delete=function(r){return e.store.delete(r,{silent:!0}),t.getMode()===pe.modes.DIRECT_SELECT&&!e.store.getSelectedIds().length?e.events.changeMode(pe.modes.SIMPLE_SELECT,void 0,{silent:!0}):e.store.render(),t},t.deleteAll=function(){return e.store.delete(e.store.getAllIds(),{silent:!0}),t.getMode()===pe.modes.DIRECT_SELECT?e.events.changeMode(pe.modes.SIMPLE_SELECT,void 0,{silent:!0}):e.store.render(),t},t.changeMode=function(r,n={}){return r===pe.modes.SIMPLE_SELECT&&t.getMode()===pe.modes.SIMPLE_SELECT?(IT(n.featureIds||[],e.store.getSelectedIds())||(e.store.setSelected(n.featureIds,{silent:!0}),e.store.render()),t):(r===pe.modes.DIRECT_SELECT&&t.getMode()===pe.modes.DIRECT_SELECT&&n.featureId===e.store.getSelectedIds()[0]||e.events.changeMode(r,n,{silent:!0}),t)},t.getMode=function(){return e.events.getMode()},t.trash=function(){return e.events.trash({silent:!0}),t},t.combineFeatures=function(){return e.events.combineFeatures({silent:!0}),t},t.uncombineFeatures=function(){return e.events.uncombineFeatures({silent:!0}),t},t.setFeatureProperty=function(r,n,o){return e.store.setFeatureProperty(r,n,o),t},t};const PT=md,MT=pT,LT=FT,RT=G,NT=function(e,t){e=MT(e);const r={options:e};t=LT(r,t),r.api=t;const n=PT(r);return t.onAdd=n.onAdd,t.onRemove=n.onRemove,t.types=RT.types,t.options=e,t};Ti.exports=function(e){NT(e,this)};Ti.exports.modes=Ul;var fn=Ti.exports;const Vi=mi(vp),xT=fn,Kt=G,BT=Mt,DT=Vi.default,jl={...xT.modes.draw_polygon},UT=2;jl.onSetup=function(e){const t=this.newFeature({type:Kt.geojsonTypes.FEATURE,properties:{isCircle:!0,center:[]},geometry:{type:Kt.geojsonTypes.POLYGON,coordinates:[[]]}});return this.addFeature(t),this.clearSelectedFeatures(),BT.disable(this),this.updateUIClasses({mouse:Kt.cursors.ADD}),this.activateUIButton(Kt.types.POLYGON),this.setActionableState({trash:!0}),{initialRadiusInKm:e.initialRadiusInKm||UT,polygon:t,currentVertexPosition:0}};jl.clickAnywhere=function(e,t){if(e.currentVertexPosition===0){e.currentVertexPosition++;const r=[t.lngLat.lng,t.lngLat.lat],n=DT(r,e.initialRadiusInKm);e.polygon.incomingCoords(n.geometry.coordinates),e.polygon.properties.center=r,e.polygon.properties.radiusInKm=e.initialRadiusInKm}return this.changeMode(Kt.modes.SIMPLE_SELECT,{featureIds:[e.polygon.id]})};var kT={enable(e){setTimeout(()=>{!e.map||!e.map.dragPan||!e._ctx||!e._ctx.store||!e._ctx.store.getInitialConfigValue||e._ctx.store.getInitialConfigValue("dragPan")&&e.map.dragPan.enable()},0)},disable(e){setTimeout(()=>{!e.map||!e.map.doubleClickZoom||e.map.dragPan.disable()},0)}};const Gl=mi(mp);var Wi={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.earthRadius=63710088e-1,e.factors={centimeters:e.earthRadius*100,centimetres:e.earthRadius*100,degrees:e.earthRadius/111325,feet:e.earthRadius*3.28084,inches:e.earthRadius*39.37,kilometers:e.earthRadius/1e3,kilometres:e.earthRadius/1e3,meters:e.earthRadius,metres:e.earthRadius,miles:e.earthRadius/1609.344,millimeters:e.earthRadius*1e3,millimetres:e.earthRadius*1e3,nauticalmiles:e.earthRadius/1852,radians:1,yards:e.earthRadius*1.0936},e.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/e.earthRadius,yards:1.0936133},e.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function t(g,b,E){E===void 0&&(E={});var x={type:"Feature"};return(E.id===0||E.id)&&(x.id=E.id),E.bbox&&(x.bbox=E.bbox),x.properties=b||{},x.geometry=g,x}e.feature=t;function r(g,b,E){switch(g){case"Point":return n(b).geometry;case"LineString":return c(b).geometry;case"Polygon":return i(b).geometry;case"MultiPoint":return v(b).geometry;case"MultiLineString":return y(b).geometry;case"MultiPolygon":return l(b).geometry;default:throw new Error(g+" is invalid")}}e.geometry=r;function n(g,b,E){if(E===void 0&&(E={}),!g)throw new Error("coordinates is required");if(!Array.isArray(g))throw new Error("coordinates must be an Array");if(g.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!O(g[0])||!O(g[1]))throw new Error("coordinates must contain numbers");var x={type:"Point",coordinates:g};return t(x,b,E)}e.point=n;function o(g,b,E){return E===void 0&&(E={}),h(g.map(function(x){return n(x,b)}),E)}e.points=o;function i(g,b,E){E===void 0&&(E={});for(var x=0,j=g;x<j.length;x++){var X=j[x];if(X.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var ge=0;ge<X[X.length-1].length;ge++)if(X[X.length-1][ge]!==X[0][ge])throw new Error("First and last Position are not equivalent.")}var xe={type:"Polygon",coordinates:g};return t(xe,b,E)}e.polygon=i;function a(g,b,E){return E===void 0&&(E={}),h(g.map(function(x){return i(x,b)}),E)}e.polygons=a;function c(g,b,E){if(E===void 0&&(E={}),g.length<2)throw new Error("coordinates must be an array of two or more positions");var x={type:"LineString",coordinates:g};return t(x,b,E)}e.lineString=c;function u(g,b,E){return E===void 0&&(E={}),h(g.map(function(x){return c(x,b)}),E)}e.lineStrings=u;function h(g,b){b===void 0&&(b={});var E={type:"FeatureCollection"};return b.id&&(E.id=b.id),b.bbox&&(E.bbox=b.bbox),E.features=g,E}e.featureCollection=h;function y(g,b,E){E===void 0&&(E={});var x={type:"MultiLineString",coordinates:g};return t(x,b,E)}e.multiLineString=y;function v(g,b,E){E===void 0&&(E={});var x={type:"MultiPoint",coordinates:g};return t(x,b,E)}e.multiPoint=v;function l(g,b,E){E===void 0&&(E={});var x={type:"MultiPolygon",coordinates:g};return t(x,b,E)}e.multiPolygon=l;function p(g,b,E){E===void 0&&(E={});var x={type:"GeometryCollection",geometries:g};return t(x,b,E)}e.geometryCollection=p;function S(g,b){if(b===void 0&&(b=0),b&&!(b>=0))throw new Error("precision must be a positive number");var E=Math.pow(10,b||0);return Math.round(g*E)/E}e.round=S;function w(g,b){b===void 0&&(b="kilometers");var E=e.factors[b];if(!E)throw new Error(b+" units is invalid");return g*E}e.radiansToLength=w;function A(g,b){b===void 0&&(b="kilometers");var E=e.factors[b];if(!E)throw new Error(b+" units is invalid");return g/E}e.lengthToRadians=A;function N(g,b){return m(A(g,b))}e.lengthToDegrees=N;function P(g){var b=g%360;return b<0&&(b+=360),b}e.bearingToAzimuth=P;function m(g){var b=g%(2*Math.PI);return b*180/Math.PI}e.radiansToDegrees=m;function I(g){var b=g%360;return b*Math.PI/180}e.degreesToRadians=I;function $(g,b,E){if(b===void 0&&(b="kilometers"),E===void 0&&(E="kilometers"),!(g>=0))throw new Error("length must be a positive number");return w(A(g,b),E)}e.convertLength=$;function L(g,b,E){if(b===void 0&&(b="meters"),E===void 0&&(E="kilometers"),!(g>=0))throw new Error("area must be a positive number");var x=e.areaFactors[b];if(!x)throw new Error("invalid original units");var j=e.areaFactors[E];if(!j)throw new Error("invalid final units");return g/x*j}e.convertArea=L;function O(g){return!isNaN(g)&&g!==null&&!Array.isArray(g)}e.isNumber=O;function F(g){return!!g&&g.constructor===Object}e.isObject=F;function f(g){if(!g)throw new Error("bbox is required");if(!Array.isArray(g))throw new Error("bbox must be an Array");if(g.length!==4&&g.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");g.forEach(function(b){if(!O(b))throw new Error("bbox must only contain numbers")})}e.validateBBox=f;function _(g){if(!g)throw new Error("id is required");if(["string","number"].indexOf(typeof g)===-1)throw new Error("id must be a number or a string")}e.validateId=_})(Wi);const qT=fn,ut=G,jT=Mt,Vl=kT,GT=Vi.default,VT=Gl.default,Wu=Wi,$e={...qT.modes.draw_polygon};$e.onSetup=function(e){const t=this.newFeature({type:ut.geojsonTypes.FEATURE,properties:{isCircle:!0,center:[]},geometry:{type:ut.geojsonTypes.POLYGON,coordinates:[[]]}});return this.addFeature(t),this.clearSelectedFeatures(),jT.disable(this),Vl.disable(this),this.updateUIClasses({mouse:ut.cursors.ADD}),this.activateUIButton(ut.types.POLYGON),this.setActionableState({trash:!0}),{polygon:t,currentVertexPosition:0}};$e.onMouseDown=$e.onTouchStart=function(e,t){e.polygon.properties.center.length===0&&(e.polygon.properties.center=[t.lngLat.lng,t.lngLat.lat])};$e.onDrag=$e.onMouseMove=function(e,t){const r=e.polygon.properties.center;if(r.length>0){const n=VT(Wu.point(r),Wu.point([t.lngLat.lng,t.lngLat.lat]),{units:"kilometers"}),o=GT(r,n);e.polygon.incomingCoords(o.geometry.coordinates),e.polygon.properties.radiusInKm=n}};$e.onMouseUp=$e.onTouchEnd=function(e,t){return Vl.enable(this),this.changeMode(ut.modes.SIMPLE_SELECT,{featureIds:[e.polygon.id]})};$e.onClick=$e.onTap=function(e,t){e.polygon.properties.center=[]};$e.toDisplayFeatures=function(e,t,r){const n=t.properties.id===e.polygon.id;return t.properties.active=n?ut.activeStates.ACTIVE:ut.activeStates.INACTIVE,r(t)};var WT=$e;const zT=Zr;function HT(e){const{properties:t,geometry:r}=e;if(!t.user_isCircle)return null;const n=[],o=r.coordinates[0].slice(0,-1);for(let i=0;i<o.length;i+=Math.round(o.length/4))n.push(zT(t.id,o[i],`0.${i}`,!1));return n}var Wl=HT;const KT=fn,JT=Xr,YT=cn,Vr=G,ZT=ji,XT=Gl.default,zu=Wi,QT=Vi.default,eS=Wl,pn=KT.modes.direct_select;pn.dragFeature=function(e,t,r){YT(this.getSelected(),r),this.getSelected().filter(n=>n.properties.isCircle).map(n=>n.properties.center).forEach(n=>{n[0]+=r.lng,n[1]+=r.lat}),e.dragMoveLocation=t.lngLat};pn.dragVertex=function(e,t,r){if(e.feature.properties.isCircle){const n=e.feature.properties.center,o=[t.lngLat.lng,t.lngLat.lat],i=XT(zu.point(n),zu.point(o),{units:"kilometers"}),a=QT(n,i);e.feature.incomingCoords(a.geometry.coordinates),e.feature.properties.radiusInKm=i}else{const n=e.selectedCoordPaths.map(a=>e.feature.getCoordinate(a)),o=n.map(a=>({type:Vr.geojsonTypes.FEATURE,properties:{},geometry:{type:Vr.geojsonTypes.POINT,coordinates:a}})),i=ZT(o,r);for(let a=0;a<n.length;a++){const c=n[a];e.feature.updateCoordinate(e.selectedCoordPaths[a],c[0]+i.lng,c[1]+i.lat)}}};pn.toDisplayFeatures=function(e,t,r){e.featureId===t.properties.id?(t.properties.active=Vr.activeStates.ACTIVE,r(t),(t.properties.user_isCircle?eS(t):JT(t,{map:this.map,midpoints:!0,selectedPaths:e.selectedCoordPaths})).forEach(r)):(t.properties.active=Vr.activeStates.INACTIVE,r(t)),this.fireActionable(e)};var tS=pn;const rS=fn,nS=Xr,oS=cn,Er=G,iS=Wl,zi=rS.modes.simple_select;zi.dragMove=function(e,t){e.dragMoving=!0,t.originalEvent.stopPropagation();const r={lng:t.lngLat.lng-e.dragMoveLocation.lng,lat:t.lngLat.lat-e.dragMoveLocation.lat};oS(this.getSelected(),r),this.getSelected().filter(n=>n.properties.isCircle).map(n=>n.properties.center).forEach(n=>{n[0]+=r.lng,n[1]+=r.lat}),e.dragMoveLocation=t.lngLat};zi.toDisplayFeatures=function(e,t,r){if(t.properties.active=this.isSelected(t.properties.id)?Er.activeStates.ACTIVE:Er.activeStates.INACTIVE,r(t),this.fireActionable(),t.properties.active!==Er.activeStates.ACTIVE||t.geometry.type===Er.geojsonTypes.POINT)return;(t.properties.user_isCircle?iS(t):nS(t)).forEach(r)};var aS=zi;const sS=WT,St=tS,uS=aS,cS={onSetup:function(e){const t=this.newFeature({type:"Feature",properties:{isRectangle:!0},geometry:{type:"Polygon",coordinates:[[[0,0],[0,0],[0,0],[0,0],[0,0]]]}});return this.addFeature(t),this.clearSelectedFeatures(),this.updateUIClasses({mouse:"add"}),this.activateUIButton("polygon"),this.setActionableState({trash:!0}),this.map&&this.map.dragPan&&this.map.dragPan.disable(),{polygon:t,startPoint:null}},onStop:function(e){this.updateUIClasses({mouse:"none"}),this.activateUIButton(),this.setActionableState({trash:!0}),this.map&&this.map.dragPan&&this.map.dragPan.enable()},onMouseDown:function(e,t){t.originalEvent&&(t.originalEvent.preventDefault(),t.originalEvent.stopPropagation()),e.startPoint=[t.lngLat.lng,t.lngLat.lat],this.updateFeature(e,t)},onDrag:function(e,t){e.startPoint&&this.updateFeature(e,t)},onMouseUp:function(e,t){e.startPoint&&(this.updateFeature(e,t),this.map.fire("draw.create",{features:[e.polygon.toGeoJSON()]}),this.changeMode("simple_select",{featureIds:[e.polygon.id]}))},updateFeature:function(e,t){const r=e.startPoint,n=[t.lngLat.lng,t.lngLat.lat],o=Math.min(r[0],n[0]),i=Math.max(r[0],n[0]),a=Math.min(r[1],n[1]),c=Math.max(r[1],n[1]),u=[[o,c],[i,c],[i,a],[o,a],[o,c]];e.polygon.incomingCoords([u])},toDisplayFeatures:function(e,t,r){const n=t.properties.id===e.polygon.id;if(t.properties.active=n?"true":"false",!n)return r(t);t.geometry.coordinates.length!==0&&r(t)},onTrash:function(e){this.deleteFeature(e.polygon.id,{silent:!0}),this.changeMode("simple_select")}},lS={...St,isRectangle:function(e){if(e&&e.properties&&(e.properties.isRectangle===!0||e.properties.isRectangle==="true"))return!0;if(e&&e.geometry&&e.geometry.type==="Polygon"&&e.geometry.coordinates.length>0){const t=e.geometry.coordinates[0];if(t.length!==5)return!1;const r=t.slice(0,4).map(a=>a[0]),n=t.slice(0,4).map(a=>a[1]),o=new Set(r.map(a=>a.toFixed(5))).size,i=new Set(n.map(a=>a.toFixed(5))).size;return o<=2&&i<=2}return!1},onDrag:function(e,t){const{featureId:r,coordPath:n}=e,o=this.getFeature(r);if(!this.isRectangle(o))return St.onDrag.call(this,e,t);if(n){const i=n.split("."),a=parseInt(i[0],10),c=parseInt(i[1],10);if(a===0&&c>=0&&c<=3){const u=o.coordinates[0];if(!u||u.length!==5)return St.onDrag.call(this,e,t);const h=t.lngLat.lng,y=t.lngLat.lat,v=(c+2)%4,l=u[v];if(!l)return St.onDrag.call(this,e,t);const p=Math.min(h,l[0]),S=Math.max(h,l[0]),w=Math.min(y,l[1]),A=Math.max(y,l[1]),N=[[p,A],[S,A],[S,w],[p,w],[p,A]];o.incomingCoords([N]);return}}St.onDrag.call(this,e,t)},toDisplayFeatures:function(e,t,r){const n=this.getFeature(e.featureId);this.isRectangle(n)&&t.properties.meta==="midpoint"||St.toDisplayFeatures.call(this,e,t,r)}};function fS({currentMode:e,onModeChange:t,onDelete:r,canDelete:n}){const o=[{id:"simple_select",icon:op,title:"Select (Pointer)"},{id:"add_waypoint",icon:ip,title:"Add Waypoint"},{id:"draw_rectangle",icon:ap,title:"Draw Square"},{id:"draw_polygon",icon:sp,title:"Draw Polygon"},{id:"drag_circle",icon:up,title:"Draw Circle"}];return we.jsxs("div",{className:"absolute top-4 left-4 flex flex-col gap-2 bg-white rounded-md shadow-md p-1 z-10",children:[o.map(i=>{const a=i.icon,c=e===i.id||i.id==="simple_select"&&e==="direct_select";return we.jsx("button",{onClick:()=>{console.log("Switching to mode:",i.id),t(i.id)},className:`p-2 rounded hover:bg-gray-100 flex items-center justify-center ${c?"text-blue-600 bg-blue-50":"text-gray-700"}`,title:i.title,children:we.jsx(a,{size:20})},i.id)}),we.jsx("div",{className:"h-px bg-gray-200 my-1"}),we.jsx("button",{onClick:r,disabled:!n,className:`p-2 rounded flex items-center justify-center ${n?"text-red-600 hover:bg-red-50 cursor-pointer":"text-gray-300 cursor-not-allowed"}`,title:"Delete Selected",children:we.jsx(cp,{size:20})})]})}wr.accessToken="pk.eyJ1Ijoid2F5Z2VuIiwiYSI6ImNtaThyMXF2czBmZ3QybXBvbW1hazFpamcifQ.P0D5plS_fpnx3qheQytxfQ";const pS="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`
<svg width="40" height="40" viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg">
  <path d="M20 0 L35 20 A 15 15 0 0 1 5 20 Z" fill="#3b82f6" stroke="white" stroke-width="2"/>
</svg>
`),dS="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`
<svg width="40" height="40" viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg">
  <path d="M20 0 L35 20 A 15 15 0 0 1 5 20 Z" fill="#ef4444" stroke="white" stroke-width="2"/>
</svg>
`),hS=[{id:"gl-draw-line",type:"line",filter:["all",["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3b82f6","line-width":2}},{id:"gl-draw-polygon-fill",type:"fill",filter:["all",["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#3b82f6","fill-outline-color":"#3b82f6","fill-opacity":.2}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3b82f6","line-width":2}},{id:"gl-draw-point-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":6,"circle-color":"#fff"}},{id:"gl-draw-point",type:"circle",filter:["all",["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":4,"circle-color":"#3b82f6"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","$type","Polygon"],["==","mode","static"]],paint:{"fill-color":"#000","fill-outline-color":"#000","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","$type","Polygon"],["==","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#000","line-width":2}}];function TS({onPolygonDrawn:e}){const t=ae.useRef(null),r=ae.useRef(null),n=ae.useRef(null),{waypoints:o,selectedIds:i,selectWaypoint:a,setSelectedIds:c,resetTrigger:u,settings:h,updateWaypoint:y,addWaypoint:v,setMapRef:l}=Fe(),p=ae.useRef(null),[S,w]=ae.useState("simple_select"),A=ae.useRef(S);ae.useEffect(()=>{A.current=S},[S]),ae.useEffect(()=>{u>0&&n.current&&(n.current.deleteAll(),e(null))},[u,e]);const[N,P]=ae.useState(null),[m,I]=ae.useState(!1),$=ae.useRef(null);ae.useEffect(()=>{if(!n.current||!r.current)return;const F=n.current.getSelectedIds();if(F.length===0)return;const f=n.current.get(F[0]);if(!f||f.geometry.type!=="Polygon")return;const _=Sn(f),g=_n(_,En(f.geometry.coordinates[0][0]),{units:"meters"});if(Math.abs(g-h.orbitRadius)>1){const b=ha(_.geometry.coordinates,h.orbitRadius,{steps:64,units:"meters"});b.id=f.id,b.properties={...f.properties,isCircle:!0},n.current.add(b),e(b)}},[h.orbitRadius]);const L=F=>{if(!F||F.geometry.type!=="Polygon")return;const f=Sn(F),_=_n(f,En(F.geometry.coordinates[0][0]),{units:"meters"});Math.abs(_-h.orbitRadius)>1&&Fe.getState().updateSettings({orbitRadius:Math.round(_)})};ae.useEffect(()=>{if(r.current)return;r.current=new wr.Map({container:t.current,style:"mapbox://styles/mapbox/satellite-streets-v12",center:[-98,39],zoom:4,boxZoom:!1});const F=new fp({accessToken:wr.accessToken,mapboxgl:wr,marker:!1,collapsed:!0});r.current.addControl(F,"top-right"),l(r.current),n.current=new da({userProperties:!0,displayControlsDefault:!1,controls:{point:!1,line:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1},styles:hS,modes:{...da.modes,drag_circle:sS,draw_rectangle:cS,direct_select:lS,simple_select:uS}}),r.current.addControl(n.current),window.mapboxDraw=n.current,r.current.on("draw.create",B=>{const M=B.features[0];n.current.getMode()==="drag_circle"&&(n.current.setFeatureProperty(M.id,"isCircle",!0),M.properties.isCircle=!0,Fe.getState().updateSettings({pathType:"orbit",spacing:10})),(M.properties.isRectangle||n.current.getMode()==="draw_rectangle")&&(n.current.setFeatureProperty(M.id,"isRectangle",!0),M.properties.isRectangle=!0);const k=Sn(M);if(_n(k,En(M.geometry.coordinates[0][0]),{units:"meters"})>500){const te=ha(k.geometry.coordinates,50,{steps:64,units:"meters"});te.id=M.id,te.properties={...M.properties,isCircle:!0},n.current.add(te),Fe.getState().updateSettings({orbitRadius:50}),e(te)}else L(M),e(M);w("simple_select")}),r.current.on("draw.update",B=>{const M=B.features[0];L(M),e(M)}),r.current.on("draw.selectionchange",B=>{B.features.length>0?(L(B.features[0]),e(B.features[0]),I(!0)):(e(null),I(!1))}),r.current.on("draw.delete",()=>e(null)),r.current.on("click",B=>{if(B.originalEvent._isDrag)return;if(A.current==="add_waypoint"){const{lng:k,lat:q}=B.lngLat;v({lng:k,lat:q});return}const M=r.current.queryRenderedFeatures(B.point,{layers:["waypoints-symbol"]});if(M.length){const k=M[0].properties.id;a(k,B.originalEvent.shiftKey)}else r.current.queryRenderedFeatures(B.point,{layers:["gl-draw-polygon-fill-static.cold","gl-draw-polygon-fill.hot"]}).length===0&&c([])});const f=B=>{if(!$.current)return;const M=$.current,k=B.point,q=Math.min(M.x,k.x),te=Math.max(M.x,k.x),R=Math.min(M.y,k.y),fe=Math.max(M.y,k.y);P({left:q,top:R,width:te-q,height:fe-R})},_=B=>{if(!$.current)return;const M=$.current,k=B.point;if(Math.abs(M.x-k.x)<5&&Math.abs(M.y-k.y)<5){$.current=null,P(null),r.current.dragPan.enable(),r.current.off("mousemove",f),r.current.off("mouseup",_);return}const q=[M,k],R=r.current.queryRenderedFeatures(q,{layers:["waypoints-symbol"]}).map(fe=>fe.properties.id);R.length>0&&c(R),$.current=null,P(null),r.current.dragPan.enable(),B.originalEvent._isDrag=!0,setTimeout(()=>{B.originalEvent&&delete B.originalEvent._isDrag},100),r.current.off("mousemove",f),r.current.off("mouseup",_)};r.current.on("mousedown",B=>{B.originalEvent.shiftKey&&(B.preventDefault(),r.current.dragPan.disable(),$.current=B.point,r.current.on("mousemove",f),r.current.on("mouseup",_))});const g=()=>{p.current||(r.current.getCanvas().style.cursor="pointer")},b=()=>{p.current||(r.current.getCanvas().style.cursor="")},E=B=>{if(n.current.getMode()!=="simple_select"&&n.current.getMode()!=="direct_select"||B.originalEvent.shiftKey||!B.originalEvent.altKey)return;B.preventDefault();const M=B.features[0];M&&(r.current.dragPan.disable(),r.current.getCanvas().style.cursor="grabbing",p.current={id:M.properties.id,initialLngLat:M.geometry.coordinates},r.current.on("mousemove",x),r.current.on("mouseup",j))},x=B=>{if(!p.current)return;const{lng:M,lat:k}=B.lngLat,q=r.current.getSource("waypoints"),te=r.current.getSource("mission-path"),R=Fe.getState().waypoints,fe=Fe.getState().selectedIds,ye=R.map((ee,_e)=>{const We=ee.id===p.current.id;return{type:"Feature",properties:{id:ee.id,index:_e+1,selected:fe.includes(ee.id),heading:ee.heading||0},geometry:{type:"Point",coordinates:We?[M,k]:[ee.lng,ee.lat]}}});if(q&&q.setData({type:"FeatureCollection",features:ye}),te){const ee=ye.map(_e=>_e.geometry.coordinates);te.setData({type:"Feature",geometry:{type:"LineString",coordinates:ee}})}},j=B=>{if(!p.current)return;const{lng:M,lat:k}=B.lngLat,{id:q}=p.current;Fe.getState().updateWaypoint(q,{lng:M,lat:k}),p.current=null,r.current.dragPan.enable(),r.current.getCanvas().style.cursor="",B.originalEvent._isDrag=!0,r.current.off("mousemove",x),r.current.off("mouseup",j)};r.current.on("mouseenter","waypoints-symbol",g),r.current.on("mouseleave","waypoints-symbol",b),r.current.on("mousedown","waypoints-symbol",E);const X=B=>{console.log("MapContainer received restore-polygon event",B.detail);const M=B.detail;if(!M||!n.current){console.error("Cannot restore polygon: Missing data or draw instance",{polygon:M,draw:!!n.current});return}try{n.current.deleteAll();const k=n.current.add(M);console.log("Restored polygon with IDs:",k),e(M);const q=bp(M);r.current.fitBounds(q,{padding:50})}catch(k){console.error("Error adding polygon to draw:",k)}};window.addEventListener("waygen:restore-polygon",X);const ge=()=>{console.log("Initializing Map Layers...");const B=(q,te)=>{if(r.current.hasImage(q))return;const R=new Image;R.src=te,R.onload=()=>{r.current.hasImage(q)||r.current.addImage(q,R)}};B("teardrop",pS),B("teardrop-selected",dS),r.current.getSource("mission-path")||r.current.addSource("mission-path",{type:"geojson",data:{type:"Feature",geometry:{type:"LineString",coordinates:[]}}}),r.current.getSource("footprints")||r.current.addSource("footprints",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),r.current.getSource("waypoints")||r.current.addSource("waypoints",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),r.current.getLayer("footprints-fill")||r.current.addLayer({id:"footprints-fill",type:"fill",source:"footprints",paint:{"fill-color":["get","color"],"fill-opacity":.15,"fill-outline-color":"rgba(0,0,0,0)"}}),r.current.getLayer("footprints-outline")||r.current.addLayer({id:"footprints-outline",type:"line",source:"footprints",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":["get","color"],"line-width":1,"line-opacity":.6}}),r.current.getLayer("mission-path-line")||r.current.addLayer({id:"mission-path-line",type:"line",source:"mission-path",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#3b82f6","line-width":3,"line-opacity":.8}}),r.current.getLayer("waypoints-symbol")||r.current.addLayer({id:"waypoints-symbol",type:"symbol",source:"waypoints",layout:{"icon-image":["case",["get","selected"],"teardrop-selected","teardrop"],"icon-size":["interpolate",["linear"],["zoom"],10,.5,15,.75,20,1],"icon-anchor":"center","icon-allow-overlap":!0,"icon-rotate":["get","heading"],"icon-rotation-alignment":"map","text-field":["to-string",["get","index"]],"text-font":["Open Sans Bold","Arial Unicode MS Bold"],"text-size":["interpolate",["linear"],["zoom"],10,9,15,11,20,13],"text-offset":[0,0],"text-anchor":"center","text-allow-overlap":!0,"text-rotation-alignment":"viewport"},paint:{"text-color":"#ffffff","text-halo-color":"#000000","text-halo-width":.5}});const M=Fe.getState().waypoints,k=Fe.getState().selectedIds;if(M.length>0){console.log("Initial waypoints found, updating source...",M.length);const q=M.map((R,fe)=>({type:"Feature",properties:{id:R.id,index:fe+1,selected:k.includes(R.id),heading:R.heading||0},geometry:{type:"Point",coordinates:[R.lng,R.lat]}}));r.current.getSource("waypoints").setData({type:"FeatureCollection",features:q});const te=M.map(R=>[R.lng,R.lat]);r.current.getSource("mission-path").setData({type:"Feature",geometry:{type:"LineString",coordinates:te}})}};r.current.loaded()?ge():r.current.on("load",ge);const xe=B=>{A.current==="add_waypoint"&&B.mode==="simple_select"||w(B.mode)};r.current.on("draw.modechange",xe);const yt=B=>{B.key==="Escape"&&(A.current!=="simple_select"?(n.current&&n.current.changeMode("simple_select"),w("simple_select")):c([]))};return window.addEventListener("keydown",yt),()=>{window.removeEventListener("waygen:restore-polygon",X),window.removeEventListener("keydown",yt)}},[]),ae.useEffect(()=>{if(!n.current||!r.current)return;const F=S,f=n.current.getMode();if(F==="add_waypoint")f!=="simple_select"&&n.current.changeMode("simple_select"),r.current.getCanvas().style.cursor="crosshair";else{if(f!==F)try{n.current.changeMode(F)}catch(_){console.warn("Failed to switch mode:",_)}r.current.getCanvas().style.cursor=""}},[S]),ae.useEffect(()=>{!r.current||!r.current.getLayer("waypoints-symbol")||(r.current.setLayoutProperty("waypoints-symbol","text-offset",[0,0]),r.current.setLayoutProperty("waypoints-symbol","text-anchor","center"),r.current.setLayoutProperty("waypoints-symbol","icon-anchor","center"),r.current.setLayoutProperty("waypoints-symbol","text-rotation-alignment","viewport"))},[]),ae.useEffect(()=>{if(!r.current||!r.current.loaded())return;const F=r.current.getSource("waypoints"),f=r.current.getSource("mission-path");if(F){const _=o.map((g,b)=>({type:"Feature",properties:{id:g.id,index:b+1,selected:i.includes(g.id),heading:g.heading||0},geometry:{type:"Point",coordinates:[g.lng,g.lat]}}));F.setData({type:"FeatureCollection",features:_})}if(f){const _=o.map(g=>[g.lng,g.lat]);f.setData({type:"Feature",geometry:{type:"LineString",coordinates:_}})}},[o,i]),ae.useEffect(()=>{if(!r.current||!r.current.getSource("footprints"))return;if(!h.showFootprints){r.current.getSource("footprints").setData({type:"FeatureCollection",features:[]});return}const F=o.map((f,_)=>{const g=f.heading||0;return{...np({lng:f.lng,lat:f.lat},h.altitude,g,h.customFOV),properties:{index:_+1,color:h.footprintColor}}}).filter(f=>f!==null);r.current.getSource("footprints").setData({type:"FeatureCollection",features:F})},[o,h.showFootprints,h.altitude,h.customFOV,h.footprintColor]),ae.useEffect(()=>{h.orbitRadius>500&&Fe.getState().updateSettings({orbitRadius:50})},[]);const O=()=>{n.current&&(n.current.trash(),e(null),I(!1))};return we.jsxs("div",{className:`relative w-full h-full ${S==="add_waypoint"?"force-crosshair":""}`,children:[we.jsx("style",{children:`
        .force-crosshair .mapboxgl-canvas-container {
          cursor: crosshair !important;
        }
        .force-crosshair .mapboxgl-canvas {
          cursor: crosshair !important;
        }
      `}),we.jsx("div",{ref:t,className:"w-full h-full"}),N&&we.jsx("div",{style:{position:"absolute",left:N.left,top:N.top,width:N.width,height:N.height,border:"2px solid #3b82f6",backgroundColor:"rgba(59, 130, 246, 0.2)",pointerEvents:"none",zIndex:20}}),we.jsx(fS,{currentMode:S,onModeChange:w,onDelete:O,canDelete:m})]})}export{TS as default};
