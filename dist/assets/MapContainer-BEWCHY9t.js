import{j as ne,u as _e,c as np}from"./index-CcgSXAA2.js";import{i as op,j as ip,k as ap,H as sp,l as up,T as cp,r as re,m as lp,M as fp,n as pp}from"./vendor-DRMOV0oM.js";import{b as dp,i as Ei,d as Zu,g as wi,m as Fr,M as hp,e as va}from"./mapbox-C3udIXGP.js";import{k as V,s as pt,n as Zr,o as It,q as Xe,r as j,_ as $t,u as Ct,v as Ai,w as Q,x as dt,y as Ot,z as Xu,A as Ve,B as yp,C as Qu,D as gp,E as ec,F as vp,G as tc,H as nr,I as rc,J as nc,K as mp,L as oc,M as bp,N as Tp,O as Sp,e as $n,b as Cn,p as On,P as ma,f as _p}from"./turf-D8sFHwPo.js";import{c as Ep}from"./utils-P9aiU5u9.js";/* empty css                           */var Ii={exports:{}};const wp=function(e,t){const r={drag:[],click:[],mousemove:[],mousedown:[],mouseup:[],mouseout:[],keydown:[],keyup:[],touchstart:[],touchmove:[],touchend:[],tap:[]},n={on:function(i,a,c){if(r[i]===void 0)throw new Error(`Invalid event type: ${i}`);r[i].push({selector:a,fn:c})},render:function(i){t.store.featureChanged(i)}},o=function(i,a){const c=r[i];let u=c.length;for(;u--;){const y=c[u];if(y.selector(a)){y.fn.call(n,a),t.store.render(),t.ui.updateMapClasses();break}}};return e.start.call(n),{render:e.render,stop:function(){e.stop&&e.stop()},trash:function(){e.trash&&(e.trash(),t.store.render())},combineFeatures:function(){e.combineFeatures&&e.combineFeatures()},uncombineFeatures:function(){e.uncombineFeatures&&e.uncombineFeatures()},drag:function(i){o("drag",i)},click:function(i){o("click",i)},mousemove:function(i){o("mousemove",i)},mousedown:function(i){o("mousedown",i)},mouseup:function(i){o("mouseup",i)},mouseout:function(i){o("mouseout",i)},keydown:function(i){o("keydown",i)},keyup:function(i){o("keyup",i)},touchstart:function(i){o("touchstart",i)},touchmove:function(i){o("touchmove",i)},touchend:function(i){o("touchend",i)},tap:function(i){o("tap",i)}}};var Ap=wp,G={classes:{CONTROL_BASE:"mapboxgl-ctrl",CONTROL_BUTTON:"mapbox-gl-draw_ctrl-draw-btn",CONTROL_BUTTON_LINE:"mapbox-gl-draw_line",CONTROL_BUTTON_POLYGON:"mapbox-gl-draw_polygon",CONTROL_BUTTON_POINT:"mapbox-gl-draw_point",CONTROL_BUTTON_TRASH:"mapbox-gl-draw_trash",CONTROL_BUTTON_COMBINE_FEATURES:"mapbox-gl-draw_combine",CONTROL_BUTTON_UNCOMBINE_FEATURES:"mapbox-gl-draw_uncombine",CONTROL_GROUP:"mapboxgl-ctrl-group",ACTIVE_BUTTON:"active",BOX_SELECT:"mapbox-gl-draw_boxselect"},sources:{HOT:"mapbox-gl-draw-hot",COLD:"mapbox-gl-draw-cold"},cursors:{ADD:"add",MOVE:"move",DRAG:"drag",POINTER:"pointer",NONE:"none"},types:{POLYGON:"polygon",LINE:"line_string",POINT:"point"},geojsonTypes:{FEATURE:"Feature",POLYGON:"Polygon",LINE_STRING:"LineString",POINT:"Point",FEATURE_COLLECTION:"FeatureCollection",MULTI_PREFIX:"Multi",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon"},modes:{DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select",STATIC:"static"},events:{CREATE:"draw.create",DELETE:"draw.delete",UPDATE:"draw.update",SELECTION_CHANGE:"draw.selectionchange",MODE_CHANGE:"draw.modechange",ACTIONABLE:"draw.actionable",RENDER:"draw.render",COMBINE_FEATURES:"draw.combine",UNCOMBINE_FEATURES:"draw.uncombine"},updateActions:{MOVE:"move",CHANGE_COORDINATES:"change_coordinates"},meta:{FEATURE:"feature",MIDPOINT:"midpoint",VERTEX:"vertex"},activeStates:{ACTIVE:"true",INACTIVE:"false"},interactions:["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate"],LAT_MIN:-90,LAT_RENDERED_MIN:-85,LAT_MAX:90,LAT_RENDERED_MAX:85,LNG_MIN:-270,LNG_MAX:270};const Ip=dp,ri=G,ba={Point:0,LineString:1,Polygon:2};function $p(e,t){const r=ba[e.geometry.type]-ba[t.geometry.type];return r===0&&e.geometry.type===ri.geojsonTypes.POLYGON?e.area-t.area:r}function Cp(e){return e.map(t=>(t.geometry.type===ri.geojsonTypes.POLYGON&&(t.area=Ip.geometry({type:ri.geojsonTypes.FEATURE,property:{},geometry:t.geometry})),t)).sort($p).map(t=>(delete t.area,t))}var Op=Cp;function Fp(e,t=0){return[[e.point.x-t,e.point.y-t],[e.point.x+t,e.point.y+t]]}var Pp=Fp;function Ft(e){if(this._items={},this._nums={},this._length=e?e.length:0,!!e)for(let t=0,r=e.length;t<r;t++)this.add(e[t]),e[t]!==void 0&&(typeof e[t]=="string"?this._items[e[t]]=t:this._nums[e[t]]=t)}Ft.prototype.add=function(e){return this.has(e)?this:(this._length++,typeof e=="string"?this._items[e]=this._length:this._nums[e]=this._length,this)};Ft.prototype.delete=function(e){return this.has(e)===!1?this:(this._length--,delete this._items[e],delete this._nums[e],this)};Ft.prototype.has=function(e){return typeof e!="string"&&typeof e!="number"?!1:this._items[e]!==void 0||this._nums[e]!==void 0};Ft.prototype.values=function(){const e=[];return Object.keys(this._items).forEach(t=>{e.push({k:t,v:this._items[t]})}),Object.keys(this._nums).forEach(t=>{e.push({k:JSON.parse(t),v:this._nums[t]})}),e.sort((t,r)=>t.v-r.v).map(t=>t.k)};Ft.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this};var Xr=Ft;const Mp=Op,Lp=Pp,Fn=G,xp=Xr,Np=[Fn.meta.FEATURE,Fn.meta.MIDPOINT,Fn.meta.VERTEX];var Qr={click:Rp,touch:Bp};function Rp(e,t,r){return ic(e,t,r,r.options.clickBuffer)}function Bp(e,t,r){return ic(e,t,r,r.options.touchBuffer)}function ic(e,t,r,n){if(r.map===null)return[];const o=e?Lp(e,n):t,i={};r.options.styles&&(i.layers=r.options.styles.map(y=>y.id));const a=r.map.queryRenderedFeatures(o,i).filter(y=>Np.indexOf(y.properties.meta)!==-1),c=new xp,u=[];return a.forEach(y=>{const h=y.properties.id;c.has(h)||(c.add(h),u.push(y))}),Mp(u)}const Dp=Qr,Jt=G;var Up=function(t,r){const n=Dp.click(t,null,r),o={mouse:Jt.cursors.NONE};return n[0]&&(o.mouse=n[0].properties.active===Jt.activeStates.ACTIVE?Jt.cursors.MOVE:Jt.cursors.POINTER,o.feature=n[0].properties.meta),r.events.currentModeName().indexOf("draw")!==-1&&(o.mouse=Jt.cursors.ADD),r.ui.queueMapClasses(o),r.ui.updateMapClasses(),n[0]},ac=function(e,t){const r=e.x-t.x,n=e.y-t.y;return Math.sqrt(r*r+n*n)};const kp=ac,jp=4,qp=12,Gp=500;var Vp=function(t,r,n={}){const o=n.fineTolerance!=null?n.fineTolerance:jp,i=n.grossTolerance!=null?n.grossTolerance:qp,a=n.interval!=null?n.interval:Gp;t.point=t.point||r.point,t.time=t.time||r.time;const c=kp(t.point,r.point);return c<o||c<i&&r.time-t.time<a};const Wp=ac,zp=25,Hp=250;var Kp=function(t,r,n={}){const o=n.tolerance!=null?n.tolerance:zp,i=n.interval!=null?n.interval:Hp;return t.point=t.point||r.point,t.time=t.time||r.time,Wp(t.point,r.point)<o&&r.time-t.time<i},sc={exports:{}},uc={exports:{}},cc={exports:{}},ni=cc.exports=function(e,t){if(t||(t=16),e===void 0&&(e=128),e<=0)return"0";for(var r=Math.log(Math.pow(2,e))/Math.log(t),n=2;r===1/0;n*=2)r=Math.log(Math.pow(2,e/n))/Math.log(t)*n;for(var o=r-Math.floor(r),i="",n=0;n<Math.floor(r);n++){var a=Math.floor(Math.random()*t).toString(t);i=a+i}if(o){var c=Math.pow(t,o),a=Math.floor(Math.random()*c).toString(t);i=a+i}var u=parseInt(i,t);return u!==1/0&&u>=Math.pow(2,e)?ni(e,t):i};ni.rack=function(e,t,r){var n=function(i){var a=0;do{if(a++>10)if(r)e+=r;else throw new Error("too many ID collisions, use more bits");var c=ni(e,t)}while(Object.hasOwnProperty.call(o,c));return o[c]=i,c},o=n.hats={};return n.get=function(i){return n.hats[i]},n.set=function(i,a){return n.hats[i]=a,n},n.bits=e||128,n.base=t||16,n};var $i=cc.exports;const Jp=$i,Pr=G,Qe=function(e,t){this.ctx=e,this.properties=t.properties||{},this.coordinates=t.geometry.coordinates,this.id=t.id||Jp(),this.type=t.geometry.type};Qe.prototype.changed=function(){this.ctx.store.featureChanged(this.id)};Qe.prototype.incomingCoords=function(e){this.setCoordinates(e)};Qe.prototype.setCoordinates=function(e){this.coordinates=e,this.changed()};Qe.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.coordinates))};Qe.prototype.setProperty=function(e,t){this.properties[e]=t};Qe.prototype.toGeoJSON=function(){return JSON.parse(JSON.stringify({id:this.id,type:Pr.geojsonTypes.FEATURE,properties:this.properties,geometry:{coordinates:this.getCoordinates(),type:this.type}}))};Qe.prototype.internal=function(e){const t={id:this.id,meta:Pr.meta.FEATURE,"meta:type":this.type,active:Pr.activeStates.INACTIVE,mode:e};if(this.ctx.options.userProperties)for(const r in this.properties)t[`user_${r}`]=this.properties[r];return{type:Pr.geojsonTypes.FEATURE,properties:t,geometry:{coordinates:this.getCoordinates(),type:this.type}}};var en=Qe;const lc=en,or=function(e,t){lc.call(this,e,t)};or.prototype=Object.create(lc.prototype);or.prototype.isValid=function(){return typeof this.coordinates[0]=="number"&&typeof this.coordinates[1]=="number"};or.prototype.updateCoordinate=function(e,t,r){arguments.length===3?this.coordinates=[t,r]:this.coordinates=[e,t],this.changed()};or.prototype.getCoordinate=function(){return this.getCoordinates()};var Ci=or;const fc=en,ht=function(e,t){fc.call(this,e,t)};ht.prototype=Object.create(fc.prototype);ht.prototype.isValid=function(){return this.coordinates.length>1};ht.prototype.addCoordinate=function(e,t,r){this.changed();const n=parseInt(e,10);this.coordinates.splice(n,0,[t,r])};ht.prototype.getCoordinate=function(e){const t=parseInt(e,10);return JSON.parse(JSON.stringify(this.coordinates[t]))};ht.prototype.removeCoordinate=function(e){this.changed(),this.coordinates.splice(parseInt(e,10),1)};ht.prototype.updateCoordinate=function(e,t,r){const n=parseInt(e,10);this.coordinates[n]=[t,r],this.changed()};var Oi=ht;const pc=en,De=function(e,t){pc.call(this,e,t),this.coordinates=this.coordinates.map(r=>r.slice(0,-1))};De.prototype=Object.create(pc.prototype);De.prototype.isValid=function(){return this.coordinates.length===0?!1:this.coordinates.every(e=>e.length>2)};De.prototype.incomingCoords=function(e){this.coordinates=e.map(t=>t.slice(0,-1)),this.changed()};De.prototype.setCoordinates=function(e){this.coordinates=e,this.changed()};De.prototype.addCoordinate=function(e,t,r){this.changed();const n=e.split(".").map(i=>parseInt(i,10));this.coordinates[n[0]].splice(n[1],0,[t,r])};De.prototype.removeCoordinate=function(e){this.changed();const t=e.split(".").map(n=>parseInt(n,10)),r=this.coordinates[t[0]];r&&(r.splice(t[1],1),r.length<3&&this.coordinates.splice(t[0],1))};De.prototype.getCoordinate=function(e){const t=e.split(".").map(n=>parseInt(n,10)),r=this.coordinates[t[0]];return JSON.parse(JSON.stringify(r[t[1]]))};De.prototype.getCoordinates=function(){return this.coordinates.map(e=>e.concat([e[0]]))};De.prototype.updateCoordinate=function(e,t,r){this.changed();const n=e.split("."),o=parseInt(n[0],10),i=parseInt(n[1],10);this.coordinates[o]===void 0&&(this.coordinates[o]=[]),this.coordinates[o][i]=[t,r]};var Fi=De;const dc=en,hc=G,Yp=$i,Zp={MultiPoint:Ci,MultiLineString:Oi,MultiPolygon:Fi},tn=(e,t,r,n,o)=>{const i=r.split("."),a=parseInt(i[0],10),c=i[1]?i.slice(1).join("."):null;return e[a][t](c,n,o)},Pe=function(e,t){if(dc.call(this,e,t),delete this.coordinates,this.model=Zp[t.geometry.type],this.model===void 0)throw new TypeError(`${t.geometry.type} is not a valid type`);this.features=this._coordinatesToFeatures(t.geometry.coordinates)};Pe.prototype=Object.create(dc.prototype);Pe.prototype._coordinatesToFeatures=function(e){const t=this.model.bind(this);return e.map(r=>new t(this.ctx,{id:Yp(),type:hc.geojsonTypes.FEATURE,properties:{},geometry:{coordinates:r,type:this.type.replace("Multi","")}}))};Pe.prototype.isValid=function(){return this.features.every(e=>e.isValid())};Pe.prototype.setCoordinates=function(e){this.features=this._coordinatesToFeatures(e),this.changed()};Pe.prototype.getCoordinate=function(e){return tn(this.features,"getCoordinate",e)};Pe.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.features.map(e=>e.type===hc.geojsonTypes.POLYGON?e.getCoordinates():e.coordinates)))};Pe.prototype.updateCoordinate=function(e,t,r){tn(this.features,"updateCoordinate",e,t,r),this.changed()};Pe.prototype.addCoordinate=function(e,t,r){tn(this.features,"addCoordinate",e,t,r),this.changed()};Pe.prototype.removeCoordinate=function(e){tn(this.features,"removeCoordinate",e),this.changed()};Pe.prototype.getFeatures=function(){return this.features};var Mr=Pe;const Et=G,Xp=Qr,yc=Ci,gc=Oi,vc=Fi,mc=Mr,ie=uc.exports=function(e){this.map=e.map,this.drawConfig=JSON.parse(JSON.stringify(e.options||{})),this._ctx=e};ie.prototype.setSelected=function(e){return this._ctx.store.setSelected(e)};ie.prototype.setSelectedCoordinates=function(e){this._ctx.store.setSelectedCoordinates(e),e.reduce((t,r)=>(t[r.feature_id]===void 0&&(t[r.feature_id]=!0,this._ctx.store.get(r.feature_id).changed()),t),{})};ie.prototype.getSelected=function(){return this._ctx.store.getSelected()};ie.prototype.getSelectedIds=function(){return this._ctx.store.getSelectedIds()};ie.prototype.isSelected=function(e){return this._ctx.store.isSelected(e)};ie.prototype.getFeature=function(e){return this._ctx.store.get(e)};ie.prototype.select=function(e){return this._ctx.store.select(e)};ie.prototype.deselect=function(e){return this._ctx.store.deselect(e)};ie.prototype.deleteFeature=function(e,t={}){return this._ctx.store.delete(e,t)};ie.prototype.addFeature=function(e){return this._ctx.store.add(e)};ie.prototype.clearSelectedFeatures=function(){return this._ctx.store.clearSelected()};ie.prototype.clearSelectedCoordinates=function(){return this._ctx.store.clearSelectedCoordinates()};ie.prototype.setActionableState=function(e={}){const t={trash:e.trash||!1,combineFeatures:e.combineFeatures||!1,uncombineFeatures:e.uncombineFeatures||!1};return this._ctx.events.actionable(t)};ie.prototype.changeMode=function(e,t={},r={}){return this._ctx.events.changeMode(e,t,r)};ie.prototype.updateUIClasses=function(e){return this._ctx.ui.queueMapClasses(e)};ie.prototype.activateUIButton=function(e){return this._ctx.ui.setActiveButton(e)};ie.prototype.featuresAt=function(e,t,r="click"){if(r!=="click"&&r!=="touch")throw new Error("invalid buffer type");return Xp[r](e,t,this._ctx)};ie.prototype.newFeature=function(e){const t=e.geometry.type;return t===Et.geojsonTypes.POINT?new yc(this._ctx,e):t===Et.geojsonTypes.LINE_STRING?new gc(this._ctx,e):t===Et.geojsonTypes.POLYGON?new vc(this._ctx,e):new mc(this._ctx,e)};ie.prototype.isInstanceOf=function(e,t){if(e===Et.geojsonTypes.POINT)return t instanceof yc;if(e===Et.geojsonTypes.LINE_STRING)return t instanceof gc;if(e===Et.geojsonTypes.POLYGON)return t instanceof vc;if(e==="MultiFeature")return t instanceof mc;throw new Error(`Unknown feature class: ${e}`)};ie.prototype.doRender=function(e){return this._ctx.store.featureChanged(e)};var Qp=uc.exports;const ce=sc.exports=Qp;ce.prototype.onSetup=function(){};ce.prototype.onDrag=function(){};ce.prototype.onClick=function(){};ce.prototype.onMouseMove=function(){};ce.prototype.onMouseDown=function(){};ce.prototype.onMouseUp=function(){};ce.prototype.onMouseOut=function(){};ce.prototype.onKeyUp=function(){};ce.prototype.onKeyDown=function(){};ce.prototype.onTouchStart=function(){};ce.prototype.onTouchMove=function(){};ce.prototype.onTouchEnd=function(){};ce.prototype.onTap=function(){};ce.prototype.onStop=function(){};ce.prototype.onTrash=function(){};ce.prototype.onCombineFeature=function(){};ce.prototype.onUncombineFeature=function(){};ce.prototype.toDisplayFeatures=function(){throw new Error("You must overwrite toDisplayFeatures")};var ed=sc.exports;const td=ed,bc={drag:"onDrag",click:"onClick",mousemove:"onMouseMove",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseout:"onMouseOut",keyup:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",tap:"onTap"},rd=Object.keys(bc);var nd=function(e){const t=Object.keys(e);return function(r,n={}){let o={};const i=t.reduce((c,u)=>(c[u]=e[u],c),new td(r));function a(c){return function(u){i[c](o,u)}}return{start:function(){o=i.onSetup(n),rd.forEach(c=>{const u=bc[c];let y=()=>!1;e[u]&&(y=()=>!0),this.on(c,y,a(u))})},stop:function(){i.onStop(o)},trash:function(){i.onTrash(o)},combineFeatures:function(){i.onCombineFeatures(o)},uncombineFeatures:function(){i.onUncombineFeatures(o)},render:function(c,u){i.toDisplayFeatures(o,c,u)}}}};const Ta=Ap,Pn=Up,Sa=Qr,_a=Vp,Ea=Kp,mt=G,od=nd;var id=function(e){const t=Object.keys(e.options.modes).reduce((l,f)=>(l[f]=od(e.options.modes[f]),l),{});let r={},n={};const o={};let i=null,a=null;o.drag=function(l,f){f({point:l.point,time:new Date().getTime()})?(e.ui.queueMapClasses({mouse:mt.cursors.DRAG}),a.drag(l)):l.originalEvent.stopPropagation()},o.mousedrag=function(l){o.drag(l,f=>!_a(r,f))},o.touchdrag=function(l){o.drag(l,f=>!Ea(n,f))},o.mousemove=function(l){if((l.originalEvent.buttons!==void 0?l.originalEvent.buttons:l.originalEvent.which)===1)return o.mousedrag(l);const _=Pn(l,e);l.featureTarget=_,a.mousemove(l)},o.mousedown=function(l){r={time:new Date().getTime(),point:l.point};const f=Pn(l,e);l.featureTarget=f,a.mousedown(l)},o.mouseup=function(l){const f=Pn(l,e);l.featureTarget=f,_a(r,{point:l.point,time:new Date().getTime()})?a.click(l):a.mouseup(l)},o.mouseout=function(l){a.mouseout(l)},o.touchstart=function(l){if(l.originalEvent.preventDefault(),!e.options.touchEnabled)return;n={time:new Date().getTime(),point:l.point};const f=Sa.touch(l,null,e)[0];l.featureTarget=f,a.touchstart(l)},o.touchmove=function(l){if(l.originalEvent.preventDefault(),!!e.options.touchEnabled)return a.touchmove(l),o.touchdrag(l)},o.touchend=function(l){if(l.originalEvent.preventDefault(),!e.options.touchEnabled)return;const f=Sa.touch(l,null,e)[0];l.featureTarget=f,Ea(n,{time:new Date().getTime(),point:l.point})?a.tap(l):a.touchend(l)};const c=l=>!(l===8||l===46||l>=48&&l<=57);o.keydown=function(l){(l.srcElement||l.target).classList[0]==="mapboxgl-canvas"&&((l.keyCode===8||l.keyCode===46)&&e.options.controls.trash?(l.preventDefault(),a.trash()):c(l.keyCode)?a.keydown(l):l.keyCode===49&&e.options.controls.point?u(mt.modes.DRAW_POINT):l.keyCode===50&&e.options.controls.line_string?u(mt.modes.DRAW_LINE_STRING):l.keyCode===51&&e.options.controls.polygon&&u(mt.modes.DRAW_POLYGON))},o.keyup=function(l){c(l.keyCode)&&a.keyup(l)},o.zoomend=function(){e.store.changeZoom()},o.data=function(l){if(l.dataType==="style"){const{setup:f,map:_,options:E,store:A}=e;E.styles.some(F=>_.getLayer(F.id))||(f.addLayers(),A.setDirty(),A.render())}};function u(l,f,_={}){a.stop();const E=t[l];if(E===void 0)throw new Error(`${l} is not valid`);i=l;const A=E(e,f);a=Ta(A,e),_.silent||e.map.fire(mt.events.MODE_CHANGE,{mode:l}),e.store.setDirty(),e.store.render()}const y={trash:!1,combineFeatures:!1,uncombineFeatures:!1};function h(l){let f=!1;Object.keys(l).forEach(_=>{if(y[_]===void 0)throw new Error("Invalid action type");y[_]!==l[_]&&(f=!0),y[_]=l[_]}),f&&e.map.fire(mt.events.ACTIONABLE,{actions:y})}return{start:function(){i=e.options.defaultMode,a=Ta(t[i](e),e)},changeMode:u,actionable:h,currentModeName:function(){return i},currentModeRender:function(l,f){return a.render(l,f)},fire:function(l,f){o[l]&&o[l](f)},addEventListeners:function(){e.map.on("mousemove",o.mousemove),e.map.on("mousedown",o.mousedown),e.map.on("mouseup",o.mouseup),e.map.on("data",o.data),e.map.on("touchmove",o.touchmove),e.map.on("touchstart",o.touchstart),e.map.on("touchend",o.touchend),e.container.addEventListener("mouseout",o.mouseout),e.options.keybindings&&(e.container.addEventListener("keydown",o.keydown),e.container.addEventListener("keyup",o.keyup))},removeEventListeners:function(){e.map.off("mousemove",o.mousemove),e.map.off("mousedown",o.mousedown),e.map.off("mouseup",o.mouseup),e.map.off("data",o.data),e.map.off("touchmove",o.touchmove),e.map.off("touchstart",o.touchstart),e.map.off("touchend",o.touchend),e.container.removeEventListener("mouseout",o.mouseout),e.options.keybindings&&(e.container.removeEventListener("keydown",o.keydown),e.container.removeEventListener("keyup",o.keyup))},trash:function(l){a.trash(l)},combineFeatures:function(){a.combineFeatures()},uncombineFeatures:function(){a.uncombineFeatures()},getMode:function(){return i}}},Tc={exports:{}};function ad(e,t,r){let n,o;function i(){n=!1,o&&(a.apply(r,o),o=!1)}function a(){n?o=arguments:(n=!0,e.apply(r,arguments),setTimeout(i,t))}return a}var sd=ad;function ud(e){return[].concat(e).filter(t=>t!==void 0)}var cd=ud;const xe=G;var ld=function(){const t=this;if(!(t.ctx.map&&t.ctx.map.getSource(xe.sources.HOT)!==void 0))return y();const n=t.ctx.events.currentModeName();t.ctx.ui.queueMapClasses({mode:n});let o=[],i=[];t.isDirty?i=t.getAllIds():(o=t.getChangedIds().filter(h=>t.get(h)!==void 0),i=t.sources.hot.filter(h=>h.properties.id&&o.indexOf(h.properties.id)===-1&&t.get(h.properties.id)!==void 0).map(h=>h.properties.id)),t.sources.hot=[];const a=t.sources.cold.length;t.sources.cold=t.isDirty?[]:t.sources.cold.filter(h=>{const T=h.properties.id||h.properties.parent;return o.indexOf(T)===-1});const c=a!==t.sources.cold.length||i.length>0;o.forEach(h=>u(h,"hot")),i.forEach(h=>u(h,"cold"));function u(h,T){const f=t.get(h).internal(n);t.ctx.events.currentModeRender(f,_=>{t.sources[T].push(_)})}if(c&&t.ctx.map.getSource(xe.sources.COLD).setData({type:xe.geojsonTypes.FEATURE_COLLECTION,features:t.sources.cold}),t.ctx.map.getSource(xe.sources.HOT).setData({type:xe.geojsonTypes.FEATURE_COLLECTION,features:t.sources.hot}),t._emitSelectionChange&&(t.ctx.map.fire(xe.events.SELECTION_CHANGE,{features:t.getSelected().map(h=>h.toGeoJSON()),points:t.getSelectedCoordinates().map(h=>({type:xe.geojsonTypes.FEATURE,properties:{},geometry:{type:xe.geojsonTypes.POINT,coordinates:h.coordinates}}))}),t._emitSelectionChange=!1),t._deletedFeaturesToEmit.length){const h=t._deletedFeaturesToEmit.map(T=>T.toGeoJSON());t._deletedFeaturesToEmit=[],t.ctx.map.fire(xe.events.DELETE,{features:h})}y(),t.ctx.map.fire(xe.events.RENDER,{});function y(){t.isDirty=!1,t.clearChangedIds()}};const fd=sd,rn=cd,Mn=Xr,pd=ld,dd=G.interactions,Y=Tc.exports=function(e){this._features={},this._featureIds=new Mn,this._selectedFeatureIds=new Mn,this._selectedCoordinates=[],this._changedFeatureIds=new Mn,this._deletedFeaturesToEmit=[],this._emitSelectionChange=!1,this._mapInitialConfig={},this.ctx=e,this.sources={hot:[],cold:[]},this.render=fd(pd,16,this),this.isDirty=!1};Y.prototype.createRenderBatch=function(){const e=this.render;let t=0;return this.render=function(){t++},()=>{this.render=e,t>0&&this.render()}};Y.prototype.setDirty=function(){return this.isDirty=!0,this};Y.prototype.featureChanged=function(e){return this._changedFeatureIds.add(e),this};Y.prototype.getChangedIds=function(){return this._changedFeatureIds.values()};Y.prototype.clearChangedIds=function(){return this._changedFeatureIds.clear(),this};Y.prototype.getAllIds=function(){return this._featureIds.values()};Y.prototype.add=function(e){return this.featureChanged(e.id),this._features[e.id]=e,this._featureIds.add(e.id),this};Y.prototype.delete=function(e,t={}){return rn(e).forEach(r=>{this._featureIds.has(r)&&(this._featureIds.delete(r),this._selectedFeatureIds.delete(r),t.silent||this._deletedFeaturesToEmit.indexOf(this._features[r])===-1&&this._deletedFeaturesToEmit.push(this._features[r]),delete this._features[r],this.isDirty=!0)}),Sc.call(this,t),this};Y.prototype.get=function(e){return this._features[e]};Y.prototype.getAll=function(){return Object.keys(this._features).map(e=>this._features[e])};Y.prototype.select=function(e,t={}){return rn(e).forEach(r=>{this._selectedFeatureIds.has(r)||(this._selectedFeatureIds.add(r),this._changedFeatureIds.add(r),t.silent||(this._emitSelectionChange=!0))}),this};Y.prototype.deselect=function(e,t={}){return rn(e).forEach(r=>{this._selectedFeatureIds.has(r)&&(this._selectedFeatureIds.delete(r),this._changedFeatureIds.add(r),t.silent||(this._emitSelectionChange=!0))}),Sc.call(this,t),this};Y.prototype.clearSelected=function(e={}){return this.deselect(this._selectedFeatureIds.values(),{silent:e.silent}),this};Y.prototype.setSelected=function(e,t={}){return e=rn(e),this.deselect(this._selectedFeatureIds.values().filter(r=>e.indexOf(r)===-1),{silent:t.silent}),this.select(e.filter(r=>!this._selectedFeatureIds.has(r)),{silent:t.silent}),this};Y.prototype.setSelectedCoordinates=function(e){return this._selectedCoordinates=e,this._emitSelectionChange=!0,this};Y.prototype.clearSelectedCoordinates=function(){return this._selectedCoordinates=[],this._emitSelectionChange=!0,this};Y.prototype.getSelectedIds=function(){return this._selectedFeatureIds.values()};Y.prototype.getSelected=function(){return this._selectedFeatureIds.values().map(e=>this.get(e))};Y.prototype.getSelectedCoordinates=function(){return this._selectedCoordinates.map(t=>({coordinates:this.get(t.feature_id).getCoordinate(t.coord_path)}))};Y.prototype.isSelected=function(e){return this._selectedFeatureIds.has(e)};Y.prototype.setFeatureProperty=function(e,t,r){this.get(e).setProperty(t,r),this.featureChanged(e)};function Sc(e){const t=this._selectedCoordinates.filter(r=>this._selectedFeatureIds.has(r.feature_id));this._selectedCoordinates.length!==t.length&&!e.silent&&(this._emitSelectionChange=!0),this._selectedCoordinates=t}Y.prototype.storeMapConfig=function(){dd.forEach(e=>{this.ctx.map[e]&&(this._mapInitialConfig[e]=this.ctx.map[e].isEnabled())})};Y.prototype.restoreMapConfig=function(){Object.keys(this._mapInitialConfig).forEach(e=>{this._mapInitialConfig[e]?this.ctx.map[e].enable():this.ctx.map[e].disable()})};Y.prototype.getInitialConfigValue=function(e){return this._mapInitialConfig[e]!==void 0?this._mapInitialConfig[e]:!0};var hd=Tc.exports;const wa=Ei,X=G,yd=["mode","feature","mouse"];var gd=function(e){const t={};let r=null,n={mode:null,feature:null,mouse:null},o={mode:null,feature:null,mouse:null};function i(){a({mode:null,feature:null,mouse:null}),c()}function a(f){o=wa(o,f)}function c(){if(!e.container)return;const f=[],_=[];yd.forEach(E=>{o[E]!==n[E]&&(f.push(`${E}-${n[E]}`),o[E]!==null&&_.push(`${E}-${o[E]}`))}),f.length>0&&e.container.classList.remove.apply(e.container.classList,f),_.length>0&&e.container.classList.add.apply(e.container.classList,_),n=wa(n,o)}function u(f,_={}){const E=document.createElement("button");return E.className=`${X.classes.CONTROL_BUTTON} ${_.className}`,E.setAttribute("title",_.title),_.container.appendChild(E),E.addEventListener("click",A=>{if(A.preventDefault(),A.stopPropagation(),A.target===r){y();return}h(f),_.onActivate()},!0),E}function y(){r&&(r.classList.remove(X.classes.ACTIVE_BUTTON),r=null)}function h(f){y();const _=t[f];_&&_&&f!=="trash"&&(_.classList.add(X.classes.ACTIVE_BUTTON),r=_)}function T(){const f=e.options.controls,_=document.createElement("div");return _.className=`${X.classes.CONTROL_GROUP} ${X.classes.CONTROL_BASE}`,f&&(f[X.types.LINE]&&(t[X.types.LINE]=u(X.types.LINE,{container:_,className:X.classes.CONTROL_BUTTON_LINE,title:`LineString tool ${e.options.keybindings?"(l)":""}`,onActivate:()=>e.events.changeMode(X.modes.DRAW_LINE_STRING)})),f[X.types.POLYGON]&&(t[X.types.POLYGON]=u(X.types.POLYGON,{container:_,className:X.classes.CONTROL_BUTTON_POLYGON,title:`Polygon tool ${e.options.keybindings?"(p)":""}`,onActivate:()=>e.events.changeMode(X.modes.DRAW_POLYGON)})),f[X.types.POINT]&&(t[X.types.POINT]=u(X.types.POINT,{container:_,className:X.classes.CONTROL_BUTTON_POINT,title:`Marker tool ${e.options.keybindings?"(m)":""}`,onActivate:()=>e.events.changeMode(X.modes.DRAW_POINT)})),f.trash&&(t.trash=u("trash",{container:_,className:X.classes.CONTROL_BUTTON_TRASH,title:"Delete",onActivate:()=>{e.events.trash()}})),f.combine_features&&(t.combine_features=u("combineFeatures",{container:_,className:X.classes.CONTROL_BUTTON_COMBINE_FEATURES,title:"Combine",onActivate:()=>{e.events.combineFeatures()}})),f.uncombine_features&&(t.uncombine_features=u("uncombineFeatures",{container:_,className:X.classes.CONTROL_BUTTON_UNCOMBINE_FEATURES,title:"Uncombine",onActivate:()=>{e.events.uncombineFeatures()}}))),_}function l(){Object.keys(t).forEach(f=>{const _=t[f];_.parentNode&&_.parentNode.removeChild(_),delete t[f]})}return{setActiveButton:h,queueMapClasses:a,updateMapClasses:c,clearMapClasses:i,addButtons:T,removeButtons:l}};const vd=id,md=hd,bd=gd,Je=G,Td=Ei;var Sd=function(e){let t=null,r=null;const n={onRemove:function(){return e.map.off("load",n.connect),clearInterval(r),n.removeLayers(),e.store.restoreMapConfig(),e.ui.removeButtons(),e.events.removeEventListeners(),e.ui.clearMapClasses(),e.map=null,e.container=null,e.store=null,t&&t.parentNode&&t.parentNode.removeChild(t),t=null,this},connect:function(){e.map.off("load",n.connect),clearInterval(r),n.addLayers(),e.store.storeMapConfig(),e.events.addEventListeners()},onAdd:function(o){{const i=o.fire;o.fire=function(a,c){let u=arguments;return i.length===1&&arguments.length!==1&&(u=[Td({},{type:a},c)]),i.apply(o,u)}}return e.map=o,e.events=vd(e),e.ui=bd(e),e.container=o.getContainer(),e.store=new md(e),t=e.ui.addButtons(),e.options.boxSelect&&(o.boxZoom.disable(),o.dragPan.disable(),o.dragPan.enable()),o.loaded()?n.connect():(o.on("load",n.connect),r=setInterval(()=>{o.loaded()&&n.connect()},16)),e.events.start(),t},addLayers:function(){e.map.addSource(Je.sources.COLD,{data:{type:Je.geojsonTypes.FEATURE_COLLECTION,features:[]},type:"geojson"}),e.map.addSource(Je.sources.HOT,{data:{type:Je.geojsonTypes.FEATURE_COLLECTION,features:[]},type:"geojson"}),e.options.styles.forEach(o=>{e.map.addLayer(o)}),e.store.setDirty(!0),e.store.render()},removeLayers:function(){e.options.styles.forEach(o=>{e.map.getLayer(o.id)&&e.map.removeLayer(o.id)}),e.map.getSource(Je.sources.COLD)&&e.map.removeSource(Je.sources.COLD),e.map.getSource(Je.sources.HOT)&&e.map.removeSource(Je.sources.HOT)}};return e.setup=n,n},_d=[{id:"gl-draw-polygon-fill-inactive",type:"fill",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#3bb2d0","fill-outline-color":"#3bb2d0","fill-opacity":.1}},{id:"gl-draw-polygon-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"#fbb03b","fill-outline-color":"#fbb03b","fill-opacity":.1}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-stroke-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","active","true"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-polygon-and-line-vertex-stroke-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-color":"#fff"}},{id:"gl-draw-polygon-and-line-vertex-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-point-point-stroke-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-opacity":1,"circle-color":"#fff"}},{id:"gl-draw-point-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#3bb2d0"}},{id:"gl-draw-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["==","active","true"],["!=","meta","midpoint"]],paint:{"circle-radius":7,"circle-color":"#fff"}},{id:"gl-draw-point-active",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","true"]],paint:{"circle-radius":5,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","mode","static"],["==","$type","Polygon"]],paint:{"fill-color":"#404040","fill-outline-color":"#404040","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","mode","static"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-line-static",type:"line",filter:["all",["==","mode","static"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-point-static",type:"circle",filter:["all",["==","mode","static"],["==","$type","Point"]],paint:{"circle-radius":5,"circle-color":"#404040"}}];const bt=G;var Pt={isOfMetaType:function(e){return function(t){const r=t.featureTarget;return!r||!r.properties?!1:r.properties.meta===e}},isShiftMousedown:function(e){return!e.originalEvent||!e.originalEvent.shiftKey?!1:e.originalEvent.button===0},isActiveFeature:function(e){return!e.featureTarget||!e.featureTarget.properties?!1:e.featureTarget.properties.active===bt.activeStates.ACTIVE&&e.featureTarget.properties.meta===bt.meta.FEATURE},isInactiveFeature:function(e){return!e.featureTarget||!e.featureTarget.properties?!1:e.featureTarget.properties.active===bt.activeStates.INACTIVE&&e.featureTarget.properties.meta===bt.meta.FEATURE},noTarget:function(e){return e.featureTarget===void 0},isFeature:function(e){return!e.featureTarget||!e.featureTarget.properties?!1:e.featureTarget.properties.meta===bt.meta.FEATURE},isVertex:function(e){const t=e.featureTarget;return!t||!t.properties?!1:t.properties.meta===bt.meta.VERTEX},isShiftDown:function(e){return e.originalEvent?e.originalEvent.shiftKey===!0:!1},isEscapeKey:function(e){return e.keyCode===27},isEnterKey:function(e){return e.keyCode===13},true:function(){return!0}},Ed=wt;function wt(e,t){this.x=e,this.y=t}wt.prototype={clone:function(){return new wt(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,r=e.y-this.y;return t*t+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[0]*this.x+e[1]*this.y,r=e[2]*this.x+e[3]*this.y;return this.x=t,this.y=r,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),r=Math.sin(e),n=t*this.x-r*this.y,o=r*this.x+t*this.y;return this.x=n,this.y=o,this},_rotateAround:function(e,t){var r=Math.cos(e),n=Math.sin(e),o=t.x+r*(this.x-t.x)-n*(this.y-t.y),i=t.y+n*(this.x-t.x)+r*(this.y-t.y);return this.x=o,this.y=i,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}};wt.convert=function(e){return e instanceof wt?e:Array.isArray(e)?new wt(e[0],e[1]):e};const wd=Ed;function Ad(e,t){const r=t.getBoundingClientRect();return new wd(e.clientX-r.left-(t.clientLeft||0),e.clientY-r.top-(t.clientTop||0))}var Id=Ad;const Yt=G;var nn=function(e,t,r,n){return{type:Yt.geojsonTypes.FEATURE,properties:{meta:Yt.meta.VERTEX,parent:e,coord_path:r,active:n?Yt.activeStates.ACTIVE:Yt.activeStates.INACTIVE},geometry:{type:Yt.geojsonTypes.POINT,coordinates:t}}};const ct=G;var $d=function(e,t,r,n){const o=t.geometry.coordinates,i=r.geometry.coordinates;if(o[1]>ct.LAT_RENDERED_MAX||o[1]<ct.LAT_RENDERED_MIN||i[1]>ct.LAT_RENDERED_MAX||i[1]<ct.LAT_RENDERED_MIN)return null;const a=n.project([o[0],o[1]]),c=n.project([i[0],i[1]]),u=n.unproject([(a.x+c.x)/2,(a.y+c.y)/2]);return{type:ct.geojsonTypes.FEATURE,properties:{meta:ct.meta.MIDPOINT,parent:e,lng:u.lng,lat:u.lat,coord_path:r.properties.coord_path},geometry:{type:ct.geojsonTypes.POINT,coordinates:[u.lng,u.lat]}}};const Aa=nn,Cd=$d,Tt=G;function _c(e,t={},r=null){const{type:n,coordinates:o}=e.geometry,i=e.properties&&e.properties.id;let a=[];n===Tt.geojsonTypes.POINT?a.push(Aa(i,o,r,u(r))):n===Tt.geojsonTypes.POLYGON?o.forEach((h,T)=>{c(h,r!==null?`${r}.${T}`:String(T))}):n===Tt.geojsonTypes.LINE_STRING?c(o,r):n.indexOf(Tt.geojsonTypes.MULTI_PREFIX)===0&&y();function c(h,T){let l="",f=null;h.forEach((_,E)=>{const A=T!=null?`${T}.${E}`:String(E),x=Aa(i,_,A,u(A));if(t.midpoints&&f){const m=Cd(i,f,x,t.map);m&&a.push(m)}f=x;const F=JSON.stringify(_);l!==F&&a.push(x),E===0&&(l=F)})}function u(h){return t.selectedPaths?t.selectedPaths.indexOf(h)!==-1:!1}function y(){const h=n.replace(Tt.geojsonTypes.MULTI_PREFIX,"");o.forEach((T,l)=>{const f={type:Tt.geojsonTypes.FEATURE,properties:e.properties,geometry:{type:h,coordinates:T}};a=a.concat(_c(f,t,l))})}return a}var on=_c,Mt={enable(e){setTimeout(()=>{!e.map||!e.map.doubleClickZoom||!e._ctx||!e._ctx.store||!e._ctx.store.getInitialConfigValue||e._ctx.store.getInitialConfigValue("doubleClickZoom")&&e.map.doubleClickZoom.enable()},0)},disable(e){setTimeout(()=>{!e.map||!e.map.doubleClickZoom||e.map.doubleClickZoom.disable()},0)}},an={exports:{}},Od=function e(t){switch(t&&t.type||null){case"FeatureCollection":return t.features=t.features.reduce(function(r,n){return r.concat(e(n))},[]),t;case"Feature":return t.geometry?e(t.geometry).map(function(r){var n={type:"Feature",properties:JSON.parse(JSON.stringify(t.properties)),geometry:r};return t.id!==void 0&&(n.id=t.id),n}):t;case"MultiPoint":return t.coordinates.map(function(r){return{type:"Point",coordinates:r}});case"MultiPolygon":return t.coordinates.map(function(r){return{type:"Polygon",coordinates:r}});case"MultiLineString":return t.coordinates.map(function(r){return{type:"LineString",coordinates:r}});case"GeometryCollection":return t.geometries.map(e).reduce(function(r,n){return r.concat(n)},[]);case"Point":case"Polygon":case"LineString":return[t]}},Fd=function(t){return r(t);function r(n){return Array.isArray(n)&&n.length&&typeof n[0]=="number"?[n]:n.reduce(function(o,i){return Array.isArray(i)&&Array.isArray(i[0])?o.concat(r(i)):(o.push(i),o)},[])}},Pd=Zu,Md=Od,Ld=Fd,xd=function(e){if(!e)return[];var t=Md(Pd(e)),r=[];return t.features.forEach(function(n){n.geometry&&(r=r.concat(Ld(n.geometry.coordinates)))}),r},Ec=Function.prototype.toString,_t=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,oi,Lr;if(typeof _t=="function"&&typeof Object.defineProperty=="function")try{oi=Object.defineProperty({},"length",{get:function(){throw Lr}}),Lr={},_t(function(){throw 42},null,oi)}catch(e){e!==Lr&&(_t=null)}else _t=null;var Nd=/^\s*class\b/,ii=function(t){try{var r=Ec.call(t);return Nd.test(r)}catch{return!1}},Ln=function(t){try{return ii(t)?!1:(Ec.call(t),!0)}catch{return!1}},xr=Object.prototype.toString,Rd="[object Object]",Bd="[object Function]",Dd="[object GeneratorFunction]",Ud="[object HTMLAllCollection]",kd="[object HTML document.all class]",jd="[object HTMLCollection]",qd=typeof Symbol=="function"&&!!Symbol.toStringTag,Gd=!(0 in[,]),ai=function(){return!1};if(typeof document=="object"){var Vd=document.all;xr.call(Vd)===xr.call(document.all)&&(ai=function(t){if((Gd||!t)&&(typeof t>"u"||typeof t=="object"))try{var r=xr.call(t);return(r===Ud||r===kd||r===jd||r===Rd)&&t("")==null}catch{}return!1})}var sn=_t?function(t){if(ai(t))return!0;if(!t||typeof t!="function"&&typeof t!="object")return!1;try{_t(t,null,oi)}catch(r){if(r!==Lr)return!1}return!ii(t)&&Ln(t)}:function(t){if(ai(t))return!0;if(!t||typeof t!="function"&&typeof t!="object")return!1;if(qd)return Ln(t);if(ii(t))return!1;var r=xr.call(t);return r!==Bd&&r!==Dd&&!/^\[object HTML/.test(r)?!1:Ln(t)},Wd=sn,zd=Object.prototype.toString,wc=Object.prototype.hasOwnProperty,Hd=function(t,r,n){for(var o=0,i=t.length;o<i;o++)wc.call(t,o)&&(n==null?r(t[o],o,t):r.call(n,t[o],o,t))},Kd=function(t,r,n){for(var o=0,i=t.length;o<i;o++)n==null?r(t.charAt(o),o,t):r.call(n,t.charAt(o),o,t)},Jd=function(t,r,n){for(var o in t)wc.call(t,o)&&(n==null?r(t[o],o,t):r.call(n,t[o],o,t))};function Yd(e){return zd.call(e)==="[object Array]"}var Pi=function(t,r,n){if(!Wd(r))throw new TypeError("iterator must be a function");var o;arguments.length>=3&&(o=n),Yd(t)?Hd(t,r,o):typeof t=="string"?Kd(t,r,o):Jd(t,r,o)},Ac=["Float16Array","Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"],xn=Ac,Zd=typeof globalThis>"u"?window:globalThis,ir=function(){for(var t=[],r=0;r<xn.length;r++)typeof Zd[xn[r]]=="function"&&(t[t.length]=xn[r]);return t},Br=Pi,Xd=ir,Ia=Xe,Mi=V,Nr=Zr,vr=It,Qd=Mi("Object.prototype.toString"),Ic=pt(),$a=typeof globalThis>"u"?window:globalThis,si=Xd(),Li=Mi("String.prototype.slice"),eh=Mi("Array.prototype.indexOf",!0)||function(t,r){for(var n=0;n<t.length;n+=1)if(t[n]===r)return n;return-1},Dr={__proto__:null};Ic&&Nr&&vr?Br(si,function(e){var t=new $a[e];if(Symbol.toStringTag in t&&vr){var r=vr(t),n=Nr(r,Symbol.toStringTag);if(!n&&r){var o=vr(r);n=Nr(o,Symbol.toStringTag)}Dr["$"+e]=Ia(n.get)}}):Br(si,function(e){var t=new $a[e],r=t.slice||t.set;r&&(Dr["$"+e]=Ia(r))});var th=function(t){var r=!1;return Br(Dr,function(n,o){if(!r)try{"$"+n(t)===o&&(r=Li(o,1))}catch{}}),r},rh=function(t){var r=!1;return Br(Dr,function(n,o){if(!r)try{n(t),r=Li(o,1)}catch{}}),r},Lt=function(t){if(!t||typeof t!="object")return!1;if(!Ic){var r=Li(Qd(t),8,-1);return eh(si,r)>-1?r:r!=="Object"?!1:rh(t)}return Nr?th(t):null};const nh={},oh=Object.freeze(Object.defineProperty({__proto__:null,default:nh},Symbol.toStringTag,{value:"Module"})),ui=wi(oh);var xi=typeof Map=="function"&&Map.prototype,Nn=Object.getOwnPropertyDescriptor&&xi?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,Ur=xi&&Nn&&typeof Nn.get=="function"?Nn.get:null,Ca=xi&&Map.prototype.forEach,Ni=typeof Set=="function"&&Set.prototype,Rn=Object.getOwnPropertyDescriptor&&Ni?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,kr=Ni&&Rn&&typeof Rn.get=="function"?Rn.get:null,Oa=Ni&&Set.prototype.forEach,ih=typeof WeakMap=="function"&&WeakMap.prototype,er=ih?WeakMap.prototype.has:null,ah=typeof WeakSet=="function"&&WeakSet.prototype,tr=ah?WeakSet.prototype.has:null,sh=typeof WeakRef=="function"&&WeakRef.prototype,Fa=sh?WeakRef.prototype.deref:null,uh=Boolean.prototype.valueOf,ch=Object.prototype.toString,lh=Function.prototype.toString,fh=String.prototype.match,Ri=String.prototype.slice,Ze=String.prototype.replace,ph=String.prototype.toUpperCase,Pa=String.prototype.toLowerCase,$c=RegExp.prototype.test,Ma=Array.prototype.concat,Ne=Array.prototype.join,dh=Array.prototype.slice,La=Math.floor,ci=typeof BigInt=="function"?BigInt.prototype.valueOf:null,Bn=Object.getOwnPropertySymbols,li=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,At=typeof Symbol=="function"&&typeof Symbol.iterator=="object",rr=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===At||!0)?Symbol.toStringTag:null,Cc=Object.prototype.propertyIsEnumerable,xa=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null);function Na(e,t){if(e===1/0||e===-1/0||e!==e||e&&e>-1e3&&e<1e3||$c.call(/e/,t))return t;var r=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof e=="number"){var n=e<0?-La(-e):La(e);if(n!==e){var o=String(n),i=Ri.call(t,o.length+1);return Ze.call(o,r,"$&_")+"."+Ze.call(Ze.call(i,/([0-9]{3})/g,"$&_"),/_$/,"")}}return Ze.call(t,r,"$&_")}var fi=ui,Ra=fi.custom,Ba=Pc(Ra)?Ra:null,Oc={__proto__:null,double:'"',single:"'"},hh={__proto__:null,double:/(["\\])/g,single:/(['\\])/g},yh=function e(t,r,n,o){var i=r||{};if(Ge(i,"quoteStyle")&&!Ge(Oc,i.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Ge(i,"maxStringLength")&&(typeof i.maxStringLength=="number"?i.maxStringLength<0&&i.maxStringLength!==1/0:i.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var a=Ge(i,"customInspect")?i.customInspect:!0;if(typeof a!="boolean"&&a!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Ge(i,"indent")&&i.indent!==null&&i.indent!=="	"&&!(parseInt(i.indent,10)===i.indent&&i.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Ge(i,"numericSeparator")&&typeof i.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var c=i.numericSeparator;if(typeof t>"u")return"undefined";if(t===null)return"null";if(typeof t=="boolean")return t?"true":"false";if(typeof t=="string")return Lc(t,i);if(typeof t=="number"){if(t===0)return 1/0/t>0?"0":"-0";var u=String(t);return c?Na(t,u):u}if(typeof t=="bigint"){var y=String(t)+"n";return c?Na(t,y):y}var h=typeof i.depth>"u"?5:i.depth;if(typeof n>"u"&&(n=0),n>=h&&h>0&&typeof t=="object")return pi(t)?"[Array]":"[Object]";var T=Lh(i,n);if(typeof o>"u")o=[];else if(Mc(o,t)>=0)return"[Circular]";function l(b,P,U){if(P&&(o=dh.call(o),o.push(P)),U){var te={depth:i.depth};return Ge(i,"quoteStyle")&&(te.quoteStyle=i.quoteStyle),e(b,te,n+1,o)}return e(b,i,n+1,o)}if(typeof t=="function"&&!Da(t)){var f=wh(t),_=mr(t,l);return"[Function"+(f?": "+f:" (anonymous)")+"]"+(_.length>0?" { "+Ne.call(_,", ")+" }":"")}if(Pc(t)){var E=At?Ze.call(String(t),/^(Symbol\(.*\))_[^)]*$/,"$1"):li.call(t);return typeof t=="object"&&!At?Zt(E):E}if(Fh(t)){for(var A="<"+Pa.call(String(t.nodeName)),x=t.attributes||[],F=0;F<x.length;F++)A+=" "+x[F].name+"="+Fc(gh(x[F].value),"double",i);return A+=">",t.childNodes&&t.childNodes.length&&(A+="..."),A+="</"+Pa.call(String(t.nodeName))+">",A}if(pi(t)){if(t.length===0)return"[]";var m=mr(t,l);return T&&!Mh(m)?"["+di(m,T)+"]":"[ "+Ne.call(m,", ")+" ]"}if(mh(t)){var w=mr(t,l);return!("cause"in Error.prototype)&&"cause"in t&&!Cc.call(t,"cause")?"{ ["+String(t)+"] "+Ne.call(Ma.call("[cause]: "+l(t.cause),w),", ")+" }":w.length===0?"["+String(t)+"]":"{ ["+String(t)+"] "+Ne.call(w,", ")+" }"}if(typeof t=="object"&&a){if(Ba&&typeof t[Ba]=="function"&&fi)return fi(t,{depth:h-n});if(a!=="symbol"&&typeof t.inspect=="function")return t.inspect()}if(Ah(t)){var $=[];return Ca&&Ca.call(t,function(b,P){$.push(l(P,t,!0)+" => "+l(b,t))}),Ua("Map",Ur.call(t),$,T)}if(Ch(t)){var M=[];return Oa&&Oa.call(t,function(b){M.push(l(b,t))}),Ua("Set",kr.call(t),M,T)}if(Ih(t))return Dn("WeakMap");if(Oh(t))return Dn("WeakSet");if($h(t))return Dn("WeakRef");if(Th(t))return Zt(l(Number(t)));if(_h(t))return Zt(l(ci.call(t)));if(Sh(t))return Zt(uh.call(t));if(bh(t))return Zt(l(String(t)));if(typeof window<"u"&&t===window)return"{ [object Window] }";if(typeof globalThis<"u"&&t===globalThis||typeof window<"u"&&t===window)return"{ [object globalThis] }";if(!vh(t)&&!Da(t)){var C=mr(t,l),B=xa?xa(t)===Object.prototype:t instanceof Object||t.constructor===Object,d=t instanceof Object?"":"null prototype",I=!B&&rr&&Object(t)===t&&rr in t?Ri.call(et(t),8,-1):d?"Object":"",g=B||typeof t.constructor!="function"?"":t.constructor.name?t.constructor.name+" ":"",v=g+(I||d?"["+Ne.call(Ma.call([],I||[],d||[]),": ")+"] ":"");return C.length===0?v+"{}":T?v+"{"+di(C,T)+"}":v+"{ "+Ne.call(C,", ")+" }"}return String(t)};function Fc(e,t,r){var n=r.quoteStyle||t,o=Oc[n];return o+e+o}function gh(e){return Ze.call(String(e),/"/g,"&quot;")}function yt(e){return!rr||!(typeof e=="object"&&(rr in e||typeof e[rr]<"u"))}function pi(e){return et(e)==="[object Array]"&&yt(e)}function vh(e){return et(e)==="[object Date]"&&yt(e)}function Da(e){return et(e)==="[object RegExp]"&&yt(e)}function mh(e){return et(e)==="[object Error]"&&yt(e)}function bh(e){return et(e)==="[object String]"&&yt(e)}function Th(e){return et(e)==="[object Number]"&&yt(e)}function Sh(e){return et(e)==="[object Boolean]"&&yt(e)}function Pc(e){if(At)return e&&typeof e=="object"&&e instanceof Symbol;if(typeof e=="symbol")return!0;if(!e||typeof e!="object"||!li)return!1;try{return li.call(e),!0}catch{}return!1}function _h(e){if(!e||typeof e!="object"||!ci)return!1;try{return ci.call(e),!0}catch{}return!1}var Eh=Object.prototype.hasOwnProperty||function(e){return e in this};function Ge(e,t){return Eh.call(e,t)}function et(e){return ch.call(e)}function wh(e){if(e.name)return e.name;var t=fh.call(lh.call(e),/^function\s*([\w$]+)/);return t?t[1]:null}function Mc(e,t){if(e.indexOf)return e.indexOf(t);for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}function Ah(e){if(!Ur||!e||typeof e!="object")return!1;try{Ur.call(e);try{kr.call(e)}catch{return!0}return e instanceof Map}catch{}return!1}function Ih(e){if(!er||!e||typeof e!="object")return!1;try{er.call(e,er);try{tr.call(e,tr)}catch{return!0}return e instanceof WeakMap}catch{}return!1}function $h(e){if(!Fa||!e||typeof e!="object")return!1;try{return Fa.call(e),!0}catch{}return!1}function Ch(e){if(!kr||!e||typeof e!="object")return!1;try{kr.call(e);try{Ur.call(e)}catch{return!0}return e instanceof Set}catch{}return!1}function Oh(e){if(!tr||!e||typeof e!="object")return!1;try{tr.call(e,tr);try{er.call(e,er)}catch{return!0}return e instanceof WeakSet}catch{}return!1}function Fh(e){return!e||typeof e!="object"?!1:typeof HTMLElement<"u"&&e instanceof HTMLElement?!0:typeof e.nodeName=="string"&&typeof e.getAttribute=="function"}function Lc(e,t){if(e.length>t.maxStringLength){var r=e.length-t.maxStringLength,n="... "+r+" more character"+(r>1?"s":"");return Lc(Ri.call(e,0,t.maxStringLength),t)+n}var o=hh[t.quoteStyle||"single"];o.lastIndex=0;var i=Ze.call(Ze.call(e,o,"\\$1"),/[\x00-\x1f]/g,Ph);return Fc(i,"single",t)}function Ph(e){var t=e.charCodeAt(0),r={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return r?"\\"+r:"\\x"+(t<16?"0":"")+ph.call(t.toString(16))}function Zt(e){return"Object("+e+")"}function Dn(e){return e+" { ? }"}function Ua(e,t,r,n){var o=n?di(r,n):Ne.call(r,", ");return e+" ("+t+") {"+o+"}"}function Mh(e){for(var t=0;t<e.length;t++)if(Mc(e[t],`
`)>=0)return!1;return!0}function Lh(e,t){var r;if(e.indent==="	")r="	";else if(typeof e.indent=="number"&&e.indent>0)r=Ne.call(Array(e.indent+1)," ");else return null;return{base:r,prev:Ne.call(Array(t+1),r)}}function di(e,t){if(e.length===0)return"";var r=`
`+t.prev+t.base;return r+Ne.call(e,","+r)+`
`+t.prev}function mr(e,t){var r=pi(e),n=[];if(r){n.length=e.length;for(var o=0;o<e.length;o++)n[o]=Ge(e,o)?t(e[o],e):""}var i=typeof Bn=="function"?Bn(e):[],a;if(At){a={};for(var c=0;c<i.length;c++)a["$"+i[c]]=i[c]}for(var u in e)Ge(e,u)&&(r&&String(Number(u))===u&&u<e.length||At&&a["$"+u]instanceof Symbol||($c.call(/[^\w$]/,u)?n.push(t(u,e)+": "+t(e[u],e)):n.push(u+": "+t(e[u],e))));if(typeof Bn=="function")for(var y=0;y<i.length;y++)Cc.call(e,i[y])&&n.push("["+t(i[y])+"]: "+t(e[i[y]],e));return n}var un=function(t){return typeof t=="string"||typeof t=="symbol"},tt=function(t){return!!t&&(typeof t=="function"||typeof t=="object")},ka=j,xh=yh,Nh=un,Rh=tt,Bh=function(t,r){if(!Rh(t))throw new ka("Assertion failed: Type(O) is not Object");if(!Nh(r))throw new ka("Assertion failed: P is not a Property Key, got "+xh(r));return t[r]},Dh=$t,We=function(t){return(typeof t=="number"||typeof t=="bigint")&&!Dh(t)&&t!==1/0&&t!==-1/0},Uh=Ai,kh=Ct,jh=$t,qh=We,cn=function(t){if(typeof t!="number"||jh(t)||!qh(t))return!1;var r=Uh(t);return kh(r)===r},Gh=Xe,xc=V,Vh=Q,hi=Vh("%ArrayBuffer%",!0),Rr=xc("ArrayBuffer.prototype.byteLength",!0),Wh=xc("Object.prototype.toString"),ja=!!hi&&!Rr&&new hi(0).slice,qa=!!ja&&Gh(ja),xt=Rr||qa?function(t){if(!t||typeof t!="object")return!1;try{return Rr?Rr(t):qa(t,0),!0}catch{return!1}}:hi?function(t){return Wh(t)==="[object ArrayBuffer]"}:function(t){return!1},zh=V,Ga=zh("ArrayBuffer.prototype.byteLength",!0),Hh=xt,Nc=function(t){return Hh(t)?Ga?Ga(t):t.byteLength:NaN},Kh=V,Va=Kh("SharedArrayBuffer.prototype.byteLength",!0),ar=Va?function(t){if(!t||typeof t!="object")return!1;try{return Va(t),!0}catch{return!1}}:function(t){return!1},Jh=j,Yh=Nc,Zh=ir(),Xh=V,Qh=xt,ey=ar,ty=Xh("SharedArrayBuffer.prototype.byteLength",!0),Nt=function(t){var r=ey(t);if(!Qh(t)&&!r)throw new Jh("Assertion failed: `arrayBuffer` must be an Object with an [[ArrayBufferData]] internal slot");if((r?ty:Yh)(t)===0)try{new window[Zh[0]](t)}catch(n){return!!n&&n.name==="TypeError"}return!1},Un,Wa;function Rc(){if(Wa)return Un;Wa=1;var e=j,t=dt,r=tt,n=un;return Un=function(i,a){if(!r(i))throw new e("Assertion failed: `O` must be an Object");if(!n(a))throw new e("Assertion failed: `P` must be a Property Key");return t(i,a)},Un}var ry=Q,Bc=ry("%Array%"),ny=!Bc.isArray&&V("Object.prototype.toString"),Dc=Bc.isArray||function(t){return ny(t)==="[object Array]"},Bi=Dc,kn,za;function Uc(){return za||(za=1,kn=function(t){return t==="BIGUINT64"||t==="BIGINT64"}),kn}var jn,Ha;function oy(){return Ha||(Ha=1,jn=function(t){return t==="UINT8"||t==="UINT8C"||t==="UINT16"||t==="UINT32"||t==="BIGUINT64"}),jn}var qn,Ka;function iy(){if(Ka)return qn;Ka=1;var e=Ot;return qn=function(r){var n=r[3]&128?-1:1,o=(r[3]&127)<<1|r[2]>>7,i=(r[2]&127)<<16|r[1]<<8|r[0];return o===0&&i===0?n===1?0:-0:o===255&&i===0?n===1?1/0:-1/0:o===255&&i!==0?NaN:(o-=127,o===-127?n*i*e(2,-149):n*(1+i*e(2,-23))*e(2,o))},qn}var Gn,Ja;function ay(){if(Ja)return Gn;Ja=1;var e=Ot;return Gn=function(r){var n=r[7]&128?-1:1,o=(r[7]&127)<<4|(r[6]&240)>>4,i=(r[6]&15)*281474976710656+r[5]*1099511627776+r[4]*4294967296+r[3]*16777216+r[2]*65536+r[1]*256+r[0];return o===0&&i===0?n*0:o===2047&&i!==0?NaN:o===2047&&i===0?n*(1/0):(o-=1023,o===-1023?n*i*5e-324:n*(1+i/4503599627370496)*e(2,o))},Gn}var Vn,Ya;function sy(){if(Ya)return Vn;Ya=1;var e=Q,t=Ot,r=e("%Number%"),n=e("%BigInt%",!0);return Vn=function(i,a,c,u){for(var y=u?n:r,h=y(0),T=0;T<i.length;T++)h+=y(i[T]*t(2,8*T));if(!c){var l=a*8;i[a-1]&128&&(h-=y(t(2,l)))}return h},Vn}var Wn,Za;function uy(){return Za||(Za=1,Wn=function(t,r){for(var n=0;n<t.length;n+=1)if(!r(t[n],n,t))return!1;return!0}),Wn}var zn,Xa;function cy(){return Xa||(Xa=1,zn=function(t){return typeof t=="number"&&t>=0&&t<=255&&(t|0)===t}),zn}var Rt={__proto__:null,name:{__proto__:null,$Int8Array:"INT8",$Uint8Array:"UINT8",$Uint8ClampedArray:"UINT8C",$Int16Array:"INT16",$Uint16Array:"UINT16",$Int32Array:"INT32",$Uint32Array:"UINT32",$BigInt64Array:"BIGINT64",$BigUint64Array:"BIGUINT64",$Float32Array:"FLOAT32",$Float64Array:"FLOAT64"},size:{__proto__:null,$INT8:1,$UINT8:1,$UINT8C:1,$INT16:2,$UINT16:2,$INT32:4,$UINT32:4,$BIGINT64:8,$BIGUINT64:8,$FLOAT32:4,$FLOAT64:8},choices:'"INT8", "UINT8", "UINT8C", "INT16", "UINT16", "INT32", "UINT32", "BIGINT64", "BIGUINT64", "FLOAT32", or "FLOAT64"'},Hn,Qa;function ly(){if(Qa)return Hn;Qa=1;var e=Q,t=V,r=Xu,n=Ve,o=j,i=e("%BigInt%",!0),a=Rc(),c=Bi,u=Uc(),y=oy(),h=iy(),T=ay(),l=sy(),f=uy(),_=cy(),E=t("Array.prototype.reverse"),A=t("Array.prototype.slice"),x=Rt;return Hn=function(m,w,$){if(!a(x.size,"$"+m))throw new o("Assertion failed: `type` must be a TypedArray element type");if(!c(w)||!f(w,_))throw new o("Assertion failed: `rawBytes` must be an Array of bytes");if(typeof $!="boolean")throw new o("Assertion failed: `isLittleEndian` must be a Boolean");var M=x.size["$"+m];if(w.length!==M)throw new r("Assertion failed: `rawBytes` must have a length of "+M+" for type "+m);var C=u(m);if(C&&!i)throw new n("this environment does not support BigInts");return w=A(w,0,M),$||E(w),m==="FLOAT32"?h(w):m==="FLOAT64"?T(w):l(w,M,y(m),C)},Hn}var Kn,es;function fy(){if(es)return Kn;es=1;var e={}.toString;return Kn=Array.isArray||function(t){return e.call(t)=="[object Array]"},Kn}var Jn,ts;function py(){if(ts)return Jn;ts=1;var e=Q,t=e("%Array.prototype.concat%"),r=Xe,n=V,o=n("Array.prototype.slice"),i=yp(),a=i&&Symbol.isConcatSpreadable,c=[],u=a?r.apply(t,c):null,y=a?fy():null;return Jn=a?function(T){for(var l=0;l<arguments.length;l+=1){var f=arguments[l];if(f&&typeof f=="object"&&typeof f[a]=="boolean"){c[a]||(c[a]=!0);var _=y(f)?o(f):[f];_[a]=!0,arguments[l]=_}}return u(arguments)}:r(t,c),Jn}var dy=Lt,Bt=function(t){return!!dy(t)},hy=j,yy=V,gy=yy("TypedArray.prototype.buffer",!0),vy=Bt,sr=gy||function(t){if(!vy(t))throw new hy("Not a Typed Array");return t.buffer},Yn,rs;function kc(){if(rs)return Yn;rs=1;var e=Q,t=e("%Uint8Array%",!0),r=e("%Uint32Array%",!0),n=sr,o=r&&new r([305419896]),i=o&&new t(n(o));return Yn=i?i[0]===120?"little":i[0]===18?"big":i[0]===52?"mixed":"unknown":"indeterminate",Yn}var my=Q,by=Ve,je=j,Ty=V,Sy=cn,_y=my("%Uint8Array%",!0),Zn=Ty("Array.prototype.slice"),Ey=Nt,wy=ly(),Ay=xt,Iy=ar,ns=py(),br=Rt,$y=kc(),Cy=function(t,r,n,o,i){var a=Iy(t);if(!Ay(t)&&!a)throw new je("Assertion failed: `arrayBuffer` must be an ArrayBuffer or a SharedArrayBuffer");if(!Sy(r))throw new je("Assertion failed: `byteIndex` must be an integer");if(typeof n!="string"||typeof br.size["$"+n]!="number")throw new je("Assertion failed: `type` must be one of "+br.choices);if(typeof o!="boolean")throw new je("Assertion failed: `isTypedArray` must be a boolean");if(i!=="SEQ-CST"&&i!=="UNORDERED")throw new je("Assertion failed: `order` must be either `SEQ-CST` or `UNORDERED`");if(arguments.length>5&&typeof arguments[5]!="boolean")throw new je("Assertion failed: `isLittleEndian` must be a boolean, if present");if(Ey(t))throw new je("Assertion failed: `arrayBuffer` is detached");if(r<0)throw new je("Assertion failed: `byteIndex` must be non-negative");var c=br.size["$"+n];if(!c)throw new je("Assertion failed: `type` must be one of "+br.choices);var u;if(a)throw new by("SharedArrayBuffer is not supported by this implementation");u=Zn(new _y(t,r),0,c);var y=arguments.length>5?arguments[5]:$y==="little",h=y?Zn(ns([0,0,0,0,0,0,0,0],u),-c):Zn(ns(u,[0,0,0,0,0,0,0,0]),0,c);return wy(n,h,y)},os=$t,jc=function(t,r){return t===r?t===0?1/t===1/r:!0:os(t)&&os(r)},Tr=j,Oy=tt,Fy=un,is=jc,as=function(){try{return delete[].length,!0}catch{return!1}}(),Py=function(t,r,n,o){if(!Oy(t))throw new Tr("Assertion failed: `O` must be an Object");if(!Fy(r))throw new Tr("Assertion failed: `P` must be a Property Key");if(typeof o!="boolean")throw new Tr("Assertion failed: `Throw` must be a Boolean");if(o){if(t[r]=n,as&&!is(t[r],n))throw new Tr("Attempted to assign to readonly property.");return!0}try{return t[r]=n,as?is(t[r],n):!0}catch{return!1}},Xn,ss;function My(){if(ss)return Xn;ss=1;var e=Q,t=e("%BigInt%",!0),r=j,n=Ve;return Xn=function(i){if(typeof i!="string")throw new r("`argument` must be a string");if(!t)throw new n("BigInts are not supported in this environment");try{return t(i)}catch{return}},Xn}var Qn,us;function Ly(){return us||(us=1,Qn=function(t){return t===null||typeof t!="function"&&typeof t!="object"}),Qn}var Sr={exports:{}},eo,cs;function ln(){if(cs)return eo;cs=1;var e=V,t=Qu,r=e("RegExp.prototype.exec"),n=j;return eo=function(i){if(!t(i))throw new n("`regex` must be a RegExp");return function(c){return r(i,c)!==null}},eo}var ls;function qc(){if(ls)return Sr.exports;ls=1;var e=V,t=e("Object.prototype.toString"),r=gp()(),n=ln();if(r){var o=e("Symbol.prototype.toString"),i=n(/^Symbol\(.*\)$/),a=function(u){return typeof u.valueOf()!="symbol"?!1:i(o(u))};Sr.exports=function(u){if(typeof u=="symbol")return!0;if(!u||typeof u!="object"||t(u)!=="[object Symbol]")return!1;try{return a(u)}catch{return!1}}}else Sr.exports=function(u){return!1};return Sr.exports}var to,fs;function xy(){if(fs)return to;fs=1;var e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol",t=Ly(),r=sn,n=ec,o=qc(),i=function(u,y){if(typeof u>"u"||u===null)throw new TypeError("Cannot call method on "+u);if(typeof y!="string"||y!=="number"&&y!=="string")throw new TypeError('hint must be "string" or "number"');var h=y==="string"?["toString","valueOf"]:["valueOf","toString"],T,l,f;for(f=0;f<h.length;++f)if(T=u[h[f]],r(T)&&(l=T.call(u),t(l)))return l;throw new TypeError("No default value")},a=function(u,y){var h=u[y];if(h!==null&&typeof h<"u"){if(!r(h))throw new TypeError(h+" returned for property "+String(y)+" of object "+u+" is not a function");return h}};return to=function(u){if(t(u))return u;var y="default";arguments.length>1&&(arguments[1]===String?y="string":arguments[1]===Number&&(y="number"));var h;if(e&&(Symbol.toPrimitive?h=a(u,Symbol.toPrimitive):o(u)&&(h=Symbol.prototype.valueOf)),typeof h<"u"){var T=h.call(u,y);if(t(T))return T;throw new TypeError("unable to convert exotic object to primitive")}return y==="default"&&(n(u)||o(u))&&(y="string"),i(u,y==="default"?"number":y)},to}var ro,ps;function Gc(){if(ps)return ro;ps=1;var e=xy();return ro=function(r){return arguments.length>1?e(r,arguments[1]):e(r)},ro}var no,ds;function Vc(){if(ds)return no;ds=1;var e=Q,t=e("%BigInt%",!0),r=e("%Number%"),n=j,o=Ve,i=My(),a=Gc();return no=function(u){if(!t)throw new o("BigInts are not supported in this environment");var y=a(u,r);if(y==null)throw new n("Cannot convert null or undefined to a BigInt");if(typeof y=="boolean")return t(y?1:0);if(typeof y=="number")throw new n("Cannot convert a Number value to a BigInt");if(typeof y=="string"){var h=i(y);if(typeof h>"u")throw new n("Failed to parse String to BigInt");return h}if(typeof y=="symbol")throw new n("Cannot convert a Symbol value to a BigInt");if(typeof y!="bigint")throw new o("Assertion failed: unknown primitive type");return y},no}var oo,hs;function Wc(){if(hs)return oo;hs=1;var e=Q,t=e("%BigInt%",!0),r=Xu,n=j,o=t&&t(0);return oo=function(a,c){if(typeof a!="bigint"||typeof c!="bigint")throw new n("Assertion failed: `n` and `d` arguments must be BigInts");if(c===o)throw new r("Division by zero");return a===o?o:a%c},oo}var io,ys;function zc(){return ys||(ys=1,io=function(t,r,n){var o=t(r,n);return o>=0?o:o+n}),io}var ao,gs;function Ny(){if(gs)return ao;gs=1;var e=Q,t=e("%BigInt%",!0),r=Ot,n=Vc(),o=Wc(),i=zc(),a=t&&BigInt(r(2,32))*BigInt(r(2,31)),c=t&&BigInt(r(2,32))*BigInt(r(2,32));return ao=function(y){var h=n(y),T=i(o,h,c);return T>=a?T-c:T},ao}var so,vs;function Ry(){if(vs)return so;vs=1;var e=Q,t=e("%BigInt%",!0),r=Ot,n=Vc(),o=Wc(),i=zc(),a=t&&BigInt(r(2,32))*BigInt(r(2,32));return so=function(u){var y=n(u),h=i(o,y,a);return h},so}var uo,ms;function By(){if(ms)return uo;ms=1;var e=Ct;return uo=function(r,n){var o=r%n;return e(o>=0?o:o+n)},uo}var co,bs;function Dy(){return bs||(bs=1,co=By()),co}var lo,Ts;function Dt(){if(Ts)return lo;Ts=1;var e=Dy();return lo=function(r,n){return e(r,n)},lo}var fo,Ss;function Uy(){return Ss||(Ss=1,fo=function(t){return t===null||typeof t!="function"&&typeof t!="object"}),fo}var po,_s;function Hc(){if(_s)return po;_s=1;var e=j;return po=function(r){if(r==null)throw new e(arguments.length>0&&arguments[1]||"Cannot call method on "+r);return r},po}var ky=Q,jy=ky("%String%"),qy=j,Kc=function(t){if(typeof t=="symbol")throw new qy("Cannot convert a Symbol value to a string");return jy(t)},ho,Es;function Jc(){if(Es)return ho;Es=1;var e=Hc(),t=Kc,r=V,n=r("String.prototype.replace"),o=/^\s$/.test(""),i=o?/^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/:/^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/,a=o?/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+$/:/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+$/;return ho=function(){var u=t(e(this));return n(n(u,i,""),a,"")},ho}var yo,ws;function Yc(){if(ws)return yo;ws=1;var e=Jc(),t="",r="";return yo=function(){return String.prototype.trim&&t.trim()===t&&r.trim()===r&&("_"+r).trim()==="_"+r&&(r+"_").trim()===r+"_"?String.prototype.trim:e},yo}var go,As;function Gy(){if(As)return go;As=1;var e=tc(),t=vp,r=Yc();return go=function(){var o=r();return String.prototype.trim!==o&&(e?t(String.prototype,"trim",o,!0):t(String.prototype,"trim",o)),o},go}var vo,Is;function Vy(){if(Is)return vo;Is=1;var e=Xe,t=nr,r=Hc(),n=Jc(),o=Yc(),i=Gy(),a=e(o()),c=function(y){return r(y),a(y)};return t(c,{getPolyfill:o,implementation:n,shim:i}),vo=c,vo}var mo,$s;function Wy(){if($s)return mo;$s=1;var e=Q,t=e("%RegExp%"),r=j,n=e("%parseInt%"),o=V,i=ln(),a=o("String.prototype.slice"),c=i(/^0b[01]+$/i),u=i(/^0o[0-7]+$/i),y=i(/^[-+]0x[0-9a-f]+$/i),h=["","",""].join(""),T=new t("["+h+"]","g"),l=i(T),f=Vy();return mo=function _(E){if(typeof E!="string")throw new r("Assertion failed: `argument` is not a String");if(c(E))return+n(a(E,2),2);if(u(E))return+n(a(E,2),8);if(l(E)||y(E))return NaN;var A=f(E);return A!==E?_(A):+E},mo}var zy=Q,Cs=j,Hy=zy("%Number%"),Ky=Uy(),Jy=Gc(),Yy=Wy(),rt=function(t){var r=Ky(t)?t:Jy(t,Hy);if(typeof r=="symbol")throw new Cs("Cannot convert a Symbol value to a number");if(typeof r=="bigint")throw new Cs("Conversion from 'BigInt' to 'number' is not allowed.");return typeof r=="string"?Yy(r):+r},Zy=Ct,Di=function(t){return typeof t=="bigint"?t:Zy(t)},Os=Di,Xy=j,gt=function(t){if(typeof t!="number"&&typeof t!="bigint")throw new Xy("argument must be a Number or a BigInt");var r=t<0?-Os(-t):Os(t);return r===0?0:r},bo,Fs;function Qy(){if(Fs)return bo;Fs=1;var e=Dt(),t=rt,r=gt,n=We,o=65536;return bo=function(a){var c=t(a);if(!n(c)||c===0)return 0;var u=r(c),y=e(u,o);return y>=32768?y-o:y},bo}var To,Ps;function eg(){if(Ps)return To;Ps=1;var e=Dt(),t=rt,r=gt,n=We,o=2147483648,i=4294967296;return To=function(c){var u=t(c);if(!n(u)||u===0)return 0;var y=r(u),h=e(y,i),T=h>=o?h-i:h;return T===0?0:T},To}var So,Ms;function tg(){if(Ms)return So;Ms=1;var e=Dt(),t=rt,r=gt,n=We;return So=function(i){var a=t(i);if(!n(a)||a===0)return 0;var c=r(a),u=e(c,256);return u>=128?u-256:u},So}var _o,Ls;function rg(){if(Ls)return _o;Ls=1;var e=Dt(),t=rt,r=gt,n=We,o=65536;return _o=function(a){var c=t(a);if(!n(c)||c===0)return 0;var u=r(c),y=e(u,o);return y===0?0:y},_o}var Eo,xs;function ng(){if(xs)return Eo;xs=1;var e=Dt(),t=rt,r=gt,n=We,o=4294967296;return Eo=function(a){var c=t(a);if(!n(c)||c===0)return 0;var u=r(c),y=e(u,o);return y===0?0:y},Eo}var wo,Ns;function og(){if(Ns)return wo;Ns=1;var e=We,t=Dt(),r=rt,n=gt;return wo=function(i){var a=r(i);if(!e(a)||a===0)return 0;var c=n(a),u=t(c,256);return u},wo}var Ao,Rs;function ig(){if(Rs)return Ao;Rs=1;var e=j,t=nc,r=rc;return Ao=function(o,i,a){if(typeof o!="number"||typeof i!="number"||typeof a!="number"||!(i<=a))throw new e("Assertion failed: all three arguments must be MVs, and `lower` must be `<= upper`");return r(t(i,o),a)},Ao}var Io,Bs;function ag(){if(Bs)return Io;Bs=1;var e=ig(),t=rt,r=Di,n=$t;return Io=function(i){var a=t(i);if(n(a))return 0;var c=e(a,0,255),u=r(c);return c<u+.5?u:c>u+.5?u+1:u%2===0?u:u+1},Io}var $o,Ds;function Zc(){return Ds||(Ds=1,$o=function(t){return t===0&&1/t===-1/0}),$o}var Co,Us;function sg(){if(Us)return Co;Us=1;var e=Ai,t=Ct,r=Ot,n=We,o=$t,i=Zc(),a=34028234663852886e22;return Co=function(u,y){if(o(u))return y?[0,0,192,127]:[127,192,0,0];var h;if(u===0)return h=i(u)?128:0,y?[0,0,0,h]:[h,0,0,0];if(e(u)>a||!n(u))return h=u<0?255:127,y?[0,0,128,h]:[h,128,0,0];var T=u<0?1:0;u=e(u);for(var l=0;u>=2;)l+=1,u/=2;for(;u<1;)l-=1,u*=2;var f=u-1;f*=r(2,23)+.5,f=t(f),l+=127,l<<=23;var _=T<<31|l|f,E=_&255;_>>=8;var A=_&255;_>>=8;var x=_&255;_>>=8;var F=_&255;return y?[E,A,x,F]:[F,x,A,E]},Co}var Oo,ks;function ug(){if(ks)return Oo;ks=1;var e=1075,t=54;return Oo=function(n){var o="";if(n===0)return o;for(var i=e,a,c=0;c<e;c+=1)if(a=n*2,a>=1?(n=a-1,o+="1",i===e&&(i=c)):(n=a,o+="0"),a===1||c-i>t)return o;return o},Oo}var Fo,js;function cg(){if(js)return Fo;js=1;var e=Ct;return Fo=function(r){for(var n="",o;r>0;)o=r/2,r=e(o),o===r?n="0"+n:n="1"+n;return n},Fo}var Po,qs;function lg(){if(qs)return Po;qs=1;var e=Q,t=e("%parseInt%"),r=Ai,n=Ct,o=Zc(),i=V,a=i("String.prototype.indexOf"),c=i("String.prototype.slice"),u=ug(),y=cg(),h=1023,T="11111111111",l="00000000000",f=l+l+l+l+"0000000";return Po=function(E,A){var x=E<0||o(E)?"1":"0",F,m;if(isNaN(E))F=T,m="1"+f;else if(!isFinite(E))F=T,m="0"+f;else if(E===0)F=l,m="0"+f;else{E=r(E);var w=n(E),$=y(w),M=u(E-w),C;if($)F=$.length-1;else{var B=a(M,"1");B>-1&&(C=B+1),F=-C}m=$+M,F<0?(F<=-h&&(C=h-1),m=c(m,C)):m=c(m,1),F=c(l+y(F+h),-11),m=c(m+f+"0",0,52)}for(var d=x+F+m,I=[],g=0;g<8;g++){var v=A?8-g-1:g;I[v]=t(c(d,g*8,(g+1)*8),2)}return I},Po}var Mo,Gs;function fg(){if(Gs)return Mo;Gs=1;var e=Q,t=e("%Number%"),r=e("%BigInt%",!0);return Mo=function(o,i,a){var c=typeof o=="bigint"?r:t;o<0&&(o>>>=0);for(var u=[],y=0;y<i;y++)u[a?y:i-1-y]=t(o&c(255)),o>>=c(8);return u},Mo}var Lo,Vs;function pg(){if(Vs)return Lo;Vs=1;var e=j,t=Rc(),r=Ny(),n=Ry(),o=Qy(),i=eg(),a=tg(),c=rg(),u=ng(),y=og(),h=ag(),T=sg(),l=lg(),f=fg(),_=Rt,E={__proto__:null,$INT8:a,$UINT8:y,$UINT8C:h,$INT16:o,$UINT16:c,$INT32:i,$UINT32:u,$BIGINT64:r,$BIGUINT64:n};return Lo=function(x,F,m){if(typeof x!="string"||!t(_.size,"$"+x))throw new e("Assertion failed: `type` must be a TypedArray element type");if(typeof F!="number"&&typeof F!="bigint")throw new e("Assertion failed: `value` must be a Number or a BigInt");if(typeof m!="boolean")throw new e("Assertion failed: `isLittleEndian` must be a Boolean");if(x==="FLOAT32")return T(F,m);if(x==="FLOAT64")return l(F,m);var w=_.size["$"+x],$=E["$"+x],M=$(F);return f(M,w,m)},Lo}var xo,Ws;function dg(){return Ws||(Ws=1,xo=function(t,r){for(var n=0;n<t.length;n+=1)r(t[n],n,t)}),xo}var hg=Q,yg=Ve,qe=j,gg=cn,vg=hg("%Uint8Array%",!0),mg=Uc(),bg=Nt,Tg=pg(),Sg=xt,_g=ar,Eg=dt,No=Rt,wg=kc(),Ag=dg(),Ig=function(t,r,n,o,i,a){var c=_g(t);if(!Sg(t)&&!c)throw new qe("Assertion failed: `arrayBuffer` must be an ArrayBuffer or a SharedArrayBuffer");if(!gg(r)||r<0)throw new qe("Assertion failed: `byteIndex` must be a non-negative integer");if(typeof n!="string"||!Eg(No.size,"$"+n))throw new qe("Assertion failed: `type` must be one of "+No.choices);if(typeof o!="number"&&typeof o!="bigint")throw new qe("Assertion failed: `value` must be a Number or a BigInt");if(typeof i!="boolean")throw new qe("Assertion failed: `isTypedArray` must be a boolean");if(a!=="SEQ-CST"&&a!=="UNORDERED"&&a!=="INIT")throw new qe('Assertion failed: `order` must be `"SEQ-CST"`, `"UNORDERED"`, or `"INIT"`');if(arguments.length>6&&typeof arguments[6]!="boolean")throw new qe("Assertion failed: `isLittleEndian` must be a boolean, if present");if(bg(t))throw new qe("Assertion failed: ArrayBuffer is detached");if(mg(n)?typeof o!="bigint":typeof o!="number")throw new qe("Assertion failed: `value` must be a BigInt if type is ~BIGINT64~ or ~BIGUINT64~, otherwise a Number");var u=No.size["$"+n],y=arguments.length>6?arguments[6]:wg==="little",h=Tg(n,o,y);if(c)throw new yg("SharedArrayBuffer is not supported by this implementation");var T=new vg(t,r,u);Ag(h,function(l,f){T[f]=l})},$g=rt,Cg=gt,Og=$t,Fg=We,Pg=function(t){var r=$g(t);return Og(r)||r===0?0:Fg(r)?Cg(r):r},Mg=Ve,Lg=j,xg=cn,Ng=Lt,zs=Rt,Ui=function(t){var r=Ng(t);if(!r)throw new Lg("Assertion failed: `O` must be a TypedArray");var n=zs.size["$"+zs.name["$"+r]];if(!xg(n)||n<0)throw new Mg("Assertion failed: Unknown TypedArray type `"+r+"`");return n},Rg=Ve,Bg=j,Dg=Lt,Ug=Rt,kg=function(t){var r=Dg(t);if(!r)throw new Bg("Assertion failed: `O` must be a TypedArray");var n=Ug.name["$"+r];if(typeof n!="string")throw new Rg("Assertion failed: Unknown TypedArray type `"+r+"`");return n},yi={exports:{}},jg=Q,Ro,Hs;function ki(){if(Hs)return Ro;Hs=1;var e=j,t=dt,r={__proto__:null,"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};return Ro=function(o){if(!o||typeof o!="object")return!1;for(var i in o)if(t(o,i)&&!r[i])return!1;var a=t(o,"[[Value]]")||t(o,"[[Writable]]"),c=t(o,"[[Get]]")||t(o,"[[Set]]");if(a&&c)throw new e("Property Descriptors may not be both accessor and data descriptors");return!0},Ro}var Bo,Ks;function qg(){if(Ks)return Bo;Ks=1;var e=tc,t=mp,r=e.hasArrayLengthDefineBug(),n=r&&Dc,o=V,i=o("Object.prototype.propertyIsEnumerable");return Bo=function(c,u,y,h,T,l){if(!t){if(!c(l)||!l["[[Configurable]]"]||!l["[[Writable]]"]||T in h&&i(h,T)!==!!l["[[Enumerable]]"])return!1;var f=l["[[Value]]"];return h[T]=f,u(h[T],f)}return r&&T==="length"&&"[[Value]]"in l&&n(h)&&h.length!==l["[[Value]]"]?(h.length=l["[[Value]]"],h.length===l["[[Value]]"]):(t(h,T,y(l)),!0)},Bo}var Do,Js;function Gg(){return Js||(Js=1,Do=function(t){if(typeof t>"u")return t;var r={};return"[[Value]]"in t&&(r.value=t["[[Value]]"]),"[[Writable]]"in t&&(r.writable=!!t["[[Writable]]"]),"[[Get]]"in t&&(r.get=t["[[Get]]"]),"[[Set]]"in t&&(r.set=t["[[Set]]"]),"[[Enumerable]]"in t&&(r.enumerable=!!t["[[Enumerable]]"]),"[[Configurable]]"in t&&(r.configurable=!!t["[[Configurable]]"]),r}),Do}var Uo,Ys;function Vg(){if(Ys)return Uo;Ys=1;var e=j,t=ki(),r=Gg();return Uo=function(o){if(typeof o<"u"&&!t(o))throw new e("Assertion failed: `Desc` must be a Property Descriptor");return r(o)},Uo}var ko,Zs;function Wg(){if(Zs)return ko;Zs=1;var e=j,t=dt,r=ki();return ko=function(o){if(typeof o>"u")return!1;if(!r(o))throw new e("Assertion failed: `Desc` must be a Property Descriptor");return!(!t(o,"[[Value]]")&&!t(o,"[[Writable]]"))},ko}var Xc=sn,jo,Xs;function zg(){return Xs||(Xs=1,jo=function(t){return!!t}),jo}var qo,Qs;function Hg(){if(Qs)return qo;Qs=1;var e=dt,t=j,r=tt,n=Xc,o=zg();return qo=function(a){if(!r(a))throw new t("ToPropertyDescriptor requires an object");var c={};if(e(a,"enumerable")&&(c["[[Enumerable]]"]=o(a.enumerable)),e(a,"configurable")&&(c["[[Configurable]]"]=o(a.configurable)),e(a,"value")&&(c["[[Value]]"]=a.value),e(a,"writable")&&(c["[[Writable]]"]=o(a.writable)),e(a,"get")){var u=a.get;if(typeof u<"u"&&!n(u))throw new t("getter must be a function");c["[[Get]]"]=u}if(e(a,"set")){var y=a.set;if(typeof y<"u"&&!n(y))throw new t("setter must be a function");c["[[Set]]"]=y}if((e(c,"[[Get]]")||e(c,"[[Set]]"))&&(e(c,"[[Value]]")||e(c,"[[Writable]]")))throw new t("Invalid property descriptor. Cannot both specify accessors and a value or writable attribute");return c},qo}var Go,eu;function Kg(){if(eu)return Go;eu=1;var e=j,t=tt,r=ki(),n=qg(),o=Vg(),i=Wg(),a=un,c=jc,u=Hg();return Go=function(h,T,l){if(!t(h))throw new e("Assertion failed: Type(O) is not Object");if(!a(T))throw new e("Assertion failed: P is not a Property Key");var f=r(l)?l:u(l);if(!r(f))throw new e("Assertion failed: Desc is not a valid Property Descriptor");return n(i,c,o,h,T,f)},Go}var Jg=jg,tu=Jg("%Reflect.construct%",!0),jr=Kg();try{jr({},"",{"[[Get]]":function(){}})}catch{jr=null}if(jr&&tu){var ru={},nu={};jr(nu,"length",{"[[Get]]":function(){throw ru},"[[Enumerable]]":!0}),yi.exports=function(t){try{tu(t,nu)}catch(r){return r===ru}}}else yi.exports=function(t){return typeof t=="function"&&!!t.prototype};var Qc=yi.exports,Yg=Q,ou=Yg("%Symbol.species%",!0),Vo=j,iu=tt,Zg=Qc,Xg=function(t,r){if(!iu(t))throw new Vo("Assertion failed: Type(O) is not Object");var n=t.constructor;if(typeof n>"u")return r;if(!iu(n))throw new Vo("O.constructor is not an Object");var o=ou?n[ou]:void 0;if(o==null)return r;if(Zg(o))return o;throw new Vo("no constructor found")},Qg=j,el=V,au=el("%ArrayBuffer.prototype.resizable%",!0),su=el("%SharedArrayBuffer.prototype.growable%",!0),ev=xt,tv=ar,tl=function(t){var r=ev(t),n=tv(t);if(!r&&!n)throw new Qg("Assertion failed: `arrayBuffer` must be an ArrayBuffer or SharedArrayBuffer");return r&&au?!au(t):n&&su?!su(t):!0},rv=cn,uu=dt,nv=Bt,ov=rv,rl=function(t){return!!t&&typeof t=="object"&&uu(t,"[[Object]]")&&uu(t,"[[CachedBufferByteLength]]")&&(ov(t["[[CachedBufferByteLength]]"])&&t["[[CachedBufferByteLength]]"]>=0||t["[[CachedBufferByteLength]]"]==="DETACHED")&&nv(t["[[Object]]"])},iv=tt,nl=V,av=nl("String.prototype.valueOf"),sv=function(t){try{return av(t),!0}catch{return!1}},uv=nl("Object.prototype.toString"),cv="[object String]",lv=pt(),fv=function(t){return typeof t=="string"?!0:!t||typeof t!="object"?!1:lv?sv(t):uv(t)===cv},ol=V,pv=ol("Number.prototype.toString"),dv=function(t){try{return pv(t),!0}catch{return!1}},hv=ol("Object.prototype.toString"),yv="[object Number]",gv=pt(),vv=function(t){return typeof t=="number"?!0:!t||typeof t!="object"?!1:gv?dv(t):hv(t)===yv},il=V,mv=il("Boolean.prototype.toString"),bv=il("Object.prototype.toString"),Tv=function(t){try{return mv(t),!0}catch{return!1}},Sv="[object Boolean]",_v=pt(),Ev=function(t){return typeof t=="boolean"?!0:t===null||typeof t!="object"?!1:_v?Tv(t):bv(t)===Sv},gi={exports:{}},cu=typeof BigInt<"u"&&BigInt,wv=function(){return typeof cu=="function"&&typeof BigInt=="function"&&typeof cu(42)=="bigint"&&typeof BigInt(42)=="bigint"},Av=wv();if(Av){var Iv=BigInt.prototype.valueOf,$v=function(t){try{return Iv.call(t),!0}catch{}return!1};gi.exports=function(t){return t===null||typeof t>"u"||typeof t=="boolean"||typeof t=="string"||typeof t=="number"||typeof t=="symbol"||typeof t=="function"?!1:typeof t=="bigint"?!0:$v(t)}}else gi.exports=function(t){return!1};var Cv=gi.exports,Ov=fv,Fv=vv,Pv=Ev,Mv=qc(),Lv=Cv,xv=function(t){if(t==null||typeof t!="object"&&typeof t!="function")return null;if(Ov(t))return"String";if(Fv(t))return"Number";if(Pv(t))return"Boolean";if(Mv(t))return"Symbol";if(Lv(t))return"BigInt"},ji=typeof Map=="function"&&Map.prototype?Map:null,Nv=typeof Set=="function"&&Set.prototype?Set:null,qr;ji||(qr=function(t){return!1});var al=ji?Map.prototype.has:null,lu=Nv?Set.prototype.has:null;!qr&&!al&&(qr=function(t){return!1});var Rv=qr||function(t){if(!t||typeof t!="object")return!1;try{if(al.call(t),lu)try{lu.call(t)}catch{return!0}return t instanceof ji}catch{}return!1},Bv=typeof Map=="function"&&Map.prototype?Map:null,qi=typeof Set=="function"&&Set.prototype?Set:null,Gr;qi||(Gr=function(t){return!1});var fu=Bv?Map.prototype.has:null,sl=qi?Set.prototype.has:null;!Gr&&!sl&&(Gr=function(t){return!1});var Dv=Gr||function(t){if(!t||typeof t!="object")return!1;try{if(sl.call(t),fu)try{fu.call(t)}catch{return!0}return t instanceof qi}catch{}return!1},Vr=typeof WeakMap=="function"&&WeakMap.prototype?WeakMap:null,pu=typeof WeakSet=="function"&&WeakSet.prototype?WeakSet:null,Wr;Vr||(Wr=function(t){return!1});var vi=Vr?Vr.prototype.has:null,Wo=pu?pu.prototype.has:null;!Wr&&!vi&&(Wr=function(t){return!1});var Uv=Wr||function(t){if(!t||typeof t!="object")return!1;try{if(vi.call(t,vi),Wo)try{Wo.call(t,Wo)}catch{return!0}return t instanceof Vr}catch{}return!1},mi={exports:{}},kv=Q,ul=V,jv=kv("%WeakSet%",!0),zo=ul("WeakSet.prototype.has",!0);if(zo){var Ho=ul("WeakMap.prototype.has",!0);mi.exports=function(t){if(!t||typeof t!="object")return!1;try{if(zo(t,zo),Ho)try{Ho(t,Ho)}catch{return!0}return t instanceof jv}catch{}return!1}}else mi.exports=function(t){return!1};var qv=mi.exports,Gv=Rv,Vv=Dv,Wv=Uv,zv=qv,Hv=function(t){if(t&&typeof t=="object"){if(Gv(t))return"Map";if(Vv(t))return"Set";if(Wv(t))return"WeakMap";if(zv(t))return"WeakSet"}return!1},Kv={}.toString,Jv=Array.isArray||function(e){return Kv.call(e)=="[object Array]"},Yv=V,Zv=Yv("WeakRef.prototype.deref",!0),Xv=typeof WeakRef>"u"?function(t){return!1}:function(t){if(!t||typeof t!="object")return!1;try{return Zv(t),!0}catch{return!1}},Qv=V,du=Qv("FinalizationRegistry.prototype.register",!0),em=du?function(t){if(!t||typeof t!="object")return!1;try{return du(t,{},null),!0}catch{return!1}}:function(t){return!1},cl=sn,tm=dt,rm=oc(),Gi=V,ll=Gi("Function.prototype.toString"),fl=Gi("String.prototype.match"),Ko=Gi("Object.prototype.toString"),nm=/^class /,om=function(t){if(cl(t)||typeof t!="function")return!1;try{var r=fl(ll(t),nm);return!!r}catch{}return!1},im=/\s*function\s+([^(\s]*)\s*/,am=!(0 in[,]),sm="[object Object]",um="[object HTMLAllCollection]",cm=Function.prototype,pl=function(){return!1};if(typeof document=="object"){var lm=document.all;Ko(lm)===Ko(document.all)&&(pl=function(t){if((am||!t)&&(typeof t>"u"||typeof t=="object"))try{var r=Ko(t);return(r===um||r===sm)&&t("")==null}catch{}return!1})}var dl=function(){if(pl(this)||!om(this)&&!cl(this))throw new TypeError("Function.prototype.name sham getter called on non-function");if(rm&&tm(this,"name"))return this.name;if(this===cm)return"";var t=ll(this),r=fl(t,im),n=r&&r[1];return n},fm=dl,hl=function(){return fm},pm=nr.supportsDescriptors,dm=oc(),hm=hl,hu=Object.defineProperty,ym=TypeError,gm=function(){var t=hm();if(dm)return t;if(!pm)throw new ym("Shimming Function.prototype.name support requires ES5 property descriptor support.");var r=Function.prototype;return hu(r,"name",{configurable:!0,enumerable:!1,get:function(){var n=t.call(this);return this!==r&&hu(this,"name",{configurable:!0,enumerable:!1,value:n,writable:!1}),n}}),t},vm=nr,mm=Xe,yl=dl,bm=hl,Tm=gm,gl=mm(yl);vm(gl,{getPolyfill:bm,implementation:yl,shim:Tm});var Sm=gl,Jo,yu;function _m(){if(yu)return Jo;yu=1;const e=(function*(){}).constructor;return Jo=()=>e,Jo}var vl=V,Em=ln(),wm=Em(/^\s*(?:function)?\*/),Am=pt(),gu=It,Im=vl("Object.prototype.toString"),$m=vl("Function.prototype.toString"),Cm=_m(),Om=function(t){if(typeof t!="function")return!1;if(wm($m(t)))return!0;if(!Am){var r=Im(t);return r==="[object GeneratorFunction]"}if(!gu)return!1;var n=Cm();return n&&gu(t)===n.prototype},Yo,vu;function Fm(){if(vu)return Yo;vu=1;const e=(async function(){}).constructor;return Yo=()=>e,Yo}var ml=V,Pm=ln(),Mm=ml("Object.prototype.toString"),Lm=ml("Function.prototype.toString"),xm=Pm(/^\s*async(?:\s+function(?:\s+|\()|\s*\()/),Nm=pt(),mu=It,Rm=Fm(),Bm=function(t){if(typeof t!="function")return!1;if(xm(Lm(t)))return!0;if(!Nm){var r=Mm(t);return r==="[object AsyncFunction]"}if(!mu)return!1;var n=Rm();return n&&n.prototype===mu(t)},Dm=xv,Um=Hv,km=Lt,jm=Jv,qm=ec,Gm=Qu,Vm=Xv,Wm=em,zm=Sm,Hm=Om,Km=Bm,Jm=V,Ym=pt(),Zo=Ym&&Symbol.toStringTag,Zm=Object,bu=Jm("Promise.prototype.then",!0),Xm=function(t){if(!t||typeof t!="object"||!bu)return!1;try{return bu(t,null,function(){}),!0}catch{}return!1},Tu=function(t){return!!t&&t!=="BigInt"&&t!=="Boolean"&&t!=="Null"&&t!=="Number"&&t!=="String"&&t!=="Symbol"&&t!=="Undefined"&&t!=="Math"&&t!=="JSON"&&t!=="Reflect"&&t!=="Atomics"&&t!=="Map"&&t!=="Set"&&t!=="WeakMap"&&t!=="WeakSet"&&t!=="BigInt64Array"&&t!=="BigUint64Array"&&t!=="Float32Array"&&t!=="Float64Array"&&t!=="Int16Array"&&t!=="Int32Array"&&t!=="Int8Array"&&t!=="Uint16Array"&&t!=="Uint32Array"&&t!=="Uint8Array"&&t!=="Uint8ClampedArray"&&t!=="Array"&&t!=="Date"&&t!=="FinalizationRegistry"&&t!=="Promise"&&t!=="RegExp"&&t!=="WeakRef"&&t!=="Function"&&t!=="GeneratorFunction"&&t!=="AsyncFunction"},Qm=function(t){if(t==null)return t;var r=Dm(Zm(t))||Um(t)||km(t);if(r)return r;if(jm(t))return"Array";if(qm(t))return"Date";if(Gm(t))return"RegExp";if(Vm(t))return"WeakRef";if(Wm(t))return"FinalizationRegistry";if(typeof t=="function")return Hm(t)?"GeneratorFunction":Km(t)?"AsyncFunction":"Function";if(Xm(t))return"Promise";if(Zo&&Zo in t){var n=t[Zo];if(Tu(n))return n}if(typeof t.constructor=="function"){var o=zm(t.constructor);if(Tu(o))return o}return"Object"},eb=Q,tb=Xc,rb=iv,nb=Qm,ob=j,Su=It,ib=bp,ab=function(t){if(!rb(t))throw new ob("Reflect.getPrototypeOf called on non-object");if(Su)return Su(t);var r=nb(t);if(r){var n=eb("%"+r+".prototype%",!0);if(n)return n}return tb(t.constructor)?t.constructor.prototype:t instanceof Object?ib.prototype:null},sb=ab,_u=It,bl=function(){return typeof Reflect=="object"&&Reflect&&Reflect.getPrototypeOf?Reflect.getPrototypeOf:_u?function(r){return _u(r)}:sb},Tl=Pi,ub=Xe,cb=bl(),lb=ir(),bi={__proto__:null},_r=Zr,Eu=Object.defineProperty;if(_r){var fb=function(e){return e.byteOffset};Tl(lb,function(e){if(typeof window[e]=="function"||typeof window[e]=="object"){var t=window[e].prototype,r=_r(t,"byteOffset");if(!r){var n=cb(t);r=_r(n,"byteOffset")}if(r&&r.get)bi[e]=ub(r.get);else if(Eu){var o=new window[e](2);r=_r(o,"byteOffset"),r&&r.configurable&&Eu(o,"length",{value:3}),o.length===2&&(bi[e]=fb)}}})}var pb=function(t){var r;return Tl(bi,function(n){if(typeof r!="number")try{var o=n(t);typeof o=="number"&&(r=o)}catch{}}),r},db=Bt,Vi=function(t){return db(t)?pb(t):!1},hb=Xe,Sl=Pi,Er=Zr,yb=Bt,gb=Ac,vb=bl(),Ti={__proto__:null},wu=Object.defineProperty;if(Er){var mb=function(e){return e.length};Sl(gb,function(e){var t=window[e];if(typeof t=="function"||typeof t=="object"){var r=t.prototype,n=Er(r,"length");if(!n){var o=vb(r);n=Er(o,"length")}if(n&&n.get)Ti["$"+e]=hb(n.get);else if(wu){var i=new window[e](2);n=Er(i,"length"),n&&n.configurable&&wu(i,"length",{value:3}),i.length===2&&(Ti["$"+e]=mb)}}})}var bb=function(t){var r;return Sl(Ti,function(n){if(typeof r!="number")try{var o=n(t);typeof o=="number"&&(r=o)}catch{}}),r},_l=function(t){return yb(t)?bb(t):!1},Au=j,Tb=Nt,Sb=tl,_b=Ui,Eb=rl,Iu=sr,wb=Vi,Ab=_l,Wi=function(t){if(!Eb(t))throw new Au("Assertion failed: `taRecord` must be a TypedArray With Buffer Witness Record");var r=t["[[Object]]"],n=t["[[CachedBufferByteLength]]"];if(Tb(Iu(r))&&n!=="DETACHED")throw new Au("Assertion failed: typed array is detached only if the byte length is ~DETACHED~");if(n==="DETACHED")return!0;var o=wb(r),i=Sb(Iu(r)),a,c=i?Ab(r):"AUTO";if(c==="AUTO")a=n;else{var u=_b(r);a=o+c*u}return o>n||a>n},wr=j,Ib=Di,$b=tl,Cb=Wi,Ob=Ui,Fb=rl,Pb=sr,Mb=Vi,Lb=_l,xb=function(t){if(!Fb(t))throw new wr("Assertion failed: `taRecord` must be a TypedArray With Buffer Witness Record");if(Cb(t))throw new wr("Assertion failed: `taRecord` is out of bounds");var r=t["[[Object]]"],n=$b(Pb(r)),o=n?Lb(r):"AUTO";if(o!=="AUTO")return o;if(n)throw new wr("Assertion failed: array buffer is not fixed length");var i=Mb(r),a=Ob(r),c=t["[[CachedBufferByteLength]]"];if(c==="DETACHED")throw new wr("Assertion failed: typed array is detached");return Ib((c-i)/a)},Xo=j,Nb=Nt,Rb=xt,Bb=ar,Db=Nc,Ub=V,kb=Ub("SharedArrayBuffer.prototype.byteLength",!0),jb=function(t,r){var n=Bb(t);if(!Rb(t)&&!n)throw new Xo("Assertion failed: `arrayBuffer` must be an ArrayBuffer or a SharedArrayBuffer");if(r!=="SEQ-CST"&&r!=="UNORDERED")throw new Xo("Assertion failed: `order` must be ~SEQ-CST~ or ~UNORDERED~");if(Nb(t))throw new Xo("Assertion failed: `arrayBuffer` must not be detached");return n?kb(t):Db(t)},$u=j,qb=jb,Gb=Nt,Vb=Bt,Wb=sr,zb=function(t,r){if(!Vb(t))throw new $u("Assertion failed: `obj` must be a Typed Array");if(r!=="SEQ-CST"&&r!=="UNORDERED")throw new $u("Assertion failed: `order` must be ~SEQ-CST~ or ~UNORDERED~");var n=Wb(t),o=Gb(n)?"DETACHED":qb(n,r);return{"[[Object]]":t,"[[CachedBufferByteLength]]":o}},Ar=j,Hb=tt,Kb=Wi,Jb=zb,Yb=Bt,El=function(t,r){if(r!=="SEQ-CST"&&r!=="UNORDERED")throw new Ar("Assertion failed: `order` must be ~SEQ-CST~ or ~UNORDERED~");if(!Hb(t))throw new Ar("Assertion failed: `O` must be an Object");if(!Yb(t))throw new Ar("Assertion failed: `O` must be a Typed Array");var n=Jb(t,r);if(Kb(n))throw new Ar("`O` must be in-bounds and backed by a non-detached buffer");return n},Zb=Ve,Ir=j,Xb=Bi,Qb=Qc,e0=Wi,t0=xb,r0=El,n0=ir(),o0=function(t,r){if(!Qb(t))throw new Ir("Assertion failed: `constructor` must be a constructor");if(!Xb(r))throw new Ir("Assertion failed: `argumentList` must be a List");if(n0.length===0)throw new Zb("Assertion failed: Typed Arrays are not supported in this environment");var n;r.length===0?n=new t:r.length===1?n=new t(r[0]):r.length===2?n=new t(r[0],r[1]):n=new t(r[0],r[1],r[2]);var o=r0(n,"SEQ-CST");if(r.length===1&&typeof r[0]=="number"){if(e0(o))throw new Ir("new Typed Array is out of bounds");var i=t0(o);if(i<r[0])throw new Ir("`argumentList[0]` must be <= `newTypedArray.length`")}return n},Ee=Q,i0={__proto__:null,$Int8Array:Ee("%Int8Array%",!0),$Uint8Array:Ee("%Uint8Array%",!0),$Uint8ClampedArray:Ee("%Uint8ClampedArray%",!0),$Int16Array:Ee("%Int16Array%",!0),$Uint16Array:Ee("%Uint16Array%",!0),$Int32Array:Ee("%Int32Array%",!0),$Uint32Array:Ee("%Uint32Array%",!0),$BigInt64Array:Ee("%BigInt64Array%",!0),$BigUint64Array:Ee("%BigUint64Array%",!0),$Float16Array:Ee("%Float16Array%",!0),$Float32Array:Ee("%Float32Array%",!0),$Float64Array:Ee("%Float64Array%",!0)},a0=function(t){return i0["$"+t]},Cu=Ve,Ou=j,s0=Lt,u0=ir(),c0=Bi,l0=Xg,f0=o0,p0=a0,d0=function(t,r){if(u0.length===0)throw new Cu("Assertion failed: Typed Arrays are not supported in this environment");var n=s0(t);if(!n)throw new Ou("Assertion failed: exemplar must be a TypedArray");if(!c0(r))throw new Ou("Assertion failed: `argumentList` must be a List");var o=p0(n);if(typeof o!="function")throw new Cu("Assertion failed: `constructor` of `exemplar` ("+n+") must exist. Please report this!");var i=l0(t,o);return f0(i,r)},h0=j,y0=Bh,g0=Cy,v0=Nt,Qo=nc,Fu=rc,m0=Py,b0=Ig,Pu=Pg,Mu=Kc,T0=Ui,Lu=kg,S0=d0,_0=El,ei=sr,xu=Vi,wl=function(t,r){var n=this;_0(n,"SEQ-CST");var o=n.length,i=Pu(t),a;i===-1/0?a=0:i<0?a=Qo(o+i,0):a=Fu(i,o);var c=typeof r>"u"?o:Pu(r),u;c===-1/0?u=0:c<0?u=Qo(o+c,0):u=Fu(c,o);var y=Qo(u-a,0),h=S0(n,[y]);if(y>0){if(v0(ei(n)))throw new h0("Cannot use a Typed Array with an underlying ArrayBuffer that is detached");var T=Lu(n),l=Lu(h);if(T===l)for(var f=ei(n),_=ei(h),E=T0(n),A=xu(n),x=a*E+A,F=xu(h),m=F+y*E;F<m;){var w=g0(f,x,"UINT8",!0,"UNORDERED");b0(_,F,"UINT8",w,!0,"UNORDERED"),x+=1,F+=1}else for(var $=0;a<u;){var M=Mu(a),C=y0(n,M);m0(h,Mu($),C,!0),a+=1,$+=1}}return h},E0=wl,Al=function(){return typeof Uint8Array=="function"&&Uint8Array.prototype.slice||E0},w0=nr,A0=It,I0=Al,$0=function(){if(typeof Uint8Array=="function"){var t=I0(),r=A0(Uint8Array.prototype);w0(r,{slice:t},{slice:function(){return r.slice!==t}})}return t},C0=nr,O0=Xe,F0=wl,Il=Al,P0=$0,$l=O0(Il());C0($l,{getPolyfill:Il,implementation:F0,shim:P0});var M0=$l,Cl=Lt,Ol=M0,Nu=Zr;function Ut(e){return Object.prototype.toString.call(e)}function L0(e){return Ut(e)==="[object Date]"}function x0(e){return Ut(e)==="[object RegExp]"}function N0(e){return Ut(e)==="[object Error]"}function R0(e){return Ut(e)==="[object Boolean]"}function B0(e){return Ut(e)==="[object Number]"}function D0(e){return Ut(e)==="[object String]"}var Fl=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};function fn(e,t){if(e.forEach)return e.forEach(t);for(var r=0;r<e.length;r++)t(e[r],r,e)}var pn=Object.keys||function(t){var r=[];for(var n in t)r[r.length]=n;return r},U0=Object.prototype.propertyIsEnumerable,Ru=Object.getOwnPropertySymbols;function dn(e){var t=pn(e);if(Ru)for(var r=Ru(e),n=0;n<r.length;n++)U0.call(e,r[n])&&(t[t.length]=r[n]);return t}var hn=Object.prototype.hasOwnProperty||function(e,t){return t in e};function k0(e,t){if(typeof Nu!="function")return!0;var r=Nu(e,t);return!r||!r.writable}function Pl(e,t){if(typeof e=="object"&&e!==null){var r;if(Fl(e))r=[];else if(L0(e))r=new Date(e.getTime?e.getTime():e);else if(x0(e))r=new RegExp(e);else if(N0(e))r={message:e.message};else if(R0(e)||B0(e)||D0(e))r=Object(e);else{var n=Cl(e);if(n)return Ol(e);if(Object.create&&Object.getPrototypeOf)r=Object.create(Object.getPrototypeOf(e));else if(e.constructor===Object)r={};else{var o=e.constructor&&e.constructor.prototype||e.__proto__||{},i=function(){};i.prototype=o,r=new i}}var a=t.includeSymbols?dn:pn;return fn(a(e),function(c){r[c]=e[c]}),r}return e}var zi={__proto__:null};function Ml(e,t){var r=[],n=[],o=!0,i=arguments.length>2?arguments[2]:zi,a=i.includeSymbols?dn:pn,c=!!i.immutable;return function u(y){var h=c?Pl(y,i):y,T={__proto__:null},l=!0,f={node:h,node_:y,path:[].concat(r),parent:n[n.length-1],parents:n,key:r[r.length-1],removedKeys:{__proto__:null},isRoot:r.length===0,level:r.length,circular:null,update:function(A,x){f.isRoot||(f.parent.node[f.key]=A),f.node=A,x&&(l=!1)},delete:function(A){delete f.parent.node[f.key],f.parent.removedKeys[f.key]=!0,A&&(l=!1)},remove:function(A){Fl(f.parent.node)?(f.parent.node.splice(f.key,1),f.parent.removedKeys[f.key]=!0,A&&(l=!1)):f.delete(A)},keys:null,before:function(A){T.before=A},after:function(A){T.after=A},pre:function(A){T.pre=A},post:function(A){T.post=A},stop:function(){o=!1},block:function(){l=!1}};if(!o)return f;function _(){if(typeof f.node=="object"&&f.node!==null){(!f.keys||f.node_!==f.node)&&(f.keys=a(f.node)),f.isLeaf=f.keys.length===0;for(var A=0;A<n.length;A++)if(n[A].node_===y){f.circular=n[A];break}}else f.isLeaf=!0,f.keys=null;f.notLeaf=!f.isLeaf,f.notRoot=!f.isRoot}_();var E=t.call(f,f.node);return E!==void 0&&f.update&&f.update(E),T.before&&T.before.call(f,f.node),l&&(typeof f.node=="object"&&f.node!==null&&!f.circular&&(n[n.length]=f,_(),fn(f.keys,function(A,x){var F=x-1 in f.removedKeys;F&&(A=f.keys[x-1]),r[r.length]=A,T.pre&&T.pre.call(f,f.node[A],A);var m=u(f.node[A]);c&&hn.call(f.node,A)&&!k0(f.node,A)&&!F&&(f.node[A]=m.node),m.isLast=x===f.keys.length-1,m.isFirst=x===0,T.post&&T.post.call(f,m),r.pop()}),n.pop()),T.after&&T.after.call(f,f.node)),f}(e).node}function we(e){this.options=arguments.length>1?arguments[1]:zi,this.value=e}we.prototype.get=function(e){for(var t=this.value,r=0;t&&r<e.length;r++){var n=e[r];if(!hn.call(t,n)||!this.options.includeSymbols&&typeof n=="symbol")return;t=t[n]}return t};we.prototype.has=function(e){var t=this.value;if(!t&&e.length>0)return!1;for(var r=0;t&&r<e.length;r++){var n=e[r];if(!hn.call(t,n)||!this.options.includeSymbols&&typeof n=="symbol")return!1;t=t[n]}return!0};we.prototype.set=function(e,t){for(var r=this.value,n=0;n<e.length-1;n++){var o=e[n];hn.call(r,o)||(r[o]={}),r=r[o]}return r[e[n]]=t,t};we.prototype.map=function(e){return Ml(this.value,e,{__proto__:null,immutable:!0,includeSymbols:!!this.options.includeSymbols})};we.prototype.forEach=function(e){return this.value=Ml(this.value,e,this.options),this.value};we.prototype.reduce=function(e,t){var r=arguments.length===1,n=r?this.value:t;return this.forEach(function(o){(!this.isRoot||!r)&&(n=e.call(this,n,o))}),n};we.prototype.paths=function(){var e=[];return this.forEach(function(){e[e.length]=this.path}),e};we.prototype.nodes=function(){var e=[];return this.forEach(function(){e[e.length]=this.node}),e};we.prototype.clone=function(){var e=[],t=[],r=this.options;return Cl(this.value)?Ol(this.value):function n(o){for(var i=0;i<e.length;i++)if(e[i]===o)return t[i];if(typeof o=="object"&&o!==null){var a=Pl(o,r);e[e.length]=o,t[t.length]=a;var c=r.includeSymbols?dn:pn;return fn(c(o),function(u){a[u]=n(o[u])}),e.pop(),t.pop(),a}return o}(this.value)};function Ll(e){var t=arguments.length>1?arguments[1]:zi;return new we(e,t)}fn(dn(we.prototype),function(e){Ll[e]=function(t){var r=[].slice.call(arguments,1),n=new we(t);return n[e].apply(n,r)}});var j0=Ll,q0=ge;function ge(e){if(!(this instanceof ge))return new ge(e);this._bbox=e||[1/0,1/0,-1/0,-1/0],this._valid=!!e}ge.prototype.include=function(e){return this._valid=!0,this._bbox[0]=Math.min(this._bbox[0],e[0]),this._bbox[1]=Math.min(this._bbox[1],e[1]),this._bbox[2]=Math.max(this._bbox[2],e[0]),this._bbox[3]=Math.max(this._bbox[3],e[1]),this};ge.prototype.equals=function(e){var t;return e instanceof ge?t=e.bbox():t=e,this._bbox[0]==t[0]&&this._bbox[1]==t[1]&&this._bbox[2]==t[2]&&this._bbox[3]==t[3]};ge.prototype.center=function(e){return this._valid?[(this._bbox[0]+this._bbox[2])/2,(this._bbox[1]+this._bbox[3])/2]:null};ge.prototype.union=function(e){this._valid=!0;var t;return e instanceof ge?t=e.bbox():t=e,this._bbox[0]=Math.min(this._bbox[0],t[0]),this._bbox[1]=Math.min(this._bbox[1],t[1]),this._bbox[2]=Math.max(this._bbox[2],t[2]),this._bbox[3]=Math.max(this._bbox[3],t[3]),this};ge.prototype.bbox=function(){return this._valid?this._bbox:null};ge.prototype.contains=function(e){if(!e)return this._fastContains();if(!this._valid)return null;var t=e[0],r=e[1];return this._bbox[0]<=t&&this._bbox[1]<=r&&this._bbox[2]>=t&&this._bbox[3]>=r};ge.prototype.intersect=function(e){if(!this._valid)return null;var t;return e instanceof ge?t=e.bbox():t=e,!(this._bbox[0]>t[2]||this._bbox[2]<t[0]||this._bbox[3]<t[1]||this._bbox[1]>t[3])};ge.prototype._fastContains=function(){if(!this._valid)return new Function("return null;");var e="return "+this._bbox[0]+"<= ll[0] &&"+this._bbox[1]+"<= ll[1] &&"+this._bbox[2]+">= ll[0] &&"+this._bbox[3]+">= ll[1]";return new Function("ll",e)};ge.prototype.polygon=function(){return this._valid?{type:"Polygon",coordinates:[[[this._bbox[0],this._bbox[1]],[this._bbox[2],this._bbox[1]],[this._bbox[2],this._bbox[3]],[this._bbox[0],this._bbox[3]],[this._bbox[0],this._bbox[1]]]]}:null};var G0=xd,V0=j0,W0=q0,xl={features:["FeatureCollection"],coordinates:["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],geometry:["Feature"],geometries:["GeometryCollection"]},z0=Object.keys(xl);an.exports=function(e){return Hi(e).bbox()};an.exports.polygon=function(e){return Hi(e).polygon()};an.exports.bboxify=function(e){return V0(e).map(function(t){if(t){var r=z0.some(function(n){return t[n]?xl[n].indexOf(t.type)!==-1:!1});r&&(t.bbox=Hi(t).bbox(),this.update(t))}})};function Hi(e){for(var t=W0(),r=G0(e),n=0;n<r.length;n++)t.include(r[n]);return t}var H0=an.exports;const K0=H0,J0=G,{LAT_MIN:$r,LAT_MAX:Cr,LAT_RENDERED_MIN:Bu,LAT_RENDERED_MAX:Du,LNG_MIN:Uu,LNG_MAX:ku}=J0;var Ki=function(e,t){let r=$r,n=Cr,o=$r,i=Cr,a=ku,c=Uu;e.forEach(y=>{const h=K0(y),T=h[1],l=h[3],f=h[0],_=h[2];T>r&&(r=T),l<n&&(n=l),l>o&&(o=l),T<i&&(i=T),f<a&&(a=f),_>c&&(c=_)});const u=t;return r+u.lat>Du&&(u.lat=Du-r),o+u.lat>Cr&&(u.lat=Cr-o),n+u.lat<Bu&&(u.lat=Bu-n),i+u.lat<$r&&(u.lat=$r-i),a+u.lng<=Uu&&(u.lng+=Math.ceil(Math.abs(u.lng)/360)*360),c+u.lng>=ku&&(u.lng-=Math.ceil(Math.abs(u.lng)/360)*360),u};const Y0=Ki,St=G;var yn=function(e,t){const r=Y0(e.map(n=>n.toGeoJSON()),t);e.forEach(n=>{const o=n.getCoordinates(),i=y=>{const h={lng:y[0]+r.lng,lat:y[1]+r.lat};return[h.lng,h.lat]},a=y=>y.map(h=>i(h)),c=y=>y.map(h=>a(h));let u;n.type===St.geojsonTypes.POINT?u=i(o):n.type===St.geojsonTypes.LINE_STRING||n.type===St.geojsonTypes.MULTI_POINT?u=o.map(i):n.type===St.geojsonTypes.POLYGON||n.type===St.geojsonTypes.MULTI_LINE_STRING?u=o.map(a):n.type===St.geojsonTypes.MULTI_POLYGON&&(u=o.map(c)),n.incomingCoords(u)})};const ft=Pt,Ji=Id,Z0=on,X0=Xr,zr=Mt,Q0=yn,oe=G,H={};H.onSetup=function(e){const t={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoveing:!1,canDragMove:!1,initiallySelectedFeatureIds:e.featureIds||[]};return this.setSelected(t.initiallySelectedFeatureIds.filter(r=>this.getFeature(r)!==void 0)),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),t};H.fireUpdate=function(){this.map.fire(oe.events.UPDATE,{action:oe.updateActions.MOVE,features:this.getSelected().map(e=>e.toGeoJSON())})};H.fireActionable=function(){const e=this.getSelected(),t=e.filter(i=>this.isInstanceOf("MultiFeature",i));let r=!1;if(e.length>1){r=!0;const i=e[0].type.replace("Multi","");e.forEach(a=>{a.type.replace("Multi","")!==i&&(r=!1)})}const n=t.length>0,o=e.length>0;this.setActionableState({combineFeatures:r,uncombineFeatures:n,trash:o})};H.getUniqueIds=function(e){return e.length?e.map(r=>r.properties.id).filter(r=>r!==void 0).reduce((r,n)=>(r.add(n),r),new X0).values():[]};H.stopExtendedInteractions=function(e){e.boxSelectElement&&(e.boxSelectElement.parentNode&&e.boxSelectElement.parentNode.removeChild(e.boxSelectElement),e.boxSelectElement=null),this.map.dragPan.enable(),e.boxSelecting=!1,e.canBoxSelect=!1,e.dragMoving=!1,e.canDragMove=!1};H.onStop=function(){zr.enable(this)};H.onMouseMove=function(e){return this.stopExtendedInteractions(e)};H.onMouseOut=function(e){if(e.dragMoving)return this.fireUpdate()};H.onTap=H.onClick=function(e,t){if(ft.noTarget(t))return this.clickAnywhere(e,t);if(ft.isOfMetaType(oe.meta.VERTEX)(t))return this.clickOnVertex(e,t);if(ft.isFeature(t))return this.clickOnFeature(e,t)};H.clickAnywhere=function(e){const t=this.getSelectedIds();t.length&&(this.clearSelectedFeatures(),t.forEach(r=>this.doRender(r))),zr.enable(this),this.stopExtendedInteractions(e)};H.clickOnVertex=function(e,t){this.changeMode(oe.modes.DIRECT_SELECT,{featureId:t.featureTarget.properties.parent,coordPath:t.featureTarget.properties.coord_path,startPos:t.lngLat}),this.updateUIClasses({mouse:oe.cursors.MOVE})};H.startOnActiveFeature=function(e,t){this.stopExtendedInteractions(e),this.map.dragPan.disable(),this.doRender(t.featureTarget.properties.id),e.canDragMove=!0,e.dragMoveLocation=t.lngLat};H.clickOnFeature=function(e,t){zr.disable(this),this.stopExtendedInteractions(e);const r=ft.isShiftDown(t),n=this.getSelectedIds(),o=t.featureTarget.properties.id,i=this.isSelected(o);if(!r&&i&&this.getFeature(o).type!==oe.geojsonTypes.POINT)return this.changeMode(oe.modes.DIRECT_SELECT,{featureId:o});i&&r?(this.deselect(o),this.updateUIClasses({mouse:oe.cursors.POINTER}),n.length===1&&zr.enable(this)):!i&&r?(this.select(o),this.updateUIClasses({mouse:oe.cursors.MOVE})):!i&&!r&&(n.forEach(a=>this.doRender(a)),this.setSelected(o),this.updateUIClasses({mouse:oe.cursors.MOVE})),this.doRender(o)};H.onMouseDown=function(e,t){if(ft.isActiveFeature(t))return this.startOnActiveFeature(e,t);if(this.drawConfig.boxSelect&&ft.isShiftMousedown(t))return this.startBoxSelect(e,t)};H.startBoxSelect=function(e,t){this.stopExtendedInteractions(e),this.map.dragPan.disable(),e.boxSelectStartLocation=Ji(t.originalEvent,this.map.getContainer()),e.canBoxSelect=!0};H.onTouchStart=function(e,t){if(ft.isActiveFeature(t))return this.startOnActiveFeature(e,t)};H.onDrag=function(e,t){if(e.canDragMove)return this.dragMove(e,t);if(this.drawConfig.boxSelect&&e.canBoxSelect)return this.whileBoxSelect(e,t)};H.whileBoxSelect=function(e,t){e.boxSelecting=!0,this.updateUIClasses({mouse:oe.cursors.ADD}),e.boxSelectElement||(e.boxSelectElement=document.createElement("div"),e.boxSelectElement.classList.add(oe.classes.BOX_SELECT),this.map.getContainer().appendChild(e.boxSelectElement));const r=Ji(t.originalEvent,this.map.getContainer()),n=Math.min(e.boxSelectStartLocation.x,r.x),o=Math.max(e.boxSelectStartLocation.x,r.x),i=Math.min(e.boxSelectStartLocation.y,r.y),a=Math.max(e.boxSelectStartLocation.y,r.y),c=`translate(${n}px, ${i}px)`;e.boxSelectElement.style.transform=c,e.boxSelectElement.style.WebkitTransform=c,e.boxSelectElement.style.width=`${o-n}px`,e.boxSelectElement.style.height=`${a-i}px`};H.dragMove=function(e,t){e.dragMoving=!0,t.originalEvent.stopPropagation();const r={lng:t.lngLat.lng-e.dragMoveLocation.lng,lat:t.lngLat.lat-e.dragMoveLocation.lat};Q0(this.getSelected(),r),e.dragMoveLocation=t.lngLat};H.onMouseUp=function(e,t){if(e.dragMoving)this.fireUpdate();else if(e.boxSelecting){const r=[e.boxSelectStartLocation,Ji(t.originalEvent,this.map.getContainer())],n=this.featuresAt(null,r,"click"),o=this.getUniqueIds(n).filter(i=>!this.isSelected(i));o.length&&(this.select(o),o.forEach(i=>this.doRender(i)),this.updateUIClasses({mouse:oe.cursors.MOVE}))}this.stopExtendedInteractions(e)};H.toDisplayFeatures=function(e,t,r){t.properties.active=this.isSelected(t.properties.id)?oe.activeStates.ACTIVE:oe.activeStates.INACTIVE,r(t),this.fireActionable(),!(t.properties.active!==oe.activeStates.ACTIVE||t.geometry.type===oe.geojsonTypes.POINT)&&Z0(t).forEach(r)};H.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()};H.onCombineFeatures=function(){const e=this.getSelected();if(e.length===0||e.length<2)return;const t=[],r=[],n=e[0].type.replace("Multi","");for(let o=0;o<e.length;o++){const i=e[o];if(i.type.replace("Multi","")!==n)return;i.type.includes("Multi")?i.getCoordinates().forEach(a=>{t.push(a)}):t.push(i.getCoordinates()),r.push(i.toGeoJSON())}if(r.length>1){const o=this.newFeature({type:oe.geojsonTypes.FEATURE,properties:r[0].properties,geometry:{type:`Multi${n}`,coordinates:t}});this.addFeature(o),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([o.id]),this.map.fire(oe.events.COMBINE_FEATURES,{createdFeatures:[o.toGeoJSON()],deletedFeatures:r})}this.fireActionable()};H.onUncombineFeatures=function(){const e=this.getSelected();if(e.length===0)return;const t=[],r=[];for(let n=0;n<e.length;n++){const o=e[n];this.isInstanceOf("MultiFeature",o)&&(o.getFeatures().forEach(i=>{this.addFeature(i),i.properties=o.properties,t.push(i.toGeoJSON()),this.select([i.id])}),this.deleteFeature(o.id,{silent:!0}),r.push(o.toGeoJSON()))}t.length>1&&this.map.fire(oe.events.UNCOMBINE_FEATURES,{createdFeatures:t,deletedFeatures:r}),this.fireActionable()};var eT=H;const{noTarget:Nl,isOfMetaType:Rl,isInactiveFeature:Bl,isShiftDown:ju}=Pt,tT=on,rT=Ki,Dl=Mt,ye=G,gn=Pt,nT=yn,Ul=Rl(ye.meta.VERTEX),oT=Rl(ye.meta.MIDPOINT),W={};W.fireUpdate=function(){this.map.fire(ye.events.UPDATE,{action:ye.updateActions.CHANGE_COORDINATES,features:this.getSelected().map(e=>e.toGeoJSON())})};W.fireActionable=function(e){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:e.selectedCoordPaths.length>0})};W.startDragging=function(e,t){this.map.dragPan.disable(),e.canDragMove=!0,e.dragMoveLocation=t.lngLat};W.stopDragging=function(e){this.map.dragPan.enable(),e.dragMoving=!1,e.canDragMove=!1,e.dragMoveLocation=null};W.onVertex=function(e,t){this.startDragging(e,t);const r=t.featureTarget.properties,n=e.selectedCoordPaths.indexOf(r.coord_path);!ju(t)&&n===-1?e.selectedCoordPaths=[r.coord_path]:ju(t)&&n===-1&&e.selectedCoordPaths.push(r.coord_path);const o=this.pathsToCoordinates(e.featureId,e.selectedCoordPaths);this.setSelectedCoordinates(o)};W.onMidpoint=function(e,t){this.startDragging(e,t);const r=t.featureTarget.properties;e.feature.addCoordinate(r.coord_path,r.lng,r.lat),this.fireUpdate(),e.selectedCoordPaths=[r.coord_path]};W.pathsToCoordinates=function(e,t){return t.map(r=>({feature_id:e,coord_path:r}))};W.onFeature=function(e,t){e.selectedCoordPaths.length===0?this.startDragging(e,t):this.stopDragging(e)};W.dragFeature=function(e,t,r){nT(this.getSelected(),r),e.dragMoveLocation=t.lngLat};W.dragVertex=function(e,t,r){const n=e.selectedCoordPaths.map(a=>e.feature.getCoordinate(a)),o=n.map(a=>({type:ye.geojsonTypes.FEATURE,properties:{},geometry:{type:ye.geojsonTypes.POINT,coordinates:a}})),i=rT(o,r);for(let a=0;a<n.length;a++){const c=n[a];e.feature.updateCoordinate(e.selectedCoordPaths[a],c[0]+i.lng,c[1]+i.lat)}};W.clickNoTarget=function(){this.changeMode(ye.modes.SIMPLE_SELECT)};W.clickInactive=function(){this.changeMode(ye.modes.SIMPLE_SELECT)};W.clickActiveFeature=function(e){e.selectedCoordPaths=[],this.clearSelectedCoordinates(),e.feature.changed()};W.onSetup=function(e){const t=e.featureId,r=this.getFeature(t);if(!r)throw new Error("You must provide a featureId to enter direct_select mode");if(r.type===ye.geojsonTypes.POINT)throw new TypeError("direct_select mode doesn't handle point features");const n={featureId:t,feature:r,dragMoveLocation:e.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:e.coordPath?[e.coordPath]:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(t,n.selectedCoordPaths)),this.setSelected(t),Dl.disable(this),this.setActionableState({trash:!0}),n};W.onStop=function(){Dl.enable(this),this.clearSelectedCoordinates()};W.toDisplayFeatures=function(e,t,r){e.featureId===t.properties.id?(t.properties.active=ye.activeStates.ACTIVE,r(t),tT(t,{map:this.map,midpoints:!0,selectedPaths:e.selectedCoordPaths}).forEach(r)):(t.properties.active=ye.activeStates.INACTIVE,r(t)),this.fireActionable(e)};W.onTrash=function(e){e.selectedCoordPaths.sort().reverse().forEach(t=>e.feature.removeCoordinate(t)),this.fireUpdate(),e.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(e),e.feature.isValid()===!1&&(this.deleteFeature([e.featureId]),this.changeMode(ye.modes.SIMPLE_SELECT,{}))};W.onMouseMove=function(e,t){const r=gn.isActiveFeature(t),n=Ul(t),o=e.selectedCoordPaths.length===0;r&&o?this.updateUIClasses({mouse:ye.cursors.MOVE}):n&&!o?this.updateUIClasses({mouse:ye.cursors.MOVE}):this.updateUIClasses({mouse:ye.cursors.NONE}),this.stopDragging(e)};W.onMouseOut=function(e){e.dragMoving&&this.fireUpdate()};W.onTouchStart=W.onMouseDown=function(e,t){if(Ul(t))return this.onVertex(e,t);if(gn.isActiveFeature(t))return this.onFeature(e,t);if(oT(t))return this.onMidpoint(e,t)};W.onDrag=function(e,t){if(e.canDragMove!==!0)return;e.dragMoving=!0,t.originalEvent.stopPropagation();const r={lng:t.lngLat.lng-e.dragMoveLocation.lng,lat:t.lngLat.lat-e.dragMoveLocation.lat};e.selectedCoordPaths.length>0?this.dragVertex(e,t,r):this.dragFeature(e,t,r),e.dragMoveLocation=t.lngLat};W.onClick=function(e,t){if(Nl(t))return this.clickNoTarget(e,t);if(gn.isActiveFeature(t))return this.clickActiveFeature(e,t);if(Bl(t))return this.clickInactive(e,t);this.stopDragging(e)};W.onTap=function(e,t){if(Nl(t))return this.clickNoTarget(e,t);if(gn.isActiveFeature(t))return this.clickActiveFeature(e,t);if(Bl(t))return this.clickInactive(e,t)};W.onTouchEnd=W.onMouseUp=function(e){e.dragMoving&&this.fireUpdate(),this.stopDragging(e)};var iT=W;const qu=Pt,Re=G,Be={};Be.onSetup=function(){const e=this.newFeature({type:Re.geojsonTypes.FEATURE,properties:{},geometry:{type:Re.geojsonTypes.POINT,coordinates:[]}});return this.addFeature(e),this.clearSelectedFeatures(),this.updateUIClasses({mouse:Re.cursors.ADD}),this.activateUIButton(Re.types.POINT),this.setActionableState({trash:!0}),{point:e}};Be.stopDrawingAndRemove=function(e){this.deleteFeature([e.point.id],{silent:!0}),this.changeMode(Re.modes.SIMPLE_SELECT)};Be.onTap=Be.onClick=function(e,t){this.updateUIClasses({mouse:Re.cursors.MOVE}),e.point.updateCoordinate("",t.lngLat.lng,t.lngLat.lat),this.map.fire(Re.events.CREATE,{features:[e.point.toGeoJSON()]}),this.changeMode(Re.modes.SIMPLE_SELECT,{featureIds:[e.point.id]})};Be.onStop=function(e){this.activateUIButton(),e.point.getCoordinate().length||this.deleteFeature([e.point.id],{silent:!0})};Be.toDisplayFeatures=function(e,t,r){const n=t.properties.id===e.point.id;if(t.properties.active=n?Re.activeStates.ACTIVE:Re.activeStates.INACTIVE,!n)return r(t)};Be.onTrash=Be.stopDrawingAndRemove;Be.onKeyUp=function(e,t){if(qu.isEscapeKey(t)||qu.isEnterKey(t))return this.stopDrawingAndRemove(e,t)};var aT=Be;function sT(e,t){return e.lngLat?e.lngLat.lng===t[0]&&e.lngLat.lat===t[1]:!1}var kl=sT;const Hr=Pt,jl=Mt,se=G,uT=kl,Gu=nn,Ce={};Ce.onSetup=function(){const e=this.newFeature({type:se.geojsonTypes.FEATURE,properties:{},geometry:{type:se.geojsonTypes.POLYGON,coordinates:[[]]}});return this.addFeature(e),this.clearSelectedFeatures(),jl.disable(this),this.updateUIClasses({mouse:se.cursors.ADD}),this.activateUIButton(se.types.POLYGON),this.setActionableState({trash:!0}),{polygon:e,currentVertexPosition:0}};Ce.clickAnywhere=function(e,t){if(e.currentVertexPosition>0&&uT(t,e.polygon.coordinates[0][e.currentVertexPosition-1]))return this.changeMode(se.modes.SIMPLE_SELECT,{featureIds:[e.polygon.id]});this.updateUIClasses({mouse:se.cursors.ADD}),e.polygon.updateCoordinate(`0.${e.currentVertexPosition}`,t.lngLat.lng,t.lngLat.lat),e.currentVertexPosition++,e.polygon.updateCoordinate(`0.${e.currentVertexPosition}`,t.lngLat.lng,t.lngLat.lat)};Ce.clickOnVertex=function(e){return this.changeMode(se.modes.SIMPLE_SELECT,{featureIds:[e.polygon.id]})};Ce.onMouseMove=function(e,t){e.polygon.updateCoordinate(`0.${e.currentVertexPosition}`,t.lngLat.lng,t.lngLat.lat),Hr.isVertex(t)&&this.updateUIClasses({mouse:se.cursors.POINTER})};Ce.onTap=Ce.onClick=function(e,t){return Hr.isVertex(t)?this.clickOnVertex(e,t):this.clickAnywhere(e,t)};Ce.onKeyUp=function(e,t){Hr.isEscapeKey(t)?(this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(se.modes.SIMPLE_SELECT)):Hr.isEnterKey(t)&&this.changeMode(se.modes.SIMPLE_SELECT,{featureIds:[e.polygon.id]})};Ce.onStop=function(e){this.updateUIClasses({mouse:se.cursors.NONE}),jl.enable(this),this.activateUIButton(),this.getFeature(e.polygon.id)!==void 0&&(e.polygon.removeCoordinate(`0.${e.currentVertexPosition}`),e.polygon.isValid()?this.map.fire(se.events.CREATE,{features:[e.polygon.toGeoJSON()]}):(this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(se.modes.SIMPLE_SELECT,{},{silent:!0})))};Ce.toDisplayFeatures=function(e,t,r){const n=t.properties.id===e.polygon.id;if(t.properties.active=n?se.activeStates.ACTIVE:se.activeStates.INACTIVE,!n)return r(t);if(t.geometry.coordinates.length===0)return;const o=t.geometry.coordinates[0].length;if(!(o<3)){if(t.properties.meta=se.meta.FEATURE,r(Gu(e.polygon.id,t.geometry.coordinates[0][0],"0.0",!1)),o>3){const i=t.geometry.coordinates[0].length-3;r(Gu(e.polygon.id,t.geometry.coordinates[0][i],`0.${i}`,!1))}if(o<=4){const i=[[t.geometry.coordinates[0][0][0],t.geometry.coordinates[0][0][1]],[t.geometry.coordinates[0][1][0],t.geometry.coordinates[0][1][1]]];if(r({type:se.geojsonTypes.FEATURE,properties:t.properties,geometry:{coordinates:i,type:se.geojsonTypes.LINE_STRING}}),o===3)return}return r(t)}};Ce.onTrash=function(e){this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(se.modes.SIMPLE_SELECT)};var cT=Ce;const Kr=Pt,Vu=kl,ql=Mt,pe=G,lT=nn,Oe={};Oe.onSetup=function(e){e=e||{};const t=e.featureId;let r,n,o="forward";if(t){if(r=this.getFeature(t),!r)throw new Error("Could not find a feature with the provided featureId");let i=e.from;if(i&&i.type==="Feature"&&i.geometry&&i.geometry.type==="Point"&&(i=i.geometry),i&&i.type==="Point"&&i.coordinates&&i.coordinates.length===2&&(i=i.coordinates),!i||!Array.isArray(i))throw new Error("Please use the `from` property to indicate which point to continue the line from");const a=r.coordinates.length-1;if(r.coordinates[a][0]===i[0]&&r.coordinates[a][1]===i[1])n=a+1,r.addCoordinate(n,...r.coordinates[a]);else if(r.coordinates[0][0]===i[0]&&r.coordinates[0][1]===i[1])o="backwards",n=0,r.addCoordinate(n,...r.coordinates[0]);else throw new Error("`from` should match the point at either the start or the end of the provided LineString")}else r=this.newFeature({type:pe.geojsonTypes.FEATURE,properties:{},geometry:{type:pe.geojsonTypes.LINE_STRING,coordinates:[]}}),n=0,this.addFeature(r);return this.clearSelectedFeatures(),ql.disable(this),this.updateUIClasses({mouse:pe.cursors.ADD}),this.activateUIButton(pe.types.LINE),this.setActionableState({trash:!0}),{line:r,currentVertexPosition:n,direction:o}};Oe.clickAnywhere=function(e,t){if(e.currentVertexPosition>0&&Vu(t,e.line.coordinates[e.currentVertexPosition-1])||e.direction==="backwards"&&Vu(t,e.line.coordinates[e.currentVertexPosition+1]))return this.changeMode(pe.modes.SIMPLE_SELECT,{featureIds:[e.line.id]});this.updateUIClasses({mouse:pe.cursors.ADD}),e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat),e.direction==="forward"?(e.currentVertexPosition++,e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat)):e.line.addCoordinate(0,t.lngLat.lng,t.lngLat.lat)};Oe.clickOnVertex=function(e){return this.changeMode(pe.modes.SIMPLE_SELECT,{featureIds:[e.line.id]})};Oe.onMouseMove=function(e,t){e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat),Kr.isVertex(t)&&this.updateUIClasses({mouse:pe.cursors.POINTER})};Oe.onTap=Oe.onClick=function(e,t){if(Kr.isVertex(t))return this.clickOnVertex(e,t);this.clickAnywhere(e,t)};Oe.onKeyUp=function(e,t){Kr.isEnterKey(t)?this.changeMode(pe.modes.SIMPLE_SELECT,{featureIds:[e.line.id]}):Kr.isEscapeKey(t)&&(this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(pe.modes.SIMPLE_SELECT))};Oe.onStop=function(e){ql.enable(this),this.activateUIButton(),this.getFeature(e.line.id)!==void 0&&(e.line.removeCoordinate(`${e.currentVertexPosition}`),e.line.isValid()?this.map.fire(pe.events.CREATE,{features:[e.line.toGeoJSON()]}):(this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(pe.modes.SIMPLE_SELECT,{},{silent:!0})))};Oe.onTrash=function(e){this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(pe.modes.SIMPLE_SELECT)};Oe.toDisplayFeatures=function(e,t,r){const n=t.properties.id===e.line.id;if(t.properties.active=n?pe.activeStates.ACTIVE:pe.activeStates.INACTIVE,!n)return r(t);t.geometry.coordinates.length<2||(t.properties.meta=pe.meta.FEATURE,r(lT(e.line.id,t.geometry.coordinates[e.direction==="forward"?t.geometry.coordinates.length-2:1],`${e.direction==="forward"?t.geometry.coordinates.length-2:1}`,!1)),r(t))};var fT=Oe,Gl={simple_select:eT,direct_select:iT,draw_point:aT,draw_polygon:cT,draw_line_string:fT};const Xt=Ei,Si=G,pT={defaultMode:Si.modes.SIMPLE_SELECT,keybindings:!0,touchEnabled:!0,clickBuffer:2,touchBuffer:25,boxSelect:!0,displayControlsDefault:!0,styles:_d,modes:Gl,controls:{},userProperties:!1},dT={point:!0,line_string:!0,polygon:!0,trash:!0,combine_features:!0,uncombine_features:!0},hT={point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1};function Wu(e,t){return e.map(r=>r.source?r:Xt(r,{id:`${r.id}.${t}`,source:t==="hot"?Si.sources.HOT:Si.sources.COLD}))}var yT=function(e={}){let t=Xt(e);return e.controls||(t.controls={}),e.displayControlsDefault===!1?t.controls=Xt(hT,e.controls):t.controls=Xt(dT,e.controls),t=Xt(pT,t),t.styles=Wu(t.styles,"cold").concat(Wu(t.styles,"hot")),t},Jr={exports:{}};Jr.exports;(function(e,t){var r=200,n="__lodash_hash_undefined__",o=1,i=2,a=9007199254740991,c="[object Arguments]",u="[object Array]",y="[object AsyncFunction]",h="[object Boolean]",T="[object Date]",l="[object Error]",f="[object Function]",_="[object GeneratorFunction]",E="[object Map]",A="[object Number]",x="[object Null]",F="[object Object]",m="[object Promise]",w="[object Proxy]",$="[object RegExp]",M="[object Set]",C="[object String]",B="[object Symbol]",d="[object Undefined]",I="[object WeakMap]",g="[object ArrayBuffer]",v="[object DataView]",b="[object Float32Array]",P="[object Float64Array]",U="[object Int8Array]",te="[object Int16Array]",ve="[object Int32Array]",Me="[object Uint8Array]",nt="[object Uint8ClampedArray]",kt="[object Uint16Array]",ae="[object Uint32Array]",N=/[\\^$.*+?()[\]{}|]/g,R=/^\[object .+?Constructor\]$/,q=/^(?:0|[1-9]\d*)$/,L={};L[b]=L[P]=L[U]=L[te]=L[ve]=L[Me]=L[nt]=L[kt]=L[ae]=!0,L[c]=L[u]=L[g]=L[h]=L[v]=L[T]=L[l]=L[f]=L[E]=L[A]=L[F]=L[$]=L[M]=L[C]=L[I]=!1;var z=typeof window=="object"&&window&&window.Object===Object&&window,k=typeof self=="object"&&self&&self.Object===Object&&self,K=z||k||Function("return this")(),be=t&&!t.nodeType&&t,de=be&&!0&&e&&!e.nodeType&&e,Ae=de&&de.exports===be,jt=Ae&&z.process,qt=function(){try{return jt&&jt.binding&&jt.binding("util")}catch{}}(),Ie=qt&&qt.isTypedArray;function Gt(s,p){for(var S=-1,O=s==null?0:s.length,J=0,D=[];++S<O;){var ee=s[S];p(ee,S,s)&&(D[J++]=ee)}return D}function Vt(s,p){for(var S=-1,O=p.length,J=s.length;++S<O;)s[J+S]=p[S];return s}function ur(s,p){for(var S=-1,O=s==null?0:s.length;++S<O;)if(p(s[S],S,s))return!0;return!1}function bn(s,p){for(var S=-1,O=Array(s);++S<s;)O[S]=p(S);return O}function Yl(s){return function(p){return s(p)}}function Zl(s,p){return s.has(p)}function Xl(s,p){return s==null?void 0:s[p]}function Ql(s){var p=-1,S=Array(s.size);return s.forEach(function(O,J){S[++p]=[J,O]}),S}function ef(s,p){return function(S){return s(p(S))}}function tf(s){var p=-1,S=Array(s.size);return s.forEach(function(O){S[++p]=O}),S}var rf=Array.prototype,nf=Function.prototype,cr=Object.prototype,Tn=K["__core-js_shared__"],Qi=nf.toString,Le=cr.hasOwnProperty,ea=function(){var s=/[^.]+$/.exec(Tn&&Tn.keys&&Tn.keys.IE_PROTO||"");return s?"Symbol(src)_1."+s:""}(),ta=cr.toString,of=RegExp("^"+Qi.call(Le).replace(N,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ra=Ae?K.Buffer:void 0,lr=K.Symbol,na=K.Uint8Array,oa=cr.propertyIsEnumerable,af=rf.splice,ot=lr?lr.toStringTag:void 0,ia=Object.getOwnPropertySymbols,sf=ra?ra.isBuffer:void 0,uf=ef(Object.keys,Object),Sn=vt(K,"DataView"),Wt=vt(K,"Map"),_n=vt(K,"Promise"),En=vt(K,"Set"),wn=vt(K,"WeakMap"),zt=vt(Object,"create"),cf=st(Sn),lf=st(Wt),ff=st(_n),pf=st(En),df=st(wn),aa=lr?lr.prototype:void 0,An=aa?aa.valueOf:void 0;function it(s){var p=-1,S=s==null?0:s.length;for(this.clear();++p<S;){var O=s[p];this.set(O[0],O[1])}}function hf(){this.__data__=zt?zt(null):{},this.size=0}function yf(s){var p=this.has(s)&&delete this.__data__[s];return this.size-=p?1:0,p}function gf(s){var p=this.__data__;if(zt){var S=p[s];return S===n?void 0:S}return Le.call(p,s)?p[s]:void 0}function vf(s){var p=this.__data__;return zt?p[s]!==void 0:Le.call(p,s)}function mf(s,p){var S=this.__data__;return this.size+=this.has(s)?0:1,S[s]=zt&&p===void 0?n:p,this}it.prototype.clear=hf,it.prototype.delete=yf,it.prototype.get=gf,it.prototype.has=vf,it.prototype.set=mf;function Ue(s){var p=-1,S=s==null?0:s.length;for(this.clear();++p<S;){var O=s[p];this.set(O[0],O[1])}}function bf(){this.__data__=[],this.size=0}function Tf(s){var p=this.__data__,S=pr(p,s);if(S<0)return!1;var O=p.length-1;return S==O?p.pop():af.call(p,S,1),--this.size,!0}function Sf(s){var p=this.__data__,S=pr(p,s);return S<0?void 0:p[S][1]}function _f(s){return pr(this.__data__,s)>-1}function Ef(s,p){var S=this.__data__,O=pr(S,s);return O<0?(++this.size,S.push([s,p])):S[O][1]=p,this}Ue.prototype.clear=bf,Ue.prototype.delete=Tf,Ue.prototype.get=Sf,Ue.prototype.has=_f,Ue.prototype.set=Ef;function at(s){var p=-1,S=s==null?0:s.length;for(this.clear();++p<S;){var O=s[p];this.set(O[0],O[1])}}function wf(){this.size=0,this.__data__={hash:new it,map:new(Wt||Ue),string:new it}}function Af(s){var p=dr(this,s).delete(s);return this.size-=p?1:0,p}function If(s){return dr(this,s).get(s)}function $f(s){return dr(this,s).has(s)}function Cf(s,p){var S=dr(this,s),O=S.size;return S.set(s,p),this.size+=S.size==O?0:1,this}at.prototype.clear=wf,at.prototype.delete=Af,at.prototype.get=If,at.prototype.has=$f,at.prototype.set=Cf;function fr(s){var p=-1,S=s==null?0:s.length;for(this.__data__=new at;++p<S;)this.add(s[p])}function Of(s){return this.__data__.set(s,n),this}function Ff(s){return this.__data__.has(s)}fr.prototype.add=fr.prototype.push=Of,fr.prototype.has=Ff;function ze(s){var p=this.__data__=new Ue(s);this.size=p.size}function Pf(){this.__data__=new Ue,this.size=0}function Mf(s){var p=this.__data__,S=p.delete(s);return this.size=p.size,S}function Lf(s){return this.__data__.get(s)}function xf(s){return this.__data__.has(s)}function Nf(s,p){var S=this.__data__;if(S instanceof Ue){var O=S.__data__;if(!Wt||O.length<r-1)return O.push([s,p]),this.size=++S.size,this;S=this.__data__=new at(O)}return S.set(s,p),this.size=S.size,this}ze.prototype.clear=Pf,ze.prototype.delete=Mf,ze.prototype.get=Lf,ze.prototype.has=xf,ze.prototype.set=Nf;function Rf(s,p){var S=hr(s),O=!S&&Zf(s),J=!S&&!O&&In(s),D=!S&&!O&&!J&&ya(s),ee=S||O||J||D,ue=ee?bn(s.length,String):[],le=ue.length;for(var Z in s)Le.call(s,Z)&&!(ee&&(Z=="length"||J&&(Z=="offset"||Z=="parent")||D&&(Z=="buffer"||Z=="byteLength"||Z=="byteOffset")||zf(Z,le)))&&ue.push(Z);return ue}function pr(s,p){for(var S=s.length;S--;)if(fa(s[S][0],p))return S;return-1}function Bf(s,p,S){var O=p(s);return hr(s)?O:Vt(O,S(s))}function Ht(s){return s==null?s===void 0?d:x:ot&&ot in Object(s)?Vf(s):Yf(s)}function sa(s){return Kt(s)&&Ht(s)==c}function ua(s,p,S,O,J){return s===p?!0:s==null||p==null||!Kt(s)&&!Kt(p)?s!==s&&p!==p:Df(s,p,S,O,ua,J)}function Df(s,p,S,O,J,D){var ee=hr(s),ue=hr(p),le=ee?u:He(s),Z=ue?u:He(p);le=le==c?F:le,Z=Z==c?F:Z;var me=le==F,$e=Z==F,fe=le==Z;if(fe&&In(s)){if(!In(p))return!1;ee=!0,me=!1}if(fe&&!me)return D||(D=new ze),ee||ya(s)?ca(s,p,S,O,J,D):qf(s,p,le,S,O,J,D);if(!(S&o)){var Te=me&&Le.call(s,"__wrapped__"),Se=$e&&Le.call(p,"__wrapped__");if(Te||Se){var Ke=Te?s.value():s,ke=Se?p.value():p;return D||(D=new ze),J(Ke,ke,S,O,D)}}return fe?(D||(D=new ze),Gf(s,p,S,O,J,D)):!1}function Uf(s){if(!ha(s)||Kf(s))return!1;var p=pa(s)?of:R;return p.test(st(s))}function kf(s){return Kt(s)&&da(s.length)&&!!L[Ht(s)]}function jf(s){if(!Jf(s))return uf(s);var p=[];for(var S in Object(s))Le.call(s,S)&&S!="constructor"&&p.push(S);return p}function ca(s,p,S,O,J,D){var ee=S&o,ue=s.length,le=p.length;if(ue!=le&&!(ee&&le>ue))return!1;var Z=D.get(s);if(Z&&D.get(p))return Z==p;var me=-1,$e=!0,fe=S&i?new fr:void 0;for(D.set(s,p),D.set(p,s);++me<ue;){var Te=s[me],Se=p[me];if(O)var Ke=ee?O(Se,Te,me,p,s,D):O(Te,Se,me,s,p,D);if(Ke!==void 0){if(Ke)continue;$e=!1;break}if(fe){if(!ur(p,function(ke,ut){if(!Zl(fe,ut)&&(Te===ke||J(Te,ke,S,O,D)))return fe.push(ut)})){$e=!1;break}}else if(!(Te===Se||J(Te,Se,S,O,D))){$e=!1;break}}return D.delete(s),D.delete(p),$e}function qf(s,p,S,O,J,D,ee){switch(S){case v:if(s.byteLength!=p.byteLength||s.byteOffset!=p.byteOffset)return!1;s=s.buffer,p=p.buffer;case g:return!(s.byteLength!=p.byteLength||!D(new na(s),new na(p)));case h:case T:case A:return fa(+s,+p);case l:return s.name==p.name&&s.message==p.message;case $:case C:return s==p+"";case E:var ue=Ql;case M:var le=O&o;if(ue||(ue=tf),s.size!=p.size&&!le)return!1;var Z=ee.get(s);if(Z)return Z==p;O|=i,ee.set(s,p);var me=ca(ue(s),ue(p),O,J,D,ee);return ee.delete(s),me;case B:if(An)return An.call(s)==An.call(p)}return!1}function Gf(s,p,S,O,J,D){var ee=S&o,ue=la(s),le=ue.length,Z=la(p),me=Z.length;if(le!=me&&!ee)return!1;for(var $e=le;$e--;){var fe=ue[$e];if(!(ee?fe in p:Le.call(p,fe)))return!1}var Te=D.get(s);if(Te&&D.get(p))return Te==p;var Se=!0;D.set(s,p),D.set(p,s);for(var Ke=ee;++$e<le;){fe=ue[$e];var ke=s[fe],ut=p[fe];if(O)var ga=ee?O(ut,ke,fe,p,s,D):O(ke,ut,fe,s,p,D);if(!(ga===void 0?ke===ut||J(ke,ut,S,O,D):ga)){Se=!1;break}Ke||(Ke=fe=="constructor")}if(Se&&!Ke){var yr=s.constructor,gr=p.constructor;yr!=gr&&"constructor"in s&&"constructor"in p&&!(typeof yr=="function"&&yr instanceof yr&&typeof gr=="function"&&gr instanceof gr)&&(Se=!1)}return D.delete(s),D.delete(p),Se}function la(s){return Bf(s,ep,Wf)}function dr(s,p){var S=s.__data__;return Hf(p)?S[typeof p=="string"?"string":"hash"]:S.map}function vt(s,p){var S=Xl(s,p);return Uf(S)?S:void 0}function Vf(s){var p=Le.call(s,ot),S=s[ot];try{s[ot]=void 0;var O=!0}catch{}var J=ta.call(s);return O&&(p?s[ot]=S:delete s[ot]),J}var Wf=ia?function(s){return s==null?[]:(s=Object(s),Gt(ia(s),function(p){return oa.call(s,p)}))}:tp,He=Ht;(Sn&&He(new Sn(new ArrayBuffer(1)))!=v||Wt&&He(new Wt)!=E||_n&&He(_n.resolve())!=m||En&&He(new En)!=M||wn&&He(new wn)!=I)&&(He=function(s){var p=Ht(s),S=p==F?s.constructor:void 0,O=S?st(S):"";if(O)switch(O){case cf:return v;case lf:return E;case ff:return m;case pf:return M;case df:return I}return p});function zf(s,p){return p=p??a,!!p&&(typeof s=="number"||q.test(s))&&s>-1&&s%1==0&&s<p}function Hf(s){var p=typeof s;return p=="string"||p=="number"||p=="symbol"||p=="boolean"?s!=="__proto__":s===null}function Kf(s){return!!ea&&ea in s}function Jf(s){var p=s&&s.constructor,S=typeof p=="function"&&p.prototype||cr;return s===S}function Yf(s){return ta.call(s)}function st(s){if(s!=null){try{return Qi.call(s)}catch{}try{return s+""}catch{}}return""}function fa(s,p){return s===p||s!==s&&p!==p}var Zf=sa(function(){return arguments}())?sa:function(s){return Kt(s)&&Le.call(s,"callee")&&!oa.call(s,"callee")},hr=Array.isArray;function Xf(s){return s!=null&&da(s.length)&&!pa(s)}var In=sf||rp;function Qf(s,p){return ua(s,p)}function pa(s){if(!ha(s))return!1;var p=Ht(s);return p==f||p==_||p==y||p==w}function da(s){return typeof s=="number"&&s>-1&&s%1==0&&s<=a}function ha(s){var p=typeof s;return s!=null&&(p=="object"||p=="function")}function Kt(s){return s!=null&&typeof s=="object"}var ya=Ie?Yl(Ie):kf;function ep(s){return Xf(s)?Rf(s):jf(s)}function tp(){return[]}function rp(){return!1}e.exports=Qf})(Jr,Jr.exports);var gT=Jr.exports,vT=function(e,t){return e.length!==t.length?!1:JSON.stringify(e.map(r=>r).sort())===JSON.stringify(t.map(r=>r).sort())},Vl={},_i={exports:{}};(function(e,t){var r={env:{},argv:[]},n=function(){var o=function(F,m,w,$){for(w=w||{},$=F.length;$--;w[F[$]]=m);return w},i=[1,12],a=[1,13],c=[1,9],u=[1,10],y=[1,11],h=[1,14],T=[1,15],l=[14,18,22,24],f=[18,22],_=[22,24],E={trace:function(){},yy:{},symbols_:{error:2,JSONString:3,STRING:4,JSONNumber:5,NUMBER:6,JSONNullLiteral:7,NULL:8,JSONBooleanLiteral:9,TRUE:10,FALSE:11,JSONText:12,JSONValue:13,EOF:14,JSONObject:15,JSONArray:16,"{":17,"}":18,JSONMemberList:19,JSONMember:20,":":21,",":22,"[":23,"]":24,JSONElementList:25,$accept:0,$end:1},terminals_:{2:"error",4:"STRING",6:"NUMBER",8:"NULL",10:"TRUE",11:"FALSE",14:"EOF",17:"{",18:"}",21:":",22:",",23:"[",24:"]"},productions_:[0,[3,1],[5,1],[7,1],[9,1],[9,1],[12,2],[13,1],[13,1],[13,1],[13,1],[13,1],[13,1],[15,2],[15,3],[20,3],[19,1],[19,3],[16,2],[16,3],[25,1],[25,3]],performAction:function(m,w,$,M,C,B,d){var I=B.length-1;switch(C){case 1:this.$=m.replace(/\\(\\|")/g,"$1").replace(/\\n/g,`
`).replace(/\\r/g,"\r").replace(/\\t/g,"	").replace(/\\v/g,"\v").replace(/\\f/g,"\f").replace(/\\b/g,"\b");break;case 2:this.$=Number(m);break;case 3:this.$=null;break;case 4:this.$=!0;break;case 5:this.$=!1;break;case 6:return this.$=B[I-1];case 13:this.$={},Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 14:case 19:this.$=B[I-1],Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 15:this.$=[B[I-2],B[I]];break;case 16:this.$={},this.$[B[I][0]]=B[I][1];break;case 17:this.$=B[I-2],B[I-2][B[I][0]]!==void 0&&(this.$.__duplicateProperties__||Object.defineProperty(this.$,"__duplicateProperties__",{value:[],enumerable:!1}),this.$.__duplicateProperties__.push(B[I][0])),B[I-2][B[I][0]]=B[I][1];break;case 18:this.$=[],Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 20:this.$=[B[I]];break;case 21:this.$=B[I-2],B[I-2].push(B[I]);break}},table:[{3:5,4:i,5:6,6:a,7:3,8:c,9:4,10:u,11:y,12:1,13:2,15:7,16:8,17:h,23:T},{1:[3]},{14:[1,16]},o(l,[2,7]),o(l,[2,8]),o(l,[2,9]),o(l,[2,10]),o(l,[2,11]),o(l,[2,12]),o(l,[2,3]),o(l,[2,4]),o(l,[2,5]),o([14,18,21,22,24],[2,1]),o(l,[2,2]),{3:20,4:i,18:[1,17],19:18,20:19},{3:5,4:i,5:6,6:a,7:3,8:c,9:4,10:u,11:y,13:23,15:7,16:8,17:h,23:T,24:[1,21],25:22},{1:[2,6]},o(l,[2,13]),{18:[1,24],22:[1,25]},o(f,[2,16]),{21:[1,26]},o(l,[2,18]),{22:[1,28],24:[1,27]},o(_,[2,20]),o(l,[2,14]),{3:20,4:i,20:29},{3:5,4:i,5:6,6:a,7:3,8:c,9:4,10:u,11:y,13:30,15:7,16:8,17:h,23:T},o(l,[2,19]),{3:5,4:i,5:6,6:a,7:3,8:c,9:4,10:u,11:y,13:31,15:7,16:8,17:h,23:T},o(f,[2,17]),o(f,[2,15]),o(_,[2,21])],defaultActions:{16:[2,6]},parseError:function(m,w){if(w.recoverable)this.trace(m);else{let $=function(M,C){this.message=M,this.hash=C};throw $.prototype=Error,new $(m,w)}},parse:function(m){var w=this,$=[0],M=[null],C=[],B=this.table,d="",I=0,g=0,v=2,b=1,P=C.slice.call(arguments,1),U=Object.create(this.lexer),te={yy:{}};for(var ve in this.yy)Object.prototype.hasOwnProperty.call(this.yy,ve)&&(te.yy[ve]=this.yy[ve]);U.setInput(m,te.yy),te.yy.lexer=U,te.yy.parser=this,typeof U.yylloc>"u"&&(U.yylloc={});var Me=U.yylloc;C.push(Me);var nt=U.options&&U.options.ranges;typeof te.yy.parseError=="function"?this.parseError=te.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var kt=function(){var Ae;return Ae=U.lex()||b,typeof Ae!="number"&&(Ae=w.symbols_[Ae]||Ae),Ae},ae,N,R,q,L={},z,k,K,be;;){if(N=$[$.length-1],this.defaultActions[N]?R=this.defaultActions[N]:((ae===null||typeof ae>"u")&&(ae=kt()),R=B[N]&&B[N][ae]),typeof R>"u"||!R.length||!R[0]){var de="";be=[];for(z in B[N])this.terminals_[z]&&z>v&&be.push("'"+this.terminals_[z]+"'");U.showPosition?de="Parse error on line "+(I+1)+`:
`+U.showPosition()+`
Expecting `+be.join(", ")+", got '"+(this.terminals_[ae]||ae)+"'":de="Parse error on line "+(I+1)+": Unexpected "+(ae==b?"end of input":"'"+(this.terminals_[ae]||ae)+"'"),this.parseError(de,{text:U.match,token:this.terminals_[ae]||ae,line:U.yylineno,loc:Me,expected:be})}if(R[0]instanceof Array&&R.length>1)throw new Error("Parse Error: multiple actions possible at state: "+N+", token: "+ae);switch(R[0]){case 1:$.push(ae),M.push(U.yytext),C.push(U.yylloc),$.push(R[1]),ae=null,g=U.yyleng,d=U.yytext,I=U.yylineno,Me=U.yylloc;break;case 2:if(k=this.productions_[R[1]][1],L.$=M[M.length-k],L._$={first_line:C[C.length-(k||1)].first_line,last_line:C[C.length-1].last_line,first_column:C[C.length-(k||1)].first_column,last_column:C[C.length-1].last_column},nt&&(L._$.range=[C[C.length-(k||1)].range[0],C[C.length-1].range[1]]),q=this.performAction.apply(L,[d,g,I,te.yy,R[1],M,C].concat(P)),typeof q<"u")return q;k&&($=$.slice(0,-1*k*2),M=M.slice(0,-1*k),C=C.slice(0,-1*k)),$.push(this.productions_[R[1]][0]),M.push(L.$),C.push(L._$),K=B[$[$.length-2]][$[$.length-1]],$.push(K);break;case 3:return!0}}return!0}},A=function(){var F={EOF:1,parseError:function(w,$){if(this.yy.parser)this.yy.parser.parseError(w,$);else throw new Error(w)},setInput:function(m,w){return this.yy=w||this.yy||{},this._input=m,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var m=this._input[0];this.yytext+=m,this.yyleng++,this.offset++,this.match+=m,this.matched+=m;var w=m.match(/(?:\r\n?|\n).*/g);return w?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),m},unput:function(m){var w=m.length,$=m.split(/(?:\r\n?|\n)/g);this._input=m+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-w),this.offset-=w;var M=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),$.length-1&&(this.yylineno-=$.length-1);var C=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:$?($.length===M.length?this.yylloc.first_column:0)+M[M.length-$.length].length-$[0].length:this.yylloc.first_column-w},this.options.ranges&&(this.yylloc.range=[C[0],C[0]+this.yyleng-w]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(m){this.unput(this.match.slice(m))},pastInput:function(){var m=this.matched.substr(0,this.matched.length-this.match.length);return(m.length>20?"...":"")+m.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var m=this.match;return m.length<20&&(m+=this._input.substr(0,20-m.length)),(m.substr(0,20)+(m.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var m=this.pastInput(),w=new Array(m.length+1).join("-");return m+this.upcomingInput()+`
`+w+"^"},test_match:function(m,w){var $,M,C;if(this.options.backtrack_lexer&&(C={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(C.yylloc.range=this.yylloc.range.slice(0))),M=m[0].match(/(?:\r\n?|\n).*/g),M&&(this.yylineno+=M.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:M?M[M.length-1].length-M[M.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+m[0].length},this.yytext+=m[0],this.match+=m[0],this.matches=m,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(m[0].length),this.matched+=m[0],$=this.performAction.call(this,this.yy,this,w,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),$)return $;if(this._backtrack){for(var B in C)this[B]=C[B];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var m,w,$,M;this._more||(this.yytext="",this.match="");for(var C=this._currentRules(),B=0;B<C.length;B++)if($=this._input.match(this.rules[C[B]]),$&&(!w||$[0].length>w[0].length)){if(w=$,M=B,this.options.backtrack_lexer){if(m=this.test_match($,C[B]),m!==!1)return m;if(this._backtrack){w=!1;continue}else return!1}else if(!this.options.flex)break}return w?(m=this.test_match(w,C[M]),m!==!1?m:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var w=this.next();return w||this.lex()},begin:function(w){this.conditionStack.push(w)},popState:function(){var w=this.conditionStack.length-1;return w>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(w){return w=this.conditionStack.length-1-Math.abs(w||0),w>=0?this.conditionStack[w]:"INITIAL"},pushState:function(w){this.begin(w)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(w,$,M,C){switch(M){case 0:break;case 1:return 6;case 2:return $.yytext=$.yytext.substr(1,$.yyleng-2),4;case 3:return 17;case 4:return 18;case 5:return 23;case 6:return 24;case 7:return 22;case 8:return 21;case 9:return 10;case 10:return 11;case 11:return 8;case 12:return 14;case 13:return"INVALID"}},rules:[/^(?:\s+)/,/^(?:(-?([0-9]|[1-9][0-9]+))(\.[0-9]+)?([eE][-+]?[0-9]+)?\b)/,/^(?:"(?:\\[\\"bfnrt\/]|\\u[a-fA-F0-9]{4}|[^\\\0-\x09\x0a-\x1f"])*")/,/^(?:\{)/,/^(?:\})/,/^(?:\[)/,/^(?:\])/,/^(?:,)/,/^(?::)/,/^(?:true\b)/,/^(?:false\b)/,/^(?:null\b)/,/^(?:$)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13],inclusive:!0}}};return F}();E.lexer=A;function x(){this.yy={}}return x.prototype=E,E.Parser=x,new x}();typeof Ep<"u"&&(t.parser=n,t.Parser=n.Parser,t.parse=function(){return n.parse.apply(n,arguments)},t.main=function(i){i[1]||(console.log("Usage: "+i[0]+" FILE"),r.exit(1));var a=ui.readFileSync(ui.normalize(i[1]),"utf8");return t.parser.parse(a)},require.main===e&&t.main(r.argv.slice(1)))})(_i,_i.exports);var mT=_i.exports,Wl={};function ti(e){return e*Math.PI/180}function zu(e){var t=0;if(e.length>2)for(var r,n,o=0;o<e.length-1;o++)r=e[o],n=e[o+1],t+=ti(n[0]-r[0])*(2+Math.sin(ti(r[1]))+Math.sin(ti(n[1])));return t>=0}function Hu(e){if(e&&e.length>0){if(zu(e[0]))return!1;var t=e.slice(1,e.length);if(!t.every(zu))return!1}return!0}function bT(e){if(e.type==="Polygon")return Hu(e.coordinates);if(e.type==="MultiPolygon")return e.coordinates.every(Hu)}var TT=function(t,r){bT(t)||r.push({message:"Polygons and MultiPolygons should follow the right-hand rule",level:"message",line:t.__line__})},Ku=TT;function ST(e,t){var r=[],n=0,o=10,i=6;function a(d){if((!t||t.noDuplicateMembers!==!1)&&d.__duplicateProperties__&&r.push({message:"An object contained duplicate members, making parsing ambigous: "+d.__duplicateProperties__.join(", "),line:d.__line__}),!u(d,"type","string"))if(C[d.type])d&&C[d.type](d);else{var I=B[d.type.toLowerCase()];I!==void 0?r.push({message:"Expected "+I+" but got "+d.type+" (case sensitive)",line:d.__line__}):r.push({message:"The type "+d.type+" is unknown",line:d.__line__})}}function c(d,I){return d.every(function(g){return g!==null&&typeof g===I})}function u(d,I,g){if(typeof d[I]>"u")return r.push({message:'"'+I+'" member required',line:d.__line__});if(g==="array"){if(!Array.isArray(d[I]))return r.push({message:'"'+I+'" member should be an array, but is an '+typeof d[I]+" instead",line:d.__line__})}else{if(g==="object"&&d[I]&&d[I].constructor!==Object)return r.push({message:'"'+I+'" member should be '+g+", but is an "+d[I].constructor.name+" instead",line:d.__line__});if(g&&typeof d[I]!==g)return r.push({message:'"'+I+'" member should be '+g+", but is an "+typeof d[I]+" instead",line:d.__line__})}}function y(d){if(l(d),f(d),d.properties!==void 0&&r.push({message:'FeatureCollection object cannot contain a "properties" member',line:d.__line__}),d.coordinates!==void 0&&r.push({message:'FeatureCollection object cannot contain a "coordinates" member',line:d.__line__}),!u(d,"features","array")){if(!c(d.features,"object"))return r.push({message:"Every feature must be an object",line:d.__line__});d.features.forEach(M)}}function h(d,I){if(!Array.isArray(d))return r.push({message:"position should be an array, is a "+typeof d+" instead",line:d.__line__||I});if(d.length<2)return r.push({message:"position must have 2 or more elements",line:d.__line__||I});if(d.length>3)return r.push({message:"position should not have more than 3 elements",level:"message",line:d.__line__||I});if(!c(d,"number"))return r.push({message:"each element in a position must be a number",line:d.__line__||I});if(t&&t.precisionWarning){if(n===o)return n+=1,r.push({message:"truncated warnings: we've encountered coordinate precision warning "+o+" times, no more warnings will be reported",level:"message",line:d.__line__||I});n<o&&d.forEach(function(g){var v=0,b=String(g).split(".")[1];if(b!==void 0&&(v=b.length),v>i)return n+=1,r.push({message:"precision of coordinates should be reduced",level:"message",line:d.__line__||I})})}}function T(d,I,g,v){if(v===void 0&&d.__line__!==void 0&&(v=d.__line__),g===0)return h(d,v);if(g===1&&I){if(I==="LinearRing"){if(!Array.isArray(d[d.length-1]))return r.push({message:"a number was found where a coordinate array should have been found: this needs to be nested more deeply",line:v}),!0;if(d.length<4&&r.push({message:"a LinearRing of coordinates needs to have four or more positions",line:v}),d.length&&(d[d.length-1].length!==d[0].length||!d[d.length-1].every(function(P,U){return d[0][U]===P})))return r.push({message:"the first and last positions in a LinearRing of coordinates must be the same",line:v}),!0}else if(I==="Line"&&d.length<2)return r.push({message:"a line needs to have two or more coordinates to be valid",line:v})}if(!Array.isArray(d))r.push({message:"a number was found where a coordinate array should have been found: this needs to be nested more deeply",line:v});else{var b=d.map(function(P){return T(P,I,g-1,P.__line__||v)});return b.some(function(P){return P})}}function l(d){if(d.crs){var I="urn:ogc:def:crs:OGC:1.3:CRS84";typeof d.crs=="object"&&d.crs.properties&&d.crs.properties.name===I?r.push({message:"old-style crs member is not recommended, this object is equivalent to the default and should be removed",line:d.__line__}):r.push({message:"old-style crs member is not recommended",line:d.__line__})}}function f(d){if(d.bbox){if(Array.isArray(d.bbox))return c(d.bbox,"number")||r.push({message:"each element in a bbox member must be a number",line:d.bbox.__line__}),d.bbox.length===4||d.bbox.length===6||r.push({message:"bbox must contain 4 elements (for 2D) or 6 elements (for 3D)",line:d.bbox.__line__}),r.length;r.push({message:"bbox member must be an array of numbers, but is a "+typeof d.bbox,line:d.__line__})}}function _(d){d.properties!==void 0&&r.push({message:'geometry object cannot contain a "properties" member',line:d.__line__}),d.geometry!==void 0&&r.push({message:'geometry object cannot contain a "geometry" member',line:d.__line__}),d.features!==void 0&&r.push({message:'geometry object cannot contain a "features" member',line:d.__line__})}function E(d){l(d),f(d),_(d),u(d,"coordinates","array")||h(d.coordinates)}function A(d){l(d),f(d),u(d,"coordinates","array")||T(d.coordinates,"LinearRing",2)||Ku(d,r)}function x(d){l(d),f(d),u(d,"coordinates","array")||T(d.coordinates,"LinearRing",3)||Ku(d,r)}function F(d){l(d),f(d),u(d,"coordinates","array")||T(d.coordinates,"Line",1)}function m(d){l(d),f(d),u(d,"coordinates","array")||T(d.coordinates,"Line",2)}function w(d){l(d),f(d),u(d,"coordinates","array")||T(d.coordinates,"",1)}function $(d){l(d),f(d),u(d,"geometries","array")||(c(d.geometries,"object")||r.push({message:"The geometries array in a GeometryCollection must contain only geometry objects",line:d.__line__}),d.geometries.length===1&&r.push({message:"GeometryCollection with a single geometry should be avoided in favor of single part or a single object of multi-part type",line:d.geometries.__line__}),d.geometries.forEach(function(I){I&&(I.type==="GeometryCollection"&&r.push({message:"GeometryCollection should avoid nested geometry collections",line:d.geometries.__line__}),a(I))}))}function M(d){l(d),f(d),d.id!==void 0&&typeof d.id!="string"&&typeof d.id!="number"&&r.push({message:'Feature "id" member must have a string or number value',line:d.__line__}),d.features!==void 0&&r.push({message:'Feature object cannot contain a "features" member',line:d.__line__}),d.coordinates!==void 0&&r.push({message:'Feature object cannot contain a "coordinates" member',line:d.__line__}),d.type!=="Feature"&&r.push({message:"GeoJSON features must have a type=feature member",line:d.__line__}),u(d,"properties","object"),u(d,"geometry","object")||d.geometry&&a(d.geometry)}var C={Point:E,Feature:M,MultiPoint:w,LineString:F,MultiLineString:m,FeatureCollection:y,GeometryCollection:$,Polygon:A,MultiPolygon:x},B=Object.keys(C).reduce(function(d,I){return d[I.toLowerCase()]=I,d},{});return typeof e!="object"||e===null||e===void 0?(r.push({message:"The root of a GeoJSON object must be an object.",line:0}),r):(a(e),r.forEach(function(d){({}).hasOwnProperty.call(d,"line")&&d.line===void 0&&delete d.line}),r)}Wl.hint=ST;var _T=mT,ET=Wl;function wT(e,t){var r,n=[];if(typeof e=="object")r=e;else if(typeof e=="string")try{r=_T.parse(e)}catch(a){var o=a.message.match(/line (\d+)/),i=parseInt(o[1],10);return[{line:i-1,message:a.message,error:a}]}else return[{message:"Expected string or object as input",line:0}];return n=n.concat(ET.hint(r,t)),n}Vl.hint=wT;const AT=gT,IT=Zu,$T=$i,CT=Qr,OT=vT,FT=Vl,he=G,PT=Xr,MT={Polygon:Fi,LineString:Oi,Point:Ci,MultiPolygon:Mr,MultiLineString:Mr,MultiPoint:Mr};var LT=function(e,t){return t.modes=he.modes,t.getFeatureIdsAt=function(r){return CT.click({point:r},null,e).map(o=>o.properties.id)},t.getSelectedIds=function(){return e.store.getSelectedIds()},t.getSelected=function(){return{type:he.geojsonTypes.FEATURE_COLLECTION,features:e.store.getSelectedIds().map(r=>e.store.get(r)).map(r=>r.toGeoJSON())}},t.getSelectedPoints=function(){return{type:he.geojsonTypes.FEATURE_COLLECTION,features:e.store.getSelectedCoordinates().map(r=>({type:he.geojsonTypes.FEATURE,properties:{},geometry:{type:he.geojsonTypes.POINT,coordinates:r.coordinates}}))}},t.set=function(r){if(r.type===void 0||r.type!==he.geojsonTypes.FEATURE_COLLECTION||!Array.isArray(r.features))throw new Error("Invalid FeatureCollection");const n=e.store.createRenderBatch();let o=e.store.getAllIds().slice();const i=t.add(r),a=new PT(i);return o=o.filter(c=>!a.has(c)),o.length&&t.delete(o),n(),i},t.add=function(r){const n=FT.hint(r,{precisionWarning:!1}).filter(a=>a.level!=="message");if(n.length)throw new Error(n[0].message);const i=JSON.parse(JSON.stringify(IT(r))).features.map(a=>{if(a.id=a.id||$T(),a.geometry===null)throw new Error("Invalid geometry: null");if(e.store.get(a.id)===void 0||e.store.get(a.id).type!==a.geometry.type){const c=MT[a.geometry.type];if(c===void 0)throw new Error(`Invalid geometry type: ${a.geometry.type}.`);const u=new c(e,a);e.store.add(u)}else{const c=e.store.get(a.id);c.properties=a.properties,AT(c.getCoordinates(),a.geometry.coordinates)||c.incomingCoords(a.geometry.coordinates)}return a.id});return e.store.render(),i},t.get=function(r){const n=e.store.get(r);if(n)return n.toGeoJSON()},t.getAll=function(){return{type:he.geojsonTypes.FEATURE_COLLECTION,features:e.store.getAll().map(r=>r.toGeoJSON())}},t.delete=function(r){return e.store.delete(r,{silent:!0}),t.getMode()===he.modes.DIRECT_SELECT&&!e.store.getSelectedIds().length?e.events.changeMode(he.modes.SIMPLE_SELECT,void 0,{silent:!0}):e.store.render(),t},t.deleteAll=function(){return e.store.delete(e.store.getAllIds(),{silent:!0}),t.getMode()===he.modes.DIRECT_SELECT?e.events.changeMode(he.modes.SIMPLE_SELECT,void 0,{silent:!0}):e.store.render(),t},t.changeMode=function(r,n={}){return r===he.modes.SIMPLE_SELECT&&t.getMode()===he.modes.SIMPLE_SELECT?(OT(n.featureIds||[],e.store.getSelectedIds())||(e.store.setSelected(n.featureIds,{silent:!0}),e.store.render()),t):(r===he.modes.DIRECT_SELECT&&t.getMode()===he.modes.DIRECT_SELECT&&n.featureId===e.store.getSelectedIds()[0]||e.events.changeMode(r,n,{silent:!0}),t)},t.getMode=function(){return e.events.getMode()},t.trash=function(){return e.events.trash({silent:!0}),t},t.combineFeatures=function(){return e.events.combineFeatures({silent:!0}),t},t.uncombineFeatures=function(){return e.events.uncombineFeatures({silent:!0}),t},t.setFeatureProperty=function(r,n,o){return e.store.setFeatureProperty(r,n,o),t},t};const xT=Sd,NT=yT,RT=LT,BT=G,DT=function(e,t){e=NT(e);const r={options:e};t=RT(r,t),r.api=t;const n=xT(r);return t.onAdd=n.onAdd,t.onRemove=n.onRemove,t.types=BT.types,t.options=e,t};Ii.exports=function(e){DT(e,this)};Ii.exports.modes=Gl;var vn=Ii.exports;const Yi=wi(Tp),UT=vn,Qt=G,kT=Mt,jT=Yi.default,zl={...UT.modes.draw_polygon},qT=2;zl.onSetup=function(e){const t=this.newFeature({type:Qt.geojsonTypes.FEATURE,properties:{isCircle:!0,center:[]},geometry:{type:Qt.geojsonTypes.POLYGON,coordinates:[[]]}});return this.addFeature(t),this.clearSelectedFeatures(),kT.disable(this),this.updateUIClasses({mouse:Qt.cursors.ADD}),this.activateUIButton(Qt.types.POLYGON),this.setActionableState({trash:!0}),{initialRadiusInKm:e.initialRadiusInKm||qT,polygon:t,currentVertexPosition:0}};zl.clickAnywhere=function(e,t){if(e.currentVertexPosition===0){e.currentVertexPosition++;const r=[t.lngLat.lng,t.lngLat.lat],n=jT(r,e.initialRadiusInKm);e.polygon.incomingCoords(n.geometry.coordinates),e.polygon.properties.center=r,e.polygon.properties.radiusInKm=e.initialRadiusInKm}return this.changeMode(Qt.modes.SIMPLE_SELECT,{featureIds:[e.polygon.id]})};var GT={enable(e){setTimeout(()=>{!e.map||!e.map.dragPan||!e._ctx||!e._ctx.store||!e._ctx.store.getInitialConfigValue||e._ctx.store.getInitialConfigValue("dragPan")&&e.map.dragPan.enable()},0)},disable(e){setTimeout(()=>{!e.map||!e.map.doubleClickZoom||e.map.dragPan.disable()},0)}};const Hl=wi(Sp);var Zi={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.earthRadius=63710088e-1,e.factors={centimeters:e.earthRadius*100,centimetres:e.earthRadius*100,degrees:e.earthRadius/111325,feet:e.earthRadius*3.28084,inches:e.earthRadius*39.37,kilometers:e.earthRadius/1e3,kilometres:e.earthRadius/1e3,meters:e.earthRadius,metres:e.earthRadius,miles:e.earthRadius/1609.344,millimeters:e.earthRadius*1e3,millimetres:e.earthRadius*1e3,nauticalmiles:e.earthRadius/1852,radians:1,yards:e.earthRadius*1.0936},e.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/e.earthRadius,yards:1.0936133},e.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function t(g,v,b){b===void 0&&(b={});var P={type:"Feature"};return(b.id===0||b.id)&&(P.id=b.id),b.bbox&&(P.bbox=b.bbox),P.properties=v||{},P.geometry=g,P}e.feature=t;function r(g,v,b){switch(g){case"Point":return n(v).geometry;case"LineString":return c(v).geometry;case"Polygon":return i(v).geometry;case"MultiPoint":return T(v).geometry;case"MultiLineString":return h(v).geometry;case"MultiPolygon":return l(v).geometry;default:throw new Error(g+" is invalid")}}e.geometry=r;function n(g,v,b){if(b===void 0&&(b={}),!g)throw new Error("coordinates is required");if(!Array.isArray(g))throw new Error("coordinates must be an Array");if(g.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!C(g[0])||!C(g[1]))throw new Error("coordinates must contain numbers");var P={type:"Point",coordinates:g};return t(P,v,b)}e.point=n;function o(g,v,b){return b===void 0&&(b={}),y(g.map(function(P){return n(P,v)}),b)}e.points=o;function i(g,v,b){b===void 0&&(b={});for(var P=0,U=g;P<U.length;P++){var te=U[P];if(te.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var ve=0;ve<te[te.length-1].length;ve++)if(te[te.length-1][ve]!==te[0][ve])throw new Error("First and last Position are not equivalent.")}var Me={type:"Polygon",coordinates:g};return t(Me,v,b)}e.polygon=i;function a(g,v,b){return b===void 0&&(b={}),y(g.map(function(P){return i(P,v)}),b)}e.polygons=a;function c(g,v,b){if(b===void 0&&(b={}),g.length<2)throw new Error("coordinates must be an array of two or more positions");var P={type:"LineString",coordinates:g};return t(P,v,b)}e.lineString=c;function u(g,v,b){return b===void 0&&(b={}),y(g.map(function(P){return c(P,v)}),b)}e.lineStrings=u;function y(g,v){v===void 0&&(v={});var b={type:"FeatureCollection"};return v.id&&(b.id=v.id),v.bbox&&(b.bbox=v.bbox),b.features=g,b}e.featureCollection=y;function h(g,v,b){b===void 0&&(b={});var P={type:"MultiLineString",coordinates:g};return t(P,v,b)}e.multiLineString=h;function T(g,v,b){b===void 0&&(b={});var P={type:"MultiPoint",coordinates:g};return t(P,v,b)}e.multiPoint=T;function l(g,v,b){b===void 0&&(b={});var P={type:"MultiPolygon",coordinates:g};return t(P,v,b)}e.multiPolygon=l;function f(g,v,b){b===void 0&&(b={});var P={type:"GeometryCollection",geometries:g};return t(P,v,b)}e.geometryCollection=f;function _(g,v){if(v===void 0&&(v=0),v&&!(v>=0))throw new Error("precision must be a positive number");var b=Math.pow(10,v||0);return Math.round(g*b)/b}e.round=_;function E(g,v){v===void 0&&(v="kilometers");var b=e.factors[v];if(!b)throw new Error(v+" units is invalid");return g*b}e.radiansToLength=E;function A(g,v){v===void 0&&(v="kilometers");var b=e.factors[v];if(!b)throw new Error(v+" units is invalid");return g/b}e.lengthToRadians=A;function x(g,v){return m(A(g,v))}e.lengthToDegrees=x;function F(g){var v=g%360;return v<0&&(v+=360),v}e.bearingToAzimuth=F;function m(g){var v=g%(2*Math.PI);return v*180/Math.PI}e.radiansToDegrees=m;function w(g){var v=g%360;return v*Math.PI/180}e.degreesToRadians=w;function $(g,v,b){if(v===void 0&&(v="kilometers"),b===void 0&&(b="kilometers"),!(g>=0))throw new Error("length must be a positive number");return E(A(g,v),b)}e.convertLength=$;function M(g,v,b){if(v===void 0&&(v="meters"),b===void 0&&(b="kilometers"),!(g>=0))throw new Error("area must be a positive number");var P=e.areaFactors[v];if(!P)throw new Error("invalid original units");var U=e.areaFactors[b];if(!U)throw new Error("invalid final units");return g/P*U}e.convertArea=M;function C(g){return!isNaN(g)&&g!==null&&!Array.isArray(g)}e.isNumber=C;function B(g){return!!g&&g.constructor===Object}e.isObject=B;function d(g){if(!g)throw new Error("bbox is required");if(!Array.isArray(g))throw new Error("bbox must be an Array");if(g.length!==4&&g.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");g.forEach(function(v){if(!C(v))throw new Error("bbox must only contain numbers")})}e.validateBBox=d;function I(g){if(!g)throw new Error("id is required");if(["string","number"].indexOf(typeof g)===-1)throw new Error("id must be a number or a string")}e.validateId=I})(Zi);const VT=vn,lt=G,WT=Mt,Kl=GT,zT=Yi.default,HT=Hl.default,Ju=Zi,Fe={...VT.modes.draw_polygon};Fe.onSetup=function(e){const t=this.newFeature({type:lt.geojsonTypes.FEATURE,properties:{isCircle:!0,center:[]},geometry:{type:lt.geojsonTypes.POLYGON,coordinates:[[]]}});return this.addFeature(t),this.clearSelectedFeatures(),WT.disable(this),Kl.disable(this),this.updateUIClasses({mouse:lt.cursors.ADD}),this.activateUIButton(lt.types.POLYGON),this.setActionableState({trash:!0}),{polygon:t,currentVertexPosition:0}};Fe.onMouseDown=Fe.onTouchStart=function(e,t){e.polygon.properties.center.length===0&&(e.polygon.properties.center=[t.lngLat.lng,t.lngLat.lat])};Fe.onDrag=Fe.onMouseMove=function(e,t){const r=e.polygon.properties.center;if(r.length>0){const n=HT(Ju.point(r),Ju.point([t.lngLat.lng,t.lngLat.lat]),{units:"kilometers"}),o=zT(r,n);e.polygon.incomingCoords(o.geometry.coordinates),e.polygon.properties.radiusInKm=n}};Fe.onMouseUp=Fe.onTouchEnd=function(e,t){return Kl.enable(this),this.changeMode(lt.modes.SIMPLE_SELECT,{featureIds:[e.polygon.id]})};Fe.onClick=Fe.onTap=function(e,t){e.polygon.properties.center=[]};Fe.toDisplayFeatures=function(e,t,r){const n=t.properties.id===e.polygon.id;return t.properties.active=n?lt.activeStates.ACTIVE:lt.activeStates.INACTIVE,r(t)};var KT=Fe;const JT=nn;function YT(e){const{properties:t,geometry:r}=e;if(!t.user_isCircle)return null;const n=[],o=r.coordinates[0].slice(0,-1);for(let i=0;i<o.length;i+=Math.round(o.length/4))n.push(JT(t.id,o[i],`0.${i}`,!1));return n}var Jl=YT;const ZT=vn,XT=on,QT=yn,Yr=G,eS=Ki,tS=Hl.default,Yu=Zi,rS=Yi.default,nS=Jl,mn=ZT.modes.direct_select;mn.dragFeature=function(e,t,r){QT(this.getSelected(),r),this.getSelected().filter(n=>n.properties.isCircle).map(n=>n.properties.center).forEach(n=>{n[0]+=r.lng,n[1]+=r.lat}),e.dragMoveLocation=t.lngLat};mn.dragVertex=function(e,t,r){if(e.feature.properties.isCircle){const n=e.feature.properties.center,o=[t.lngLat.lng,t.lngLat.lat],i=tS(Yu.point(n),Yu.point(o),{units:"kilometers"}),a=rS(n,i);e.feature.incomingCoords(a.geometry.coordinates),e.feature.properties.radiusInKm=i}else{const n=e.selectedCoordPaths.map(a=>e.feature.getCoordinate(a)),o=n.map(a=>({type:Yr.geojsonTypes.FEATURE,properties:{},geometry:{type:Yr.geojsonTypes.POINT,coordinates:a}})),i=eS(o,r);for(let a=0;a<n.length;a++){const c=n[a];e.feature.updateCoordinate(e.selectedCoordPaths[a],c[0]+i.lng,c[1]+i.lat)}}};mn.toDisplayFeatures=function(e,t,r){e.featureId===t.properties.id?(t.properties.active=Yr.activeStates.ACTIVE,r(t),(t.properties.user_isCircle?nS(t):XT(t,{map:this.map,midpoints:!0,selectedPaths:e.selectedCoordPaths})).forEach(r)):(t.properties.active=Yr.activeStates.INACTIVE,r(t)),this.fireActionable(e)};var oS=mn;const iS=vn,aS=on,sS=yn,Or=G,uS=Jl,Xi=iS.modes.simple_select;Xi.dragMove=function(e,t){e.dragMoving=!0,t.originalEvent.stopPropagation();const r={lng:t.lngLat.lng-e.dragMoveLocation.lng,lat:t.lngLat.lat-e.dragMoveLocation.lat};sS(this.getSelected(),r),this.getSelected().filter(n=>n.properties.isCircle).map(n=>n.properties.center).forEach(n=>{n[0]+=r.lng,n[1]+=r.lat}),e.dragMoveLocation=t.lngLat};Xi.toDisplayFeatures=function(e,t,r){if(t.properties.active=this.isSelected(t.properties.id)?Or.activeStates.ACTIVE:Or.activeStates.INACTIVE,r(t),this.fireActionable(),t.properties.active!==Or.activeStates.ACTIVE||t.geometry.type===Or.geojsonTypes.POINT)return;(t.properties.user_isCircle?uS(t):aS(t)).forEach(r)};var cS=Xi;const lS=KT,Ye=oS,fS=cS,pS={onSetup:function(e){const t=this.newFeature({type:"Feature",properties:{isRectangle:!0},geometry:{type:"Polygon",coordinates:[[[0,0],[0,0],[0,0],[0,0],[0,0]]]}});return this.addFeature(t),this.clearSelectedFeatures(),this.updateUIClasses({mouse:"add"}),this.activateUIButton("polygon"),this.setActionableState({trash:!0}),this.map&&this.map.dragPan&&this.map.dragPan.disable(),{polygon:t,startPoint:null}},onStop:function(e){this.updateUIClasses({mouse:"none"}),this.activateUIButton(),this.setActionableState({trash:!0}),this.map&&this.map.dragPan&&this.map.dragPan.enable()},onMouseDown:function(e,t){t.originalEvent&&(t.originalEvent.preventDefault(),t.originalEvent.stopPropagation()),e.startPoint=[t.lngLat.lng,t.lngLat.lat],this.updateFeature(e,t)},onDrag:function(e,t){e.startPoint&&this.updateFeature(e,t)},onMouseUp:function(e,t){e.startPoint&&(this.updateFeature(e,t),this.map.fire("draw.create",{features:[e.polygon.toGeoJSON()]}),this.changeMode("simple_select",{featureIds:[e.polygon.id]}))},updateFeature:function(e,t){const r=e.startPoint,n=[t.lngLat.lng,t.lngLat.lat],o=Math.min(r[0],n[0]),i=Math.max(r[0],n[0]),a=Math.min(r[1],n[1]),c=Math.max(r[1],n[1]),u=[[o,c],[i,c],[i,a],[o,a],[o,c]];e.polygon.incomingCoords([u])},toDisplayFeatures:function(e,t,r){const n=t.properties.id===e.polygon.id;if(t.properties.active=n?"true":"false",!n)return r(t);t.geometry.coordinates.length!==0&&r(t)},onTrash:function(e){this.deleteFeature(e.polygon.id,{silent:!0}),this.changeMode("simple_select")}},dS={...Ye,isRectangle:function(e){return e?!!(e.properties&&(e.properties.isRectangle===!0||e.properties.isRectangle==="true")||e.geometry&&e.geometry.type==="Polygon"&&e.geometry.coordinates.length>0&&e.geometry.coordinates[0].length===5):!1},onSetup:function(e){const t=Ye.onSetup.call(this,e);return t.draggingHandle=null,t},onMouseDown:function(e,t){const r=e.featureId,n=this.getFeature(r);this.isRectangle(n),Ye.onMouseDown.call(this,e,t)},onDrag:function(e,t){const{featureId:r}=e,n=this.getFeature(r);if(!this.isRectangle(n))return Ye.onDrag.call(this,e,t);if(e.selectedCoordPaths&&e.selectedCoordPaths.length>0){const i=e.selectedCoordPaths[0].split("."),a=parseInt(i[0],10),c=parseInt(i[1],10);if(a===0&&c>=0&&c<=4){const u=n.coordinates[0],y=t.lngLat.lng,h=t.lngLat.lat,l=((c===4?0:c)+2)%4,f=u[l];if(!f)return;const _=Math.min(y,f[0]),E=Math.max(y,f[0]),A=Math.min(h,f[1]),x=Math.max(h,f[1]),F=[[_,x],[E,x],[E,A],[_,A],[_,x]];n.incomingCoords([F]),e.draggingHandle=!0;return}}Ye.onDrag.call(this,e,t)},onMouseUp:function(e,t){e.draggingHandle&&(e.draggingHandle=null,this.map.dragPan.enable(),this.fireUpdate()),Ye.onMouseUp.call(this,e,t)},fireUpdate:function(){this.map.fire("draw.update",{action:"move",features:this.getSelected().map(e=>e.toGeoJSON())})},toDisplayFeatures:function(e,t,r){const n=this.getFeature(e.featureId);if(this.isRectangle(n)){const o=i=>{i.properties.meta!=="midpoint"&&r(i)};Ye.toDisplayFeatures.call(this,e,t,o);return}Ye.toDisplayFeatures.call(this,e,t,r)}};function hS({currentMode:e,onModeChange:t,onDelete:r,canDelete:n}){const o=[{id:"simple_select",icon:op,title:"Select (Pointer)"},{id:"add_waypoint",icon:ip,title:"Add Waypoint"},{id:"draw_rectangle",icon:ap,title:"Draw Square"},{id:"draw_polygon",icon:sp,title:"Draw Polygon"},{id:"drag_circle",icon:up,title:"Draw Circle"}];return ne.jsxs("div",{className:"absolute top-4 left-4 flex flex-col gap-2 bg-white rounded-md shadow-md p-1 z-10",children:[o.map(i=>{const a=i.icon,c=e===i.id||i.id==="simple_select"&&e==="direct_select";return ne.jsx("button",{onClick:()=>{console.log("Switching to mode:",i.id),t(i.id)},className:`p-2 rounded hover:bg-gray-100 flex items-center justify-center ${c?"text-blue-600 bg-blue-50":"text-gray-700"}`,title:i.title,children:ne.jsx(a,{size:20})},i.id)}),ne.jsx("div",{className:"h-px bg-gray-200 my-1"}),ne.jsx("button",{onClick:r,disabled:!n,className:`p-2 rounded flex items-center justify-center ${n?"text-red-600 hover:bg-red-50 cursor-pointer":"text-gray-300 cursor-not-allowed"}`,title:"Delete Selected",children:ne.jsx(cp,{size:20})})]})}Fr.accessToken="pk.eyJ1Ijoid2F5Z2VuIiwiYSI6ImNtaThyMXF2czBmZ3QybXBvbW1hazFpamcifQ.P0D5plS_fpnx3qheQytxfQ";const yS="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`
<svg width="40" height="40" viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg">
  <path d="M20 0 L35 20 A 15 15 0 0 1 5 20 Z" fill="#3b82f6" stroke="white" stroke-width="2"/>
</svg>
`),gS="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`
<svg width="40" height="40" viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg">
  <path d="M20 0 L35 20 A 15 15 0 0 1 5 20 Z" fill="#ef4444" stroke="white" stroke-width="2"/>
</svg>
`),vS=[{id:"gl-draw-line",type:"line",filter:["all",["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3b82f6","line-width":2}},{id:"gl-draw-polygon-fill",type:"fill",filter:["all",["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#3b82f6","fill-outline-color":"#3b82f6","fill-opacity":.2}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3b82f6","line-width":2}},{id:"gl-draw-point-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":6,"circle-color":"#fff"}},{id:"gl-draw-point",type:"circle",filter:["all",["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":4,"circle-color":"#3b82f6"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","$type","Polygon"],["==","mode","static"]],paint:{"fill-color":"#000","fill-outline-color":"#000","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","$type","Polygon"],["==","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#000","line-width":2}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","resize-handle"]],paint:{"circle-radius":4,"circle-color":"#fbb03b"}}];function wS({onPolygonDrawn:e,polygon:t}){const r=re.useRef(null),n=re.useRef(null),o=re.useRef(null),{waypoints:i,selectedIds:a,selectWaypoint:c,setSelectedIds:u,resetTrigger:y,settings:h,updateWaypoint:T,addWaypoint:l,setMapRef:f}=_e(),_=re.useRef(null),[E,A]=re.useState("simple_select"),[x,F]=re.useState("satellite"),m=re.useRef(E);re.useEffect(()=>{m.current=E},[E]),re.useEffect(()=>{y>0&&o.current&&(o.current.deleteAll(),e(null))},[y,e]);const[w,$]=re.useState(null),[M,C]=re.useState(!1),B=re.useRef(null);re.useEffect(()=>{if(!o.current||!n.current)return;const g=o.current.getSelectedIds();if(g.length===0)return;const v=o.current.get(g[0]);if(!v||v.geometry.type!=="Polygon")return;const b=$n(v),P=Cn(b,On(v.geometry.coordinates[0][0]),{units:"meters"});if(Math.abs(P-h.orbitRadius)>1){const U=ma(b.geometry.coordinates,h.orbitRadius,{steps:64,units:"meters"});U.id=v.id,U.properties={...v.properties,isCircle:!0},o.current.add(U),e(U)}},[h.orbitRadius]);const d=g=>{if(!g||g.geometry.type!=="Polygon")return;const v=$n(g),b=Cn(v,On(g.geometry.coordinates[0][0]),{units:"meters"});Math.abs(b-h.orbitRadius)>1&&_e.getState().updateSettings({orbitRadius:Math.round(b)})};re.useEffect(()=>{if(n.current)return;n.current=new Fr.Map({container:r.current,style:"mapbox://styles/mapbox/satellite-streets-v12",center:[-98,39],zoom:4,boxZoom:!1});const g=new hp({accessToken:Fr.accessToken,mapboxgl:Fr,marker:!1,collapsed:!0});n.current.addControl(g,"top-right"),f(n.current),o.current=new va({userProperties:!0,displayControlsDefault:!1,controls:{point:!1,line:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1},styles:vS,modes:{...va.modes,drag_circle:lS,draw_rectangle:pS,direct_select:dS,simple_select:fS}}),n.current.addControl(o.current),window.mapboxDraw=o.current,n.current.on("draw.create",N=>{const R=N.features[0];o.current.getMode()==="drag_circle"&&(o.current.setFeatureProperty(R.id,"isCircle",!0),R.properties.isCircle=!0,_e.getState().updateSettings({pathType:"orbit",spacing:10})),(R.properties.isRectangle||o.current.getMode()==="draw_rectangle")&&(o.current.setFeatureProperty(R.id,"isRectangle",!0),R.properties.isRectangle=!0);const q=$n(R);if(Cn(q,On(R.geometry.coordinates[0][0]),{units:"meters"})>500){const z=ma(q.geometry.coordinates,50,{steps:64,units:"meters"});z.id=R.id,z.properties={...R.properties,isCircle:!0},o.current.add(z),_e.getState().updateSettings({orbitRadius:50}),e(z)}else d(R),e(R);A("simple_select")}),n.current.on("draw.update",N=>{const R=N.features[0];d(R),e(R)}),n.current.on("draw.selectionchange",N=>{N.features.length>0?(d(N.features[0]),e(N.features[0]),C(!0)):C(!1)}),n.current.on("draw.delete",()=>e(null)),n.current.on("click",N=>{if(N.originalEvent._isDrag)return;if(m.current==="add_waypoint"){const{lng:q,lat:L}=N.lngLat;l({lng:q,lat:L});return}const R=n.current.queryRenderedFeatures(N.point,{layers:["waypoints-symbol"]});if(R.length){const q=R[0].properties.id;c(q,N.originalEvent.shiftKey)}else n.current.queryRenderedFeatures(N.point,{layers:["gl-draw-polygon-fill-static.cold","gl-draw-polygon-fill.hot"]}).length===0&&u([])});const v=N=>{if(!B.current)return;const R=B.current,q=N.point,L=Math.min(R.x,q.x),z=Math.max(R.x,q.x),k=Math.min(R.y,q.y),K=Math.max(R.y,q.y);$({left:L,top:k,width:z-L,height:K-k})},b=N=>{if(!B.current)return;const R=B.current,q=N.point;if(Math.abs(R.x-q.x)<5&&Math.abs(R.y-q.y)<5){B.current=null,$(null),n.current.dragPan.enable(),n.current.off("mousemove",v),n.current.off("mouseup",b);return}const L=[R,q],k=n.current.queryRenderedFeatures(L,{layers:["waypoints-symbol"]}).map(K=>K.properties.id);k.length>0&&u(k),B.current=null,$(null),n.current.dragPan.enable(),N.originalEvent._isDrag=!0,setTimeout(()=>{N.originalEvent&&delete N.originalEvent._isDrag},100),n.current.off("mousemove",v),n.current.off("mouseup",b)};n.current.on("mousedown",N=>{N.originalEvent.shiftKey&&(N.preventDefault(),n.current.dragPan.disable(),B.current=N.point,n.current.on("mousemove",v),n.current.on("mouseup",b))});const P=()=>{_.current||(n.current.getCanvas().style.cursor="pointer")},U=()=>{_.current||(n.current.getCanvas().style.cursor="")},te=N=>{if(o.current.getMode()!=="simple_select"&&o.current.getMode()!=="direct_select"||N.originalEvent.shiftKey||!N.originalEvent.altKey)return;N.preventDefault();const R=N.features[0];if(!R)return;n.current.dragPan.disable(),n.current.getCanvas().style.cursor="grabbing";const q=R.properties.id,L=_e.getState().waypoints,z=_e.getState().selectedIds,k=z.includes(q),K=k?z:[q],be=L.filter(de=>K.includes(de.id)).map(de=>({id:de.id,lng:de.lng,lat:de.lat}));_.current={ids:K,isMulti:k,initialWaypoints:be,startLngLat:N.lngLat},n.current.on("mousemove",ve),n.current.on("mouseup",Me)},ve=N=>{if(!_.current)return;const{lng:R,lat:q}=N.lngLat,{startLngLat:L,initialWaypoints:z}=_.current,k=R-L.lng,K=q-L.lat,be=n.current.getSource("waypoints"),de=n.current.getSource("mission-path"),Ae=_e.getState().waypoints,jt=_e.getState().selectedIds,qt=Ae.map((Ie,Gt)=>{const Vt=z.find(bn=>bn.id===Ie.id);let ur=[Ie.lng,Ie.lat];return Vt&&(ur=[Vt.lng+k,Vt.lat+K]),{type:"Feature",properties:{id:Ie.id,index:Gt+1,selected:jt.includes(Ie.id),heading:Ie.heading||0},geometry:{type:"Point",coordinates:ur}}});if(be&&be.setData({type:"FeatureCollection",features:qt}),de){const Ie=qt.map(Gt=>Gt.geometry.coordinates);de.setData({type:"Feature",geometry:{type:"LineString",coordinates:Ie}})}},Me=N=>{if(!_.current)return;const{lng:R,lat:q}=N.lngLat,{startLngLat:L,ids:z}=_.current,k=R-L.lng,K=q-L.lat;_e.getState().moveWaypoints(z,k,K),_.current=null,n.current.dragPan.enable(),n.current.getCanvas().style.cursor="",N.originalEvent._isDrag=!0,n.current.off("mousemove",ve),n.current.off("mouseup",Me)};n.current.on("mouseenter","waypoints-symbol",P),n.current.on("mouseleave","waypoints-symbol",U),n.current.on("mousedown","waypoints-symbol",te);const nt=()=>{console.log("Initializing Map Layers...");const N=(L,z)=>{if(n.current.hasImage(L))return;const k=new Image;k.src=z,k.onload=()=>{n.current.hasImage(L)||n.current.addImage(L,k)}};N("teardrop",yS),N("teardrop-selected",gS),n.current.getSource("mission-path")||n.current.addSource("mission-path",{type:"geojson",data:{type:"Feature",geometry:{type:"LineString",coordinates:[]}}}),n.current.getSource("footprints")||n.current.addSource("footprints",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),n.current.getSource("waypoints")||n.current.addSource("waypoints",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),n.current.getLayer("footprints-fill")||n.current.addLayer({id:"footprints-fill",type:"fill",source:"footprints",paint:{"fill-color":["get","color"],"fill-opacity":.15,"fill-outline-color":"rgba(0,0,0,0)"}}),n.current.getLayer("footprints-outline")||n.current.addLayer({id:"footprints-outline",type:"line",source:"footprints",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":["get","color"],"line-width":1,"line-opacity":.6}}),n.current.getLayer("mission-path-line")||n.current.addLayer({id:"mission-path-line",type:"line",source:"mission-path",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#3b82f6","line-width":3,"line-opacity":.8}}),n.current.getLayer("waypoints-symbol")||n.current.addLayer({id:"waypoints-symbol",type:"symbol",source:"waypoints",layout:{"icon-image":["case",["get","selected"],"teardrop-selected","teardrop"],"icon-size":["interpolate",["linear"],["zoom"],10,.5,15,.75,20,1],"icon-anchor":"center","icon-allow-overlap":!0,"icon-rotate":["get","heading"],"icon-rotation-alignment":"map","text-field":["to-string",["get","index"]],"text-font":["Open Sans Bold","Arial Unicode MS Bold"],"text-size":["interpolate",["linear"],["zoom"],10,9,15,11,20,13],"text-offset":[0,0],"text-anchor":"center","text-allow-overlap":!0,"text-rotation-alignment":"viewport"},paint:{"text-color":"#ffffff","text-halo-color":"#000000","text-halo-width":.5}});const R=_e.getState().waypoints,q=_e.getState().selectedIds;if(R.length>0){console.log("Initial waypoints found, updating source...",R.length);const L=R.map((k,K)=>({type:"Feature",properties:{id:k.id,index:K+1,selected:q.includes(k.id),heading:k.heading||0},geometry:{type:"Point",coordinates:[k.lng,k.lat]}}));n.current.getSource("waypoints").setData({type:"FeatureCollection",features:L});const z=R.map(k=>[k.lng,k.lat]);n.current.getSource("mission-path").setData({type:"Feature",geometry:{type:"LineString",coordinates:z}})}};n.current.loaded()?nt():n.current.on("load",nt),n.current.on("style.load",nt);const kt=N=>{m.current==="add_waypoint"&&N.mode==="simple_select"||A(N.mode)};n.current.on("draw.modechange",kt);const ae=N=>{N.key==="Escape"&&(m.current!=="simple_select"?(o.current&&o.current.changeMode("simple_select"),A("simple_select")):u([]))};return window.addEventListener("keydown",ae),()=>{window.removeEventListener("keydown",ae)}},[]),re.useEffect(()=>{if(!o.current||!n.current)return;const g=E,v=o.current.getMode();if(g==="add_waypoint")v!=="simple_select"&&o.current.changeMode("simple_select"),n.current.getCanvas().style.cursor="crosshair";else{if(v!==g)try{o.current.changeMode(g)}catch(b){console.warn("Failed to switch mode:",b)}n.current.getCanvas().style.cursor=""}},[E]),re.useEffect(()=>{!n.current||!n.current.getLayer("waypoints-symbol")||(n.current.setLayoutProperty("waypoints-symbol","text-offset",[0,0]),n.current.setLayoutProperty("waypoints-symbol","text-anchor","center"),n.current.setLayoutProperty("waypoints-symbol","icon-anchor","center"),n.current.setLayoutProperty("waypoints-symbol","text-rotation-alignment","viewport"))},[]),re.useEffect(()=>{if(!n.current||!n.current)return;const g=n.current.getSource("waypoints"),v=n.current.getSource("mission-path");if(g){const b=i.map((P,U)=>({type:"Feature",properties:{id:P.id,index:U+1,selected:a.includes(P.id),heading:P.heading||0},geometry:{type:"Point",coordinates:[P.lng,P.lat]}}));g.setData({type:"FeatureCollection",features:b})}if(v){const b=i.map(P=>[P.lng,P.lat]);v.setData({type:"Feature",geometry:{type:"LineString",coordinates:b}})}},[i,a]),re.useEffect(()=>{if(!n.current||!n.current.getSource("footprints"))return;if(!h.showFootprints){n.current.getSource("footprints").setData({type:"FeatureCollection",features:[]});return}const g=i.map((v,b)=>{const P=v.heading||0;return{...np({lng:v.lng,lat:v.lat},h.altitude,P,h.customFOV),properties:{index:b+1,color:h.footprintColor}}}).filter(v=>v!==null);n.current.getSource("footprints").setData({type:"FeatureCollection",features:g})},[i,h.showFootprints,h.altitude,h.customFOV,h.footprintColor]),re.useEffect(()=>{h.orbitRadius>500&&_e.getState().updateSettings({orbitRadius:50})},[]);const I=()=>{o.current&&(o.current.trash(),e(null),C(!1))};return re.useEffect(()=>{if(!o.current||!n.current)return;if(!t){o.current.getAll().features.length>0&&o.current.deleteAll();return}if(!o.current.getAll().features.some(b=>b.id===t.id)){console.log("Syncing polygon from prop:",t),o.current.deleteAll(),o.current.add(t);try{const b=_p(t);n.current.fitBounds(b,{padding:100})}catch(b){console.warn("Could not fit bounds:",b)}}},[t]),ne.jsxs("div",{className:`relative w-full h-full ${E==="add_waypoint"?"force-crosshair":""}`,children:[ne.jsx("style",{children:`
        .force-crosshair .mapboxgl-canvas-container {
          cursor: crosshair !important;
        }
        .force-crosshair .mapboxgl-canvas {
          cursor: crosshair !important;
        }
      `}),ne.jsx("div",{ref:r,className:"w-full h-full"}),w&&ne.jsx("div",{style:{position:"absolute",left:w.left,top:w.top,width:w.width,height:w.height,border:"2px solid #3b82f6",backgroundColor:"rgba(59, 130, 246, 0.2)",pointerEvents:"none",zIndex:20}}),ne.jsx(hS,{currentMode:E,onModeChange:A,onDelete:I,canDelete:M}),ne.jsxs("div",{className:"absolute bottom-8 left-4 flex flex-col gap-2 z-10",children:[ne.jsxs("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 overflow-hidden flex flex-col",children:[ne.jsx("button",{onClick:()=>{x!=="satellite"&&(F("satellite"),n.current.setStyle("mapbox://styles/mapbox/satellite-streets-v12"))},className:`p-2 hover:bg-gray-50 transition-colors ${x==="satellite"?"bg-blue-50 text-blue-600":"text-gray-700"}`,title:"Satellite View",children:ne.jsx(lp,{size:20})}),ne.jsx("div",{className:"h-px bg-gray-200"}),ne.jsx("button",{onClick:()=>{x!=="streets"&&(F("streets"),n.current.setStyle("mapbox://styles/mapbox/streets-v12"))},className:`p-2 hover:bg-gray-50 transition-colors ${x==="streets"?"bg-blue-50 text-blue-600":"text-gray-700"}`,title:"Street Map",children:ne.jsx(fp,{size:20})})]}),ne.jsx("button",{onClick:()=>{"geolocation"in navigator?navigator.geolocation.getCurrentPosition(g=>{n.current.flyTo({center:[g.coords.longitude,g.coords.latitude],zoom:16})},g=>{console.error("Error getting location:",g),alert("Could not get your location. Please check permissions.")}):alert("Geolocation is not supported by your browser.")},className:"bg-white p-2 rounded-lg shadow-md border border-gray-200 text-gray-700 hover:bg-gray-50 hover:text-blue-600 transition-colors",title:"My Location",children:ne.jsx(pp,{size:20})})]})]})}export{wS as default};
