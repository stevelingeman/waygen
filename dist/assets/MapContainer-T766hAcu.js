import{j as Ie,u as _e,c as np}from"./index-uKczYS42.js";import{i as ip,j as op,k as ap,H as sp,l as up,T as cp,r as oe}from"./vendor-CgYbqmbV.js";import{b as lp,i as So,d as Ju,g as _o,m as Cr,M as fp,e as ya}from"./mapbox-C3udIXGP.js";import{k as V,s as pt,n as Jr,o as Ot,q as Qe,r as U,_ as Ft,u as Pt,v as Eo,w as X,x as dt,y as Mt,z as Yu,A as Ve,B as pp,C as Zu,D as dp,E as Xu,F as hp,G as Qu,H as tr,I as ec,J as tc,K as yp,L as rc,M as gp,N as vp,O as mp,e as An,b as In,p as $n,P as ga,f as bp}from"./turf-D8sFHwPo.js";import{c as Tp}from"./utils-P9aiU5u9.js";/* empty css                           */var wo={exports:{}};const Sp=function(e,t){const r={drag:[],click:[],mousemove:[],mousedown:[],mouseup:[],mouseout:[],keydown:[],keyup:[],touchstart:[],touchmove:[],touchend:[],tap:[]},n={on:function(o,a,c){if(r[o]===void 0)throw new Error(`Invalid event type: ${o}`);r[o].push({selector:a,fn:c})},render:function(o){t.store.featureChanged(o)}},i=function(o,a){const c=r[o];let u=c.length;for(;u--;){const y=c[u];if(y.selector(a)){y.fn.call(n,a),t.store.render(),t.ui.updateMapClasses();break}}};return e.start.call(n),{render:e.render,stop:function(){e.stop&&e.stop()},trash:function(){e.trash&&(e.trash(),t.store.render())},combineFeatures:function(){e.combineFeatures&&e.combineFeatures()},uncombineFeatures:function(){e.uncombineFeatures&&e.uncombineFeatures()},drag:function(o){i("drag",o)},click:function(o){i("click",o)},mousemove:function(o){i("mousemove",o)},mousedown:function(o){i("mousedown",o)},mouseup:function(o){i("mouseup",o)},mouseout:function(o){i("mouseout",o)},keydown:function(o){i("keydown",o)},keyup:function(o){i("keyup",o)},touchstart:function(o){i("touchstart",o)},touchmove:function(o){i("touchmove",o)},touchend:function(o){i("touchend",o)},tap:function(o){i("tap",o)}}};var _p=Sp,G={classes:{CONTROL_BASE:"mapboxgl-ctrl",CONTROL_BUTTON:"mapbox-gl-draw_ctrl-draw-btn",CONTROL_BUTTON_LINE:"mapbox-gl-draw_line",CONTROL_BUTTON_POLYGON:"mapbox-gl-draw_polygon",CONTROL_BUTTON_POINT:"mapbox-gl-draw_point",CONTROL_BUTTON_TRASH:"mapbox-gl-draw_trash",CONTROL_BUTTON_COMBINE_FEATURES:"mapbox-gl-draw_combine",CONTROL_BUTTON_UNCOMBINE_FEATURES:"mapbox-gl-draw_uncombine",CONTROL_GROUP:"mapboxgl-ctrl-group",ACTIVE_BUTTON:"active",BOX_SELECT:"mapbox-gl-draw_boxselect"},sources:{HOT:"mapbox-gl-draw-hot",COLD:"mapbox-gl-draw-cold"},cursors:{ADD:"add",MOVE:"move",DRAG:"drag",POINTER:"pointer",NONE:"none"},types:{POLYGON:"polygon",LINE:"line_string",POINT:"point"},geojsonTypes:{FEATURE:"Feature",POLYGON:"Polygon",LINE_STRING:"LineString",POINT:"Point",FEATURE_COLLECTION:"FeatureCollection",MULTI_PREFIX:"Multi",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon"},modes:{DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select",STATIC:"static"},events:{CREATE:"draw.create",DELETE:"draw.delete",UPDATE:"draw.update",SELECTION_CHANGE:"draw.selectionchange",MODE_CHANGE:"draw.modechange",ACTIONABLE:"draw.actionable",RENDER:"draw.render",COMBINE_FEATURES:"draw.combine",UNCOMBINE_FEATURES:"draw.uncombine"},updateActions:{MOVE:"move",CHANGE_COORDINATES:"change_coordinates"},meta:{FEATURE:"feature",MIDPOINT:"midpoint",VERTEX:"vertex"},activeStates:{ACTIVE:"true",INACTIVE:"false"},interactions:["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate"],LAT_MIN:-90,LAT_RENDERED_MIN:-85,LAT_MAX:90,LAT_RENDERED_MAX:85,LNG_MIN:-270,LNG_MAX:270};const Ep=lp,Qi=G,va={Point:0,LineString:1,Polygon:2};function wp(e,t){const r=va[e.geometry.type]-va[t.geometry.type];return r===0&&e.geometry.type===Qi.geojsonTypes.POLYGON?e.area-t.area:r}function Ap(e){return e.map(t=>(t.geometry.type===Qi.geojsonTypes.POLYGON&&(t.area=Ep.geometry({type:Qi.geojsonTypes.FEATURE,property:{},geometry:t.geometry})),t)).sort(wp).map(t=>(delete t.area,t))}var Ip=Ap;function $p(e,t=0){return[[e.point.x-t,e.point.y-t],[e.point.x+t,e.point.y+t]]}var Cp=$p;function Lt(e){if(this._items={},this._nums={},this._length=e?e.length:0,!!e)for(let t=0,r=e.length;t<r;t++)this.add(e[t]),e[t]!==void 0&&(typeof e[t]=="string"?this._items[e[t]]=t:this._nums[e[t]]=t)}Lt.prototype.add=function(e){return this.has(e)?this:(this._length++,typeof e=="string"?this._items[e]=this._length:this._nums[e]=this._length,this)};Lt.prototype.delete=function(e){return this.has(e)===!1?this:(this._length--,delete this._items[e],delete this._nums[e],this)};Lt.prototype.has=function(e){return typeof e!="string"&&typeof e!="number"?!1:this._items[e]!==void 0||this._nums[e]!==void 0};Lt.prototype.values=function(){const e=[];return Object.keys(this._items).forEach(t=>{e.push({k:t,v:this._items[t]})}),Object.keys(this._nums).forEach(t=>{e.push({k:JSON.parse(t),v:this._nums[t]})}),e.sort((t,r)=>t.v-r.v).map(t=>t.k)};Lt.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this};var Yr=Lt;const Op=Ip,Fp=Cp,Cn=G,Pp=Yr,Mp=[Cn.meta.FEATURE,Cn.meta.MIDPOINT,Cn.meta.VERTEX];var Zr={click:Lp,touch:Rp};function Lp(e,t,r){return nc(e,t,r,r.options.clickBuffer)}function Rp(e,t,r){return nc(e,t,r,r.options.touchBuffer)}function nc(e,t,r,n){if(r.map===null)return[];const i=e?Fp(e,n):t,o={};r.options.styles&&(o.layers=r.options.styles.map(y=>y.id));const a=r.map.queryRenderedFeatures(i,o).filter(y=>Mp.indexOf(y.properties.meta)!==-1),c=new Pp,u=[];return a.forEach(y=>{const h=y.properties.id;c.has(h)||(c.add(h),u.push(y))}),Op(u)}const Np=Zr,Ht=G;var xp=function(t,r){const n=Np.click(t,null,r),i={mouse:Ht.cursors.NONE};return n[0]&&(i.mouse=n[0].properties.active===Ht.activeStates.ACTIVE?Ht.cursors.MOVE:Ht.cursors.POINTER,i.feature=n[0].properties.meta),r.events.currentModeName().indexOf("draw")!==-1&&(i.mouse=Ht.cursors.ADD),r.ui.queueMapClasses(i),r.ui.updateMapClasses(),n[0]},ic=function(e,t){const r=e.x-t.x,n=e.y-t.y;return Math.sqrt(r*r+n*n)};const Bp=ic,Dp=4,Up=12,kp=500;var qp=function(t,r,n={}){const i=n.fineTolerance!=null?n.fineTolerance:Dp,o=n.grossTolerance!=null?n.grossTolerance:Up,a=n.interval!=null?n.interval:kp;t.point=t.point||r.point,t.time=t.time||r.time;const c=Bp(t.point,r.point);return c<i||c<o&&r.time-t.time<a};const jp=ic,Gp=25,Vp=250;var Wp=function(t,r,n={}){const i=n.tolerance!=null?n.tolerance:Gp,o=n.interval!=null?n.interval:Vp;return t.point=t.point||r.point,t.time=t.time||r.time,jp(t.point,r.point)<i&&r.time-t.time<o},oc={exports:{}},ac={exports:{}},sc={exports:{}},eo=sc.exports=function(e,t){if(t||(t=16),e===void 0&&(e=128),e<=0)return"0";for(var r=Math.log(Math.pow(2,e))/Math.log(t),n=2;r===1/0;n*=2)r=Math.log(Math.pow(2,e/n))/Math.log(t)*n;for(var i=r-Math.floor(r),o="",n=0;n<Math.floor(r);n++){var a=Math.floor(Math.random()*t).toString(t);o=a+o}if(i){var c=Math.pow(t,i),a=Math.floor(Math.random()*c).toString(t);o=a+o}var u=parseInt(o,t);return u!==1/0&&u>=Math.pow(2,e)?eo(e,t):o};eo.rack=function(e,t,r){var n=function(o){var a=0;do{if(a++>10)if(r)e+=r;else throw new Error("too many ID collisions, use more bits");var c=eo(e,t)}while(Object.hasOwnProperty.call(i,c));return i[c]=o,c},i=n.hats={};return n.get=function(o){return n.hats[o]},n.set=function(o,a){return n.hats[o]=a,n},n.bits=e||128,n.base=t||16,n};var Ao=sc.exports;const zp=Ao,Or=G,et=function(e,t){this.ctx=e,this.properties=t.properties||{},this.coordinates=t.geometry.coordinates,this.id=t.id||zp(),this.type=t.geometry.type};et.prototype.changed=function(){this.ctx.store.featureChanged(this.id)};et.prototype.incomingCoords=function(e){this.setCoordinates(e)};et.prototype.setCoordinates=function(e){this.coordinates=e,this.changed()};et.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.coordinates))};et.prototype.setProperty=function(e,t){this.properties[e]=t};et.prototype.toGeoJSON=function(){return JSON.parse(JSON.stringify({id:this.id,type:Or.geojsonTypes.FEATURE,properties:this.properties,geometry:{coordinates:this.getCoordinates(),type:this.type}}))};et.prototype.internal=function(e){const t={id:this.id,meta:Or.meta.FEATURE,"meta:type":this.type,active:Or.activeStates.INACTIVE,mode:e};if(this.ctx.options.userProperties)for(const r in this.properties)t[`user_${r}`]=this.properties[r];return{type:Or.geojsonTypes.FEATURE,properties:t,geometry:{coordinates:this.getCoordinates(),type:this.type}}};var Xr=et;const uc=Xr,rr=function(e,t){uc.call(this,e,t)};rr.prototype=Object.create(uc.prototype);rr.prototype.isValid=function(){return typeof this.coordinates[0]=="number"&&typeof this.coordinates[1]=="number"};rr.prototype.updateCoordinate=function(e,t,r){arguments.length===3?this.coordinates=[t,r]:this.coordinates=[e,t],this.changed()};rr.prototype.getCoordinate=function(){return this.getCoordinates()};var Io=rr;const cc=Xr,ht=function(e,t){cc.call(this,e,t)};ht.prototype=Object.create(cc.prototype);ht.prototype.isValid=function(){return this.coordinates.length>1};ht.prototype.addCoordinate=function(e,t,r){this.changed();const n=parseInt(e,10);this.coordinates.splice(n,0,[t,r])};ht.prototype.getCoordinate=function(e){const t=parseInt(e,10);return JSON.parse(JSON.stringify(this.coordinates[t]))};ht.prototype.removeCoordinate=function(e){this.changed(),this.coordinates.splice(parseInt(e,10),1)};ht.prototype.updateCoordinate=function(e,t,r){const n=parseInt(e,10);this.coordinates[n]=[t,r],this.changed()};var $o=ht;const lc=Xr,xe=function(e,t){lc.call(this,e,t),this.coordinates=this.coordinates.map(r=>r.slice(0,-1))};xe.prototype=Object.create(lc.prototype);xe.prototype.isValid=function(){return this.coordinates.length===0?!1:this.coordinates.every(e=>e.length>2)};xe.prototype.incomingCoords=function(e){this.coordinates=e.map(t=>t.slice(0,-1)),this.changed()};xe.prototype.setCoordinates=function(e){this.coordinates=e,this.changed()};xe.prototype.addCoordinate=function(e,t,r){this.changed();const n=e.split(".").map(o=>parseInt(o,10));this.coordinates[n[0]].splice(n[1],0,[t,r])};xe.prototype.removeCoordinate=function(e){this.changed();const t=e.split(".").map(n=>parseInt(n,10)),r=this.coordinates[t[0]];r&&(r.splice(t[1],1),r.length<3&&this.coordinates.splice(t[0],1))};xe.prototype.getCoordinate=function(e){const t=e.split(".").map(n=>parseInt(n,10)),r=this.coordinates[t[0]];return JSON.parse(JSON.stringify(r[t[1]]))};xe.prototype.getCoordinates=function(){return this.coordinates.map(e=>e.concat([e[0]]))};xe.prototype.updateCoordinate=function(e,t,r){this.changed();const n=e.split("."),i=parseInt(n[0],10),o=parseInt(n[1],10);this.coordinates[i]===void 0&&(this.coordinates[i]=[]),this.coordinates[i][o]=[t,r]};var Co=xe;const fc=Xr,pc=G,Hp=Ao,Kp={MultiPoint:Io,MultiLineString:$o,MultiPolygon:Co},Qr=(e,t,r,n,i)=>{const o=r.split("."),a=parseInt(o[0],10),c=o[1]?o.slice(1).join("."):null;return e[a][t](c,n,i)},Fe=function(e,t){if(fc.call(this,e,t),delete this.coordinates,this.model=Kp[t.geometry.type],this.model===void 0)throw new TypeError(`${t.geometry.type} is not a valid type`);this.features=this._coordinatesToFeatures(t.geometry.coordinates)};Fe.prototype=Object.create(fc.prototype);Fe.prototype._coordinatesToFeatures=function(e){const t=this.model.bind(this);return e.map(r=>new t(this.ctx,{id:Hp(),type:pc.geojsonTypes.FEATURE,properties:{},geometry:{coordinates:r,type:this.type.replace("Multi","")}}))};Fe.prototype.isValid=function(){return this.features.every(e=>e.isValid())};Fe.prototype.setCoordinates=function(e){this.features=this._coordinatesToFeatures(e),this.changed()};Fe.prototype.getCoordinate=function(e){return Qr(this.features,"getCoordinate",e)};Fe.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.features.map(e=>e.type===pc.geojsonTypes.POLYGON?e.getCoordinates():e.coordinates)))};Fe.prototype.updateCoordinate=function(e,t,r){Qr(this.features,"updateCoordinate",e,t,r),this.changed()};Fe.prototype.addCoordinate=function(e,t,r){Qr(this.features,"addCoordinate",e,t,r),this.changed()};Fe.prototype.removeCoordinate=function(e){Qr(this.features,"removeCoordinate",e),this.changed()};Fe.prototype.getFeatures=function(){return this.features};var Fr=Fe;const It=G,Jp=Zr,dc=Io,hc=$o,yc=Co,gc=Fr,ie=ac.exports=function(e){this.map=e.map,this.drawConfig=JSON.parse(JSON.stringify(e.options||{})),this._ctx=e};ie.prototype.setSelected=function(e){return this._ctx.store.setSelected(e)};ie.prototype.setSelectedCoordinates=function(e){this._ctx.store.setSelectedCoordinates(e),e.reduce((t,r)=>(t[r.feature_id]===void 0&&(t[r.feature_id]=!0,this._ctx.store.get(r.feature_id).changed()),t),{})};ie.prototype.getSelected=function(){return this._ctx.store.getSelected()};ie.prototype.getSelectedIds=function(){return this._ctx.store.getSelectedIds()};ie.prototype.isSelected=function(e){return this._ctx.store.isSelected(e)};ie.prototype.getFeature=function(e){return this._ctx.store.get(e)};ie.prototype.select=function(e){return this._ctx.store.select(e)};ie.prototype.deselect=function(e){return this._ctx.store.deselect(e)};ie.prototype.deleteFeature=function(e,t={}){return this._ctx.store.delete(e,t)};ie.prototype.addFeature=function(e){return this._ctx.store.add(e)};ie.prototype.clearSelectedFeatures=function(){return this._ctx.store.clearSelected()};ie.prototype.clearSelectedCoordinates=function(){return this._ctx.store.clearSelectedCoordinates()};ie.prototype.setActionableState=function(e={}){const t={trash:e.trash||!1,combineFeatures:e.combineFeatures||!1,uncombineFeatures:e.uncombineFeatures||!1};return this._ctx.events.actionable(t)};ie.prototype.changeMode=function(e,t={},r={}){return this._ctx.events.changeMode(e,t,r)};ie.prototype.updateUIClasses=function(e){return this._ctx.ui.queueMapClasses(e)};ie.prototype.activateUIButton=function(e){return this._ctx.ui.setActiveButton(e)};ie.prototype.featuresAt=function(e,t,r="click"){if(r!=="click"&&r!=="touch")throw new Error("invalid buffer type");return Jp[r](e,t,this._ctx)};ie.prototype.newFeature=function(e){const t=e.geometry.type;return t===It.geojsonTypes.POINT?new dc(this._ctx,e):t===It.geojsonTypes.LINE_STRING?new hc(this._ctx,e):t===It.geojsonTypes.POLYGON?new yc(this._ctx,e):new gc(this._ctx,e)};ie.prototype.isInstanceOf=function(e,t){if(e===It.geojsonTypes.POINT)return t instanceof dc;if(e===It.geojsonTypes.LINE_STRING)return t instanceof hc;if(e===It.geojsonTypes.POLYGON)return t instanceof yc;if(e==="MultiFeature")return t instanceof gc;throw new Error(`Unknown feature class: ${e}`)};ie.prototype.doRender=function(e){return this._ctx.store.featureChanged(e)};var Yp=ac.exports;const ue=oc.exports=Yp;ue.prototype.onSetup=function(){};ue.prototype.onDrag=function(){};ue.prototype.onClick=function(){};ue.prototype.onMouseMove=function(){};ue.prototype.onMouseDown=function(){};ue.prototype.onMouseUp=function(){};ue.prototype.onMouseOut=function(){};ue.prototype.onKeyUp=function(){};ue.prototype.onKeyDown=function(){};ue.prototype.onTouchStart=function(){};ue.prototype.onTouchMove=function(){};ue.prototype.onTouchEnd=function(){};ue.prototype.onTap=function(){};ue.prototype.onStop=function(){};ue.prototype.onTrash=function(){};ue.prototype.onCombineFeature=function(){};ue.prototype.onUncombineFeature=function(){};ue.prototype.toDisplayFeatures=function(){throw new Error("You must overwrite toDisplayFeatures")};var Zp=oc.exports;const Xp=Zp,vc={drag:"onDrag",click:"onClick",mousemove:"onMouseMove",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseout:"onMouseOut",keyup:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",tap:"onTap"},Qp=Object.keys(vc);var ed=function(e){const t=Object.keys(e);return function(r,n={}){let i={};const o=t.reduce((c,u)=>(c[u]=e[u],c),new Xp(r));function a(c){return function(u){o[c](i,u)}}return{start:function(){i=o.onSetup(n),Qp.forEach(c=>{const u=vc[c];let y=()=>!1;e[u]&&(y=()=>!0),this.on(c,y,a(u))})},stop:function(){o.onStop(i)},trash:function(){o.onTrash(i)},combineFeatures:function(){o.onCombineFeatures(i)},uncombineFeatures:function(){o.onUncombineFeatures(i)},render:function(c,u){o.toDisplayFeatures(i,c,u)}}}};const ma=_p,On=xp,ba=Zr,Ta=qp,Sa=Wp,St=G,td=ed;var rd=function(e){const t=Object.keys(e.options.modes).reduce((l,p)=>(l[p]=td(e.options.modes[p]),l),{});let r={},n={};const i={};let o=null,a=null;i.drag=function(l,p){p({point:l.point,time:new Date().getTime()})?(e.ui.queueMapClasses({mouse:St.cursors.DRAG}),a.drag(l)):l.originalEvent.stopPropagation()},i.mousedrag=function(l){i.drag(l,p=>!Ta(r,p))},i.touchdrag=function(l){i.drag(l,p=>!Sa(n,p))},i.mousemove=function(l){if((l.originalEvent.buttons!==void 0?l.originalEvent.buttons:l.originalEvent.which)===1)return i.mousedrag(l);const _=On(l,e);l.featureTarget=_,a.mousemove(l)},i.mousedown=function(l){r={time:new Date().getTime(),point:l.point};const p=On(l,e);l.featureTarget=p,a.mousedown(l)},i.mouseup=function(l){const p=On(l,e);l.featureTarget=p,Ta(r,{point:l.point,time:new Date().getTime()})?a.click(l):a.mouseup(l)},i.mouseout=function(l){a.mouseout(l)},i.touchstart=function(l){if(l.originalEvent.preventDefault(),!e.options.touchEnabled)return;n={time:new Date().getTime(),point:l.point};const p=ba.touch(l,null,e)[0];l.featureTarget=p,a.touchstart(l)},i.touchmove=function(l){if(l.originalEvent.preventDefault(),!!e.options.touchEnabled)return a.touchmove(l),i.touchdrag(l)},i.touchend=function(l){if(l.originalEvent.preventDefault(),!e.options.touchEnabled)return;const p=ba.touch(l,null,e)[0];l.featureTarget=p,Sa(n,{time:new Date().getTime(),point:l.point})?a.tap(l):a.touchend(l)};const c=l=>!(l===8||l===46||l>=48&&l<=57);i.keydown=function(l){(l.srcElement||l.target).classList[0]==="mapboxgl-canvas"&&((l.keyCode===8||l.keyCode===46)&&e.options.controls.trash?(l.preventDefault(),a.trash()):c(l.keyCode)?a.keydown(l):l.keyCode===49&&e.options.controls.point?u(St.modes.DRAW_POINT):l.keyCode===50&&e.options.controls.line_string?u(St.modes.DRAW_LINE_STRING):l.keyCode===51&&e.options.controls.polygon&&u(St.modes.DRAW_POLYGON))},i.keyup=function(l){c(l.keyCode)&&a.keyup(l)},i.zoomend=function(){e.store.changeZoom()},i.data=function(l){if(l.dataType==="style"){const{setup:p,map:_,options:w,store:A}=e;w.styles.some(O=>_.getLayer(O.id))||(p.addLayers(),A.setDirty(),A.render())}};function u(l,p,_={}){a.stop();const w=t[l];if(w===void 0)throw new Error(`${l} is not valid`);o=l;const A=w(e,p);a=ma(A,e),_.silent||e.map.fire(St.events.MODE_CHANGE,{mode:l}),e.store.setDirty(),e.store.render()}const y={trash:!1,combineFeatures:!1,uncombineFeatures:!1};function h(l){let p=!1;Object.keys(l).forEach(_=>{if(y[_]===void 0)throw new Error("Invalid action type");y[_]!==l[_]&&(p=!0),y[_]=l[_]}),p&&e.map.fire(St.events.ACTIONABLE,{actions:y})}return{start:function(){o=e.options.defaultMode,a=ma(t[o](e),e)},changeMode:u,actionable:h,currentModeName:function(){return o},currentModeRender:function(l,p){return a.render(l,p)},fire:function(l,p){i[l]&&i[l](p)},addEventListeners:function(){e.map.on("mousemove",i.mousemove),e.map.on("mousedown",i.mousedown),e.map.on("mouseup",i.mouseup),e.map.on("data",i.data),e.map.on("touchmove",i.touchmove),e.map.on("touchstart",i.touchstart),e.map.on("touchend",i.touchend),e.container.addEventListener("mouseout",i.mouseout),e.options.keybindings&&(e.container.addEventListener("keydown",i.keydown),e.container.addEventListener("keyup",i.keyup))},removeEventListeners:function(){e.map.off("mousemove",i.mousemove),e.map.off("mousedown",i.mousedown),e.map.off("mouseup",i.mouseup),e.map.off("data",i.data),e.map.off("touchmove",i.touchmove),e.map.off("touchstart",i.touchstart),e.map.off("touchend",i.touchend),e.container.removeEventListener("mouseout",i.mouseout),e.options.keybindings&&(e.container.removeEventListener("keydown",i.keydown),e.container.removeEventListener("keyup",i.keyup))},trash:function(l){a.trash(l)},combineFeatures:function(){a.combineFeatures()},uncombineFeatures:function(){a.uncombineFeatures()},getMode:function(){return o}}},mc={exports:{}};function nd(e,t,r){let n,i;function o(){n=!1,i&&(a.apply(r,i),i=!1)}function a(){n?i=arguments:(n=!0,e.apply(r,arguments),setTimeout(o,t))}return a}var id=nd;function od(e){return[].concat(e).filter(t=>t!==void 0)}var ad=od;const Me=G;var sd=function(){const t=this;if(!(t.ctx.map&&t.ctx.map.getSource(Me.sources.HOT)!==void 0))return y();const n=t.ctx.events.currentModeName();t.ctx.ui.queueMapClasses({mode:n});let i=[],o=[];t.isDirty?o=t.getAllIds():(i=t.getChangedIds().filter(h=>t.get(h)!==void 0),o=t.sources.hot.filter(h=>h.properties.id&&i.indexOf(h.properties.id)===-1&&t.get(h.properties.id)!==void 0).map(h=>h.properties.id)),t.sources.hot=[];const a=t.sources.cold.length;t.sources.cold=t.isDirty?[]:t.sources.cold.filter(h=>{const b=h.properties.id||h.properties.parent;return i.indexOf(b)===-1});const c=a!==t.sources.cold.length||o.length>0;i.forEach(h=>u(h,"hot")),o.forEach(h=>u(h,"cold"));function u(h,b){const p=t.get(h).internal(n);t.ctx.events.currentModeRender(p,_=>{t.sources[b].push(_)})}if(c&&t.ctx.map.getSource(Me.sources.COLD).setData({type:Me.geojsonTypes.FEATURE_COLLECTION,features:t.sources.cold}),t.ctx.map.getSource(Me.sources.HOT).setData({type:Me.geojsonTypes.FEATURE_COLLECTION,features:t.sources.hot}),t._emitSelectionChange&&(t.ctx.map.fire(Me.events.SELECTION_CHANGE,{features:t.getSelected().map(h=>h.toGeoJSON()),points:t.getSelectedCoordinates().map(h=>({type:Me.geojsonTypes.FEATURE,properties:{},geometry:{type:Me.geojsonTypes.POINT,coordinates:h.coordinates}}))}),t._emitSelectionChange=!1),t._deletedFeaturesToEmit.length){const h=t._deletedFeaturesToEmit.map(b=>b.toGeoJSON());t._deletedFeaturesToEmit=[],t.ctx.map.fire(Me.events.DELETE,{features:h})}y(),t.ctx.map.fire(Me.events.RENDER,{});function y(){t.isDirty=!1,t.clearChangedIds()}};const ud=id,en=ad,Fn=Yr,cd=sd,ld=G.interactions,J=mc.exports=function(e){this._features={},this._featureIds=new Fn,this._selectedFeatureIds=new Fn,this._selectedCoordinates=[],this._changedFeatureIds=new Fn,this._deletedFeaturesToEmit=[],this._emitSelectionChange=!1,this._mapInitialConfig={},this.ctx=e,this.sources={hot:[],cold:[]},this.render=ud(cd,16,this),this.isDirty=!1};J.prototype.createRenderBatch=function(){const e=this.render;let t=0;return this.render=function(){t++},()=>{this.render=e,t>0&&this.render()}};J.prototype.setDirty=function(){return this.isDirty=!0,this};J.prototype.featureChanged=function(e){return this._changedFeatureIds.add(e),this};J.prototype.getChangedIds=function(){return this._changedFeatureIds.values()};J.prototype.clearChangedIds=function(){return this._changedFeatureIds.clear(),this};J.prototype.getAllIds=function(){return this._featureIds.values()};J.prototype.add=function(e){return this.featureChanged(e.id),this._features[e.id]=e,this._featureIds.add(e.id),this};J.prototype.delete=function(e,t={}){return en(e).forEach(r=>{this._featureIds.has(r)&&(this._featureIds.delete(r),this._selectedFeatureIds.delete(r),t.silent||this._deletedFeaturesToEmit.indexOf(this._features[r])===-1&&this._deletedFeaturesToEmit.push(this._features[r]),delete this._features[r],this.isDirty=!0)}),bc.call(this,t),this};J.prototype.get=function(e){return this._features[e]};J.prototype.getAll=function(){return Object.keys(this._features).map(e=>this._features[e])};J.prototype.select=function(e,t={}){return en(e).forEach(r=>{this._selectedFeatureIds.has(r)||(this._selectedFeatureIds.add(r),this._changedFeatureIds.add(r),t.silent||(this._emitSelectionChange=!0))}),this};J.prototype.deselect=function(e,t={}){return en(e).forEach(r=>{this._selectedFeatureIds.has(r)&&(this._selectedFeatureIds.delete(r),this._changedFeatureIds.add(r),t.silent||(this._emitSelectionChange=!0))}),bc.call(this,t),this};J.prototype.clearSelected=function(e={}){return this.deselect(this._selectedFeatureIds.values(),{silent:e.silent}),this};J.prototype.setSelected=function(e,t={}){return e=en(e),this.deselect(this._selectedFeatureIds.values().filter(r=>e.indexOf(r)===-1),{silent:t.silent}),this.select(e.filter(r=>!this._selectedFeatureIds.has(r)),{silent:t.silent}),this};J.prototype.setSelectedCoordinates=function(e){return this._selectedCoordinates=e,this._emitSelectionChange=!0,this};J.prototype.clearSelectedCoordinates=function(){return this._selectedCoordinates=[],this._emitSelectionChange=!0,this};J.prototype.getSelectedIds=function(){return this._selectedFeatureIds.values()};J.prototype.getSelected=function(){return this._selectedFeatureIds.values().map(e=>this.get(e))};J.prototype.getSelectedCoordinates=function(){return this._selectedCoordinates.map(t=>({coordinates:this.get(t.feature_id).getCoordinate(t.coord_path)}))};J.prototype.isSelected=function(e){return this._selectedFeatureIds.has(e)};J.prototype.setFeatureProperty=function(e,t,r){this.get(e).setProperty(t,r),this.featureChanged(e)};function bc(e){const t=this._selectedCoordinates.filter(r=>this._selectedFeatureIds.has(r.feature_id));this._selectedCoordinates.length!==t.length&&!e.silent&&(this._emitSelectionChange=!0),this._selectedCoordinates=t}J.prototype.storeMapConfig=function(){ld.forEach(e=>{this.ctx.map[e]&&(this._mapInitialConfig[e]=this.ctx.map[e].isEnabled())})};J.prototype.restoreMapConfig=function(){Object.keys(this._mapInitialConfig).forEach(e=>{this._mapInitialConfig[e]?this.ctx.map[e].enable():this.ctx.map[e].disable()})};J.prototype.getInitialConfigValue=function(e){return this._mapInitialConfig[e]!==void 0?this._mapInitialConfig[e]:!0};var fd=mc.exports;const _a=So,Z=G,pd=["mode","feature","mouse"];var dd=function(e){const t={};let r=null,n={mode:null,feature:null,mouse:null},i={mode:null,feature:null,mouse:null};function o(){a({mode:null,feature:null,mouse:null}),c()}function a(p){i=_a(i,p)}function c(){if(!e.container)return;const p=[],_=[];pd.forEach(w=>{i[w]!==n[w]&&(p.push(`${w}-${n[w]}`),i[w]!==null&&_.push(`${w}-${i[w]}`))}),p.length>0&&e.container.classList.remove.apply(e.container.classList,p),_.length>0&&e.container.classList.add.apply(e.container.classList,_),n=_a(n,i)}function u(p,_={}){const w=document.createElement("button");return w.className=`${Z.classes.CONTROL_BUTTON} ${_.className}`,w.setAttribute("title",_.title),_.container.appendChild(w),w.addEventListener("click",A=>{if(A.preventDefault(),A.stopPropagation(),A.target===r){y();return}h(p),_.onActivate()},!0),w}function y(){r&&(r.classList.remove(Z.classes.ACTIVE_BUTTON),r=null)}function h(p){y();const _=t[p];_&&_&&p!=="trash"&&(_.classList.add(Z.classes.ACTIVE_BUTTON),r=_)}function b(){const p=e.options.controls,_=document.createElement("div");return _.className=`${Z.classes.CONTROL_GROUP} ${Z.classes.CONTROL_BASE}`,p&&(p[Z.types.LINE]&&(t[Z.types.LINE]=u(Z.types.LINE,{container:_,className:Z.classes.CONTROL_BUTTON_LINE,title:`LineString tool ${e.options.keybindings?"(l)":""}`,onActivate:()=>e.events.changeMode(Z.modes.DRAW_LINE_STRING)})),p[Z.types.POLYGON]&&(t[Z.types.POLYGON]=u(Z.types.POLYGON,{container:_,className:Z.classes.CONTROL_BUTTON_POLYGON,title:`Polygon tool ${e.options.keybindings?"(p)":""}`,onActivate:()=>e.events.changeMode(Z.modes.DRAW_POLYGON)})),p[Z.types.POINT]&&(t[Z.types.POINT]=u(Z.types.POINT,{container:_,className:Z.classes.CONTROL_BUTTON_POINT,title:`Marker tool ${e.options.keybindings?"(m)":""}`,onActivate:()=>e.events.changeMode(Z.modes.DRAW_POINT)})),p.trash&&(t.trash=u("trash",{container:_,className:Z.classes.CONTROL_BUTTON_TRASH,title:"Delete",onActivate:()=>{e.events.trash()}})),p.combine_features&&(t.combine_features=u("combineFeatures",{container:_,className:Z.classes.CONTROL_BUTTON_COMBINE_FEATURES,title:"Combine",onActivate:()=>{e.events.combineFeatures()}})),p.uncombine_features&&(t.uncombine_features=u("uncombineFeatures",{container:_,className:Z.classes.CONTROL_BUTTON_UNCOMBINE_FEATURES,title:"Uncombine",onActivate:()=>{e.events.uncombineFeatures()}}))),_}function l(){Object.keys(t).forEach(p=>{const _=t[p];_.parentNode&&_.parentNode.removeChild(_),delete t[p]})}return{setActiveButton:h,queueMapClasses:a,updateMapClasses:c,clearMapClasses:o,addButtons:b,removeButtons:l}};const hd=rd,yd=fd,gd=dd,Ye=G,vd=So;var md=function(e){let t=null,r=null;const n={onRemove:function(){return e.map.off("load",n.connect),clearInterval(r),n.removeLayers(),e.store.restoreMapConfig(),e.ui.removeButtons(),e.events.removeEventListeners(),e.ui.clearMapClasses(),e.map=null,e.container=null,e.store=null,t&&t.parentNode&&t.parentNode.removeChild(t),t=null,this},connect:function(){e.map.off("load",n.connect),clearInterval(r),n.addLayers(),e.store.storeMapConfig(),e.events.addEventListeners()},onAdd:function(i){{const o=i.fire;i.fire=function(a,c){let u=arguments;return o.length===1&&arguments.length!==1&&(u=[vd({},{type:a},c)]),o.apply(i,u)}}return e.map=i,e.events=hd(e),e.ui=gd(e),e.container=i.getContainer(),e.store=new yd(e),t=e.ui.addButtons(),e.options.boxSelect&&(i.boxZoom.disable(),i.dragPan.disable(),i.dragPan.enable()),i.loaded()?n.connect():(i.on("load",n.connect),r=setInterval(()=>{i.loaded()&&n.connect()},16)),e.events.start(),t},addLayers:function(){e.map.addSource(Ye.sources.COLD,{data:{type:Ye.geojsonTypes.FEATURE_COLLECTION,features:[]},type:"geojson"}),e.map.addSource(Ye.sources.HOT,{data:{type:Ye.geojsonTypes.FEATURE_COLLECTION,features:[]},type:"geojson"}),e.options.styles.forEach(i=>{e.map.addLayer(i)}),e.store.setDirty(!0),e.store.render()},removeLayers:function(){e.options.styles.forEach(i=>{e.map.getLayer(i.id)&&e.map.removeLayer(i.id)}),e.map.getSource(Ye.sources.COLD)&&e.map.removeSource(Ye.sources.COLD),e.map.getSource(Ye.sources.HOT)&&e.map.removeSource(Ye.sources.HOT)}};return e.setup=n,n},bd=[{id:"gl-draw-polygon-fill-inactive",type:"fill",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#3bb2d0","fill-outline-color":"#3bb2d0","fill-opacity":.1}},{id:"gl-draw-polygon-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"#fbb03b","fill-outline-color":"#fbb03b","fill-opacity":.1}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-stroke-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","active","true"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-polygon-and-line-vertex-stroke-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-color":"#fff"}},{id:"gl-draw-polygon-and-line-vertex-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-point-point-stroke-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-opacity":1,"circle-color":"#fff"}},{id:"gl-draw-point-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#3bb2d0"}},{id:"gl-draw-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["==","active","true"],["!=","meta","midpoint"]],paint:{"circle-radius":7,"circle-color":"#fff"}},{id:"gl-draw-point-active",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","true"]],paint:{"circle-radius":5,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","mode","static"],["==","$type","Polygon"]],paint:{"fill-color":"#404040","fill-outline-color":"#404040","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","mode","static"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-line-static",type:"line",filter:["all",["==","mode","static"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-point-static",type:"circle",filter:["all",["==","mode","static"],["==","$type","Point"]],paint:{"circle-radius":5,"circle-color":"#404040"}}];const _t=G;var Rt={isOfMetaType:function(e){return function(t){const r=t.featureTarget;return!r||!r.properties?!1:r.properties.meta===e}},isShiftMousedown:function(e){return!e.originalEvent||!e.originalEvent.shiftKey?!1:e.originalEvent.button===0},isActiveFeature:function(e){return!e.featureTarget||!e.featureTarget.properties?!1:e.featureTarget.properties.active===_t.activeStates.ACTIVE&&e.featureTarget.properties.meta===_t.meta.FEATURE},isInactiveFeature:function(e){return!e.featureTarget||!e.featureTarget.properties?!1:e.featureTarget.properties.active===_t.activeStates.INACTIVE&&e.featureTarget.properties.meta===_t.meta.FEATURE},noTarget:function(e){return e.featureTarget===void 0},isFeature:function(e){return!e.featureTarget||!e.featureTarget.properties?!1:e.featureTarget.properties.meta===_t.meta.FEATURE},isVertex:function(e){const t=e.featureTarget;return!t||!t.properties?!1:t.properties.meta===_t.meta.VERTEX},isShiftDown:function(e){return e.originalEvent?e.originalEvent.shiftKey===!0:!1},isEscapeKey:function(e){return e.keyCode===27},isEnterKey:function(e){return e.keyCode===13},true:function(){return!0}},Td=$t;function $t(e,t){this.x=e,this.y=t}$t.prototype={clone:function(){return new $t(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,r=e.y-this.y;return t*t+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[0]*this.x+e[1]*this.y,r=e[2]*this.x+e[3]*this.y;return this.x=t,this.y=r,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),r=Math.sin(e),n=t*this.x-r*this.y,i=r*this.x+t*this.y;return this.x=n,this.y=i,this},_rotateAround:function(e,t){var r=Math.cos(e),n=Math.sin(e),i=t.x+r*(this.x-t.x)-n*(this.y-t.y),o=t.y+n*(this.x-t.x)+r*(this.y-t.y);return this.x=i,this.y=o,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}};$t.convert=function(e){return e instanceof $t?e:Array.isArray(e)?new $t(e[0],e[1]):e};const Sd=Td;function _d(e,t){const r=t.getBoundingClientRect();return new Sd(e.clientX-r.left-(t.clientLeft||0),e.clientY-r.top-(t.clientTop||0))}var Ed=_d;const Kt=G;var tn=function(e,t,r,n){return{type:Kt.geojsonTypes.FEATURE,properties:{meta:Kt.meta.VERTEX,parent:e,coord_path:r,active:n?Kt.activeStates.ACTIVE:Kt.activeStates.INACTIVE},geometry:{type:Kt.geojsonTypes.POINT,coordinates:t}}};const ct=G;var wd=function(e,t,r,n){const i=t.geometry.coordinates,o=r.geometry.coordinates;if(i[1]>ct.LAT_RENDERED_MAX||i[1]<ct.LAT_RENDERED_MIN||o[1]>ct.LAT_RENDERED_MAX||o[1]<ct.LAT_RENDERED_MIN)return null;const a=n.project([i[0],i[1]]),c=n.project([o[0],o[1]]),u=n.unproject([(a.x+c.x)/2,(a.y+c.y)/2]);return{type:ct.geojsonTypes.FEATURE,properties:{meta:ct.meta.MIDPOINT,parent:e,lng:u.lng,lat:u.lat,coord_path:r.properties.coord_path},geometry:{type:ct.geojsonTypes.POINT,coordinates:[u.lng,u.lat]}}};const Ea=tn,Ad=wd,Et=G;function Tc(e,t={},r=null){const{type:n,coordinates:i}=e.geometry,o=e.properties&&e.properties.id;let a=[];n===Et.geojsonTypes.POINT?a.push(Ea(o,i,r,u(r))):n===Et.geojsonTypes.POLYGON?i.forEach((h,b)=>{c(h,r!==null?`${r}.${b}`:String(b))}):n===Et.geojsonTypes.LINE_STRING?c(i,r):n.indexOf(Et.geojsonTypes.MULTI_PREFIX)===0&&y();function c(h,b){let l="",p=null;h.forEach((_,w)=>{const A=b!=null?`${b}.${w}`:String(w),R=Ea(o,_,A,u(A));if(t.midpoints&&p){const m=Ad(o,p,R,t.map);m&&a.push(m)}p=R;const O=JSON.stringify(_);l!==O&&a.push(R),w===0&&(l=O)})}function u(h){return t.selectedPaths?t.selectedPaths.indexOf(h)!==-1:!1}function y(){const h=n.replace(Et.geojsonTypes.MULTI_PREFIX,"");i.forEach((b,l)=>{const p={type:Et.geojsonTypes.FEATURE,properties:e.properties,geometry:{type:h,coordinates:b}};a=a.concat(Tc(p,t,l))})}return a}var rn=Tc,Nt={enable(e){setTimeout(()=>{!e.map||!e.map.doubleClickZoom||!e._ctx||!e._ctx.store||!e._ctx.store.getInitialConfigValue||e._ctx.store.getInitialConfigValue("doubleClickZoom")&&e.map.doubleClickZoom.enable()},0)},disable(e){setTimeout(()=>{!e.map||!e.map.doubleClickZoom||e.map.doubleClickZoom.disable()},0)}},nn={exports:{}},Id=function e(t){switch(t&&t.type||null){case"FeatureCollection":return t.features=t.features.reduce(function(r,n){return r.concat(e(n))},[]),t;case"Feature":return t.geometry?e(t.geometry).map(function(r){var n={type:"Feature",properties:JSON.parse(JSON.stringify(t.properties)),geometry:r};return t.id!==void 0&&(n.id=t.id),n}):t;case"MultiPoint":return t.coordinates.map(function(r){return{type:"Point",coordinates:r}});case"MultiPolygon":return t.coordinates.map(function(r){return{type:"Polygon",coordinates:r}});case"MultiLineString":return t.coordinates.map(function(r){return{type:"LineString",coordinates:r}});case"GeometryCollection":return t.geometries.map(e).reduce(function(r,n){return r.concat(n)},[]);case"Point":case"Polygon":case"LineString":return[t]}},$d=function(t){return r(t);function r(n){return Array.isArray(n)&&n.length&&typeof n[0]=="number"?[n]:n.reduce(function(i,o){return Array.isArray(o)&&Array.isArray(o[0])?i.concat(r(o)):(i.push(o),i)},[])}},Cd=Ju,Od=Id,Fd=$d,Pd=function(e){if(!e)return[];var t=Od(Cd(e)),r=[];return t.features.forEach(function(n){n.geometry&&(r=r.concat(Fd(n.geometry.coordinates)))}),r},Sc=Function.prototype.toString,At=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,to,Pr;if(typeof At=="function"&&typeof Object.defineProperty=="function")try{to=Object.defineProperty({},"length",{get:function(){throw Pr}}),Pr={},At(function(){throw 42},null,to)}catch(e){e!==Pr&&(At=null)}else At=null;var Md=/^\s*class\b/,ro=function(t){try{var r=Sc.call(t);return Md.test(r)}catch{return!1}},Pn=function(t){try{return ro(t)?!1:(Sc.call(t),!0)}catch{return!1}},Mr=Object.prototype.toString,Ld="[object Object]",Rd="[object Function]",Nd="[object GeneratorFunction]",xd="[object HTMLAllCollection]",Bd="[object HTML document.all class]",Dd="[object HTMLCollection]",Ud=typeof Symbol=="function"&&!!Symbol.toStringTag,kd=!(0 in[,]),no=function(){return!1};if(typeof document=="object"){var qd=document.all;Mr.call(qd)===Mr.call(document.all)&&(no=function(t){if((kd||!t)&&(typeof t>"u"||typeof t=="object"))try{var r=Mr.call(t);return(r===xd||r===Bd||r===Dd||r===Ld)&&t("")==null}catch{}return!1})}var on=At?function(t){if(no(t))return!0;if(!t||typeof t!="function"&&typeof t!="object")return!1;try{At(t,null,to)}catch(r){if(r!==Pr)return!1}return!ro(t)&&Pn(t)}:function(t){if(no(t))return!0;if(!t||typeof t!="function"&&typeof t!="object")return!1;if(Ud)return Pn(t);if(ro(t))return!1;var r=Mr.call(t);return r!==Rd&&r!==Nd&&!/^\[object HTML/.test(r)?!1:Pn(t)},jd=on,Gd=Object.prototype.toString,_c=Object.prototype.hasOwnProperty,Vd=function(t,r,n){for(var i=0,o=t.length;i<o;i++)_c.call(t,i)&&(n==null?r(t[i],i,t):r.call(n,t[i],i,t))},Wd=function(t,r,n){for(var i=0,o=t.length;i<o;i++)n==null?r(t.charAt(i),i,t):r.call(n,t.charAt(i),i,t)},zd=function(t,r,n){for(var i in t)_c.call(t,i)&&(n==null?r(t[i],i,t):r.call(n,t[i],i,t))};function Hd(e){return Gd.call(e)==="[object Array]"}var Oo=function(t,r,n){if(!jd(r))throw new TypeError("iterator must be a function");var i;arguments.length>=3&&(i=n),Hd(t)?Vd(t,r,i):typeof t=="string"?Wd(t,r,i):zd(t,r,i)},Ec=["Float16Array","Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"],Mn=Ec,Kd=typeof globalThis>"u"?window:globalThis,nr=function(){for(var t=[],r=0;r<Mn.length;r++)typeof Kd[Mn[r]]=="function"&&(t[t.length]=Mn[r]);return t},Nr=Oo,Jd=nr,wa=Qe,Fo=V,Lr=Jr,yr=Ot,Yd=Fo("Object.prototype.toString"),wc=pt(),Aa=typeof globalThis>"u"?window:globalThis,io=Jd(),Po=Fo("String.prototype.slice"),Zd=Fo("Array.prototype.indexOf",!0)||function(t,r){for(var n=0;n<t.length;n+=1)if(t[n]===r)return n;return-1},xr={__proto__:null};wc&&Lr&&yr?Nr(io,function(e){var t=new Aa[e];if(Symbol.toStringTag in t&&yr){var r=yr(t),n=Lr(r,Symbol.toStringTag);if(!n&&r){var i=yr(r);n=Lr(i,Symbol.toStringTag)}xr["$"+e]=wa(n.get)}}):Nr(io,function(e){var t=new Aa[e],r=t.slice||t.set;r&&(xr["$"+e]=wa(r))});var Xd=function(t){var r=!1;return Nr(xr,function(n,i){if(!r)try{"$"+n(t)===i&&(r=Po(i,1))}catch{}}),r},Qd=function(t){var r=!1;return Nr(xr,function(n,i){if(!r)try{n(t),r=Po(i,1)}catch{}}),r},xt=function(t){if(!t||typeof t!="object")return!1;if(!wc){var r=Po(Yd(t),8,-1);return Zd(io,r)>-1?r:r!=="Object"?!1:Qd(t)}return Lr?Xd(t):null};const eh={},th=Object.freeze(Object.defineProperty({__proto__:null,default:eh},Symbol.toStringTag,{value:"Module"})),oo=_o(th);var Mo=typeof Map=="function"&&Map.prototype,Ln=Object.getOwnPropertyDescriptor&&Mo?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,Br=Mo&&Ln&&typeof Ln.get=="function"?Ln.get:null,Ia=Mo&&Map.prototype.forEach,Lo=typeof Set=="function"&&Set.prototype,Rn=Object.getOwnPropertyDescriptor&&Lo?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,Dr=Lo&&Rn&&typeof Rn.get=="function"?Rn.get:null,$a=Lo&&Set.prototype.forEach,rh=typeof WeakMap=="function"&&WeakMap.prototype,Xt=rh?WeakMap.prototype.has:null,nh=typeof WeakSet=="function"&&WeakSet.prototype,Qt=nh?WeakSet.prototype.has:null,ih=typeof WeakRef=="function"&&WeakRef.prototype,Ca=ih?WeakRef.prototype.deref:null,oh=Boolean.prototype.valueOf,ah=Object.prototype.toString,sh=Function.prototype.toString,uh=String.prototype.match,Ro=String.prototype.slice,Xe=String.prototype.replace,ch=String.prototype.toUpperCase,Oa=String.prototype.toLowerCase,Ac=RegExp.prototype.test,Fa=Array.prototype.concat,Le=Array.prototype.join,lh=Array.prototype.slice,Pa=Math.floor,ao=typeof BigInt=="function"?BigInt.prototype.valueOf:null,Nn=Object.getOwnPropertySymbols,so=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,Ct=typeof Symbol=="function"&&typeof Symbol.iterator=="object",er=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Ct||!0)?Symbol.toStringTag:null,Ic=Object.prototype.propertyIsEnumerable,Ma=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null);function La(e,t){if(e===1/0||e===-1/0||e!==e||e&&e>-1e3&&e<1e3||Ac.call(/e/,t))return t;var r=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof e=="number"){var n=e<0?-Pa(-e):Pa(e);if(n!==e){var i=String(n),o=Ro.call(t,i.length+1);return Xe.call(i,r,"$&_")+"."+Xe.call(Xe.call(o,/([0-9]{3})/g,"$&_"),/_$/,"")}}return Xe.call(t,r,"$&_")}var uo=oo,Ra=uo.custom,Na=Oc(Ra)?Ra:null,$c={__proto__:null,double:'"',single:"'"},fh={__proto__:null,double:/(["\\])/g,single:/(['\\])/g},ph=function e(t,r,n,i){var o=r||{};if(Ge(o,"quoteStyle")&&!Ge($c,o.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Ge(o,"maxStringLength")&&(typeof o.maxStringLength=="number"?o.maxStringLength<0&&o.maxStringLength!==1/0:o.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var a=Ge(o,"customInspect")?o.customInspect:!0;if(typeof a!="boolean"&&a!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Ge(o,"indent")&&o.indent!==null&&o.indent!=="	"&&!(parseInt(o.indent,10)===o.indent&&o.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Ge(o,"numericSeparator")&&typeof o.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var c=o.numericSeparator;if(typeof t>"u")return"undefined";if(t===null)return"null";if(typeof t=="boolean")return t?"true":"false";if(typeof t=="string")return Pc(t,o);if(typeof t=="number"){if(t===0)return 1/0/t>0?"0":"-0";var u=String(t);return c?La(t,u):u}if(typeof t=="bigint"){var y=String(t)+"n";return c?La(t,y):y}var h=typeof o.depth>"u"?5:o.depth;if(typeof n>"u"&&(n=0),n>=h&&h>0&&typeof t=="object")return co(t)?"[Array]":"[Object]";var b=Fh(o,n);if(typeof i>"u")i=[];else if(Fc(i,t)>=0)return"[Circular]";function l(E,N,j){if(N&&(i=lh.call(i),i.push(N)),j){var Q={depth:o.depth};return Ge(o,"quoteStyle")&&(Q.quoteStyle=o.quoteStyle),e(E,Q,n+1,i)}return e(E,o,n+1,i)}if(typeof t=="function"&&!xa(t)){var p=Sh(t),_=gr(t,l);return"[Function"+(p?": "+p:" (anonymous)")+"]"+(_.length>0?" { "+Le.call(_,", ")+" }":"")}if(Oc(t)){var w=Ct?Xe.call(String(t),/^(Symbol\(.*\))_[^)]*$/,"$1"):so.call(t);return typeof t=="object"&&!Ct?Jt(w):w}if($h(t)){for(var A="<"+Oa.call(String(t.nodeName)),R=t.attributes||[],O=0;O<R.length;O++)A+=" "+R[O].name+"="+Cc(dh(R[O].value),"double",o);return A+=">",t.childNodes&&t.childNodes.length&&(A+="..."),A+="</"+Oa.call(String(t.nodeName))+">",A}if(co(t)){if(t.length===0)return"[]";var m=gr(t,l);return b&&!Oh(m)?"["+lo(m,b)+"]":"[ "+Le.call(m,", ")+" ]"}if(yh(t)){var I=gr(t,l);return!("cause"in Error.prototype)&&"cause"in t&&!Ic.call(t,"cause")?"{ ["+String(t)+"] "+Le.call(Fa.call("[cause]: "+l(t.cause),I),", ")+" }":I.length===0?"["+String(t)+"]":"{ ["+String(t)+"] "+Le.call(I,", ")+" }"}if(typeof t=="object"&&a){if(Na&&typeof t[Na]=="function"&&uo)return uo(t,{depth:h-n});if(a!=="symbol"&&typeof t.inspect=="function")return t.inspect()}if(_h(t)){var $=[];return Ia&&Ia.call(t,function(E,N){$.push(l(N,t,!0)+" => "+l(E,t))}),Ba("Map",Br.call(t),$,b)}if(Ah(t)){var P=[];return $a&&$a.call(t,function(E){P.push(l(E,t))}),Ba("Set",Dr.call(t),P,b)}if(Eh(t))return xn("WeakMap");if(Ih(t))return xn("WeakSet");if(wh(t))return xn("WeakRef");if(vh(t))return Jt(l(Number(t)));if(bh(t))return Jt(l(ao.call(t)));if(mh(t))return Jt(oh.call(t));if(gh(t))return Jt(l(String(t)));if(typeof window<"u"&&t===window)return"{ [object Window] }";if(typeof globalThis<"u"&&t===globalThis||typeof window<"u"&&t===window)return"{ [object globalThis] }";if(!hh(t)&&!xa(t)){var C=gr(t,l),B=Ma?Ma(t)===Object.prototype:t instanceof Object||t.constructor===Object,f=t instanceof Object?"":"null prototype",S=!B&&er&&Object(t)===t&&er in t?Ro.call(tt(t),8,-1):f?"Object":"",g=B||typeof t.constructor!="function"?"":t.constructor.name?t.constructor.name+" ":"",v=g+(S||f?"["+Le.call(Fa.call([],S||[],f||[]),": ")+"] ":"");return C.length===0?v+"{}":b?v+"{"+lo(C,b)+"}":v+"{ "+Le.call(C,", ")+" }"}return String(t)};function Cc(e,t,r){var n=r.quoteStyle||t,i=$c[n];return i+e+i}function dh(e){return Xe.call(String(e),/"/g,"&quot;")}function yt(e){return!er||!(typeof e=="object"&&(er in e||typeof e[er]<"u"))}function co(e){return tt(e)==="[object Array]"&&yt(e)}function hh(e){return tt(e)==="[object Date]"&&yt(e)}function xa(e){return tt(e)==="[object RegExp]"&&yt(e)}function yh(e){return tt(e)==="[object Error]"&&yt(e)}function gh(e){return tt(e)==="[object String]"&&yt(e)}function vh(e){return tt(e)==="[object Number]"&&yt(e)}function mh(e){return tt(e)==="[object Boolean]"&&yt(e)}function Oc(e){if(Ct)return e&&typeof e=="object"&&e instanceof Symbol;if(typeof e=="symbol")return!0;if(!e||typeof e!="object"||!so)return!1;try{return so.call(e),!0}catch{}return!1}function bh(e){if(!e||typeof e!="object"||!ao)return!1;try{return ao.call(e),!0}catch{}return!1}var Th=Object.prototype.hasOwnProperty||function(e){return e in this};function Ge(e,t){return Th.call(e,t)}function tt(e){return ah.call(e)}function Sh(e){if(e.name)return e.name;var t=uh.call(sh.call(e),/^function\s*([\w$]+)/);return t?t[1]:null}function Fc(e,t){if(e.indexOf)return e.indexOf(t);for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}function _h(e){if(!Br||!e||typeof e!="object")return!1;try{Br.call(e);try{Dr.call(e)}catch{return!0}return e instanceof Map}catch{}return!1}function Eh(e){if(!Xt||!e||typeof e!="object")return!1;try{Xt.call(e,Xt);try{Qt.call(e,Qt)}catch{return!0}return e instanceof WeakMap}catch{}return!1}function wh(e){if(!Ca||!e||typeof e!="object")return!1;try{return Ca.call(e),!0}catch{}return!1}function Ah(e){if(!Dr||!e||typeof e!="object")return!1;try{Dr.call(e);try{Br.call(e)}catch{return!0}return e instanceof Set}catch{}return!1}function Ih(e){if(!Qt||!e||typeof e!="object")return!1;try{Qt.call(e,Qt);try{Xt.call(e,Xt)}catch{return!0}return e instanceof WeakSet}catch{}return!1}function $h(e){return!e||typeof e!="object"?!1:typeof HTMLElement<"u"&&e instanceof HTMLElement?!0:typeof e.nodeName=="string"&&typeof e.getAttribute=="function"}function Pc(e,t){if(e.length>t.maxStringLength){var r=e.length-t.maxStringLength,n="... "+r+" more character"+(r>1?"s":"");return Pc(Ro.call(e,0,t.maxStringLength),t)+n}var i=fh[t.quoteStyle||"single"];i.lastIndex=0;var o=Xe.call(Xe.call(e,i,"\\$1"),/[\x00-\x1f]/g,Ch);return Cc(o,"single",t)}function Ch(e){var t=e.charCodeAt(0),r={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return r?"\\"+r:"\\x"+(t<16?"0":"")+ch.call(t.toString(16))}function Jt(e){return"Object("+e+")"}function xn(e){return e+" { ? }"}function Ba(e,t,r,n){var i=n?lo(r,n):Le.call(r,", ");return e+" ("+t+") {"+i+"}"}function Oh(e){for(var t=0;t<e.length;t++)if(Fc(e[t],`
`)>=0)return!1;return!0}function Fh(e,t){var r;if(e.indent==="	")r="	";else if(typeof e.indent=="number"&&e.indent>0)r=Le.call(Array(e.indent+1)," ");else return null;return{base:r,prev:Le.call(Array(t+1),r)}}function lo(e,t){if(e.length===0)return"";var r=`
`+t.prev+t.base;return r+Le.call(e,","+r)+`
`+t.prev}function gr(e,t){var r=co(e),n=[];if(r){n.length=e.length;for(var i=0;i<e.length;i++)n[i]=Ge(e,i)?t(e[i],e):""}var o=typeof Nn=="function"?Nn(e):[],a;if(Ct){a={};for(var c=0;c<o.length;c++)a["$"+o[c]]=o[c]}for(var u in e)Ge(e,u)&&(r&&String(Number(u))===u&&u<e.length||Ct&&a["$"+u]instanceof Symbol||(Ac.call(/[^\w$]/,u)?n.push(t(u,e)+": "+t(e[u],e)):n.push(u+": "+t(e[u],e))));if(typeof Nn=="function")for(var y=0;y<o.length;y++)Ic.call(e,o[y])&&n.push("["+t(o[y])+"]: "+t(e[o[y]],e));return n}var an=function(t){return typeof t=="string"||typeof t=="symbol"},rt=function(t){return!!t&&(typeof t=="function"||typeof t=="object")},Da=U,Ph=ph,Mh=an,Lh=rt,Rh=function(t,r){if(!Lh(t))throw new Da("Assertion failed: Type(O) is not Object");if(!Mh(r))throw new Da("Assertion failed: P is not a Property Key, got "+Ph(r));return t[r]},Nh=Ft,We=function(t){return(typeof t=="number"||typeof t=="bigint")&&!Nh(t)&&t!==1/0&&t!==-1/0},xh=Eo,Bh=Pt,Dh=Ft,Uh=We,sn=function(t){if(typeof t!="number"||Dh(t)||!Uh(t))return!1;var r=xh(t);return Bh(r)===r},kh=Qe,Mc=V,qh=X,fo=qh("%ArrayBuffer%",!0),Rr=Mc("ArrayBuffer.prototype.byteLength",!0),jh=Mc("Object.prototype.toString"),Ua=!!fo&&!Rr&&new fo(0).slice,ka=!!Ua&&kh(Ua),Bt=Rr||ka?function(t){if(!t||typeof t!="object")return!1;try{return Rr?Rr(t):ka(t,0),!0}catch{return!1}}:fo?function(t){return jh(t)==="[object ArrayBuffer]"}:function(t){return!1},Gh=V,qa=Gh("ArrayBuffer.prototype.byteLength",!0),Vh=Bt,Lc=function(t){return Vh(t)?qa?qa(t):t.byteLength:NaN},Wh=V,ja=Wh("SharedArrayBuffer.prototype.byteLength",!0),ir=ja?function(t){if(!t||typeof t!="object")return!1;try{return ja(t),!0}catch{return!1}}:function(t){return!1},zh=U,Hh=Lc,Kh=nr(),Jh=V,Yh=Bt,Zh=ir,Xh=Jh("SharedArrayBuffer.prototype.byteLength",!0),Dt=function(t){var r=Zh(t);if(!Yh(t)&&!r)throw new zh("Assertion failed: `arrayBuffer` must be an Object with an [[ArrayBufferData]] internal slot");if((r?Xh:Hh)(t)===0)try{new window[Kh[0]](t)}catch(n){return!!n&&n.name==="TypeError"}return!1},Bn,Ga;function Rc(){if(Ga)return Bn;Ga=1;var e=U,t=dt,r=rt,n=an;return Bn=function(o,a){if(!r(o))throw new e("Assertion failed: `O` must be an Object");if(!n(a))throw new e("Assertion failed: `P` must be a Property Key");return t(o,a)},Bn}var Qh=X,Nc=Qh("%Array%"),ey=!Nc.isArray&&V("Object.prototype.toString"),xc=Nc.isArray||function(t){return ey(t)==="[object Array]"},No=xc,Dn,Va;function Bc(){return Va||(Va=1,Dn=function(t){return t==="BIGUINT64"||t==="BIGINT64"}),Dn}var Un,Wa;function ty(){return Wa||(Wa=1,Un=function(t){return t==="UINT8"||t==="UINT8C"||t==="UINT16"||t==="UINT32"||t==="BIGUINT64"}),Un}var kn,za;function ry(){if(za)return kn;za=1;var e=Mt;return kn=function(r){var n=r[3]&128?-1:1,i=(r[3]&127)<<1|r[2]>>7,o=(r[2]&127)<<16|r[1]<<8|r[0];return i===0&&o===0?n===1?0:-0:i===255&&o===0?n===1?1/0:-1/0:i===255&&o!==0?NaN:(i-=127,i===-127?n*o*e(2,-149):n*(1+o*e(2,-23))*e(2,i))},kn}var qn,Ha;function ny(){if(Ha)return qn;Ha=1;var e=Mt;return qn=function(r){var n=r[7]&128?-1:1,i=(r[7]&127)<<4|(r[6]&240)>>4,o=(r[6]&15)*281474976710656+r[5]*1099511627776+r[4]*4294967296+r[3]*16777216+r[2]*65536+r[1]*256+r[0];return i===0&&o===0?n*0:i===2047&&o!==0?NaN:i===2047&&o===0?n*(1/0):(i-=1023,i===-1023?n*o*5e-324:n*(1+o/4503599627370496)*e(2,i))},qn}var jn,Ka;function iy(){if(Ka)return jn;Ka=1;var e=X,t=Mt,r=e("%Number%"),n=e("%BigInt%",!0);return jn=function(o,a,c,u){for(var y=u?n:r,h=y(0),b=0;b<o.length;b++)h+=y(o[b]*t(2,8*b));if(!c){var l=a*8;o[a-1]&128&&(h-=y(t(2,l)))}return h},jn}var Gn,Ja;function oy(){return Ja||(Ja=1,Gn=function(t,r){for(var n=0;n<t.length;n+=1)if(!r(t[n],n,t))return!1;return!0}),Gn}var Vn,Ya;function ay(){return Ya||(Ya=1,Vn=function(t){return typeof t=="number"&&t>=0&&t<=255&&(t|0)===t}),Vn}var Ut={__proto__:null,name:{__proto__:null,$Int8Array:"INT8",$Uint8Array:"UINT8",$Uint8ClampedArray:"UINT8C",$Int16Array:"INT16",$Uint16Array:"UINT16",$Int32Array:"INT32",$Uint32Array:"UINT32",$BigInt64Array:"BIGINT64",$BigUint64Array:"BIGUINT64",$Float32Array:"FLOAT32",$Float64Array:"FLOAT64"},size:{__proto__:null,$INT8:1,$UINT8:1,$UINT8C:1,$INT16:2,$UINT16:2,$INT32:4,$UINT32:4,$BIGINT64:8,$BIGUINT64:8,$FLOAT32:4,$FLOAT64:8},choices:'"INT8", "UINT8", "UINT8C", "INT16", "UINT16", "INT32", "UINT32", "BIGINT64", "BIGUINT64", "FLOAT32", or "FLOAT64"'},Wn,Za;function sy(){if(Za)return Wn;Za=1;var e=X,t=V,r=Yu,n=Ve,i=U,o=e("%BigInt%",!0),a=Rc(),c=No,u=Bc(),y=ty(),h=ry(),b=ny(),l=iy(),p=oy(),_=ay(),w=t("Array.prototype.reverse"),A=t("Array.prototype.slice"),R=Ut;return Wn=function(m,I,$){if(!a(R.size,"$"+m))throw new i("Assertion failed: `type` must be a TypedArray element type");if(!c(I)||!p(I,_))throw new i("Assertion failed: `rawBytes` must be an Array of bytes");if(typeof $!="boolean")throw new i("Assertion failed: `isLittleEndian` must be a Boolean");var P=R.size["$"+m];if(I.length!==P)throw new r("Assertion failed: `rawBytes` must have a length of "+P+" for type "+m);var C=u(m);if(C&&!o)throw new n("this environment does not support BigInts");return I=A(I,0,P),$||w(I),m==="FLOAT32"?h(I):m==="FLOAT64"?b(I):l(I,P,y(m),C)},Wn}var zn,Xa;function uy(){if(Xa)return zn;Xa=1;var e={}.toString;return zn=Array.isArray||function(t){return e.call(t)=="[object Array]"},zn}var Hn,Qa;function cy(){if(Qa)return Hn;Qa=1;var e=X,t=e("%Array.prototype.concat%"),r=Qe,n=V,i=n("Array.prototype.slice"),o=pp(),a=o&&Symbol.isConcatSpreadable,c=[],u=a?r.apply(t,c):null,y=a?uy():null;return Hn=a?function(b){for(var l=0;l<arguments.length;l+=1){var p=arguments[l];if(p&&typeof p=="object"&&typeof p[a]=="boolean"){c[a]||(c[a]=!0);var _=y(p)?i(p):[p];_[a]=!0,arguments[l]=_}}return u(arguments)}:r(t,c),Hn}var ly=xt,kt=function(t){return!!ly(t)},fy=U,py=V,dy=py("TypedArray.prototype.buffer",!0),hy=kt,or=dy||function(t){if(!hy(t))throw new fy("Not a Typed Array");return t.buffer},Kn,es;function Dc(){if(es)return Kn;es=1;var e=X,t=e("%Uint8Array%",!0),r=e("%Uint32Array%",!0),n=or,i=r&&new r([305419896]),o=i&&new t(n(i));return Kn=o?o[0]===120?"little":o[0]===18?"big":o[0]===52?"mixed":"unknown":"indeterminate",Kn}var yy=X,gy=Ve,qe=U,vy=V,my=sn,by=yy("%Uint8Array%",!0),Jn=vy("Array.prototype.slice"),Ty=Dt,Sy=sy(),_y=Bt,Ey=ir,ts=cy(),vr=Ut,wy=Dc(),Ay=function(t,r,n,i,o){var a=Ey(t);if(!_y(t)&&!a)throw new qe("Assertion failed: `arrayBuffer` must be an ArrayBuffer or a SharedArrayBuffer");if(!my(r))throw new qe("Assertion failed: `byteIndex` must be an integer");if(typeof n!="string"||typeof vr.size["$"+n]!="number")throw new qe("Assertion failed: `type` must be one of "+vr.choices);if(typeof i!="boolean")throw new qe("Assertion failed: `isTypedArray` must be a boolean");if(o!=="SEQ-CST"&&o!=="UNORDERED")throw new qe("Assertion failed: `order` must be either `SEQ-CST` or `UNORDERED`");if(arguments.length>5&&typeof arguments[5]!="boolean")throw new qe("Assertion failed: `isLittleEndian` must be a boolean, if present");if(Ty(t))throw new qe("Assertion failed: `arrayBuffer` is detached");if(r<0)throw new qe("Assertion failed: `byteIndex` must be non-negative");var c=vr.size["$"+n];if(!c)throw new qe("Assertion failed: `type` must be one of "+vr.choices);var u;if(a)throw new gy("SharedArrayBuffer is not supported by this implementation");u=Jn(new by(t,r),0,c);var y=arguments.length>5?arguments[5]:wy==="little",h=y?Jn(ts([0,0,0,0,0,0,0,0],u),-c):Jn(ts(u,[0,0,0,0,0,0,0,0]),0,c);return Sy(n,h,y)},rs=Ft,Uc=function(t,r){return t===r?t===0?1/t===1/r:!0:rs(t)&&rs(r)},mr=U,Iy=rt,$y=an,ns=Uc,is=function(){try{return delete[].length,!0}catch{return!1}}(),Cy=function(t,r,n,i){if(!Iy(t))throw new mr("Assertion failed: `O` must be an Object");if(!$y(r))throw new mr("Assertion failed: `P` must be a Property Key");if(typeof i!="boolean")throw new mr("Assertion failed: `Throw` must be a Boolean");if(i){if(t[r]=n,is&&!ns(t[r],n))throw new mr("Attempted to assign to readonly property.");return!0}try{return t[r]=n,is?ns(t[r],n):!0}catch{return!1}},Yn,os;function Oy(){if(os)return Yn;os=1;var e=X,t=e("%BigInt%",!0),r=U,n=Ve;return Yn=function(o){if(typeof o!="string")throw new r("`argument` must be a string");if(!t)throw new n("BigInts are not supported in this environment");try{return t(o)}catch{return}},Yn}var Zn,as;function Fy(){return as||(as=1,Zn=function(t){return t===null||typeof t!="function"&&typeof t!="object"}),Zn}var br={exports:{}},Xn,ss;function un(){if(ss)return Xn;ss=1;var e=V,t=Zu,r=e("RegExp.prototype.exec"),n=U;return Xn=function(o){if(!t(o))throw new n("`regex` must be a RegExp");return function(c){return r(o,c)!==null}},Xn}var us;function kc(){if(us)return br.exports;us=1;var e=V,t=e("Object.prototype.toString"),r=dp()(),n=un();if(r){var i=e("Symbol.prototype.toString"),o=n(/^Symbol\(.*\)$/),a=function(u){return typeof u.valueOf()!="symbol"?!1:o(i(u))};br.exports=function(u){if(typeof u=="symbol")return!0;if(!u||typeof u!="object"||t(u)!=="[object Symbol]")return!1;try{return a(u)}catch{return!1}}}else br.exports=function(u){return!1};return br.exports}var Qn,cs;function Py(){if(cs)return Qn;cs=1;var e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol",t=Fy(),r=on,n=Xu,i=kc(),o=function(u,y){if(typeof u>"u"||u===null)throw new TypeError("Cannot call method on "+u);if(typeof y!="string"||y!=="number"&&y!=="string")throw new TypeError('hint must be "string" or "number"');var h=y==="string"?["toString","valueOf"]:["valueOf","toString"],b,l,p;for(p=0;p<h.length;++p)if(b=u[h[p]],r(b)&&(l=b.call(u),t(l)))return l;throw new TypeError("No default value")},a=function(u,y){var h=u[y];if(h!==null&&typeof h<"u"){if(!r(h))throw new TypeError(h+" returned for property "+String(y)+" of object "+u+" is not a function");return h}};return Qn=function(u){if(t(u))return u;var y="default";arguments.length>1&&(arguments[1]===String?y="string":arguments[1]===Number&&(y="number"));var h;if(e&&(Symbol.toPrimitive?h=a(u,Symbol.toPrimitive):i(u)&&(h=Symbol.prototype.valueOf)),typeof h<"u"){var b=h.call(u,y);if(t(b))return b;throw new TypeError("unable to convert exotic object to primitive")}return y==="default"&&(n(u)||i(u))&&(y="string"),o(u,y==="default"?"number":y)},Qn}var ei,ls;function qc(){if(ls)return ei;ls=1;var e=Py();return ei=function(r){return arguments.length>1?e(r,arguments[1]):e(r)},ei}var ti,fs;function jc(){if(fs)return ti;fs=1;var e=X,t=e("%BigInt%",!0),r=e("%Number%"),n=U,i=Ve,o=Oy(),a=qc();return ti=function(u){if(!t)throw new i("BigInts are not supported in this environment");var y=a(u,r);if(y==null)throw new n("Cannot convert null or undefined to a BigInt");if(typeof y=="boolean")return t(y?1:0);if(typeof y=="number")throw new n("Cannot convert a Number value to a BigInt");if(typeof y=="string"){var h=o(y);if(typeof h>"u")throw new n("Failed to parse String to BigInt");return h}if(typeof y=="symbol")throw new n("Cannot convert a Symbol value to a BigInt");if(typeof y!="bigint")throw new i("Assertion failed: unknown primitive type");return y},ti}var ri,ps;function Gc(){if(ps)return ri;ps=1;var e=X,t=e("%BigInt%",!0),r=Yu,n=U,i=t&&t(0);return ri=function(a,c){if(typeof a!="bigint"||typeof c!="bigint")throw new n("Assertion failed: `n` and `d` arguments must be BigInts");if(c===i)throw new r("Division by zero");return a===i?i:a%c},ri}var ni,ds;function Vc(){return ds||(ds=1,ni=function(t,r,n){var i=t(r,n);return i>=0?i:i+n}),ni}var ii,hs;function My(){if(hs)return ii;hs=1;var e=X,t=e("%BigInt%",!0),r=Mt,n=jc(),i=Gc(),o=Vc(),a=t&&BigInt(r(2,32))*BigInt(r(2,31)),c=t&&BigInt(r(2,32))*BigInt(r(2,32));return ii=function(y){var h=n(y),b=o(i,h,c);return b>=a?b-c:b},ii}var oi,ys;function Ly(){if(ys)return oi;ys=1;var e=X,t=e("%BigInt%",!0),r=Mt,n=jc(),i=Gc(),o=Vc(),a=t&&BigInt(r(2,32))*BigInt(r(2,32));return oi=function(u){var y=n(u),h=o(i,y,a);return h},oi}var ai,gs;function Ry(){if(gs)return ai;gs=1;var e=Pt;return ai=function(r,n){var i=r%n;return e(i>=0?i:i+n)},ai}var si,vs;function Ny(){return vs||(vs=1,si=Ry()),si}var ui,ms;function qt(){if(ms)return ui;ms=1;var e=Ny();return ui=function(r,n){return e(r,n)},ui}var ci,bs;function xy(){return bs||(bs=1,ci=function(t){return t===null||typeof t!="function"&&typeof t!="object"}),ci}var li,Ts;function Wc(){if(Ts)return li;Ts=1;var e=U;return li=function(r){if(r==null)throw new e(arguments.length>0&&arguments[1]||"Cannot call method on "+r);return r},li}var By=X,Dy=By("%String%"),Uy=U,zc=function(t){if(typeof t=="symbol")throw new Uy("Cannot convert a Symbol value to a string");return Dy(t)},fi,Ss;function Hc(){if(Ss)return fi;Ss=1;var e=Wc(),t=zc,r=V,n=r("String.prototype.replace"),i=/^\s$/.test(""),o=i?/^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/:/^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/,a=i?/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+$/:/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+$/;return fi=function(){var u=t(e(this));return n(n(u,o,""),a,"")},fi}var pi,_s;function Kc(){if(_s)return pi;_s=1;var e=Hc(),t="",r="";return pi=function(){return String.prototype.trim&&t.trim()===t&&r.trim()===r&&("_"+r).trim()==="_"+r&&(r+"_").trim()===r+"_"?String.prototype.trim:e},pi}var di,Es;function ky(){if(Es)return di;Es=1;var e=Qu(),t=hp,r=Kc();return di=function(){var i=r();return String.prototype.trim!==i&&(e?t(String.prototype,"trim",i,!0):t(String.prototype,"trim",i)),i},di}var hi,ws;function qy(){if(ws)return hi;ws=1;var e=Qe,t=tr,r=Wc(),n=Hc(),i=Kc(),o=ky(),a=e(i()),c=function(y){return r(y),a(y)};return t(c,{getPolyfill:i,implementation:n,shim:o}),hi=c,hi}var yi,As;function jy(){if(As)return yi;As=1;var e=X,t=e("%RegExp%"),r=U,n=e("%parseInt%"),i=V,o=un(),a=i("String.prototype.slice"),c=o(/^0b[01]+$/i),u=o(/^0o[0-7]+$/i),y=o(/^[-+]0x[0-9a-f]+$/i),h=["","",""].join(""),b=new t("["+h+"]","g"),l=o(b),p=qy();return yi=function _(w){if(typeof w!="string")throw new r("Assertion failed: `argument` is not a String");if(c(w))return+n(a(w,2),2);if(u(w))return+n(a(w,2),8);if(l(w)||y(w))return NaN;var A=p(w);return A!==w?_(A):+w},yi}var Gy=X,Is=U,Vy=Gy("%Number%"),Wy=xy(),zy=qc(),Hy=jy(),nt=function(t){var r=Wy(t)?t:zy(t,Vy);if(typeof r=="symbol")throw new Is("Cannot convert a Symbol value to a number");if(typeof r=="bigint")throw new Is("Conversion from 'BigInt' to 'number' is not allowed.");return typeof r=="string"?Hy(r):+r},Ky=Pt,xo=function(t){return typeof t=="bigint"?t:Ky(t)},$s=xo,Jy=U,gt=function(t){if(typeof t!="number"&&typeof t!="bigint")throw new Jy("argument must be a Number or a BigInt");var r=t<0?-$s(-t):$s(t);return r===0?0:r},gi,Cs;function Yy(){if(Cs)return gi;Cs=1;var e=qt(),t=nt,r=gt,n=We,i=65536;return gi=function(a){var c=t(a);if(!n(c)||c===0)return 0;var u=r(c),y=e(u,i);return y>=32768?y-i:y},gi}var vi,Os;function Zy(){if(Os)return vi;Os=1;var e=qt(),t=nt,r=gt,n=We,i=2147483648,o=4294967296;return vi=function(c){var u=t(c);if(!n(u)||u===0)return 0;var y=r(u),h=e(y,o),b=h>=i?h-o:h;return b===0?0:b},vi}var mi,Fs;function Xy(){if(Fs)return mi;Fs=1;var e=qt(),t=nt,r=gt,n=We;return mi=function(o){var a=t(o);if(!n(a)||a===0)return 0;var c=r(a),u=e(c,256);return u>=128?u-256:u},mi}var bi,Ps;function Qy(){if(Ps)return bi;Ps=1;var e=qt(),t=nt,r=gt,n=We,i=65536;return bi=function(a){var c=t(a);if(!n(c)||c===0)return 0;var u=r(c),y=e(u,i);return y===0?0:y},bi}var Ti,Ms;function eg(){if(Ms)return Ti;Ms=1;var e=qt(),t=nt,r=gt,n=We,i=4294967296;return Ti=function(a){var c=t(a);if(!n(c)||c===0)return 0;var u=r(c),y=e(u,i);return y===0?0:y},Ti}var Si,Ls;function tg(){if(Ls)return Si;Ls=1;var e=We,t=qt(),r=nt,n=gt;return Si=function(o){var a=r(o);if(!e(a)||a===0)return 0;var c=n(a),u=t(c,256);return u},Si}var _i,Rs;function rg(){if(Rs)return _i;Rs=1;var e=U,t=tc,r=ec;return _i=function(i,o,a){if(typeof i!="number"||typeof o!="number"||typeof a!="number"||!(o<=a))throw new e("Assertion failed: all three arguments must be MVs, and `lower` must be `<= upper`");return r(t(o,i),a)},_i}var Ei,Ns;function ng(){if(Ns)return Ei;Ns=1;var e=rg(),t=nt,r=xo,n=Ft;return Ei=function(o){var a=t(o);if(n(a))return 0;var c=e(a,0,255),u=r(c);return c<u+.5?u:c>u+.5?u+1:u%2===0?u:u+1},Ei}var wi,xs;function Jc(){return xs||(xs=1,wi=function(t){return t===0&&1/t===-1/0}),wi}var Ai,Bs;function ig(){if(Bs)return Ai;Bs=1;var e=Eo,t=Pt,r=Mt,n=We,i=Ft,o=Jc(),a=34028234663852886e22;return Ai=function(u,y){if(i(u))return y?[0,0,192,127]:[127,192,0,0];var h;if(u===0)return h=o(u)?128:0,y?[0,0,0,h]:[h,0,0,0];if(e(u)>a||!n(u))return h=u<0?255:127,y?[0,0,128,h]:[h,128,0,0];var b=u<0?1:0;u=e(u);for(var l=0;u>=2;)l+=1,u/=2;for(;u<1;)l-=1,u*=2;var p=u-1;p*=r(2,23)+.5,p=t(p),l+=127,l<<=23;var _=b<<31|l|p,w=_&255;_>>=8;var A=_&255;_>>=8;var R=_&255;_>>=8;var O=_&255;return y?[w,A,R,O]:[O,R,A,w]},Ai}var Ii,Ds;function og(){if(Ds)return Ii;Ds=1;var e=1075,t=54;return Ii=function(n){var i="";if(n===0)return i;for(var o=e,a,c=0;c<e;c+=1)if(a=n*2,a>=1?(n=a-1,i+="1",o===e&&(o=c)):(n=a,i+="0"),a===1||c-o>t)return i;return i},Ii}var $i,Us;function ag(){if(Us)return $i;Us=1;var e=Pt;return $i=function(r){for(var n="",i;r>0;)i=r/2,r=e(i),i===r?n="0"+n:n="1"+n;return n},$i}var Ci,ks;function sg(){if(ks)return Ci;ks=1;var e=X,t=e("%parseInt%"),r=Eo,n=Pt,i=Jc(),o=V,a=o("String.prototype.indexOf"),c=o("String.prototype.slice"),u=og(),y=ag(),h=1023,b="11111111111",l="00000000000",p=l+l+l+l+"0000000";return Ci=function(w,A){var R=w<0||i(w)?"1":"0",O,m;if(isNaN(w))O=b,m="1"+p;else if(!isFinite(w))O=b,m="0"+p;else if(w===0)O=l,m="0"+p;else{w=r(w);var I=n(w),$=y(I),P=u(w-I),C;if($)O=$.length-1;else{var B=a(P,"1");B>-1&&(C=B+1),O=-C}m=$+P,O<0?(O<=-h&&(C=h-1),m=c(m,C)):m=c(m,1),O=c(l+y(O+h),-11),m=c(m+p+"0",0,52)}for(var f=R+O+m,S=[],g=0;g<8;g++){var v=A?8-g-1:g;S[v]=t(c(f,g*8,(g+1)*8),2)}return S},Ci}var Oi,qs;function ug(){if(qs)return Oi;qs=1;var e=X,t=e("%Number%"),r=e("%BigInt%",!0);return Oi=function(i,o,a){var c=typeof i=="bigint"?r:t;i<0&&(i>>>=0);for(var u=[],y=0;y<o;y++)u[a?y:o-1-y]=t(i&c(255)),i>>=c(8);return u},Oi}var Fi,js;function cg(){if(js)return Fi;js=1;var e=U,t=Rc(),r=My(),n=Ly(),i=Yy(),o=Zy(),a=Xy(),c=Qy(),u=eg(),y=tg(),h=ng(),b=ig(),l=sg(),p=ug(),_=Ut,w={__proto__:null,$INT8:a,$UINT8:y,$UINT8C:h,$INT16:i,$UINT16:c,$INT32:o,$UINT32:u,$BIGINT64:r,$BIGUINT64:n};return Fi=function(R,O,m){if(typeof R!="string"||!t(_.size,"$"+R))throw new e("Assertion failed: `type` must be a TypedArray element type");if(typeof O!="number"&&typeof O!="bigint")throw new e("Assertion failed: `value` must be a Number or a BigInt");if(typeof m!="boolean")throw new e("Assertion failed: `isLittleEndian` must be a Boolean");if(R==="FLOAT32")return b(O,m);if(R==="FLOAT64")return l(O,m);var I=_.size["$"+R],$=w["$"+R],P=$(O);return p(P,I,m)},Fi}var Pi,Gs;function lg(){return Gs||(Gs=1,Pi=function(t,r){for(var n=0;n<t.length;n+=1)r(t[n],n,t)}),Pi}var fg=X,pg=Ve,je=U,dg=sn,hg=fg("%Uint8Array%",!0),yg=Bc(),gg=Dt,vg=cg(),mg=Bt,bg=ir,Tg=dt,Mi=Ut,Sg=Dc(),_g=lg(),Eg=function(t,r,n,i,o,a){var c=bg(t);if(!mg(t)&&!c)throw new je("Assertion failed: `arrayBuffer` must be an ArrayBuffer or a SharedArrayBuffer");if(!dg(r)||r<0)throw new je("Assertion failed: `byteIndex` must be a non-negative integer");if(typeof n!="string"||!Tg(Mi.size,"$"+n))throw new je("Assertion failed: `type` must be one of "+Mi.choices);if(typeof i!="number"&&typeof i!="bigint")throw new je("Assertion failed: `value` must be a Number or a BigInt");if(typeof o!="boolean")throw new je("Assertion failed: `isTypedArray` must be a boolean");if(a!=="SEQ-CST"&&a!=="UNORDERED"&&a!=="INIT")throw new je('Assertion failed: `order` must be `"SEQ-CST"`, `"UNORDERED"`, or `"INIT"`');if(arguments.length>6&&typeof arguments[6]!="boolean")throw new je("Assertion failed: `isLittleEndian` must be a boolean, if present");if(gg(t))throw new je("Assertion failed: ArrayBuffer is detached");if(yg(n)?typeof i!="bigint":typeof i!="number")throw new je("Assertion failed: `value` must be a BigInt if type is ~BIGINT64~ or ~BIGUINT64~, otherwise a Number");var u=Mi.size["$"+n],y=arguments.length>6?arguments[6]:Sg==="little",h=vg(n,i,y);if(c)throw new pg("SharedArrayBuffer is not supported by this implementation");var b=new hg(t,r,u);_g(h,function(l,p){b[p]=l})},wg=nt,Ag=gt,Ig=Ft,$g=We,Cg=function(t){var r=wg(t);return Ig(r)||r===0?0:$g(r)?Ag(r):r},Og=Ve,Fg=U,Pg=sn,Mg=xt,Vs=Ut,Bo=function(t){var r=Mg(t);if(!r)throw new Fg("Assertion failed: `O` must be a TypedArray");var n=Vs.size["$"+Vs.name["$"+r]];if(!Pg(n)||n<0)throw new Og("Assertion failed: Unknown TypedArray type `"+r+"`");return n},Lg=Ve,Rg=U,Ng=xt,xg=Ut,Bg=function(t){var r=Ng(t);if(!r)throw new Rg("Assertion failed: `O` must be a TypedArray");var n=xg.name["$"+r];if(typeof n!="string")throw new Lg("Assertion failed: Unknown TypedArray type `"+r+"`");return n},po={exports:{}},Dg=X,Li,Ws;function Do(){if(Ws)return Li;Ws=1;var e=U,t=dt,r={__proto__:null,"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};return Li=function(i){if(!i||typeof i!="object")return!1;for(var o in i)if(t(i,o)&&!r[o])return!1;var a=t(i,"[[Value]]")||t(i,"[[Writable]]"),c=t(i,"[[Get]]")||t(i,"[[Set]]");if(a&&c)throw new e("Property Descriptors may not be both accessor and data descriptors");return!0},Li}var Ri,zs;function Ug(){if(zs)return Ri;zs=1;var e=Qu,t=yp,r=e.hasArrayLengthDefineBug(),n=r&&xc,i=V,o=i("Object.prototype.propertyIsEnumerable");return Ri=function(c,u,y,h,b,l){if(!t){if(!c(l)||!l["[[Configurable]]"]||!l["[[Writable]]"]||b in h&&o(h,b)!==!!l["[[Enumerable]]"])return!1;var p=l["[[Value]]"];return h[b]=p,u(h[b],p)}return r&&b==="length"&&"[[Value]]"in l&&n(h)&&h.length!==l["[[Value]]"]?(h.length=l["[[Value]]"],h.length===l["[[Value]]"]):(t(h,b,y(l)),!0)},Ri}var Ni,Hs;function kg(){return Hs||(Hs=1,Ni=function(t){if(typeof t>"u")return t;var r={};return"[[Value]]"in t&&(r.value=t["[[Value]]"]),"[[Writable]]"in t&&(r.writable=!!t["[[Writable]]"]),"[[Get]]"in t&&(r.get=t["[[Get]]"]),"[[Set]]"in t&&(r.set=t["[[Set]]"]),"[[Enumerable]]"in t&&(r.enumerable=!!t["[[Enumerable]]"]),"[[Configurable]]"in t&&(r.configurable=!!t["[[Configurable]]"]),r}),Ni}var xi,Ks;function qg(){if(Ks)return xi;Ks=1;var e=U,t=Do(),r=kg();return xi=function(i){if(typeof i<"u"&&!t(i))throw new e("Assertion failed: `Desc` must be a Property Descriptor");return r(i)},xi}var Bi,Js;function jg(){if(Js)return Bi;Js=1;var e=U,t=dt,r=Do();return Bi=function(i){if(typeof i>"u")return!1;if(!r(i))throw new e("Assertion failed: `Desc` must be a Property Descriptor");return!(!t(i,"[[Value]]")&&!t(i,"[[Writable]]"))},Bi}var Yc=on,Di,Ys;function Gg(){return Ys||(Ys=1,Di=function(t){return!!t}),Di}var Ui,Zs;function Vg(){if(Zs)return Ui;Zs=1;var e=dt,t=U,r=rt,n=Yc,i=Gg();return Ui=function(a){if(!r(a))throw new t("ToPropertyDescriptor requires an object");var c={};if(e(a,"enumerable")&&(c["[[Enumerable]]"]=i(a.enumerable)),e(a,"configurable")&&(c["[[Configurable]]"]=i(a.configurable)),e(a,"value")&&(c["[[Value]]"]=a.value),e(a,"writable")&&(c["[[Writable]]"]=i(a.writable)),e(a,"get")){var u=a.get;if(typeof u<"u"&&!n(u))throw new t("getter must be a function");c["[[Get]]"]=u}if(e(a,"set")){var y=a.set;if(typeof y<"u"&&!n(y))throw new t("setter must be a function");c["[[Set]]"]=y}if((e(c,"[[Get]]")||e(c,"[[Set]]"))&&(e(c,"[[Value]]")||e(c,"[[Writable]]")))throw new t("Invalid property descriptor. Cannot both specify accessors and a value or writable attribute");return c},Ui}var ki,Xs;function Wg(){if(Xs)return ki;Xs=1;var e=U,t=rt,r=Do(),n=Ug(),i=qg(),o=jg(),a=an,c=Uc,u=Vg();return ki=function(h,b,l){if(!t(h))throw new e("Assertion failed: Type(O) is not Object");if(!a(b))throw new e("Assertion failed: P is not a Property Key");var p=r(l)?l:u(l);if(!r(p))throw new e("Assertion failed: Desc is not a valid Property Descriptor");return n(o,c,i,h,b,p)},ki}var zg=Dg,Qs=zg("%Reflect.construct%",!0),Ur=Wg();try{Ur({},"",{"[[Get]]":function(){}})}catch{Ur=null}if(Ur&&Qs){var eu={},tu={};Ur(tu,"length",{"[[Get]]":function(){throw eu},"[[Enumerable]]":!0}),po.exports=function(t){try{Qs(t,tu)}catch(r){return r===eu}}}else po.exports=function(t){return typeof t=="function"&&!!t.prototype};var Zc=po.exports,Hg=X,ru=Hg("%Symbol.species%",!0),qi=U,nu=rt,Kg=Zc,Jg=function(t,r){if(!nu(t))throw new qi("Assertion failed: Type(O) is not Object");var n=t.constructor;if(typeof n>"u")return r;if(!nu(n))throw new qi("O.constructor is not an Object");var i=ru?n[ru]:void 0;if(i==null)return r;if(Kg(i))return i;throw new qi("no constructor found")},Yg=U,Xc=V,iu=Xc("%ArrayBuffer.prototype.resizable%",!0),ou=Xc("%SharedArrayBuffer.prototype.growable%",!0),Zg=Bt,Xg=ir,Qc=function(t){var r=Zg(t),n=Xg(t);if(!r&&!n)throw new Yg("Assertion failed: `arrayBuffer` must be an ArrayBuffer or SharedArrayBuffer");return r&&iu?!iu(t):n&&ou?!ou(t):!0},Qg=sn,au=dt,ev=kt,tv=Qg,el=function(t){return!!t&&typeof t=="object"&&au(t,"[[Object]]")&&au(t,"[[CachedBufferByteLength]]")&&(tv(t["[[CachedBufferByteLength]]"])&&t["[[CachedBufferByteLength]]"]>=0||t["[[CachedBufferByteLength]]"]==="DETACHED")&&ev(t["[[Object]]"])},rv=rt,tl=V,nv=tl("String.prototype.valueOf"),iv=function(t){try{return nv(t),!0}catch{return!1}},ov=tl("Object.prototype.toString"),av="[object String]",sv=pt(),uv=function(t){return typeof t=="string"?!0:!t||typeof t!="object"?!1:sv?iv(t):ov(t)===av},rl=V,cv=rl("Number.prototype.toString"),lv=function(t){try{return cv(t),!0}catch{return!1}},fv=rl("Object.prototype.toString"),pv="[object Number]",dv=pt(),hv=function(t){return typeof t=="number"?!0:!t||typeof t!="object"?!1:dv?lv(t):fv(t)===pv},nl=V,yv=nl("Boolean.prototype.toString"),gv=nl("Object.prototype.toString"),vv=function(t){try{return yv(t),!0}catch{return!1}},mv="[object Boolean]",bv=pt(),Tv=function(t){return typeof t=="boolean"?!0:t===null||typeof t!="object"?!1:bv?vv(t):gv(t)===mv},ho={exports:{}},su=typeof BigInt<"u"&&BigInt,Sv=function(){return typeof su=="function"&&typeof BigInt=="function"&&typeof su(42)=="bigint"&&typeof BigInt(42)=="bigint"},_v=Sv();if(_v){var Ev=BigInt.prototype.valueOf,wv=function(t){try{return Ev.call(t),!0}catch{}return!1};ho.exports=function(t){return t===null||typeof t>"u"||typeof t=="boolean"||typeof t=="string"||typeof t=="number"||typeof t=="symbol"||typeof t=="function"?!1:typeof t=="bigint"?!0:wv(t)}}else ho.exports=function(t){return!1};var Av=ho.exports,Iv=uv,$v=hv,Cv=Tv,Ov=kc(),Fv=Av,Pv=function(t){if(t==null||typeof t!="object"&&typeof t!="function")return null;if(Iv(t))return"String";if($v(t))return"Number";if(Cv(t))return"Boolean";if(Ov(t))return"Symbol";if(Fv(t))return"BigInt"},Uo=typeof Map=="function"&&Map.prototype?Map:null,Mv=typeof Set=="function"&&Set.prototype?Set:null,kr;Uo||(kr=function(t){return!1});var il=Uo?Map.prototype.has:null,uu=Mv?Set.prototype.has:null;!kr&&!il&&(kr=function(t){return!1});var Lv=kr||function(t){if(!t||typeof t!="object")return!1;try{if(il.call(t),uu)try{uu.call(t)}catch{return!0}return t instanceof Uo}catch{}return!1},Rv=typeof Map=="function"&&Map.prototype?Map:null,ko=typeof Set=="function"&&Set.prototype?Set:null,qr;ko||(qr=function(t){return!1});var cu=Rv?Map.prototype.has:null,ol=ko?Set.prototype.has:null;!qr&&!ol&&(qr=function(t){return!1});var Nv=qr||function(t){if(!t||typeof t!="object")return!1;try{if(ol.call(t),cu)try{cu.call(t)}catch{return!0}return t instanceof ko}catch{}return!1},jr=typeof WeakMap=="function"&&WeakMap.prototype?WeakMap:null,lu=typeof WeakSet=="function"&&WeakSet.prototype?WeakSet:null,Gr;jr||(Gr=function(t){return!1});var yo=jr?jr.prototype.has:null,ji=lu?lu.prototype.has:null;!Gr&&!yo&&(Gr=function(t){return!1});var xv=Gr||function(t){if(!t||typeof t!="object")return!1;try{if(yo.call(t,yo),ji)try{ji.call(t,ji)}catch{return!0}return t instanceof jr}catch{}return!1},go={exports:{}},Bv=X,al=V,Dv=Bv("%WeakSet%",!0),Gi=al("WeakSet.prototype.has",!0);if(Gi){var Vi=al("WeakMap.prototype.has",!0);go.exports=function(t){if(!t||typeof t!="object")return!1;try{if(Gi(t,Gi),Vi)try{Vi(t,Vi)}catch{return!0}return t instanceof Dv}catch{}return!1}}else go.exports=function(t){return!1};var Uv=go.exports,kv=Lv,qv=Nv,jv=xv,Gv=Uv,Vv=function(t){if(t&&typeof t=="object"){if(kv(t))return"Map";if(qv(t))return"Set";if(jv(t))return"WeakMap";if(Gv(t))return"WeakSet"}return!1},Wv={}.toString,zv=Array.isArray||function(e){return Wv.call(e)=="[object Array]"},Hv=V,Kv=Hv("WeakRef.prototype.deref",!0),Jv=typeof WeakRef>"u"?function(t){return!1}:function(t){if(!t||typeof t!="object")return!1;try{return Kv(t),!0}catch{return!1}},Yv=V,fu=Yv("FinalizationRegistry.prototype.register",!0),Zv=fu?function(t){if(!t||typeof t!="object")return!1;try{return fu(t,{},null),!0}catch{return!1}}:function(t){return!1},sl=on,Xv=dt,Qv=rc(),qo=V,ul=qo("Function.prototype.toString"),cl=qo("String.prototype.match"),Wi=qo("Object.prototype.toString"),em=/^class /,tm=function(t){if(sl(t)||typeof t!="function")return!1;try{var r=cl(ul(t),em);return!!r}catch{}return!1},rm=/\s*function\s+([^(\s]*)\s*/,nm=!(0 in[,]),im="[object Object]",om="[object HTMLAllCollection]",am=Function.prototype,ll=function(){return!1};if(typeof document=="object"){var sm=document.all;Wi(sm)===Wi(document.all)&&(ll=function(t){if((nm||!t)&&(typeof t>"u"||typeof t=="object"))try{var r=Wi(t);return(r===om||r===im)&&t("")==null}catch{}return!1})}var fl=function(){if(ll(this)||!tm(this)&&!sl(this))throw new TypeError("Function.prototype.name sham getter called on non-function");if(Qv&&Xv(this,"name"))return this.name;if(this===am)return"";var t=ul(this),r=cl(t,rm),n=r&&r[1];return n},um=fl,pl=function(){return um},cm=tr.supportsDescriptors,lm=rc(),fm=pl,pu=Object.defineProperty,pm=TypeError,dm=function(){var t=fm();if(lm)return t;if(!cm)throw new pm("Shimming Function.prototype.name support requires ES5 property descriptor support.");var r=Function.prototype;return pu(r,"name",{configurable:!0,enumerable:!1,get:function(){var n=t.call(this);return this!==r&&pu(this,"name",{configurable:!0,enumerable:!1,value:n,writable:!1}),n}}),t},hm=tr,ym=Qe,dl=fl,gm=pl,vm=dm,hl=ym(dl);hm(hl,{getPolyfill:gm,implementation:dl,shim:vm});var mm=hl,zi,du;function bm(){if(du)return zi;du=1;const e=(function*(){}).constructor;return zi=()=>e,zi}var yl=V,Tm=un(),Sm=Tm(/^\s*(?:function)?\*/),_m=pt(),hu=Ot,Em=yl("Object.prototype.toString"),wm=yl("Function.prototype.toString"),Am=bm(),Im=function(t){if(typeof t!="function")return!1;if(Sm(wm(t)))return!0;if(!_m){var r=Em(t);return r==="[object GeneratorFunction]"}if(!hu)return!1;var n=Am();return n&&hu(t)===n.prototype},Hi,yu;function $m(){if(yu)return Hi;yu=1;const e=(async function(){}).constructor;return Hi=()=>e,Hi}var gl=V,Cm=un(),Om=gl("Object.prototype.toString"),Fm=gl("Function.prototype.toString"),Pm=Cm(/^\s*async(?:\s+function(?:\s+|\()|\s*\()/),Mm=pt(),gu=Ot,Lm=$m(),Rm=function(t){if(typeof t!="function")return!1;if(Pm(Fm(t)))return!0;if(!Mm){var r=Om(t);return r==="[object AsyncFunction]"}if(!gu)return!1;var n=Lm();return n&&n.prototype===gu(t)},Nm=Pv,xm=Vv,Bm=xt,Dm=zv,Um=Xu,km=Zu,qm=Jv,jm=Zv,Gm=mm,Vm=Im,Wm=Rm,zm=V,Hm=pt(),Ki=Hm&&Symbol.toStringTag,Km=Object,vu=zm("Promise.prototype.then",!0),Jm=function(t){if(!t||typeof t!="object"||!vu)return!1;try{return vu(t,null,function(){}),!0}catch{}return!1},mu=function(t){return!!t&&t!=="BigInt"&&t!=="Boolean"&&t!=="Null"&&t!=="Number"&&t!=="String"&&t!=="Symbol"&&t!=="Undefined"&&t!=="Math"&&t!=="JSON"&&t!=="Reflect"&&t!=="Atomics"&&t!=="Map"&&t!=="Set"&&t!=="WeakMap"&&t!=="WeakSet"&&t!=="BigInt64Array"&&t!=="BigUint64Array"&&t!=="Float32Array"&&t!=="Float64Array"&&t!=="Int16Array"&&t!=="Int32Array"&&t!=="Int8Array"&&t!=="Uint16Array"&&t!=="Uint32Array"&&t!=="Uint8Array"&&t!=="Uint8ClampedArray"&&t!=="Array"&&t!=="Date"&&t!=="FinalizationRegistry"&&t!=="Promise"&&t!=="RegExp"&&t!=="WeakRef"&&t!=="Function"&&t!=="GeneratorFunction"&&t!=="AsyncFunction"},Ym=function(t){if(t==null)return t;var r=Nm(Km(t))||xm(t)||Bm(t);if(r)return r;if(Dm(t))return"Array";if(Um(t))return"Date";if(km(t))return"RegExp";if(qm(t))return"WeakRef";if(jm(t))return"FinalizationRegistry";if(typeof t=="function")return Vm(t)?"GeneratorFunction":Wm(t)?"AsyncFunction":"Function";if(Jm(t))return"Promise";if(Ki&&Ki in t){var n=t[Ki];if(mu(n))return n}if(typeof t.constructor=="function"){var i=Gm(t.constructor);if(mu(i))return i}return"Object"},Zm=X,Xm=Yc,Qm=rv,eb=Ym,tb=U,bu=Ot,rb=gp,nb=function(t){if(!Qm(t))throw new tb("Reflect.getPrototypeOf called on non-object");if(bu)return bu(t);var r=eb(t);if(r){var n=Zm("%"+r+".prototype%",!0);if(n)return n}return Xm(t.constructor)?t.constructor.prototype:t instanceof Object?rb.prototype:null},ib=nb,Tu=Ot,vl=function(){return typeof Reflect=="object"&&Reflect&&Reflect.getPrototypeOf?Reflect.getPrototypeOf:Tu?function(r){return Tu(r)}:ib},ml=Oo,ob=Qe,ab=vl(),sb=nr(),vo={__proto__:null},Tr=Jr,Su=Object.defineProperty;if(Tr){var ub=function(e){return e.byteOffset};ml(sb,function(e){if(typeof window[e]=="function"||typeof window[e]=="object"){var t=window[e].prototype,r=Tr(t,"byteOffset");if(!r){var n=ab(t);r=Tr(n,"byteOffset")}if(r&&r.get)vo[e]=ob(r.get);else if(Su){var i=new window[e](2);r=Tr(i,"byteOffset"),r&&r.configurable&&Su(i,"length",{value:3}),i.length===2&&(vo[e]=ub)}}})}var cb=function(t){var r;return ml(vo,function(n){if(typeof r!="number")try{var i=n(t);typeof i=="number"&&(r=i)}catch{}}),r},lb=kt,jo=function(t){return lb(t)?cb(t):!1},fb=Qe,bl=Oo,Sr=Jr,pb=kt,db=Ec,hb=vl(),mo={__proto__:null},_u=Object.defineProperty;if(Sr){var yb=function(e){return e.length};bl(db,function(e){var t=window[e];if(typeof t=="function"||typeof t=="object"){var r=t.prototype,n=Sr(r,"length");if(!n){var i=hb(r);n=Sr(i,"length")}if(n&&n.get)mo["$"+e]=fb(n.get);else if(_u){var o=new window[e](2);n=Sr(o,"length"),n&&n.configurable&&_u(o,"length",{value:3}),o.length===2&&(mo["$"+e]=yb)}}})}var gb=function(t){var r;return bl(mo,function(n){if(typeof r!="number")try{var i=n(t);typeof i=="number"&&(r=i)}catch{}}),r},Tl=function(t){return pb(t)?gb(t):!1},Eu=U,vb=Dt,mb=Qc,bb=Bo,Tb=el,wu=or,Sb=jo,_b=Tl,Go=function(t){if(!Tb(t))throw new Eu("Assertion failed: `taRecord` must be a TypedArray With Buffer Witness Record");var r=t["[[Object]]"],n=t["[[CachedBufferByteLength]]"];if(vb(wu(r))&&n!=="DETACHED")throw new Eu("Assertion failed: typed array is detached only if the byte length is ~DETACHED~");if(n==="DETACHED")return!0;var i=Sb(r),o=mb(wu(r)),a,c=o?_b(r):"AUTO";if(c==="AUTO")a=n;else{var u=bb(r);a=i+c*u}return i>n||a>n},_r=U,Eb=xo,wb=Qc,Ab=Go,Ib=Bo,$b=el,Cb=or,Ob=jo,Fb=Tl,Pb=function(t){if(!$b(t))throw new _r("Assertion failed: `taRecord` must be a TypedArray With Buffer Witness Record");if(Ab(t))throw new _r("Assertion failed: `taRecord` is out of bounds");var r=t["[[Object]]"],n=wb(Cb(r)),i=n?Fb(r):"AUTO";if(i!=="AUTO")return i;if(n)throw new _r("Assertion failed: array buffer is not fixed length");var o=Ob(r),a=Ib(r),c=t["[[CachedBufferByteLength]]"];if(c==="DETACHED")throw new _r("Assertion failed: typed array is detached");return Eb((c-o)/a)},Ji=U,Mb=Dt,Lb=Bt,Rb=ir,Nb=Lc,xb=V,Bb=xb("SharedArrayBuffer.prototype.byteLength",!0),Db=function(t,r){var n=Rb(t);if(!Lb(t)&&!n)throw new Ji("Assertion failed: `arrayBuffer` must be an ArrayBuffer or a SharedArrayBuffer");if(r!=="SEQ-CST"&&r!=="UNORDERED")throw new Ji("Assertion failed: `order` must be ~SEQ-CST~ or ~UNORDERED~");if(Mb(t))throw new Ji("Assertion failed: `arrayBuffer` must not be detached");return n?Bb(t):Nb(t)},Au=U,Ub=Db,kb=Dt,qb=kt,jb=or,Gb=function(t,r){if(!qb(t))throw new Au("Assertion failed: `obj` must be a Typed Array");if(r!=="SEQ-CST"&&r!=="UNORDERED")throw new Au("Assertion failed: `order` must be ~SEQ-CST~ or ~UNORDERED~");var n=jb(t),i=kb(n)?"DETACHED":Ub(n,r);return{"[[Object]]":t,"[[CachedBufferByteLength]]":i}},Er=U,Vb=rt,Wb=Go,zb=Gb,Hb=kt,Sl=function(t,r){if(r!=="SEQ-CST"&&r!=="UNORDERED")throw new Er("Assertion failed: `order` must be ~SEQ-CST~ or ~UNORDERED~");if(!Vb(t))throw new Er("Assertion failed: `O` must be an Object");if(!Hb(t))throw new Er("Assertion failed: `O` must be a Typed Array");var n=zb(t,r);if(Wb(n))throw new Er("`O` must be in-bounds and backed by a non-detached buffer");return n},Kb=Ve,wr=U,Jb=No,Yb=Zc,Zb=Go,Xb=Pb,Qb=Sl,e0=nr(),t0=function(t,r){if(!Yb(t))throw new wr("Assertion failed: `constructor` must be a constructor");if(!Jb(r))throw new wr("Assertion failed: `argumentList` must be a List");if(e0.length===0)throw new Kb("Assertion failed: Typed Arrays are not supported in this environment");var n;r.length===0?n=new t:r.length===1?n=new t(r[0]):r.length===2?n=new t(r[0],r[1]):n=new t(r[0],r[1],r[2]);var i=Qb(n,"SEQ-CST");if(r.length===1&&typeof r[0]=="number"){if(Zb(i))throw new wr("new Typed Array is out of bounds");var o=Xb(i);if(o<r[0])throw new wr("`argumentList[0]` must be <= `newTypedArray.length`")}return n},Ee=X,r0={__proto__:null,$Int8Array:Ee("%Int8Array%",!0),$Uint8Array:Ee("%Uint8Array%",!0),$Uint8ClampedArray:Ee("%Uint8ClampedArray%",!0),$Int16Array:Ee("%Int16Array%",!0),$Uint16Array:Ee("%Uint16Array%",!0),$Int32Array:Ee("%Int32Array%",!0),$Uint32Array:Ee("%Uint32Array%",!0),$BigInt64Array:Ee("%BigInt64Array%",!0),$BigUint64Array:Ee("%BigUint64Array%",!0),$Float16Array:Ee("%Float16Array%",!0),$Float32Array:Ee("%Float32Array%",!0),$Float64Array:Ee("%Float64Array%",!0)},n0=function(t){return r0["$"+t]},Iu=Ve,$u=U,i0=xt,o0=nr(),a0=No,s0=Jg,u0=t0,c0=n0,l0=function(t,r){if(o0.length===0)throw new Iu("Assertion failed: Typed Arrays are not supported in this environment");var n=i0(t);if(!n)throw new $u("Assertion failed: exemplar must be a TypedArray");if(!a0(r))throw new $u("Assertion failed: `argumentList` must be a List");var i=c0(n);if(typeof i!="function")throw new Iu("Assertion failed: `constructor` of `exemplar` ("+n+") must exist. Please report this!");var o=s0(t,i);return u0(o,r)},f0=U,p0=Rh,d0=Ay,h0=Dt,Yi=tc,Cu=ec,y0=Cy,g0=Eg,Ou=Cg,Fu=zc,v0=Bo,Pu=Bg,m0=l0,b0=Sl,Zi=or,Mu=jo,_l=function(t,r){var n=this;b0(n,"SEQ-CST");var i=n.length,o=Ou(t),a;o===-1/0?a=0:o<0?a=Yi(i+o,0):a=Cu(o,i);var c=typeof r>"u"?i:Ou(r),u;c===-1/0?u=0:c<0?u=Yi(i+c,0):u=Cu(c,i);var y=Yi(u-a,0),h=m0(n,[y]);if(y>0){if(h0(Zi(n)))throw new f0("Cannot use a Typed Array with an underlying ArrayBuffer that is detached");var b=Pu(n),l=Pu(h);if(b===l)for(var p=Zi(n),_=Zi(h),w=v0(n),A=Mu(n),R=a*w+A,O=Mu(h),m=O+y*w;O<m;){var I=d0(p,R,"UINT8",!0,"UNORDERED");g0(_,O,"UINT8",I,!0,"UNORDERED"),R+=1,O+=1}else for(var $=0;a<u;){var P=Fu(a),C=p0(n,P);y0(h,Fu($),C,!0),a+=1,$+=1}}return h},T0=_l,El=function(){return typeof Uint8Array=="function"&&Uint8Array.prototype.slice||T0},S0=tr,_0=Ot,E0=El,w0=function(){if(typeof Uint8Array=="function"){var t=E0(),r=_0(Uint8Array.prototype);S0(r,{slice:t},{slice:function(){return r.slice!==t}})}return t},A0=tr,I0=Qe,$0=_l,wl=El,C0=w0,Al=I0(wl());A0(Al,{getPolyfill:wl,implementation:$0,shim:C0});var O0=Al,Il=xt,$l=O0,Lu=Jr;function jt(e){return Object.prototype.toString.call(e)}function F0(e){return jt(e)==="[object Date]"}function P0(e){return jt(e)==="[object RegExp]"}function M0(e){return jt(e)==="[object Error]"}function L0(e){return jt(e)==="[object Boolean]"}function R0(e){return jt(e)==="[object Number]"}function N0(e){return jt(e)==="[object String]"}var Cl=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};function cn(e,t){if(e.forEach)return e.forEach(t);for(var r=0;r<e.length;r++)t(e[r],r,e)}var ln=Object.keys||function(t){var r=[];for(var n in t)r[r.length]=n;return r},x0=Object.prototype.propertyIsEnumerable,Ru=Object.getOwnPropertySymbols;function fn(e){var t=ln(e);if(Ru)for(var r=Ru(e),n=0;n<r.length;n++)x0.call(e,r[n])&&(t[t.length]=r[n]);return t}var pn=Object.prototype.hasOwnProperty||function(e,t){return t in e};function B0(e,t){if(typeof Lu!="function")return!0;var r=Lu(e,t);return!r||!r.writable}function Ol(e,t){if(typeof e=="object"&&e!==null){var r;if(Cl(e))r=[];else if(F0(e))r=new Date(e.getTime?e.getTime():e);else if(P0(e))r=new RegExp(e);else if(M0(e))r={message:e.message};else if(L0(e)||R0(e)||N0(e))r=Object(e);else{var n=Il(e);if(n)return $l(e);if(Object.create&&Object.getPrototypeOf)r=Object.create(Object.getPrototypeOf(e));else if(e.constructor===Object)r={};else{var i=e.constructor&&e.constructor.prototype||e.__proto__||{},o=function(){};o.prototype=i,r=new o}}var a=t.includeSymbols?fn:ln;return cn(a(e),function(c){r[c]=e[c]}),r}return e}var Vo={__proto__:null};function Fl(e,t){var r=[],n=[],i=!0,o=arguments.length>2?arguments[2]:Vo,a=o.includeSymbols?fn:ln,c=!!o.immutable;return function u(y){var h=c?Ol(y,o):y,b={__proto__:null},l=!0,p={node:h,node_:y,path:[].concat(r),parent:n[n.length-1],parents:n,key:r[r.length-1],removedKeys:{__proto__:null},isRoot:r.length===0,level:r.length,circular:null,update:function(A,R){p.isRoot||(p.parent.node[p.key]=A),p.node=A,R&&(l=!1)},delete:function(A){delete p.parent.node[p.key],p.parent.removedKeys[p.key]=!0,A&&(l=!1)},remove:function(A){Cl(p.parent.node)?(p.parent.node.splice(p.key,1),p.parent.removedKeys[p.key]=!0,A&&(l=!1)):p.delete(A)},keys:null,before:function(A){b.before=A},after:function(A){b.after=A},pre:function(A){b.pre=A},post:function(A){b.post=A},stop:function(){i=!1},block:function(){l=!1}};if(!i)return p;function _(){if(typeof p.node=="object"&&p.node!==null){(!p.keys||p.node_!==p.node)&&(p.keys=a(p.node)),p.isLeaf=p.keys.length===0;for(var A=0;A<n.length;A++)if(n[A].node_===y){p.circular=n[A];break}}else p.isLeaf=!0,p.keys=null;p.notLeaf=!p.isLeaf,p.notRoot=!p.isRoot}_();var w=t.call(p,p.node);return w!==void 0&&p.update&&p.update(w),b.before&&b.before.call(p,p.node),l&&(typeof p.node=="object"&&p.node!==null&&!p.circular&&(n[n.length]=p,_(),cn(p.keys,function(A,R){var O=R-1 in p.removedKeys;O&&(A=p.keys[R-1]),r[r.length]=A,b.pre&&b.pre.call(p,p.node[A],A);var m=u(p.node[A]);c&&pn.call(p.node,A)&&!B0(p.node,A)&&!O&&(p.node[A]=m.node),m.isLast=R===p.keys.length-1,m.isFirst=R===0,b.post&&b.post.call(p,m),r.pop()}),n.pop()),b.after&&b.after.call(p,p.node)),p}(e).node}function we(e){this.options=arguments.length>1?arguments[1]:Vo,this.value=e}we.prototype.get=function(e){for(var t=this.value,r=0;t&&r<e.length;r++){var n=e[r];if(!pn.call(t,n)||!this.options.includeSymbols&&typeof n=="symbol")return;t=t[n]}return t};we.prototype.has=function(e){var t=this.value;if(!t&&e.length>0)return!1;for(var r=0;t&&r<e.length;r++){var n=e[r];if(!pn.call(t,n)||!this.options.includeSymbols&&typeof n=="symbol")return!1;t=t[n]}return!0};we.prototype.set=function(e,t){for(var r=this.value,n=0;n<e.length-1;n++){var i=e[n];pn.call(r,i)||(r[i]={}),r=r[i]}return r[e[n]]=t,t};we.prototype.map=function(e){return Fl(this.value,e,{__proto__:null,immutable:!0,includeSymbols:!!this.options.includeSymbols})};we.prototype.forEach=function(e){return this.value=Fl(this.value,e,this.options),this.value};we.prototype.reduce=function(e,t){var r=arguments.length===1,n=r?this.value:t;return this.forEach(function(i){(!this.isRoot||!r)&&(n=e.call(this,n,i))}),n};we.prototype.paths=function(){var e=[];return this.forEach(function(){e[e.length]=this.path}),e};we.prototype.nodes=function(){var e=[];return this.forEach(function(){e[e.length]=this.node}),e};we.prototype.clone=function(){var e=[],t=[],r=this.options;return Il(this.value)?$l(this.value):function n(i){for(var o=0;o<e.length;o++)if(e[o]===i)return t[o];if(typeof i=="object"&&i!==null){var a=Ol(i,r);e[e.length]=i,t[t.length]=a;var c=r.includeSymbols?fn:ln;return cn(c(i),function(u){a[u]=n(i[u])}),e.pop(),t.pop(),a}return i}(this.value)};function Pl(e){var t=arguments.length>1?arguments[1]:Vo;return new we(e,t)}cn(fn(we.prototype),function(e){Pl[e]=function(t){var r=[].slice.call(arguments,1),n=new we(t);return n[e].apply(n,r)}});var D0=Pl,U0=ye;function ye(e){if(!(this instanceof ye))return new ye(e);this._bbox=e||[1/0,1/0,-1/0,-1/0],this._valid=!!e}ye.prototype.include=function(e){return this._valid=!0,this._bbox[0]=Math.min(this._bbox[0],e[0]),this._bbox[1]=Math.min(this._bbox[1],e[1]),this._bbox[2]=Math.max(this._bbox[2],e[0]),this._bbox[3]=Math.max(this._bbox[3],e[1]),this};ye.prototype.equals=function(e){var t;return e instanceof ye?t=e.bbox():t=e,this._bbox[0]==t[0]&&this._bbox[1]==t[1]&&this._bbox[2]==t[2]&&this._bbox[3]==t[3]};ye.prototype.center=function(e){return this._valid?[(this._bbox[0]+this._bbox[2])/2,(this._bbox[1]+this._bbox[3])/2]:null};ye.prototype.union=function(e){this._valid=!0;var t;return e instanceof ye?t=e.bbox():t=e,this._bbox[0]=Math.min(this._bbox[0],t[0]),this._bbox[1]=Math.min(this._bbox[1],t[1]),this._bbox[2]=Math.max(this._bbox[2],t[2]),this._bbox[3]=Math.max(this._bbox[3],t[3]),this};ye.prototype.bbox=function(){return this._valid?this._bbox:null};ye.prototype.contains=function(e){if(!e)return this._fastContains();if(!this._valid)return null;var t=e[0],r=e[1];return this._bbox[0]<=t&&this._bbox[1]<=r&&this._bbox[2]>=t&&this._bbox[3]>=r};ye.prototype.intersect=function(e){if(!this._valid)return null;var t;return e instanceof ye?t=e.bbox():t=e,!(this._bbox[0]>t[2]||this._bbox[2]<t[0]||this._bbox[3]<t[1]||this._bbox[1]>t[3])};ye.prototype._fastContains=function(){if(!this._valid)return new Function("return null;");var e="return "+this._bbox[0]+"<= ll[0] &&"+this._bbox[1]+"<= ll[1] &&"+this._bbox[2]+">= ll[0] &&"+this._bbox[3]+">= ll[1]";return new Function("ll",e)};ye.prototype.polygon=function(){return this._valid?{type:"Polygon",coordinates:[[[this._bbox[0],this._bbox[1]],[this._bbox[2],this._bbox[1]],[this._bbox[2],this._bbox[3]],[this._bbox[0],this._bbox[3]],[this._bbox[0],this._bbox[1]]]]}:null};var k0=Pd,q0=D0,j0=U0,Ml={features:["FeatureCollection"],coordinates:["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],geometry:["Feature"],geometries:["GeometryCollection"]},G0=Object.keys(Ml);nn.exports=function(e){return Wo(e).bbox()};nn.exports.polygon=function(e){return Wo(e).polygon()};nn.exports.bboxify=function(e){return q0(e).map(function(t){if(t){var r=G0.some(function(n){return t[n]?Ml[n].indexOf(t.type)!==-1:!1});r&&(t.bbox=Wo(t).bbox(),this.update(t))}})};function Wo(e){for(var t=j0(),r=k0(e),n=0;n<r.length;n++)t.include(r[n]);return t}var V0=nn.exports;const W0=V0,z0=G,{LAT_MIN:Ar,LAT_MAX:Ir,LAT_RENDERED_MIN:Nu,LAT_RENDERED_MAX:xu,LNG_MIN:Bu,LNG_MAX:Du}=z0;var zo=function(e,t){let r=Ar,n=Ir,i=Ar,o=Ir,a=Du,c=Bu;e.forEach(y=>{const h=W0(y),b=h[1],l=h[3],p=h[0],_=h[2];b>r&&(r=b),l<n&&(n=l),l>i&&(i=l),b<o&&(o=b),p<a&&(a=p),_>c&&(c=_)});const u=t;return r+u.lat>xu&&(u.lat=xu-r),i+u.lat>Ir&&(u.lat=Ir-i),n+u.lat<Nu&&(u.lat=Nu-n),o+u.lat<Ar&&(u.lat=Ar-o),a+u.lng<=Bu&&(u.lng+=Math.ceil(Math.abs(u.lng)/360)*360),c+u.lng>=Du&&(u.lng-=Math.ceil(Math.abs(u.lng)/360)*360),u};const H0=zo,wt=G;var dn=function(e,t){const r=H0(e.map(n=>n.toGeoJSON()),t);e.forEach(n=>{const i=n.getCoordinates(),o=y=>{const h={lng:y[0]+r.lng,lat:y[1]+r.lat};return[h.lng,h.lat]},a=y=>y.map(h=>o(h)),c=y=>y.map(h=>a(h));let u;n.type===wt.geojsonTypes.POINT?u=o(i):n.type===wt.geojsonTypes.LINE_STRING||n.type===wt.geojsonTypes.MULTI_POINT?u=i.map(o):n.type===wt.geojsonTypes.POLYGON||n.type===wt.geojsonTypes.MULTI_LINE_STRING?u=i.map(a):n.type===wt.geojsonTypes.MULTI_POLYGON&&(u=i.map(c)),n.incomingCoords(u)})};const ft=Rt,Ho=Ed,K0=rn,J0=Yr,Vr=Nt,Y0=dn,ne=G,z={};z.onSetup=function(e){const t={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoveing:!1,canDragMove:!1,initiallySelectedFeatureIds:e.featureIds||[]};return this.setSelected(t.initiallySelectedFeatureIds.filter(r=>this.getFeature(r)!==void 0)),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),t};z.fireUpdate=function(){this.map.fire(ne.events.UPDATE,{action:ne.updateActions.MOVE,features:this.getSelected().map(e=>e.toGeoJSON())})};z.fireActionable=function(){const e=this.getSelected(),t=e.filter(o=>this.isInstanceOf("MultiFeature",o));let r=!1;if(e.length>1){r=!0;const o=e[0].type.replace("Multi","");e.forEach(a=>{a.type.replace("Multi","")!==o&&(r=!1)})}const n=t.length>0,i=e.length>0;this.setActionableState({combineFeatures:r,uncombineFeatures:n,trash:i})};z.getUniqueIds=function(e){return e.length?e.map(r=>r.properties.id).filter(r=>r!==void 0).reduce((r,n)=>(r.add(n),r),new J0).values():[]};z.stopExtendedInteractions=function(e){e.boxSelectElement&&(e.boxSelectElement.parentNode&&e.boxSelectElement.parentNode.removeChild(e.boxSelectElement),e.boxSelectElement=null),this.map.dragPan.enable(),e.boxSelecting=!1,e.canBoxSelect=!1,e.dragMoving=!1,e.canDragMove=!1};z.onStop=function(){Vr.enable(this)};z.onMouseMove=function(e){return this.stopExtendedInteractions(e)};z.onMouseOut=function(e){if(e.dragMoving)return this.fireUpdate()};z.onTap=z.onClick=function(e,t){if(ft.noTarget(t))return this.clickAnywhere(e,t);if(ft.isOfMetaType(ne.meta.VERTEX)(t))return this.clickOnVertex(e,t);if(ft.isFeature(t))return this.clickOnFeature(e,t)};z.clickAnywhere=function(e){const t=this.getSelectedIds();t.length&&(this.clearSelectedFeatures(),t.forEach(r=>this.doRender(r))),Vr.enable(this),this.stopExtendedInteractions(e)};z.clickOnVertex=function(e,t){this.changeMode(ne.modes.DIRECT_SELECT,{featureId:t.featureTarget.properties.parent,coordPath:t.featureTarget.properties.coord_path,startPos:t.lngLat}),this.updateUIClasses({mouse:ne.cursors.MOVE})};z.startOnActiveFeature=function(e,t){this.stopExtendedInteractions(e),this.map.dragPan.disable(),this.doRender(t.featureTarget.properties.id),e.canDragMove=!0,e.dragMoveLocation=t.lngLat};z.clickOnFeature=function(e,t){Vr.disable(this),this.stopExtendedInteractions(e);const r=ft.isShiftDown(t),n=this.getSelectedIds(),i=t.featureTarget.properties.id,o=this.isSelected(i);if(!r&&o&&this.getFeature(i).type!==ne.geojsonTypes.POINT)return this.changeMode(ne.modes.DIRECT_SELECT,{featureId:i});o&&r?(this.deselect(i),this.updateUIClasses({mouse:ne.cursors.POINTER}),n.length===1&&Vr.enable(this)):!o&&r?(this.select(i),this.updateUIClasses({mouse:ne.cursors.MOVE})):!o&&!r&&(n.forEach(a=>this.doRender(a)),this.setSelected(i),this.updateUIClasses({mouse:ne.cursors.MOVE})),this.doRender(i)};z.onMouseDown=function(e,t){if(ft.isActiveFeature(t))return this.startOnActiveFeature(e,t);if(this.drawConfig.boxSelect&&ft.isShiftMousedown(t))return this.startBoxSelect(e,t)};z.startBoxSelect=function(e,t){this.stopExtendedInteractions(e),this.map.dragPan.disable(),e.boxSelectStartLocation=Ho(t.originalEvent,this.map.getContainer()),e.canBoxSelect=!0};z.onTouchStart=function(e,t){if(ft.isActiveFeature(t))return this.startOnActiveFeature(e,t)};z.onDrag=function(e,t){if(e.canDragMove)return this.dragMove(e,t);if(this.drawConfig.boxSelect&&e.canBoxSelect)return this.whileBoxSelect(e,t)};z.whileBoxSelect=function(e,t){e.boxSelecting=!0,this.updateUIClasses({mouse:ne.cursors.ADD}),e.boxSelectElement||(e.boxSelectElement=document.createElement("div"),e.boxSelectElement.classList.add(ne.classes.BOX_SELECT),this.map.getContainer().appendChild(e.boxSelectElement));const r=Ho(t.originalEvent,this.map.getContainer()),n=Math.min(e.boxSelectStartLocation.x,r.x),i=Math.max(e.boxSelectStartLocation.x,r.x),o=Math.min(e.boxSelectStartLocation.y,r.y),a=Math.max(e.boxSelectStartLocation.y,r.y),c=`translate(${n}px, ${o}px)`;e.boxSelectElement.style.transform=c,e.boxSelectElement.style.WebkitTransform=c,e.boxSelectElement.style.width=`${i-n}px`,e.boxSelectElement.style.height=`${a-o}px`};z.dragMove=function(e,t){e.dragMoving=!0,t.originalEvent.stopPropagation();const r={lng:t.lngLat.lng-e.dragMoveLocation.lng,lat:t.lngLat.lat-e.dragMoveLocation.lat};Y0(this.getSelected(),r),e.dragMoveLocation=t.lngLat};z.onMouseUp=function(e,t){if(e.dragMoving)this.fireUpdate();else if(e.boxSelecting){const r=[e.boxSelectStartLocation,Ho(t.originalEvent,this.map.getContainer())],n=this.featuresAt(null,r,"click"),i=this.getUniqueIds(n).filter(o=>!this.isSelected(o));i.length&&(this.select(i),i.forEach(o=>this.doRender(o)),this.updateUIClasses({mouse:ne.cursors.MOVE}))}this.stopExtendedInteractions(e)};z.toDisplayFeatures=function(e,t,r){t.properties.active=this.isSelected(t.properties.id)?ne.activeStates.ACTIVE:ne.activeStates.INACTIVE,r(t),this.fireActionable(),!(t.properties.active!==ne.activeStates.ACTIVE||t.geometry.type===ne.geojsonTypes.POINT)&&K0(t).forEach(r)};z.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()};z.onCombineFeatures=function(){const e=this.getSelected();if(e.length===0||e.length<2)return;const t=[],r=[],n=e[0].type.replace("Multi","");for(let i=0;i<e.length;i++){const o=e[i];if(o.type.replace("Multi","")!==n)return;o.type.includes("Multi")?o.getCoordinates().forEach(a=>{t.push(a)}):t.push(o.getCoordinates()),r.push(o.toGeoJSON())}if(r.length>1){const i=this.newFeature({type:ne.geojsonTypes.FEATURE,properties:r[0].properties,geometry:{type:`Multi${n}`,coordinates:t}});this.addFeature(i),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([i.id]),this.map.fire(ne.events.COMBINE_FEATURES,{createdFeatures:[i.toGeoJSON()],deletedFeatures:r})}this.fireActionable()};z.onUncombineFeatures=function(){const e=this.getSelected();if(e.length===0)return;const t=[],r=[];for(let n=0;n<e.length;n++){const i=e[n];this.isInstanceOf("MultiFeature",i)&&(i.getFeatures().forEach(o=>{this.addFeature(o),o.properties=i.properties,t.push(o.toGeoJSON()),this.select([o.id])}),this.deleteFeature(i.id,{silent:!0}),r.push(i.toGeoJSON()))}t.length>1&&this.map.fire(ne.events.UNCOMBINE_FEATURES,{createdFeatures:t,deletedFeatures:r}),this.fireActionable()};var Z0=z;const{noTarget:Ll,isOfMetaType:Rl,isInactiveFeature:Nl,isShiftDown:Uu}=Rt,X0=rn,Q0=zo,xl=Nt,he=G,hn=Rt,eT=dn,Bl=Rl(he.meta.VERTEX),tT=Rl(he.meta.MIDPOINT),W={};W.fireUpdate=function(){this.map.fire(he.events.UPDATE,{action:he.updateActions.CHANGE_COORDINATES,features:this.getSelected().map(e=>e.toGeoJSON())})};W.fireActionable=function(e){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:e.selectedCoordPaths.length>0})};W.startDragging=function(e,t){this.map.dragPan.disable(),e.canDragMove=!0,e.dragMoveLocation=t.lngLat};W.stopDragging=function(e){this.map.dragPan.enable(),e.dragMoving=!1,e.canDragMove=!1,e.dragMoveLocation=null};W.onVertex=function(e,t){this.startDragging(e,t);const r=t.featureTarget.properties,n=e.selectedCoordPaths.indexOf(r.coord_path);!Uu(t)&&n===-1?e.selectedCoordPaths=[r.coord_path]:Uu(t)&&n===-1&&e.selectedCoordPaths.push(r.coord_path);const i=this.pathsToCoordinates(e.featureId,e.selectedCoordPaths);this.setSelectedCoordinates(i)};W.onMidpoint=function(e,t){this.startDragging(e,t);const r=t.featureTarget.properties;e.feature.addCoordinate(r.coord_path,r.lng,r.lat),this.fireUpdate(),e.selectedCoordPaths=[r.coord_path]};W.pathsToCoordinates=function(e,t){return t.map(r=>({feature_id:e,coord_path:r}))};W.onFeature=function(e,t){e.selectedCoordPaths.length===0?this.startDragging(e,t):this.stopDragging(e)};W.dragFeature=function(e,t,r){eT(this.getSelected(),r),e.dragMoveLocation=t.lngLat};W.dragVertex=function(e,t,r){const n=e.selectedCoordPaths.map(a=>e.feature.getCoordinate(a)),i=n.map(a=>({type:he.geojsonTypes.FEATURE,properties:{},geometry:{type:he.geojsonTypes.POINT,coordinates:a}})),o=Q0(i,r);for(let a=0;a<n.length;a++){const c=n[a];e.feature.updateCoordinate(e.selectedCoordPaths[a],c[0]+o.lng,c[1]+o.lat)}};W.clickNoTarget=function(){this.changeMode(he.modes.SIMPLE_SELECT)};W.clickInactive=function(){this.changeMode(he.modes.SIMPLE_SELECT)};W.clickActiveFeature=function(e){e.selectedCoordPaths=[],this.clearSelectedCoordinates(),e.feature.changed()};W.onSetup=function(e){const t=e.featureId,r=this.getFeature(t);if(!r)throw new Error("You must provide a featureId to enter direct_select mode");if(r.type===he.geojsonTypes.POINT)throw new TypeError("direct_select mode doesn't handle point features");const n={featureId:t,feature:r,dragMoveLocation:e.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:e.coordPath?[e.coordPath]:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(t,n.selectedCoordPaths)),this.setSelected(t),xl.disable(this),this.setActionableState({trash:!0}),n};W.onStop=function(){xl.enable(this),this.clearSelectedCoordinates()};W.toDisplayFeatures=function(e,t,r){e.featureId===t.properties.id?(t.properties.active=he.activeStates.ACTIVE,r(t),X0(t,{map:this.map,midpoints:!0,selectedPaths:e.selectedCoordPaths}).forEach(r)):(t.properties.active=he.activeStates.INACTIVE,r(t)),this.fireActionable(e)};W.onTrash=function(e){e.selectedCoordPaths.sort().reverse().forEach(t=>e.feature.removeCoordinate(t)),this.fireUpdate(),e.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(e),e.feature.isValid()===!1&&(this.deleteFeature([e.featureId]),this.changeMode(he.modes.SIMPLE_SELECT,{}))};W.onMouseMove=function(e,t){const r=hn.isActiveFeature(t),n=Bl(t),i=e.selectedCoordPaths.length===0;r&&i?this.updateUIClasses({mouse:he.cursors.MOVE}):n&&!i?this.updateUIClasses({mouse:he.cursors.MOVE}):this.updateUIClasses({mouse:he.cursors.NONE}),this.stopDragging(e)};W.onMouseOut=function(e){e.dragMoving&&this.fireUpdate()};W.onTouchStart=W.onMouseDown=function(e,t){if(Bl(t))return this.onVertex(e,t);if(hn.isActiveFeature(t))return this.onFeature(e,t);if(tT(t))return this.onMidpoint(e,t)};W.onDrag=function(e,t){if(e.canDragMove!==!0)return;e.dragMoving=!0,t.originalEvent.stopPropagation();const r={lng:t.lngLat.lng-e.dragMoveLocation.lng,lat:t.lngLat.lat-e.dragMoveLocation.lat};e.selectedCoordPaths.length>0?this.dragVertex(e,t,r):this.dragFeature(e,t,r),e.dragMoveLocation=t.lngLat};W.onClick=function(e,t){if(Ll(t))return this.clickNoTarget(e,t);if(hn.isActiveFeature(t))return this.clickActiveFeature(e,t);if(Nl(t))return this.clickInactive(e,t);this.stopDragging(e)};W.onTap=function(e,t){if(Ll(t))return this.clickNoTarget(e,t);if(hn.isActiveFeature(t))return this.clickActiveFeature(e,t);if(Nl(t))return this.clickInactive(e,t)};W.onTouchEnd=W.onMouseUp=function(e){e.dragMoving&&this.fireUpdate(),this.stopDragging(e)};var rT=W;const ku=Rt,Re=G,Ne={};Ne.onSetup=function(){const e=this.newFeature({type:Re.geojsonTypes.FEATURE,properties:{},geometry:{type:Re.geojsonTypes.POINT,coordinates:[]}});return this.addFeature(e),this.clearSelectedFeatures(),this.updateUIClasses({mouse:Re.cursors.ADD}),this.activateUIButton(Re.types.POINT),this.setActionableState({trash:!0}),{point:e}};Ne.stopDrawingAndRemove=function(e){this.deleteFeature([e.point.id],{silent:!0}),this.changeMode(Re.modes.SIMPLE_SELECT)};Ne.onTap=Ne.onClick=function(e,t){this.updateUIClasses({mouse:Re.cursors.MOVE}),e.point.updateCoordinate("",t.lngLat.lng,t.lngLat.lat),this.map.fire(Re.events.CREATE,{features:[e.point.toGeoJSON()]}),this.changeMode(Re.modes.SIMPLE_SELECT,{featureIds:[e.point.id]})};Ne.onStop=function(e){this.activateUIButton(),e.point.getCoordinate().length||this.deleteFeature([e.point.id],{silent:!0})};Ne.toDisplayFeatures=function(e,t,r){const n=t.properties.id===e.point.id;if(t.properties.active=n?Re.activeStates.ACTIVE:Re.activeStates.INACTIVE,!n)return r(t)};Ne.onTrash=Ne.stopDrawingAndRemove;Ne.onKeyUp=function(e,t){if(ku.isEscapeKey(t)||ku.isEnterKey(t))return this.stopDrawingAndRemove(e,t)};var nT=Ne;function iT(e,t){return e.lngLat?e.lngLat.lng===t[0]&&e.lngLat.lat===t[1]:!1}var Dl=iT;const Wr=Rt,Ul=Nt,ae=G,oT=Dl,qu=tn,$e={};$e.onSetup=function(){const e=this.newFeature({type:ae.geojsonTypes.FEATURE,properties:{},geometry:{type:ae.geojsonTypes.POLYGON,coordinates:[[]]}});return this.addFeature(e),this.clearSelectedFeatures(),Ul.disable(this),this.updateUIClasses({mouse:ae.cursors.ADD}),this.activateUIButton(ae.types.POLYGON),this.setActionableState({trash:!0}),{polygon:e,currentVertexPosition:0}};$e.clickAnywhere=function(e,t){if(e.currentVertexPosition>0&&oT(t,e.polygon.coordinates[0][e.currentVertexPosition-1]))return this.changeMode(ae.modes.SIMPLE_SELECT,{featureIds:[e.polygon.id]});this.updateUIClasses({mouse:ae.cursors.ADD}),e.polygon.updateCoordinate(`0.${e.currentVertexPosition}`,t.lngLat.lng,t.lngLat.lat),e.currentVertexPosition++,e.polygon.updateCoordinate(`0.${e.currentVertexPosition}`,t.lngLat.lng,t.lngLat.lat)};$e.clickOnVertex=function(e){return this.changeMode(ae.modes.SIMPLE_SELECT,{featureIds:[e.polygon.id]})};$e.onMouseMove=function(e,t){e.polygon.updateCoordinate(`0.${e.currentVertexPosition}`,t.lngLat.lng,t.lngLat.lat),Wr.isVertex(t)&&this.updateUIClasses({mouse:ae.cursors.POINTER})};$e.onTap=$e.onClick=function(e,t){return Wr.isVertex(t)?this.clickOnVertex(e,t):this.clickAnywhere(e,t)};$e.onKeyUp=function(e,t){Wr.isEscapeKey(t)?(this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(ae.modes.SIMPLE_SELECT)):Wr.isEnterKey(t)&&this.changeMode(ae.modes.SIMPLE_SELECT,{featureIds:[e.polygon.id]})};$e.onStop=function(e){this.updateUIClasses({mouse:ae.cursors.NONE}),Ul.enable(this),this.activateUIButton(),this.getFeature(e.polygon.id)!==void 0&&(e.polygon.removeCoordinate(`0.${e.currentVertexPosition}`),e.polygon.isValid()?this.map.fire(ae.events.CREATE,{features:[e.polygon.toGeoJSON()]}):(this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(ae.modes.SIMPLE_SELECT,{},{silent:!0})))};$e.toDisplayFeatures=function(e,t,r){const n=t.properties.id===e.polygon.id;if(t.properties.active=n?ae.activeStates.ACTIVE:ae.activeStates.INACTIVE,!n)return r(t);if(t.geometry.coordinates.length===0)return;const i=t.geometry.coordinates[0].length;if(!(i<3)){if(t.properties.meta=ae.meta.FEATURE,r(qu(e.polygon.id,t.geometry.coordinates[0][0],"0.0",!1)),i>3){const o=t.geometry.coordinates[0].length-3;r(qu(e.polygon.id,t.geometry.coordinates[0][o],`0.${o}`,!1))}if(i<=4){const o=[[t.geometry.coordinates[0][0][0],t.geometry.coordinates[0][0][1]],[t.geometry.coordinates[0][1][0],t.geometry.coordinates[0][1][1]]];if(r({type:ae.geojsonTypes.FEATURE,properties:t.properties,geometry:{coordinates:o,type:ae.geojsonTypes.LINE_STRING}}),i===3)return}return r(t)}};$e.onTrash=function(e){this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(ae.modes.SIMPLE_SELECT)};var aT=$e;const zr=Rt,ju=Dl,kl=Nt,pe=G,sT=tn,Ce={};Ce.onSetup=function(e){e=e||{};const t=e.featureId;let r,n,i="forward";if(t){if(r=this.getFeature(t),!r)throw new Error("Could not find a feature with the provided featureId");let o=e.from;if(o&&o.type==="Feature"&&o.geometry&&o.geometry.type==="Point"&&(o=o.geometry),o&&o.type==="Point"&&o.coordinates&&o.coordinates.length===2&&(o=o.coordinates),!o||!Array.isArray(o))throw new Error("Please use the `from` property to indicate which point to continue the line from");const a=r.coordinates.length-1;if(r.coordinates[a][0]===o[0]&&r.coordinates[a][1]===o[1])n=a+1,r.addCoordinate(n,...r.coordinates[a]);else if(r.coordinates[0][0]===o[0]&&r.coordinates[0][1]===o[1])i="backwards",n=0,r.addCoordinate(n,...r.coordinates[0]);else throw new Error("`from` should match the point at either the start or the end of the provided LineString")}else r=this.newFeature({type:pe.geojsonTypes.FEATURE,properties:{},geometry:{type:pe.geojsonTypes.LINE_STRING,coordinates:[]}}),n=0,this.addFeature(r);return this.clearSelectedFeatures(),kl.disable(this),this.updateUIClasses({mouse:pe.cursors.ADD}),this.activateUIButton(pe.types.LINE),this.setActionableState({trash:!0}),{line:r,currentVertexPosition:n,direction:i}};Ce.clickAnywhere=function(e,t){if(e.currentVertexPosition>0&&ju(t,e.line.coordinates[e.currentVertexPosition-1])||e.direction==="backwards"&&ju(t,e.line.coordinates[e.currentVertexPosition+1]))return this.changeMode(pe.modes.SIMPLE_SELECT,{featureIds:[e.line.id]});this.updateUIClasses({mouse:pe.cursors.ADD}),e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat),e.direction==="forward"?(e.currentVertexPosition++,e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat)):e.line.addCoordinate(0,t.lngLat.lng,t.lngLat.lat)};Ce.clickOnVertex=function(e){return this.changeMode(pe.modes.SIMPLE_SELECT,{featureIds:[e.line.id]})};Ce.onMouseMove=function(e,t){e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat),zr.isVertex(t)&&this.updateUIClasses({mouse:pe.cursors.POINTER})};Ce.onTap=Ce.onClick=function(e,t){if(zr.isVertex(t))return this.clickOnVertex(e,t);this.clickAnywhere(e,t)};Ce.onKeyUp=function(e,t){zr.isEnterKey(t)?this.changeMode(pe.modes.SIMPLE_SELECT,{featureIds:[e.line.id]}):zr.isEscapeKey(t)&&(this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(pe.modes.SIMPLE_SELECT))};Ce.onStop=function(e){kl.enable(this),this.activateUIButton(),this.getFeature(e.line.id)!==void 0&&(e.line.removeCoordinate(`${e.currentVertexPosition}`),e.line.isValid()?this.map.fire(pe.events.CREATE,{features:[e.line.toGeoJSON()]}):(this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(pe.modes.SIMPLE_SELECT,{},{silent:!0})))};Ce.onTrash=function(e){this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(pe.modes.SIMPLE_SELECT)};Ce.toDisplayFeatures=function(e,t,r){const n=t.properties.id===e.line.id;if(t.properties.active=n?pe.activeStates.ACTIVE:pe.activeStates.INACTIVE,!n)return r(t);t.geometry.coordinates.length<2||(t.properties.meta=pe.meta.FEATURE,r(sT(e.line.id,t.geometry.coordinates[e.direction==="forward"?t.geometry.coordinates.length-2:1],`${e.direction==="forward"?t.geometry.coordinates.length-2:1}`,!1)),r(t))};var uT=Ce,ql={simple_select:Z0,direct_select:rT,draw_point:nT,draw_polygon:aT,draw_line_string:uT};const Yt=So,bo=G,cT={defaultMode:bo.modes.SIMPLE_SELECT,keybindings:!0,touchEnabled:!0,clickBuffer:2,touchBuffer:25,boxSelect:!0,displayControlsDefault:!0,styles:bd,modes:ql,controls:{},userProperties:!1},lT={point:!0,line_string:!0,polygon:!0,trash:!0,combine_features:!0,uncombine_features:!0},fT={point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1};function Gu(e,t){return e.map(r=>r.source?r:Yt(r,{id:`${r.id}.${t}`,source:t==="hot"?bo.sources.HOT:bo.sources.COLD}))}var pT=function(e={}){let t=Yt(e);return e.controls||(t.controls={}),e.displayControlsDefault===!1?t.controls=Yt(fT,e.controls):t.controls=Yt(lT,e.controls),t=Yt(cT,t),t.styles=Gu(t.styles,"cold").concat(Gu(t.styles,"hot")),t},Hr={exports:{}};Hr.exports;(function(e,t){var r=200,n="__lodash_hash_undefined__",i=1,o=2,a=9007199254740991,c="[object Arguments]",u="[object Array]",y="[object AsyncFunction]",h="[object Boolean]",b="[object Date]",l="[object Error]",p="[object Function]",_="[object GeneratorFunction]",w="[object Map]",A="[object Number]",R="[object Null]",O="[object Object]",m="[object Promise]",I="[object Proxy]",$="[object RegExp]",P="[object Set]",C="[object String]",B="[object Symbol]",f="[object Undefined]",S="[object WeakMap]",g="[object ArrayBuffer]",v="[object DataView]",E="[object Float32Array]",N="[object Float64Array]",j="[object Int8Array]",Q="[object Int16Array]",ge="[object Int32Array]",Be="[object Uint8Array]",vt="[object Uint8ClampedArray]",x="[object Uint16Array]",L="[object Uint32Array]",q=/[\\^$.*+?()[\]{}|]/g,k=/^\[object .+?Constructor\]$/,K=/^(?:0|[1-9]\d*)$/,M={};M[E]=M[N]=M[j]=M[Q]=M[ge]=M[Be]=M[vt]=M[x]=M[L]=!0,M[c]=M[u]=M[g]=M[h]=M[v]=M[b]=M[l]=M[p]=M[w]=M[A]=M[O]=M[$]=M[P]=M[C]=M[S]=!1;var re=typeof window=="object"&&window&&window.Object===Object&&window,le=typeof self=="object"&&self&&self.Object===Object&&self,te=re||le||Function("return this")(),De=t&&!t.nodeType&&t,ze=De&&!0&&e&&!e.nodeType&&e,me=ze&&ze.exports===De,be=me&&re.process,mt=function(){try{return be&&be.binding&&be.binding("util")}catch{}}(),bt=mt&&mt.isTypedArray;function ar(s,d){for(var T=-1,F=s==null?0:s.length,H=0,D=[];++T<F;){var ee=s[T];d(ee,T,s)&&(D[H++]=ee)}return D}function vn(s,d){for(var T=-1,F=d.length,H=s.length;++T<F;)s[H+T]=d[T];return s}function Kl(s,d){for(var T=-1,F=s==null?0:s.length;++T<F;)if(d(s[T],T,s))return!0;return!1}function Jl(s,d){for(var T=-1,F=Array(s);++T<s;)F[T]=d(T);return F}function Yl(s){return function(d){return s(d)}}function Zl(s,d){return s.has(d)}function Xl(s,d){return s==null?void 0:s[d]}function Ql(s){var d=-1,T=Array(s.size);return s.forEach(function(F,H){T[++d]=[H,F]}),T}function ef(s,d){return function(T){return s(d(T))}}function tf(s){var d=-1,T=Array(s.size);return s.forEach(function(F){T[++d]=F}),T}var rf=Array.prototype,nf=Function.prototype,sr=Object.prototype,mn=te["__core-js_shared__"],Zo=nf.toString,Pe=sr.hasOwnProperty,Xo=function(){var s=/[^.]+$/.exec(mn&&mn.keys&&mn.keys.IE_PROTO||"");return s?"Symbol(src)_1."+s:""}(),Qo=sr.toString,of=RegExp("^"+Zo.call(Pe).replace(q,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ea=me?te.Buffer:void 0,ur=te.Symbol,ta=te.Uint8Array,ra=sr.propertyIsEnumerable,af=rf.splice,it=ur?ur.toStringTag:void 0,na=Object.getOwnPropertySymbols,sf=ea?ea.isBuffer:void 0,uf=ef(Object.keys,Object),bn=Tt(te,"DataView"),Gt=Tt(te,"Map"),Tn=Tt(te,"Promise"),Sn=Tt(te,"Set"),_n=Tt(te,"WeakMap"),Vt=Tt(Object,"create"),cf=st(bn),lf=st(Gt),ff=st(Tn),pf=st(Sn),df=st(_n),ia=ur?ur.prototype:void 0,En=ia?ia.valueOf:void 0;function ot(s){var d=-1,T=s==null?0:s.length;for(this.clear();++d<T;){var F=s[d];this.set(F[0],F[1])}}function hf(){this.__data__=Vt?Vt(null):{},this.size=0}function yf(s){var d=this.has(s)&&delete this.__data__[s];return this.size-=d?1:0,d}function gf(s){var d=this.__data__;if(Vt){var T=d[s];return T===n?void 0:T}return Pe.call(d,s)?d[s]:void 0}function vf(s){var d=this.__data__;return Vt?d[s]!==void 0:Pe.call(d,s)}function mf(s,d){var T=this.__data__;return this.size+=this.has(s)?0:1,T[s]=Vt&&d===void 0?n:d,this}ot.prototype.clear=hf,ot.prototype.delete=yf,ot.prototype.get=gf,ot.prototype.has=vf,ot.prototype.set=mf;function Ue(s){var d=-1,T=s==null?0:s.length;for(this.clear();++d<T;){var F=s[d];this.set(F[0],F[1])}}function bf(){this.__data__=[],this.size=0}function Tf(s){var d=this.__data__,T=lr(d,s);if(T<0)return!1;var F=d.length-1;return T==F?d.pop():af.call(d,T,1),--this.size,!0}function Sf(s){var d=this.__data__,T=lr(d,s);return T<0?void 0:d[T][1]}function _f(s){return lr(this.__data__,s)>-1}function Ef(s,d){var T=this.__data__,F=lr(T,s);return F<0?(++this.size,T.push([s,d])):T[F][1]=d,this}Ue.prototype.clear=bf,Ue.prototype.delete=Tf,Ue.prototype.get=Sf,Ue.prototype.has=_f,Ue.prototype.set=Ef;function at(s){var d=-1,T=s==null?0:s.length;for(this.clear();++d<T;){var F=s[d];this.set(F[0],F[1])}}function wf(){this.size=0,this.__data__={hash:new ot,map:new(Gt||Ue),string:new ot}}function Af(s){var d=fr(this,s).delete(s);return this.size-=d?1:0,d}function If(s){return fr(this,s).get(s)}function $f(s){return fr(this,s).has(s)}function Cf(s,d){var T=fr(this,s),F=T.size;return T.set(s,d),this.size+=T.size==F?0:1,this}at.prototype.clear=wf,at.prototype.delete=Af,at.prototype.get=If,at.prototype.has=$f,at.prototype.set=Cf;function cr(s){var d=-1,T=s==null?0:s.length;for(this.__data__=new at;++d<T;)this.add(s[d])}function Of(s){return this.__data__.set(s,n),this}function Ff(s){return this.__data__.has(s)}cr.prototype.add=cr.prototype.push=Of,cr.prototype.has=Ff;function He(s){var d=this.__data__=new Ue(s);this.size=d.size}function Pf(){this.__data__=new Ue,this.size=0}function Mf(s){var d=this.__data__,T=d.delete(s);return this.size=d.size,T}function Lf(s){return this.__data__.get(s)}function Rf(s){return this.__data__.has(s)}function Nf(s,d){var T=this.__data__;if(T instanceof Ue){var F=T.__data__;if(!Gt||F.length<r-1)return F.push([s,d]),this.size=++T.size,this;T=this.__data__=new at(F)}return T.set(s,d),this.size=T.size,this}He.prototype.clear=Pf,He.prototype.delete=Mf,He.prototype.get=Lf,He.prototype.has=Rf,He.prototype.set=Nf;function xf(s,d){var T=pr(s),F=!T&&Zf(s),H=!T&&!F&&wn(s),D=!T&&!F&&!H&&da(s),ee=T||F||H||D,se=ee?Jl(s.length,String):[],ce=se.length;for(var Y in s)Pe.call(s,Y)&&!(ee&&(Y=="length"||H&&(Y=="offset"||Y=="parent")||D&&(Y=="buffer"||Y=="byteLength"||Y=="byteOffset")||zf(Y,ce)))&&se.push(Y);return se}function lr(s,d){for(var T=s.length;T--;)if(ca(s[T][0],d))return T;return-1}function Bf(s,d,T){var F=d(s);return pr(s)?F:vn(F,T(s))}function Wt(s){return s==null?s===void 0?f:R:it&&it in Object(s)?Vf(s):Yf(s)}function oa(s){return zt(s)&&Wt(s)==c}function aa(s,d,T,F,H){return s===d?!0:s==null||d==null||!zt(s)&&!zt(d)?s!==s&&d!==d:Df(s,d,T,F,aa,H)}function Df(s,d,T,F,H,D){var ee=pr(s),se=pr(d),ce=ee?u:Ke(s),Y=se?u:Ke(d);ce=ce==c?O:ce,Y=Y==c?O:Y;var ve=ce==O,Ae=Y==O,fe=ce==Y;if(fe&&wn(s)){if(!wn(d))return!1;ee=!0,ve=!1}if(fe&&!ve)return D||(D=new He),ee||da(s)?sa(s,d,T,F,H,D):jf(s,d,ce,T,F,H,D);if(!(T&i)){var Te=ve&&Pe.call(s,"__wrapped__"),Se=Ae&&Pe.call(d,"__wrapped__");if(Te||Se){var Je=Te?s.value():s,ke=Se?d.value():d;return D||(D=new He),H(Je,ke,T,F,D)}}return fe?(D||(D=new He),Gf(s,d,T,F,H,D)):!1}function Uf(s){if(!pa(s)||Kf(s))return!1;var d=la(s)?of:k;return d.test(st(s))}function kf(s){return zt(s)&&fa(s.length)&&!!M[Wt(s)]}function qf(s){if(!Jf(s))return uf(s);var d=[];for(var T in Object(s))Pe.call(s,T)&&T!="constructor"&&d.push(T);return d}function sa(s,d,T,F,H,D){var ee=T&i,se=s.length,ce=d.length;if(se!=ce&&!(ee&&ce>se))return!1;var Y=D.get(s);if(Y&&D.get(d))return Y==d;var ve=-1,Ae=!0,fe=T&o?new cr:void 0;for(D.set(s,d),D.set(d,s);++ve<se;){var Te=s[ve],Se=d[ve];if(F)var Je=ee?F(Se,Te,ve,d,s,D):F(Te,Se,ve,s,d,D);if(Je!==void 0){if(Je)continue;Ae=!1;break}if(fe){if(!Kl(d,function(ke,ut){if(!Zl(fe,ut)&&(Te===ke||H(Te,ke,T,F,D)))return fe.push(ut)})){Ae=!1;break}}else if(!(Te===Se||H(Te,Se,T,F,D))){Ae=!1;break}}return D.delete(s),D.delete(d),Ae}function jf(s,d,T,F,H,D,ee){switch(T){case v:if(s.byteLength!=d.byteLength||s.byteOffset!=d.byteOffset)return!1;s=s.buffer,d=d.buffer;case g:return!(s.byteLength!=d.byteLength||!D(new ta(s),new ta(d)));case h:case b:case A:return ca(+s,+d);case l:return s.name==d.name&&s.message==d.message;case $:case C:return s==d+"";case w:var se=Ql;case P:var ce=F&i;if(se||(se=tf),s.size!=d.size&&!ce)return!1;var Y=ee.get(s);if(Y)return Y==d;F|=o,ee.set(s,d);var ve=sa(se(s),se(d),F,H,D,ee);return ee.delete(s),ve;case B:if(En)return En.call(s)==En.call(d)}return!1}function Gf(s,d,T,F,H,D){var ee=T&i,se=ua(s),ce=se.length,Y=ua(d),ve=Y.length;if(ce!=ve&&!ee)return!1;for(var Ae=ce;Ae--;){var fe=se[Ae];if(!(ee?fe in d:Pe.call(d,fe)))return!1}var Te=D.get(s);if(Te&&D.get(d))return Te==d;var Se=!0;D.set(s,d),D.set(d,s);for(var Je=ee;++Ae<ce;){fe=se[Ae];var ke=s[fe],ut=d[fe];if(F)var ha=ee?F(ut,ke,fe,d,s,D):F(ke,ut,fe,s,d,D);if(!(ha===void 0?ke===ut||H(ke,ut,T,F,D):ha)){Se=!1;break}Je||(Je=fe=="constructor")}if(Se&&!Je){var dr=s.constructor,hr=d.constructor;dr!=hr&&"constructor"in s&&"constructor"in d&&!(typeof dr=="function"&&dr instanceof dr&&typeof hr=="function"&&hr instanceof hr)&&(Se=!1)}return D.delete(s),D.delete(d),Se}function ua(s){return Bf(s,ep,Wf)}function fr(s,d){var T=s.__data__;return Hf(d)?T[typeof d=="string"?"string":"hash"]:T.map}function Tt(s,d){var T=Xl(s,d);return Uf(T)?T:void 0}function Vf(s){var d=Pe.call(s,it),T=s[it];try{s[it]=void 0;var F=!0}catch{}var H=Qo.call(s);return F&&(d?s[it]=T:delete s[it]),H}var Wf=na?function(s){return s==null?[]:(s=Object(s),ar(na(s),function(d){return ra.call(s,d)}))}:tp,Ke=Wt;(bn&&Ke(new bn(new ArrayBuffer(1)))!=v||Gt&&Ke(new Gt)!=w||Tn&&Ke(Tn.resolve())!=m||Sn&&Ke(new Sn)!=P||_n&&Ke(new _n)!=S)&&(Ke=function(s){var d=Wt(s),T=d==O?s.constructor:void 0,F=T?st(T):"";if(F)switch(F){case cf:return v;case lf:return w;case ff:return m;case pf:return P;case df:return S}return d});function zf(s,d){return d=d??a,!!d&&(typeof s=="number"||K.test(s))&&s>-1&&s%1==0&&s<d}function Hf(s){var d=typeof s;return d=="string"||d=="number"||d=="symbol"||d=="boolean"?s!=="__proto__":s===null}function Kf(s){return!!Xo&&Xo in s}function Jf(s){var d=s&&s.constructor,T=typeof d=="function"&&d.prototype||sr;return s===T}function Yf(s){return Qo.call(s)}function st(s){if(s!=null){try{return Zo.call(s)}catch{}try{return s+""}catch{}}return""}function ca(s,d){return s===d||s!==s&&d!==d}var Zf=oa(function(){return arguments}())?oa:function(s){return zt(s)&&Pe.call(s,"callee")&&!ra.call(s,"callee")},pr=Array.isArray;function Xf(s){return s!=null&&fa(s.length)&&!la(s)}var wn=sf||rp;function Qf(s,d){return aa(s,d)}function la(s){if(!pa(s))return!1;var d=Wt(s);return d==p||d==_||d==y||d==I}function fa(s){return typeof s=="number"&&s>-1&&s%1==0&&s<=a}function pa(s){var d=typeof s;return s!=null&&(d=="object"||d=="function")}function zt(s){return s!=null&&typeof s=="object"}var da=bt?Yl(bt):kf;function ep(s){return Xf(s)?xf(s):qf(s)}function tp(){return[]}function rp(){return!1}e.exports=Qf})(Hr,Hr.exports);var dT=Hr.exports,hT=function(e,t){return e.length!==t.length?!1:JSON.stringify(e.map(r=>r).sort())===JSON.stringify(t.map(r=>r).sort())},jl={},To={exports:{}};(function(e,t){var r={env:{},argv:[]},n=function(){var i=function(O,m,I,$){for(I=I||{},$=O.length;$--;I[O[$]]=m);return I},o=[1,12],a=[1,13],c=[1,9],u=[1,10],y=[1,11],h=[1,14],b=[1,15],l=[14,18,22,24],p=[18,22],_=[22,24],w={trace:function(){},yy:{},symbols_:{error:2,JSONString:3,STRING:4,JSONNumber:5,NUMBER:6,JSONNullLiteral:7,NULL:8,JSONBooleanLiteral:9,TRUE:10,FALSE:11,JSONText:12,JSONValue:13,EOF:14,JSONObject:15,JSONArray:16,"{":17,"}":18,JSONMemberList:19,JSONMember:20,":":21,",":22,"[":23,"]":24,JSONElementList:25,$accept:0,$end:1},terminals_:{2:"error",4:"STRING",6:"NUMBER",8:"NULL",10:"TRUE",11:"FALSE",14:"EOF",17:"{",18:"}",21:":",22:",",23:"[",24:"]"},productions_:[0,[3,1],[5,1],[7,1],[9,1],[9,1],[12,2],[13,1],[13,1],[13,1],[13,1],[13,1],[13,1],[15,2],[15,3],[20,3],[19,1],[19,3],[16,2],[16,3],[25,1],[25,3]],performAction:function(m,I,$,P,C,B,f){var S=B.length-1;switch(C){case 1:this.$=m.replace(/\\(\\|")/g,"$1").replace(/\\n/g,`
`).replace(/\\r/g,"\r").replace(/\\t/g,"	").replace(/\\v/g,"\v").replace(/\\f/g,"\f").replace(/\\b/g,"\b");break;case 2:this.$=Number(m);break;case 3:this.$=null;break;case 4:this.$=!0;break;case 5:this.$=!1;break;case 6:return this.$=B[S-1];case 13:this.$={},Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 14:case 19:this.$=B[S-1],Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 15:this.$=[B[S-2],B[S]];break;case 16:this.$={},this.$[B[S][0]]=B[S][1];break;case 17:this.$=B[S-2],B[S-2][B[S][0]]!==void 0&&(this.$.__duplicateProperties__||Object.defineProperty(this.$,"__duplicateProperties__",{value:[],enumerable:!1}),this.$.__duplicateProperties__.push(B[S][0])),B[S-2][B[S][0]]=B[S][1];break;case 18:this.$=[],Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 20:this.$=[B[S]];break;case 21:this.$=B[S-2],B[S-2].push(B[S]);break}},table:[{3:5,4:o,5:6,6:a,7:3,8:c,9:4,10:u,11:y,12:1,13:2,15:7,16:8,17:h,23:b},{1:[3]},{14:[1,16]},i(l,[2,7]),i(l,[2,8]),i(l,[2,9]),i(l,[2,10]),i(l,[2,11]),i(l,[2,12]),i(l,[2,3]),i(l,[2,4]),i(l,[2,5]),i([14,18,21,22,24],[2,1]),i(l,[2,2]),{3:20,4:o,18:[1,17],19:18,20:19},{3:5,4:o,5:6,6:a,7:3,8:c,9:4,10:u,11:y,13:23,15:7,16:8,17:h,23:b,24:[1,21],25:22},{1:[2,6]},i(l,[2,13]),{18:[1,24],22:[1,25]},i(p,[2,16]),{21:[1,26]},i(l,[2,18]),{22:[1,28],24:[1,27]},i(_,[2,20]),i(l,[2,14]),{3:20,4:o,20:29},{3:5,4:o,5:6,6:a,7:3,8:c,9:4,10:u,11:y,13:30,15:7,16:8,17:h,23:b},i(l,[2,19]),{3:5,4:o,5:6,6:a,7:3,8:c,9:4,10:u,11:y,13:31,15:7,16:8,17:h,23:b},i(p,[2,17]),i(p,[2,15]),i(_,[2,21])],defaultActions:{16:[2,6]},parseError:function(m,I){if(I.recoverable)this.trace(m);else{let $=function(P,C){this.message=P,this.hash=C};throw $.prototype=Error,new $(m,I)}},parse:function(m){var I=this,$=[0],P=[null],C=[],B=this.table,f="",S=0,g=0,v=2,E=1,N=C.slice.call(arguments,1),j=Object.create(this.lexer),Q={yy:{}};for(var ge in this.yy)Object.prototype.hasOwnProperty.call(this.yy,ge)&&(Q.yy[ge]=this.yy[ge]);j.setInput(m,Q.yy),Q.yy.lexer=j,Q.yy.parser=this,typeof j.yylloc>"u"&&(j.yylloc={});var Be=j.yylloc;C.push(Be);var vt=j.options&&j.options.ranges;typeof Q.yy.parseError=="function"?this.parseError=Q.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var x=function(){var me;return me=j.lex()||E,typeof me!="number"&&(me=I.symbols_[me]||me),me},L,q,k,K,M={},re,le,te,De;;){if(q=$[$.length-1],this.defaultActions[q]?k=this.defaultActions[q]:((L===null||typeof L>"u")&&(L=x()),k=B[q]&&B[q][L]),typeof k>"u"||!k.length||!k[0]){var ze="";De=[];for(re in B[q])this.terminals_[re]&&re>v&&De.push("'"+this.terminals_[re]+"'");j.showPosition?ze="Parse error on line "+(S+1)+`:
`+j.showPosition()+`
Expecting `+De.join(", ")+", got '"+(this.terminals_[L]||L)+"'":ze="Parse error on line "+(S+1)+": Unexpected "+(L==E?"end of input":"'"+(this.terminals_[L]||L)+"'"),this.parseError(ze,{text:j.match,token:this.terminals_[L]||L,line:j.yylineno,loc:Be,expected:De})}if(k[0]instanceof Array&&k.length>1)throw new Error("Parse Error: multiple actions possible at state: "+q+", token: "+L);switch(k[0]){case 1:$.push(L),P.push(j.yytext),C.push(j.yylloc),$.push(k[1]),L=null,g=j.yyleng,f=j.yytext,S=j.yylineno,Be=j.yylloc;break;case 2:if(le=this.productions_[k[1]][1],M.$=P[P.length-le],M._$={first_line:C[C.length-(le||1)].first_line,last_line:C[C.length-1].last_line,first_column:C[C.length-(le||1)].first_column,last_column:C[C.length-1].last_column},vt&&(M._$.range=[C[C.length-(le||1)].range[0],C[C.length-1].range[1]]),K=this.performAction.apply(M,[f,g,S,Q.yy,k[1],P,C].concat(N)),typeof K<"u")return K;le&&($=$.slice(0,-1*le*2),P=P.slice(0,-1*le),C=C.slice(0,-1*le)),$.push(this.productions_[k[1]][0]),P.push(M.$),C.push(M._$),te=B[$[$.length-2]][$[$.length-1]],$.push(te);break;case 3:return!0}}return!0}},A=function(){var O={EOF:1,parseError:function(I,$){if(this.yy.parser)this.yy.parser.parseError(I,$);else throw new Error(I)},setInput:function(m,I){return this.yy=I||this.yy||{},this._input=m,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var m=this._input[0];this.yytext+=m,this.yyleng++,this.offset++,this.match+=m,this.matched+=m;var I=m.match(/(?:\r\n?|\n).*/g);return I?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),m},unput:function(m){var I=m.length,$=m.split(/(?:\r\n?|\n)/g);this._input=m+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-I),this.offset-=I;var P=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),$.length-1&&(this.yylineno-=$.length-1);var C=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:$?($.length===P.length?this.yylloc.first_column:0)+P[P.length-$.length].length-$[0].length:this.yylloc.first_column-I},this.options.ranges&&(this.yylloc.range=[C[0],C[0]+this.yyleng-I]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(m){this.unput(this.match.slice(m))},pastInput:function(){var m=this.matched.substr(0,this.matched.length-this.match.length);return(m.length>20?"...":"")+m.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var m=this.match;return m.length<20&&(m+=this._input.substr(0,20-m.length)),(m.substr(0,20)+(m.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var m=this.pastInput(),I=new Array(m.length+1).join("-");return m+this.upcomingInput()+`
`+I+"^"},test_match:function(m,I){var $,P,C;if(this.options.backtrack_lexer&&(C={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(C.yylloc.range=this.yylloc.range.slice(0))),P=m[0].match(/(?:\r\n?|\n).*/g),P&&(this.yylineno+=P.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:P?P[P.length-1].length-P[P.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+m[0].length},this.yytext+=m[0],this.match+=m[0],this.matches=m,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(m[0].length),this.matched+=m[0],$=this.performAction.call(this,this.yy,this,I,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),$)return $;if(this._backtrack){for(var B in C)this[B]=C[B];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var m,I,$,P;this._more||(this.yytext="",this.match="");for(var C=this._currentRules(),B=0;B<C.length;B++)if($=this._input.match(this.rules[C[B]]),$&&(!I||$[0].length>I[0].length)){if(I=$,P=B,this.options.backtrack_lexer){if(m=this.test_match($,C[B]),m!==!1)return m;if(this._backtrack){I=!1;continue}else return!1}else if(!this.options.flex)break}return I?(m=this.test_match(I,C[P]),m!==!1?m:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var I=this.next();return I||this.lex()},begin:function(I){this.conditionStack.push(I)},popState:function(){var I=this.conditionStack.length-1;return I>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(I){return I=this.conditionStack.length-1-Math.abs(I||0),I>=0?this.conditionStack[I]:"INITIAL"},pushState:function(I){this.begin(I)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(I,$,P,C){switch(P){case 0:break;case 1:return 6;case 2:return $.yytext=$.yytext.substr(1,$.yyleng-2),4;case 3:return 17;case 4:return 18;case 5:return 23;case 6:return 24;case 7:return 22;case 8:return 21;case 9:return 10;case 10:return 11;case 11:return 8;case 12:return 14;case 13:return"INVALID"}},rules:[/^(?:\s+)/,/^(?:(-?([0-9]|[1-9][0-9]+))(\.[0-9]+)?([eE][-+]?[0-9]+)?\b)/,/^(?:"(?:\\[\\"bfnrt\/]|\\u[a-fA-F0-9]{4}|[^\\\0-\x09\x0a-\x1f"])*")/,/^(?:\{)/,/^(?:\})/,/^(?:\[)/,/^(?:\])/,/^(?:,)/,/^(?::)/,/^(?:true\b)/,/^(?:false\b)/,/^(?:null\b)/,/^(?:$)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13],inclusive:!0}}};return O}();w.lexer=A;function R(){this.yy={}}return R.prototype=w,w.Parser=R,new R}();typeof Tp<"u"&&(t.parser=n,t.Parser=n.Parser,t.parse=function(){return n.parse.apply(n,arguments)},t.main=function(o){o[1]||(console.log("Usage: "+o[0]+" FILE"),r.exit(1));var a=oo.readFileSync(oo.normalize(o[1]),"utf8");return t.parser.parse(a)},require.main===e&&t.main(r.argv.slice(1)))})(To,To.exports);var yT=To.exports,Gl={};function Xi(e){return e*Math.PI/180}function Vu(e){var t=0;if(e.length>2)for(var r,n,i=0;i<e.length-1;i++)r=e[i],n=e[i+1],t+=Xi(n[0]-r[0])*(2+Math.sin(Xi(r[1]))+Math.sin(Xi(n[1])));return t>=0}function Wu(e){if(e&&e.length>0){if(Vu(e[0]))return!1;var t=e.slice(1,e.length);if(!t.every(Vu))return!1}return!0}function gT(e){if(e.type==="Polygon")return Wu(e.coordinates);if(e.type==="MultiPolygon")return e.coordinates.every(Wu)}var vT=function(t,r){gT(t)||r.push({message:"Polygons and MultiPolygons should follow the right-hand rule",level:"message",line:t.__line__})},zu=vT;function mT(e,t){var r=[],n=0,i=10,o=6;function a(f){if((!t||t.noDuplicateMembers!==!1)&&f.__duplicateProperties__&&r.push({message:"An object contained duplicate members, making parsing ambigous: "+f.__duplicateProperties__.join(", "),line:f.__line__}),!u(f,"type","string"))if(C[f.type])f&&C[f.type](f);else{var S=B[f.type.toLowerCase()];S!==void 0?r.push({message:"Expected "+S+" but got "+f.type+" (case sensitive)",line:f.__line__}):r.push({message:"The type "+f.type+" is unknown",line:f.__line__})}}function c(f,S){return f.every(function(g){return g!==null&&typeof g===S})}function u(f,S,g){if(typeof f[S]>"u")return r.push({message:'"'+S+'" member required',line:f.__line__});if(g==="array"){if(!Array.isArray(f[S]))return r.push({message:'"'+S+'" member should be an array, but is an '+typeof f[S]+" instead",line:f.__line__})}else{if(g==="object"&&f[S]&&f[S].constructor!==Object)return r.push({message:'"'+S+'" member should be '+g+", but is an "+f[S].constructor.name+" instead",line:f.__line__});if(g&&typeof f[S]!==g)return r.push({message:'"'+S+'" member should be '+g+", but is an "+typeof f[S]+" instead",line:f.__line__})}}function y(f){if(l(f),p(f),f.properties!==void 0&&r.push({message:'FeatureCollection object cannot contain a "properties" member',line:f.__line__}),f.coordinates!==void 0&&r.push({message:'FeatureCollection object cannot contain a "coordinates" member',line:f.__line__}),!u(f,"features","array")){if(!c(f.features,"object"))return r.push({message:"Every feature must be an object",line:f.__line__});f.features.forEach(P)}}function h(f,S){if(!Array.isArray(f))return r.push({message:"position should be an array, is a "+typeof f+" instead",line:f.__line__||S});if(f.length<2)return r.push({message:"position must have 2 or more elements",line:f.__line__||S});if(f.length>3)return r.push({message:"position should not have more than 3 elements",level:"message",line:f.__line__||S});if(!c(f,"number"))return r.push({message:"each element in a position must be a number",line:f.__line__||S});if(t&&t.precisionWarning){if(n===i)return n+=1,r.push({message:"truncated warnings: we've encountered coordinate precision warning "+i+" times, no more warnings will be reported",level:"message",line:f.__line__||S});n<i&&f.forEach(function(g){var v=0,E=String(g).split(".")[1];if(E!==void 0&&(v=E.length),v>o)return n+=1,r.push({message:"precision of coordinates should be reduced",level:"message",line:f.__line__||S})})}}function b(f,S,g,v){if(v===void 0&&f.__line__!==void 0&&(v=f.__line__),g===0)return h(f,v);if(g===1&&S){if(S==="LinearRing"){if(!Array.isArray(f[f.length-1]))return r.push({message:"a number was found where a coordinate array should have been found: this needs to be nested more deeply",line:v}),!0;if(f.length<4&&r.push({message:"a LinearRing of coordinates needs to have four or more positions",line:v}),f.length&&(f[f.length-1].length!==f[0].length||!f[f.length-1].every(function(N,j){return f[0][j]===N})))return r.push({message:"the first and last positions in a LinearRing of coordinates must be the same",line:v}),!0}else if(S==="Line"&&f.length<2)return r.push({message:"a line needs to have two or more coordinates to be valid",line:v})}if(!Array.isArray(f))r.push({message:"a number was found where a coordinate array should have been found: this needs to be nested more deeply",line:v});else{var E=f.map(function(N){return b(N,S,g-1,N.__line__||v)});return E.some(function(N){return N})}}function l(f){if(f.crs){var S="urn:ogc:def:crs:OGC:1.3:CRS84";typeof f.crs=="object"&&f.crs.properties&&f.crs.properties.name===S?r.push({message:"old-style crs member is not recommended, this object is equivalent to the default and should be removed",line:f.__line__}):r.push({message:"old-style crs member is not recommended",line:f.__line__})}}function p(f){if(f.bbox){if(Array.isArray(f.bbox))return c(f.bbox,"number")||r.push({message:"each element in a bbox member must be a number",line:f.bbox.__line__}),f.bbox.length===4||f.bbox.length===6||r.push({message:"bbox must contain 4 elements (for 2D) or 6 elements (for 3D)",line:f.bbox.__line__}),r.length;r.push({message:"bbox member must be an array of numbers, but is a "+typeof f.bbox,line:f.__line__})}}function _(f){f.properties!==void 0&&r.push({message:'geometry object cannot contain a "properties" member',line:f.__line__}),f.geometry!==void 0&&r.push({message:'geometry object cannot contain a "geometry" member',line:f.__line__}),f.features!==void 0&&r.push({message:'geometry object cannot contain a "features" member',line:f.__line__})}function w(f){l(f),p(f),_(f),u(f,"coordinates","array")||h(f.coordinates)}function A(f){l(f),p(f),u(f,"coordinates","array")||b(f.coordinates,"LinearRing",2)||zu(f,r)}function R(f){l(f),p(f),u(f,"coordinates","array")||b(f.coordinates,"LinearRing",3)||zu(f,r)}function O(f){l(f),p(f),u(f,"coordinates","array")||b(f.coordinates,"Line",1)}function m(f){l(f),p(f),u(f,"coordinates","array")||b(f.coordinates,"Line",2)}function I(f){l(f),p(f),u(f,"coordinates","array")||b(f.coordinates,"",1)}function $(f){l(f),p(f),u(f,"geometries","array")||(c(f.geometries,"object")||r.push({message:"The geometries array in a GeometryCollection must contain only geometry objects",line:f.__line__}),f.geometries.length===1&&r.push({message:"GeometryCollection with a single geometry should be avoided in favor of single part or a single object of multi-part type",line:f.geometries.__line__}),f.geometries.forEach(function(S){S&&(S.type==="GeometryCollection"&&r.push({message:"GeometryCollection should avoid nested geometry collections",line:f.geometries.__line__}),a(S))}))}function P(f){l(f),p(f),f.id!==void 0&&typeof f.id!="string"&&typeof f.id!="number"&&r.push({message:'Feature "id" member must have a string or number value',line:f.__line__}),f.features!==void 0&&r.push({message:'Feature object cannot contain a "features" member',line:f.__line__}),f.coordinates!==void 0&&r.push({message:'Feature object cannot contain a "coordinates" member',line:f.__line__}),f.type!=="Feature"&&r.push({message:"GeoJSON features must have a type=feature member",line:f.__line__}),u(f,"properties","object"),u(f,"geometry","object")||f.geometry&&a(f.geometry)}var C={Point:w,Feature:P,MultiPoint:I,LineString:O,MultiLineString:m,FeatureCollection:y,GeometryCollection:$,Polygon:A,MultiPolygon:R},B=Object.keys(C).reduce(function(f,S){return f[S.toLowerCase()]=S,f},{});return typeof e!="object"||e===null||e===void 0?(r.push({message:"The root of a GeoJSON object must be an object.",line:0}),r):(a(e),r.forEach(function(f){({}).hasOwnProperty.call(f,"line")&&f.line===void 0&&delete f.line}),r)}Gl.hint=mT;var bT=yT,TT=Gl;function ST(e,t){var r,n=[];if(typeof e=="object")r=e;else if(typeof e=="string")try{r=bT.parse(e)}catch(a){var i=a.message.match(/line (\d+)/),o=parseInt(i[1],10);return[{line:o-1,message:a.message,error:a}]}else return[{message:"Expected string or object as input",line:0}];return n=n.concat(TT.hint(r,t)),n}jl.hint=ST;const _T=dT,ET=Ju,wT=Ao,AT=Zr,IT=hT,$T=jl,de=G,CT=Yr,OT={Polygon:Co,LineString:$o,Point:Io,MultiPolygon:Fr,MultiLineString:Fr,MultiPoint:Fr};var FT=function(e,t){return t.modes=de.modes,t.getFeatureIdsAt=function(r){return AT.click({point:r},null,e).map(i=>i.properties.id)},t.getSelectedIds=function(){return e.store.getSelectedIds()},t.getSelected=function(){return{type:de.geojsonTypes.FEATURE_COLLECTION,features:e.store.getSelectedIds().map(r=>e.store.get(r)).map(r=>r.toGeoJSON())}},t.getSelectedPoints=function(){return{type:de.geojsonTypes.FEATURE_COLLECTION,features:e.store.getSelectedCoordinates().map(r=>({type:de.geojsonTypes.FEATURE,properties:{},geometry:{type:de.geojsonTypes.POINT,coordinates:r.coordinates}}))}},t.set=function(r){if(r.type===void 0||r.type!==de.geojsonTypes.FEATURE_COLLECTION||!Array.isArray(r.features))throw new Error("Invalid FeatureCollection");const n=e.store.createRenderBatch();let i=e.store.getAllIds().slice();const o=t.add(r),a=new CT(o);return i=i.filter(c=>!a.has(c)),i.length&&t.delete(i),n(),o},t.add=function(r){const n=$T.hint(r,{precisionWarning:!1}).filter(a=>a.level!=="message");if(n.length)throw new Error(n[0].message);const o=JSON.parse(JSON.stringify(ET(r))).features.map(a=>{if(a.id=a.id||wT(),a.geometry===null)throw new Error("Invalid geometry: null");if(e.store.get(a.id)===void 0||e.store.get(a.id).type!==a.geometry.type){const c=OT[a.geometry.type];if(c===void 0)throw new Error(`Invalid geometry type: ${a.geometry.type}.`);const u=new c(e,a);e.store.add(u)}else{const c=e.store.get(a.id);c.properties=a.properties,_T(c.getCoordinates(),a.geometry.coordinates)||c.incomingCoords(a.geometry.coordinates)}return a.id});return e.store.render(),o},t.get=function(r){const n=e.store.get(r);if(n)return n.toGeoJSON()},t.getAll=function(){return{type:de.geojsonTypes.FEATURE_COLLECTION,features:e.store.getAll().map(r=>r.toGeoJSON())}},t.delete=function(r){return e.store.delete(r,{silent:!0}),t.getMode()===de.modes.DIRECT_SELECT&&!e.store.getSelectedIds().length?e.events.changeMode(de.modes.SIMPLE_SELECT,void 0,{silent:!0}):e.store.render(),t},t.deleteAll=function(){return e.store.delete(e.store.getAllIds(),{silent:!0}),t.getMode()===de.modes.DIRECT_SELECT?e.events.changeMode(de.modes.SIMPLE_SELECT,void 0,{silent:!0}):e.store.render(),t},t.changeMode=function(r,n={}){return r===de.modes.SIMPLE_SELECT&&t.getMode()===de.modes.SIMPLE_SELECT?(IT(n.featureIds||[],e.store.getSelectedIds())||(e.store.setSelected(n.featureIds,{silent:!0}),e.store.render()),t):(r===de.modes.DIRECT_SELECT&&t.getMode()===de.modes.DIRECT_SELECT&&n.featureId===e.store.getSelectedIds()[0]||e.events.changeMode(r,n,{silent:!0}),t)},t.getMode=function(){return e.events.getMode()},t.trash=function(){return e.events.trash({silent:!0}),t},t.combineFeatures=function(){return e.events.combineFeatures({silent:!0}),t},t.uncombineFeatures=function(){return e.events.uncombineFeatures({silent:!0}),t},t.setFeatureProperty=function(r,n,i){return e.store.setFeatureProperty(r,n,i),t},t};const PT=md,MT=pT,LT=FT,RT=G,NT=function(e,t){e=MT(e);const r={options:e};t=LT(r,t),r.api=t;const n=PT(r);return t.onAdd=n.onAdd,t.onRemove=n.onRemove,t.types=RT.types,t.options=e,t};wo.exports=function(e){NT(e,this)};wo.exports.modes=ql;var yn=wo.exports;const Ko=_o(vp),xT=yn,Zt=G,BT=Nt,DT=Ko.default,Vl={...xT.modes.draw_polygon},UT=2;Vl.onSetup=function(e){const t=this.newFeature({type:Zt.geojsonTypes.FEATURE,properties:{isCircle:!0,center:[]},geometry:{type:Zt.geojsonTypes.POLYGON,coordinates:[[]]}});return this.addFeature(t),this.clearSelectedFeatures(),BT.disable(this),this.updateUIClasses({mouse:Zt.cursors.ADD}),this.activateUIButton(Zt.types.POLYGON),this.setActionableState({trash:!0}),{initialRadiusInKm:e.initialRadiusInKm||UT,polygon:t,currentVertexPosition:0}};Vl.clickAnywhere=function(e,t){if(e.currentVertexPosition===0){e.currentVertexPosition++;const r=[t.lngLat.lng,t.lngLat.lat],n=DT(r,e.initialRadiusInKm);e.polygon.incomingCoords(n.geometry.coordinates),e.polygon.properties.center=r,e.polygon.properties.radiusInKm=e.initialRadiusInKm}return this.changeMode(Zt.modes.SIMPLE_SELECT,{featureIds:[e.polygon.id]})};var kT={enable(e){setTimeout(()=>{!e.map||!e.map.dragPan||!e._ctx||!e._ctx.store||!e._ctx.store.getInitialConfigValue||e._ctx.store.getInitialConfigValue("dragPan")&&e.map.dragPan.enable()},0)},disable(e){setTimeout(()=>{!e.map||!e.map.doubleClickZoom||e.map.dragPan.disable()},0)}};const Wl=_o(mp);var Jo={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.earthRadius=63710088e-1,e.factors={centimeters:e.earthRadius*100,centimetres:e.earthRadius*100,degrees:e.earthRadius/111325,feet:e.earthRadius*3.28084,inches:e.earthRadius*39.37,kilometers:e.earthRadius/1e3,kilometres:e.earthRadius/1e3,meters:e.earthRadius,metres:e.earthRadius,miles:e.earthRadius/1609.344,millimeters:e.earthRadius*1e3,millimetres:e.earthRadius*1e3,nauticalmiles:e.earthRadius/1852,radians:1,yards:e.earthRadius*1.0936},e.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/e.earthRadius,yards:1.0936133},e.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function t(g,v,E){E===void 0&&(E={});var N={type:"Feature"};return(E.id===0||E.id)&&(N.id=E.id),E.bbox&&(N.bbox=E.bbox),N.properties=v||{},N.geometry=g,N}e.feature=t;function r(g,v,E){switch(g){case"Point":return n(v).geometry;case"LineString":return c(v).geometry;case"Polygon":return o(v).geometry;case"MultiPoint":return b(v).geometry;case"MultiLineString":return h(v).geometry;case"MultiPolygon":return l(v).geometry;default:throw new Error(g+" is invalid")}}e.geometry=r;function n(g,v,E){if(E===void 0&&(E={}),!g)throw new Error("coordinates is required");if(!Array.isArray(g))throw new Error("coordinates must be an Array");if(g.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!C(g[0])||!C(g[1]))throw new Error("coordinates must contain numbers");var N={type:"Point",coordinates:g};return t(N,v,E)}e.point=n;function i(g,v,E){return E===void 0&&(E={}),y(g.map(function(N){return n(N,v)}),E)}e.points=i;function o(g,v,E){E===void 0&&(E={});for(var N=0,j=g;N<j.length;N++){var Q=j[N];if(Q.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var ge=0;ge<Q[Q.length-1].length;ge++)if(Q[Q.length-1][ge]!==Q[0][ge])throw new Error("First and last Position are not equivalent.")}var Be={type:"Polygon",coordinates:g};return t(Be,v,E)}e.polygon=o;function a(g,v,E){return E===void 0&&(E={}),y(g.map(function(N){return o(N,v)}),E)}e.polygons=a;function c(g,v,E){if(E===void 0&&(E={}),g.length<2)throw new Error("coordinates must be an array of two or more positions");var N={type:"LineString",coordinates:g};return t(N,v,E)}e.lineString=c;function u(g,v,E){return E===void 0&&(E={}),y(g.map(function(N){return c(N,v)}),E)}e.lineStrings=u;function y(g,v){v===void 0&&(v={});var E={type:"FeatureCollection"};return v.id&&(E.id=v.id),v.bbox&&(E.bbox=v.bbox),E.features=g,E}e.featureCollection=y;function h(g,v,E){E===void 0&&(E={});var N={type:"MultiLineString",coordinates:g};return t(N,v,E)}e.multiLineString=h;function b(g,v,E){E===void 0&&(E={});var N={type:"MultiPoint",coordinates:g};return t(N,v,E)}e.multiPoint=b;function l(g,v,E){E===void 0&&(E={});var N={type:"MultiPolygon",coordinates:g};return t(N,v,E)}e.multiPolygon=l;function p(g,v,E){E===void 0&&(E={});var N={type:"GeometryCollection",geometries:g};return t(N,v,E)}e.geometryCollection=p;function _(g,v){if(v===void 0&&(v=0),v&&!(v>=0))throw new Error("precision must be a positive number");var E=Math.pow(10,v||0);return Math.round(g*E)/E}e.round=_;function w(g,v){v===void 0&&(v="kilometers");var E=e.factors[v];if(!E)throw new Error(v+" units is invalid");return g*E}e.radiansToLength=w;function A(g,v){v===void 0&&(v="kilometers");var E=e.factors[v];if(!E)throw new Error(v+" units is invalid");return g/E}e.lengthToRadians=A;function R(g,v){return m(A(g,v))}e.lengthToDegrees=R;function O(g){var v=g%360;return v<0&&(v+=360),v}e.bearingToAzimuth=O;function m(g){var v=g%(2*Math.PI);return v*180/Math.PI}e.radiansToDegrees=m;function I(g){var v=g%360;return v*Math.PI/180}e.degreesToRadians=I;function $(g,v,E){if(v===void 0&&(v="kilometers"),E===void 0&&(E="kilometers"),!(g>=0))throw new Error("length must be a positive number");return w(A(g,v),E)}e.convertLength=$;function P(g,v,E){if(v===void 0&&(v="meters"),E===void 0&&(E="kilometers"),!(g>=0))throw new Error("area must be a positive number");var N=e.areaFactors[v];if(!N)throw new Error("invalid original units");var j=e.areaFactors[E];if(!j)throw new Error("invalid final units");return g/N*j}e.convertArea=P;function C(g){return!isNaN(g)&&g!==null&&!Array.isArray(g)}e.isNumber=C;function B(g){return!!g&&g.constructor===Object}e.isObject=B;function f(g){if(!g)throw new Error("bbox is required");if(!Array.isArray(g))throw new Error("bbox must be an Array");if(g.length!==4&&g.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");g.forEach(function(v){if(!C(v))throw new Error("bbox must only contain numbers")})}e.validateBBox=f;function S(g){if(!g)throw new Error("id is required");if(["string","number"].indexOf(typeof g)===-1)throw new Error("id must be a number or a string")}e.validateId=S})(Jo);const qT=yn,lt=G,jT=Nt,zl=kT,GT=Ko.default,VT=Wl.default,Hu=Jo,Oe={...qT.modes.draw_polygon};Oe.onSetup=function(e){const t=this.newFeature({type:lt.geojsonTypes.FEATURE,properties:{isCircle:!0,center:[]},geometry:{type:lt.geojsonTypes.POLYGON,coordinates:[[]]}});return this.addFeature(t),this.clearSelectedFeatures(),jT.disable(this),zl.disable(this),this.updateUIClasses({mouse:lt.cursors.ADD}),this.activateUIButton(lt.types.POLYGON),this.setActionableState({trash:!0}),{polygon:t,currentVertexPosition:0}};Oe.onMouseDown=Oe.onTouchStart=function(e,t){e.polygon.properties.center.length===0&&(e.polygon.properties.center=[t.lngLat.lng,t.lngLat.lat])};Oe.onDrag=Oe.onMouseMove=function(e,t){const r=e.polygon.properties.center;if(r.length>0){const n=VT(Hu.point(r),Hu.point([t.lngLat.lng,t.lngLat.lat]),{units:"kilometers"}),i=GT(r,n);e.polygon.incomingCoords(i.geometry.coordinates),e.polygon.properties.radiusInKm=n}};Oe.onMouseUp=Oe.onTouchEnd=function(e,t){return zl.enable(this),this.changeMode(lt.modes.SIMPLE_SELECT,{featureIds:[e.polygon.id]})};Oe.onClick=Oe.onTap=function(e,t){e.polygon.properties.center=[]};Oe.toDisplayFeatures=function(e,t,r){const n=t.properties.id===e.polygon.id;return t.properties.active=n?lt.activeStates.ACTIVE:lt.activeStates.INACTIVE,r(t)};var WT=Oe;const zT=tn;function HT(e){const{properties:t,geometry:r}=e;if(!t.user_isCircle)return null;const n=[],i=r.coordinates[0].slice(0,-1);for(let o=0;o<i.length;o+=Math.round(i.length/4))n.push(zT(t.id,i[o],`0.${o}`,!1));return n}var Hl=HT;const KT=yn,JT=rn,YT=dn,Kr=G,ZT=zo,XT=Wl.default,Ku=Jo,QT=Ko.default,eS=Hl,gn=KT.modes.direct_select;gn.dragFeature=function(e,t,r){YT(this.getSelected(),r),this.getSelected().filter(n=>n.properties.isCircle).map(n=>n.properties.center).forEach(n=>{n[0]+=r.lng,n[1]+=r.lat}),e.dragMoveLocation=t.lngLat};gn.dragVertex=function(e,t,r){if(e.feature.properties.isCircle){const n=e.feature.properties.center,i=[t.lngLat.lng,t.lngLat.lat],o=XT(Ku.point(n),Ku.point(i),{units:"kilometers"}),a=QT(n,o);e.feature.incomingCoords(a.geometry.coordinates),e.feature.properties.radiusInKm=o}else{const n=e.selectedCoordPaths.map(a=>e.feature.getCoordinate(a)),i=n.map(a=>({type:Kr.geojsonTypes.FEATURE,properties:{},geometry:{type:Kr.geojsonTypes.POINT,coordinates:a}})),o=ZT(i,r);for(let a=0;a<n.length;a++){const c=n[a];e.feature.updateCoordinate(e.selectedCoordPaths[a],c[0]+o.lng,c[1]+o.lat)}}};gn.toDisplayFeatures=function(e,t,r){e.featureId===t.properties.id?(t.properties.active=Kr.activeStates.ACTIVE,r(t),(t.properties.user_isCircle?eS(t):JT(t,{map:this.map,midpoints:!0,selectedPaths:e.selectedCoordPaths})).forEach(r)):(t.properties.active=Kr.activeStates.INACTIVE,r(t)),this.fireActionable(e)};var tS=gn;const rS=yn,nS=rn,iS=dn,$r=G,oS=Hl,Yo=rS.modes.simple_select;Yo.dragMove=function(e,t){e.dragMoving=!0,t.originalEvent.stopPropagation();const r={lng:t.lngLat.lng-e.dragMoveLocation.lng,lat:t.lngLat.lat-e.dragMoveLocation.lat};iS(this.getSelected(),r),this.getSelected().filter(n=>n.properties.isCircle).map(n=>n.properties.center).forEach(n=>{n[0]+=r.lng,n[1]+=r.lat}),e.dragMoveLocation=t.lngLat};Yo.toDisplayFeatures=function(e,t,r){if(t.properties.active=this.isSelected(t.properties.id)?$r.activeStates.ACTIVE:$r.activeStates.INACTIVE,r(t),this.fireActionable(),t.properties.active!==$r.activeStates.ACTIVE||t.geometry.type===$r.geojsonTypes.POINT)return;(t.properties.user_isCircle?oS(t):nS(t)).forEach(r)};var aS=Yo;const sS=WT,Ze=tS,uS=aS,cS={onSetup:function(e){const t=this.newFeature({type:"Feature",properties:{isRectangle:!0},geometry:{type:"Polygon",coordinates:[[[0,0],[0,0],[0,0],[0,0],[0,0]]]}});return this.addFeature(t),this.clearSelectedFeatures(),this.updateUIClasses({mouse:"add"}),this.activateUIButton("polygon"),this.setActionableState({trash:!0}),this.map&&this.map.dragPan&&this.map.dragPan.disable(),{polygon:t,startPoint:null}},onStop:function(e){this.updateUIClasses({mouse:"none"}),this.activateUIButton(),this.setActionableState({trash:!0}),this.map&&this.map.dragPan&&this.map.dragPan.enable()},onMouseDown:function(e,t){t.originalEvent&&(t.originalEvent.preventDefault(),t.originalEvent.stopPropagation()),e.startPoint=[t.lngLat.lng,t.lngLat.lat],this.updateFeature(e,t)},onDrag:function(e,t){e.startPoint&&this.updateFeature(e,t)},onMouseUp:function(e,t){e.startPoint&&(this.updateFeature(e,t),this.map.fire("draw.create",{features:[e.polygon.toGeoJSON()]}),this.changeMode("simple_select",{featureIds:[e.polygon.id]}))},updateFeature:function(e,t){const r=e.startPoint,n=[t.lngLat.lng,t.lngLat.lat],i=Math.min(r[0],n[0]),o=Math.max(r[0],n[0]),a=Math.min(r[1],n[1]),c=Math.max(r[1],n[1]),u=[[i,c],[o,c],[o,a],[i,a],[i,c]];e.polygon.incomingCoords([u])},toDisplayFeatures:function(e,t,r){const n=t.properties.id===e.polygon.id;if(t.properties.active=n?"true":"false",!n)return r(t);t.geometry.coordinates.length!==0&&r(t)},onTrash:function(e){this.deleteFeature(e.polygon.id,{silent:!0}),this.changeMode("simple_select")}},lS={...Ze,isRectangle:function(e){return e?!!(e.properties&&(e.properties.isRectangle===!0||e.properties.isRectangle==="true")||e.geometry&&e.geometry.type==="Polygon"&&e.geometry.coordinates.length>0&&e.geometry.coordinates[0].length===5):!1},onSetup:function(e){const t=Ze.onSetup.call(this,e);return t.draggingHandle=null,t},onMouseDown:function(e,t){const r=e.featureId,n=this.getFeature(r);this.isRectangle(n),Ze.onMouseDown.call(this,e,t)},onDrag:function(e,t){const{featureId:r}=e,n=this.getFeature(r);if(!this.isRectangle(n))return Ze.onDrag.call(this,e,t);if(e.selectedCoordPaths&&e.selectedCoordPaths.length>0){const o=e.selectedCoordPaths[0].split("."),a=parseInt(o[0],10),c=parseInt(o[1],10);if(a===0&&c>=0&&c<=4){const u=n.coordinates[0],y=t.lngLat.lng,h=t.lngLat.lat,l=((c===4?0:c)+2)%4,p=u[l];if(!p)return;const _=Math.min(y,p[0]),w=Math.max(y,p[0]),A=Math.min(h,p[1]),R=Math.max(h,p[1]),O=[[_,R],[w,R],[w,A],[_,A],[_,R]];n.incomingCoords([O]);return}}Ze.onDrag.call(this,e,t)},onMouseUp:function(e,t){e.draggingHandle&&(e.draggingHandle=null,this.map.dragPan.enable(),this.fireUpdate()),Ze.onMouseUp.call(this,e,t)},fireUpdate:function(){this.map.fire("draw.update",{action:"move",features:this.getSelected().map(e=>e.toGeoJSON())})},toDisplayFeatures:function(e,t,r){const n=this.getFeature(e.featureId);if(this.isRectangle(n)){const i=o=>{o.properties.meta!=="midpoint"&&r(o)};Ze.toDisplayFeatures.call(this,e,t,i);return}Ze.toDisplayFeatures.call(this,e,t,r)}};function fS({currentMode:e,onModeChange:t,onDelete:r,canDelete:n}){const i=[{id:"simple_select",icon:ip,title:"Select (Pointer)"},{id:"add_waypoint",icon:op,title:"Add Waypoint"},{id:"draw_rectangle",icon:ap,title:"Draw Square"},{id:"draw_polygon",icon:sp,title:"Draw Polygon"},{id:"drag_circle",icon:up,title:"Draw Circle"}];return Ie.jsxs("div",{className:"absolute top-4 left-4 flex flex-col gap-2 bg-white rounded-md shadow-md p-1 z-10",children:[i.map(o=>{const a=o.icon,c=e===o.id||o.id==="simple_select"&&e==="direct_select";return Ie.jsx("button",{onClick:()=>{console.log("Switching to mode:",o.id),t(o.id)},className:`p-2 rounded hover:bg-gray-100 flex items-center justify-center ${c?"text-blue-600 bg-blue-50":"text-gray-700"}`,title:o.title,children:Ie.jsx(a,{size:20})},o.id)}),Ie.jsx("div",{className:"h-px bg-gray-200 my-1"}),Ie.jsx("button",{onClick:r,disabled:!n,className:`p-2 rounded flex items-center justify-center ${n?"text-red-600 hover:bg-red-50 cursor-pointer":"text-gray-300 cursor-not-allowed"}`,title:"Delete Selected",children:Ie.jsx(cp,{size:20})})]})}Cr.accessToken="pk.eyJ1Ijoid2F5Z2VuIiwiYSI6ImNtaThyMXF2czBmZ3QybXBvbW1hazFpamcifQ.P0D5plS_fpnx3qheQytxfQ";const pS="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`
<svg width="40" height="40" viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg">
  <path d="M20 0 L35 20 A 15 15 0 0 1 5 20 Z" fill="#3b82f6" stroke="white" stroke-width="2"/>
</svg>
`),dS="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`
<svg width="40" height="40" viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg">
  <path d="M20 0 L35 20 A 15 15 0 0 1 5 20 Z" fill="#ef4444" stroke="white" stroke-width="2"/>
</svg>
`),hS=[{id:"gl-draw-line",type:"line",filter:["all",["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3b82f6","line-width":2}},{id:"gl-draw-polygon-fill",type:"fill",filter:["all",["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#3b82f6","fill-outline-color":"#3b82f6","fill-opacity":.2}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3b82f6","line-width":2}},{id:"gl-draw-point-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":6,"circle-color":"#fff"}},{id:"gl-draw-point",type:"circle",filter:["all",["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":4,"circle-color":"#3b82f6"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","$type","Polygon"],["==","mode","static"]],paint:{"fill-color":"#000","fill-outline-color":"#000","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","$type","Polygon"],["==","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#000","line-width":2}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","resize-handle"]],paint:{"circle-radius":4,"circle-color":"#fbb03b"}}];function SS({onPolygonDrawn:e,polygon:t}){const r=oe.useRef(null),n=oe.useRef(null),i=oe.useRef(null),{waypoints:o,selectedIds:a,selectWaypoint:c,setSelectedIds:u,resetTrigger:y,settings:h,updateWaypoint:b,addWaypoint:l,setMapRef:p}=_e(),_=oe.useRef(null),[w,A]=oe.useState("simple_select"),R=oe.useRef(w);oe.useEffect(()=>{R.current=w},[w]),oe.useEffect(()=>{y>0&&i.current&&(i.current.deleteAll(),e(null))},[y,e]);const[O,m]=oe.useState(null),[I,$]=oe.useState(!1),P=oe.useRef(null);oe.useEffect(()=>{if(!i.current||!n.current)return;const f=i.current.getSelectedIds();if(f.length===0)return;const S=i.current.get(f[0]);if(!S||S.geometry.type!=="Polygon")return;const g=An(S),v=In(g,$n(S.geometry.coordinates[0][0]),{units:"meters"});if(Math.abs(v-h.orbitRadius)>1){const E=ga(g.geometry.coordinates,h.orbitRadius,{steps:64,units:"meters"});E.id=S.id,E.properties={...S.properties,isCircle:!0},i.current.add(E),e(E)}},[h.orbitRadius]);const C=f=>{if(!f||f.geometry.type!=="Polygon")return;const S=An(f),g=In(S,$n(f.geometry.coordinates[0][0]),{units:"meters"});Math.abs(g-h.orbitRadius)>1&&_e.getState().updateSettings({orbitRadius:Math.round(g)})};oe.useEffect(()=>{if(n.current)return;n.current=new Cr.Map({container:r.current,style:"mapbox://styles/mapbox/satellite-streets-v12",center:[-98,39],zoom:4,boxZoom:!1});const f=new fp({accessToken:Cr.accessToken,mapboxgl:Cr,marker:!1,collapsed:!0});n.current.addControl(f,"top-right"),p(n.current),i.current=new ya({userProperties:!0,displayControlsDefault:!1,controls:{point:!1,line:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1},styles:hS,modes:{...ya.modes,drag_circle:sS,draw_rectangle:cS,direct_select:lS,simple_select:uS}}),n.current.addControl(i.current),window.mapboxDraw=i.current,n.current.on("draw.create",x=>{const L=x.features[0];i.current.getMode()==="drag_circle"&&(i.current.setFeatureProperty(L.id,"isCircle",!0),L.properties.isCircle=!0,_e.getState().updateSettings({pathType:"orbit",spacing:10})),(L.properties.isRectangle||i.current.getMode()==="draw_rectangle")&&(i.current.setFeatureProperty(L.id,"isRectangle",!0),L.properties.isRectangle=!0);const q=An(L);if(In(q,$n(L.geometry.coordinates[0][0]),{units:"meters"})>500){const K=ga(q.geometry.coordinates,50,{steps:64,units:"meters"});K.id=L.id,K.properties={...L.properties,isCircle:!0},i.current.add(K),_e.getState().updateSettings({orbitRadius:50}),e(K)}else C(L),e(L);A("simple_select")}),n.current.on("draw.update",x=>{const L=x.features[0];C(L),e(L)}),n.current.on("draw.selectionchange",x=>{x.features.length>0?(C(x.features[0]),e(x.features[0]),$(!0)):$(!1)}),n.current.on("draw.delete",()=>e(null)),n.current.on("click",x=>{if(x.originalEvent._isDrag)return;if(R.current==="add_waypoint"){const{lng:q,lat:k}=x.lngLat;l({lng:q,lat:k});return}const L=n.current.queryRenderedFeatures(x.point,{layers:["waypoints-symbol"]});if(L.length){const q=L[0].properties.id;c(q,x.originalEvent.shiftKey)}else n.current.queryRenderedFeatures(x.point,{layers:["gl-draw-polygon-fill-static.cold","gl-draw-polygon-fill.hot"]}).length===0&&u([])});const S=x=>{if(!P.current)return;const L=P.current,q=x.point,k=Math.min(L.x,q.x),K=Math.max(L.x,q.x),M=Math.min(L.y,q.y),re=Math.max(L.y,q.y);m({left:k,top:M,width:K-k,height:re-M})},g=x=>{if(!P.current)return;const L=P.current,q=x.point;if(Math.abs(L.x-q.x)<5&&Math.abs(L.y-q.y)<5){P.current=null,m(null),n.current.dragPan.enable(),n.current.off("mousemove",S),n.current.off("mouseup",g);return}const k=[L,q],M=n.current.queryRenderedFeatures(k,{layers:["waypoints-symbol"]}).map(re=>re.properties.id);M.length>0&&u(M),P.current=null,m(null),n.current.dragPan.enable(),x.originalEvent._isDrag=!0,setTimeout(()=>{x.originalEvent&&delete x.originalEvent._isDrag},100),n.current.off("mousemove",S),n.current.off("mouseup",g)};n.current.on("mousedown",x=>{x.originalEvent.shiftKey&&(x.preventDefault(),n.current.dragPan.disable(),P.current=x.point,n.current.on("mousemove",S),n.current.on("mouseup",g))});const v=()=>{_.current||(n.current.getCanvas().style.cursor="pointer")},E=()=>{_.current||(n.current.getCanvas().style.cursor="")},N=x=>{if(i.current.getMode()!=="simple_select"&&i.current.getMode()!=="direct_select"||x.originalEvent.shiftKey||!x.originalEvent.altKey)return;x.preventDefault();const L=x.features[0];if(!L)return;n.current.dragPan.disable(),n.current.getCanvas().style.cursor="grabbing";const q=L.properties.id,k=_e.getState().waypoints,K=_e.getState().selectedIds,M=K.includes(q),re=M?K:[q],le=k.filter(te=>re.includes(te.id)).map(te=>({id:te.id,lng:te.lng,lat:te.lat}));_.current={ids:re,isMulti:M,initialWaypoints:le,startLngLat:x.lngLat},n.current.on("mousemove",j),n.current.on("mouseup",Q)},j=x=>{if(!_.current)return;const{lng:L,lat:q}=x.lngLat,{startLngLat:k,initialWaypoints:K}=_.current,M=L-k.lng,re=q-k.lat,le=n.current.getSource("waypoints"),te=n.current.getSource("mission-path"),De=_e.getState().waypoints,ze=_e.getState().selectedIds,me=De.map((be,mt)=>{const bt=K.find(vn=>vn.id===be.id);let ar=[be.lng,be.lat];return bt&&(ar=[bt.lng+M,bt.lat+re]),{type:"Feature",properties:{id:be.id,index:mt+1,selected:ze.includes(be.id),heading:be.heading||0},geometry:{type:"Point",coordinates:ar}}});if(le&&le.setData({type:"FeatureCollection",features:me}),te){const be=me.map(mt=>mt.geometry.coordinates);te.setData({type:"Feature",geometry:{type:"LineString",coordinates:be}})}},Q=x=>{if(!_.current)return;const{lng:L,lat:q}=x.lngLat,{startLngLat:k,ids:K}=_.current,M=L-k.lng,re=q-k.lat;_e.getState().moveWaypoints(K,M,re),_.current=null,n.current.dragPan.enable(),n.current.getCanvas().style.cursor="",x.originalEvent._isDrag=!0,n.current.off("mousemove",j),n.current.off("mouseup",Q)};n.current.on("mouseenter","waypoints-symbol",v),n.current.on("mouseleave","waypoints-symbol",E),n.current.on("mousedown","waypoints-symbol",N);const ge=()=>{console.log("Initializing Map Layers...");const x=(k,K)=>{if(n.current.hasImage(k))return;const M=new Image;M.src=K,M.onload=()=>{n.current.hasImage(k)||n.current.addImage(k,M)}};x("teardrop",pS),x("teardrop-selected",dS),n.current.getSource("mission-path")||n.current.addSource("mission-path",{type:"geojson",data:{type:"Feature",geometry:{type:"LineString",coordinates:[]}}}),n.current.getSource("footprints")||n.current.addSource("footprints",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),n.current.getSource("waypoints")||n.current.addSource("waypoints",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),n.current.getLayer("footprints-fill")||n.current.addLayer({id:"footprints-fill",type:"fill",source:"footprints",paint:{"fill-color":["get","color"],"fill-opacity":.15,"fill-outline-color":"rgba(0,0,0,0)"}}),n.current.getLayer("footprints-outline")||n.current.addLayer({id:"footprints-outline",type:"line",source:"footprints",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":["get","color"],"line-width":1,"line-opacity":.6}}),n.current.getLayer("mission-path-line")||n.current.addLayer({id:"mission-path-line",type:"line",source:"mission-path",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#3b82f6","line-width":3,"line-opacity":.8}}),n.current.getLayer("waypoints-symbol")||n.current.addLayer({id:"waypoints-symbol",type:"symbol",source:"waypoints",layout:{"icon-image":["case",["get","selected"],"teardrop-selected","teardrop"],"icon-size":["interpolate",["linear"],["zoom"],10,.5,15,.75,20,1],"icon-anchor":"center","icon-allow-overlap":!0,"icon-rotate":["get","heading"],"icon-rotation-alignment":"map","text-field":["to-string",["get","index"]],"text-font":["Open Sans Bold","Arial Unicode MS Bold"],"text-size":["interpolate",["linear"],["zoom"],10,9,15,11,20,13],"text-offset":[0,0],"text-anchor":"center","text-allow-overlap":!0,"text-rotation-alignment":"viewport"},paint:{"text-color":"#ffffff","text-halo-color":"#000000","text-halo-width":.5}});const L=_e.getState().waypoints,q=_e.getState().selectedIds;if(L.length>0){console.log("Initial waypoints found, updating source...",L.length);const k=L.map((M,re)=>({type:"Feature",properties:{id:M.id,index:re+1,selected:q.includes(M.id),heading:M.heading||0},geometry:{type:"Point",coordinates:[M.lng,M.lat]}}));n.current.getSource("waypoints").setData({type:"FeatureCollection",features:k});const K=L.map(M=>[M.lng,M.lat]);n.current.getSource("mission-path").setData({type:"Feature",geometry:{type:"LineString",coordinates:K}})}};n.current.loaded()?ge():n.current.on("load",ge);const Be=x=>{R.current==="add_waypoint"&&x.mode==="simple_select"||A(x.mode)};n.current.on("draw.modechange",Be);const vt=x=>{x.key==="Escape"&&(R.current!=="simple_select"?(i.current&&i.current.changeMode("simple_select"),A("simple_select")):u([]))};return window.addEventListener("keydown",vt),()=>{window.removeEventListener("keydown",vt)}},[]),oe.useEffect(()=>{if(!i.current||!n.current)return;const f=w,S=i.current.getMode();if(f==="add_waypoint")S!=="simple_select"&&i.current.changeMode("simple_select"),n.current.getCanvas().style.cursor="crosshair";else{if(S!==f)try{i.current.changeMode(f)}catch(g){console.warn("Failed to switch mode:",g)}n.current.getCanvas().style.cursor=""}},[w]),oe.useEffect(()=>{!n.current||!n.current.getLayer("waypoints-symbol")||(n.current.setLayoutProperty("waypoints-symbol","text-offset",[0,0]),n.current.setLayoutProperty("waypoints-symbol","text-anchor","center"),n.current.setLayoutProperty("waypoints-symbol","icon-anchor","center"),n.current.setLayoutProperty("waypoints-symbol","text-rotation-alignment","viewport"))},[]),oe.useEffect(()=>{if(!n.current||!n.current)return;const f=n.current.getSource("waypoints"),S=n.current.getSource("mission-path");if(f){const g=o.map((v,E)=>({type:"Feature",properties:{id:v.id,index:E+1,selected:a.includes(v.id),heading:v.heading||0},geometry:{type:"Point",coordinates:[v.lng,v.lat]}}));f.setData({type:"FeatureCollection",features:g})}if(S){const g=o.map(v=>[v.lng,v.lat]);S.setData({type:"Feature",geometry:{type:"LineString",coordinates:g}})}},[o,a]),oe.useEffect(()=>{if(!n.current||!n.current.getSource("footprints"))return;if(!h.showFootprints){n.current.getSource("footprints").setData({type:"FeatureCollection",features:[]});return}const f=o.map((S,g)=>{const v=S.heading||0;return{...np({lng:S.lng,lat:S.lat},h.altitude,v,h.customFOV),properties:{index:g+1,color:h.footprintColor}}}).filter(S=>S!==null);n.current.getSource("footprints").setData({type:"FeatureCollection",features:f})},[o,h.showFootprints,h.altitude,h.customFOV,h.footprintColor]),oe.useEffect(()=>{h.orbitRadius>500&&_e.getState().updateSettings({orbitRadius:50})},[]);const B=()=>{i.current&&(i.current.trash(),e(null),$(!1))};return oe.useEffect(()=>{if(!i.current||!n.current)return;if(!t){i.current.getAll().features.length>0&&i.current.deleteAll();return}if(!i.current.getAll().features.some(g=>g.id===t.id)){console.log("Syncing polygon from prop:",t),i.current.deleteAll(),i.current.add(t);try{const g=bp(t);n.current.fitBounds(g,{padding:100})}catch(g){console.warn("Could not fit bounds:",g)}}},[t]),Ie.jsxs("div",{className:`relative w-full h-full ${w==="add_waypoint"?"force-crosshair":""}`,children:[Ie.jsx("style",{children:`
        .force-crosshair .mapboxgl-canvas-container {
          cursor: crosshair !important;
        }
        .force-crosshair .mapboxgl-canvas {
          cursor: crosshair !important;
        }
      `}),Ie.jsx("div",{ref:r,className:"w-full h-full"}),O&&Ie.jsx("div",{style:{position:"absolute",left:O.left,top:O.top,width:O.width,height:O.height,border:"2px solid #3b82f6",backgroundColor:"rgba(59, 130, 246, 0.2)",pointerEvents:"none",zIndex:20}}),Ie.jsx(fS,{currentMode:w,onModeChange:A,onDelete:B,canDelete:I})]})}export{SS as default};
