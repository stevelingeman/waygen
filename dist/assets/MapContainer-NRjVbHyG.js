import{j as te,u as ge,c as zf}from"./index-P0lmqIAM.js";import{i as Hf,j as Kf,k as Jf,H as Yf,l as Zf,T as Xf,r as ee,m as Qf,M as ep,n as tp}from"./vendor-DRMOV0oM.js";import{b as rp,i as go,d as Ku,g as vo,m as vr,M as np,e as ca}from"./mapbox-C3udIXGP.js";import{k as V,s as tt,n as Lr,o as ht,q as je,r as q,_ as yt,u as gt,v as mo,w as Z,x as rt,y as vt,z as Ju,A as Le,B as ip,C as Yu,D as op,E as Zu,F as ap,G as Xu,H as Vt,I as Qu,J as ec,K as sp,L as tc,M as up,N as cp,O as lp,e as cn,b as ln,p as fn,P as la,f as fp}from"./turf-D8sFHwPo.js";import{c as pp}from"./utils-P9aiU5u9.js";/* empty css                           */var bo={exports:{}};const dp=function(t,e){const r={drag:[],click:[],mousemove:[],mousedown:[],mouseup:[],mouseout:[],keydown:[],keyup:[],touchstart:[],touchmove:[],touchend:[],tap:[]},n={on:function(o,a,u){if(r[o]===void 0)throw new Error(`Invalid event type: ${o}`);r[o].push({selector:a,fn:u})},render:function(o){e.store.featureChanged(o)}},i=function(o,a){const u=r[o];let s=u.length;for(;s--;){const p=u[s];if(p.selector(a)){p.fn.call(n,a),e.store.render(),e.ui.updateMapClasses();break}}};return t.start.call(n),{render:t.render,stop:function(){t.stop&&t.stop()},trash:function(){t.trash&&(t.trash(),e.store.render())},combineFeatures:function(){t.combineFeatures&&t.combineFeatures()},uncombineFeatures:function(){t.uncombineFeatures&&t.uncombineFeatures()},drag:function(o){i("drag",o)},click:function(o){i("click",o)},mousemove:function(o){i("mousemove",o)},mousedown:function(o){i("mousedown",o)},mouseup:function(o){i("mouseup",o)},mouseout:function(o){i("mouseout",o)},keydown:function(o){i("keydown",o)},keyup:function(o){i("keyup",o)},touchstart:function(o){i("touchstart",o)},touchmove:function(o){i("touchmove",o)},touchend:function(o){i("touchend",o)},tap:function(o){i("tap",o)}}};var hp=dp,G={classes:{CONTROL_BASE:"mapboxgl-ctrl",CONTROL_BUTTON:"mapbox-gl-draw_ctrl-draw-btn",CONTROL_BUTTON_LINE:"mapbox-gl-draw_line",CONTROL_BUTTON_POLYGON:"mapbox-gl-draw_polygon",CONTROL_BUTTON_POINT:"mapbox-gl-draw_point",CONTROL_BUTTON_TRASH:"mapbox-gl-draw_trash",CONTROL_BUTTON_COMBINE_FEATURES:"mapbox-gl-draw_combine",CONTROL_BUTTON_UNCOMBINE_FEATURES:"mapbox-gl-draw_uncombine",CONTROL_GROUP:"mapboxgl-ctrl-group",ACTIVE_BUTTON:"active",BOX_SELECT:"mapbox-gl-draw_boxselect"},sources:{HOT:"mapbox-gl-draw-hot",COLD:"mapbox-gl-draw-cold"},cursors:{ADD:"add",MOVE:"move",DRAG:"drag",POINTER:"pointer",NONE:"none"},types:{POLYGON:"polygon",LINE:"line_string",POINT:"point"},geojsonTypes:{FEATURE:"Feature",POLYGON:"Polygon",LINE_STRING:"LineString",POINT:"Point",FEATURE_COLLECTION:"FeatureCollection",MULTI_PREFIX:"Multi",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon"},modes:{DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select",STATIC:"static"},events:{CREATE:"draw.create",DELETE:"draw.delete",UPDATE:"draw.update",SELECTION_CHANGE:"draw.selectionchange",MODE_CHANGE:"draw.modechange",ACTIONABLE:"draw.actionable",RENDER:"draw.render",COMBINE_FEATURES:"draw.combine",UNCOMBINE_FEATURES:"draw.uncombine"},updateActions:{MOVE:"move",CHANGE_COORDINATES:"change_coordinates"},meta:{FEATURE:"feature",MIDPOINT:"midpoint",VERTEX:"vertex"},activeStates:{ACTIVE:"true",INACTIVE:"false"},interactions:["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate"],LAT_MIN:-90,LAT_RENDERED_MIN:-85,LAT_MAX:90,LAT_RENDERED_MAX:85,LNG_MIN:-270,LNG_MAX:270};const yp=rp,Ji=G,fa={Point:0,LineString:1,Polygon:2};function gp(t,e){const r=fa[t.geometry.type]-fa[e.geometry.type];return r===0&&t.geometry.type===Ji.geojsonTypes.POLYGON?t.area-e.area:r}function vp(t){return t.map(e=>(e.geometry.type===Ji.geojsonTypes.POLYGON&&(e.area=yp.geometry({type:Ji.geojsonTypes.FEATURE,property:{},geometry:e.geometry})),e)).sort(gp).map(e=>(delete e.area,e))}var mp=vp;function bp(t,e=0){return[[t.point.x-e,t.point.y-e],[t.point.x+e,t.point.y+e]]}var Tp=bp;function mt(t){if(this._items={},this._nums={},this._length=t?t.length:0,!!t)for(let e=0,r=t.length;e<r;e++)this.add(t[e]),t[e]!==void 0&&(typeof t[e]=="string"?this._items[t[e]]=e:this._nums[t[e]]=e)}mt.prototype.add=function(t){return this.has(t)?this:(this._length++,typeof t=="string"?this._items[t]=this._length:this._nums[t]=this._length,this)};mt.prototype.delete=function(t){return this.has(t)===!1?this:(this._length--,delete this._items[t],delete this._nums[t],this)};mt.prototype.has=function(t){return typeof t!="string"&&typeof t!="number"?!1:this._items[t]!==void 0||this._nums[t]!==void 0};mt.prototype.values=function(){const t=[];return Object.keys(this._items).forEach(e=>{t.push({k:e,v:this._items[e]})}),Object.keys(this._nums).forEach(e=>{t.push({k:JSON.parse(e),v:this._nums[e]})}),t.sort((e,r)=>e.v-r.v).map(e=>e.k)};mt.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this};var xr=mt;const _p=mp,Sp=Tp,pn=G,Ep=xr,wp=[pn.meta.FEATURE,pn.meta.MIDPOINT,pn.meta.VERTEX];var Nr={click:Ap,touch:Ip};function Ap(t,e,r){return rc(t,e,r,r.options.clickBuffer)}function Ip(t,e,r){return rc(t,e,r,r.options.touchBuffer)}function rc(t,e,r,n){if(r.map===null)return[];const i=t?Sp(t,n):e,o={};r.options.styles&&(o.layers=r.options.styles.map(p=>p.id));const a=r.map.queryRenderedFeatures(i,o).filter(p=>wp.indexOf(p.properties.meta)!==-1),u=new Ep,s=[];return a.forEach(p=>{const d=p.properties.id;u.has(d)||(u.add(d),s.push(p))}),_p(s)}const Cp=Nr,Nt=G;var $p=function(e,r){const n=Cp.click(e,null,r),i={mouse:Nt.cursors.NONE};return n[0]&&(i.mouse=n[0].properties.active===Nt.activeStates.ACTIVE?Nt.cursors.MOVE:Nt.cursors.POINTER,i.feature=n[0].properties.meta),r.events.currentModeName().indexOf("draw")!==-1&&(i.mouse=Nt.cursors.ADD),r.ui.queueMapClasses(i),r.ui.updateMapClasses(),n[0]},nc=function(t,e){const r=t.x-e.x,n=t.y-e.y;return Math.sqrt(r*r+n*n)};const Op=nc,Pp=4,Fp=12,Mp=500;var Rp=function(e,r,n={}){const i=n.fineTolerance!=null?n.fineTolerance:Pp,o=n.grossTolerance!=null?n.grossTolerance:Fp,a=n.interval!=null?n.interval:Mp;e.point=e.point||r.point,e.time=e.time||r.time;const u=Op(e.point,r.point);return u<i||u<o&&r.time-e.time<a};const Lp=nc,xp=25,Np=250;var Bp=function(e,r,n={}){const i=n.tolerance!=null?n.tolerance:xp,o=n.interval!=null?n.interval:Np;return e.point=e.point||r.point,e.time=e.time||r.time,Lp(e.point,r.point)<i&&r.time-e.time<o},ic={exports:{}},oc={exports:{}},ac={exports:{}},Yi=ac.exports=function(t,e){if(e||(e=16),t===void 0&&(t=128),t<=0)return"0";for(var r=Math.log(Math.pow(2,t))/Math.log(e),n=2;r===1/0;n*=2)r=Math.log(Math.pow(2,t/n))/Math.log(e)*n;for(var i=r-Math.floor(r),o="",n=0;n<Math.floor(r);n++){var a=Math.floor(Math.random()*e).toString(e);o=a+o}if(i){var u=Math.pow(e,i),a=Math.floor(Math.random()*u).toString(e);o=a+o}var s=parseInt(o,e);return s!==1/0&&s>=Math.pow(2,t)?Yi(t,e):o};Yi.rack=function(t,e,r){var n=function(o){var a=0;do{if(a++>10)if(r)t+=r;else throw new Error("too many ID collisions, use more bits");var u=Yi(t,e)}while(Object.hasOwnProperty.call(i,u));return i[u]=o,u},i=n.hats={};return n.get=function(o){return n.hats[o]},n.set=function(o,a){return n.hats[o]=a,n},n.bits=t||128,n.base=e||16,n};var To=ac.exports;const Dp=To,mr=G,Ge=function(t,e){this.ctx=t,this.properties=e.properties||{},this.coordinates=e.geometry.coordinates,this.id=e.id||Dp(),this.type=e.geometry.type};Ge.prototype.changed=function(){this.ctx.store.featureChanged(this.id)};Ge.prototype.incomingCoords=function(t){this.setCoordinates(t)};Ge.prototype.setCoordinates=function(t){this.coordinates=t,this.changed()};Ge.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.coordinates))};Ge.prototype.setProperty=function(t,e){this.properties[t]=e};Ge.prototype.toGeoJSON=function(){return JSON.parse(JSON.stringify({id:this.id,type:mr.geojsonTypes.FEATURE,properties:this.properties,geometry:{coordinates:this.getCoordinates(),type:this.type}}))};Ge.prototype.internal=function(t){const e={id:this.id,meta:mr.meta.FEATURE,"meta:type":this.type,active:mr.activeStates.INACTIVE,mode:t};if(this.ctx.options.userProperties)for(const r in this.properties)e[`user_${r}`]=this.properties[r];return{type:mr.geojsonTypes.FEATURE,properties:e,geometry:{coordinates:this.getCoordinates(),type:this.type}}};var Br=Ge;const sc=Br,Wt=function(t,e){sc.call(this,t,e)};Wt.prototype=Object.create(sc.prototype);Wt.prototype.isValid=function(){return typeof this.coordinates[0]=="number"&&typeof this.coordinates[1]=="number"};Wt.prototype.updateCoordinate=function(t,e,r){arguments.length===3?this.coordinates=[e,r]:this.coordinates=[t,e],this.changed()};Wt.prototype.getCoordinate=function(){return this.getCoordinates()};var _o=Wt;const uc=Br,nt=function(t,e){uc.call(this,t,e)};nt.prototype=Object.create(uc.prototype);nt.prototype.isValid=function(){return this.coordinates.length>1};nt.prototype.addCoordinate=function(t,e,r){this.changed();const n=parseInt(t,10);this.coordinates.splice(n,0,[e,r])};nt.prototype.getCoordinate=function(t){const e=parseInt(t,10);return JSON.parse(JSON.stringify(this.coordinates[e]))};nt.prototype.removeCoordinate=function(t){this.changed(),this.coordinates.splice(parseInt(t,10),1)};nt.prototype.updateCoordinate=function(t,e,r){const n=parseInt(t,10);this.coordinates[n]=[e,r],this.changed()};var So=nt;const cc=Br,$e=function(t,e){cc.call(this,t,e),this.coordinates=this.coordinates.map(r=>r.slice(0,-1))};$e.prototype=Object.create(cc.prototype);$e.prototype.isValid=function(){return this.coordinates.length===0?!1:this.coordinates.every(t=>t.length>2)};$e.prototype.incomingCoords=function(t){this.coordinates=t.map(e=>e.slice(0,-1)),this.changed()};$e.prototype.setCoordinates=function(t){this.coordinates=t,this.changed()};$e.prototype.addCoordinate=function(t,e,r){this.changed();const n=t.split(".").map(o=>parseInt(o,10));this.coordinates[n[0]].splice(n[1],0,[e,r])};$e.prototype.removeCoordinate=function(t){this.changed();const e=t.split(".").map(n=>parseInt(n,10)),r=this.coordinates[e[0]];r&&(r.splice(e[1],1),r.length<3&&this.coordinates.splice(e[0],1))};$e.prototype.getCoordinate=function(t){const e=t.split(".").map(n=>parseInt(n,10)),r=this.coordinates[e[0]];return JSON.parse(JSON.stringify(r[e[1]]))};$e.prototype.getCoordinates=function(){return this.coordinates.map(t=>t.concat([t[0]]))};$e.prototype.updateCoordinate=function(t,e,r){this.changed();const n=t.split("."),i=parseInt(n[0],10),o=parseInt(n[1],10);this.coordinates[i]===void 0&&(this.coordinates[i]=[]),this.coordinates[i][o]=[e,r]};var Eo=$e;const lc=Br,fc=G,Up=To,kp={MultiPoint:_o,MultiLineString:So,MultiPolygon:Eo},Dr=(t,e,r,n,i)=>{const o=r.split("."),a=parseInt(o[0],10),u=o[1]?o.slice(1).join("."):null;return t[a][e](u,n,i)},Ee=function(t,e){if(lc.call(this,t,e),delete this.coordinates,this.model=kp[e.geometry.type],this.model===void 0)throw new TypeError(`${e.geometry.type} is not a valid type`);this.features=this._coordinatesToFeatures(e.geometry.coordinates)};Ee.prototype=Object.create(lc.prototype);Ee.prototype._coordinatesToFeatures=function(t){const e=this.model.bind(this);return t.map(r=>new e(this.ctx,{id:Up(),type:fc.geojsonTypes.FEATURE,properties:{},geometry:{coordinates:r,type:this.type.replace("Multi","")}}))};Ee.prototype.isValid=function(){return this.features.every(t=>t.isValid())};Ee.prototype.setCoordinates=function(t){this.features=this._coordinatesToFeatures(t),this.changed()};Ee.prototype.getCoordinate=function(t){return Dr(this.features,"getCoordinate",t)};Ee.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.features.map(t=>t.type===fc.geojsonTypes.POLYGON?t.getCoordinates():t.coordinates)))};Ee.prototype.updateCoordinate=function(t,e,r){Dr(this.features,"updateCoordinate",t,e,r),this.changed()};Ee.prototype.addCoordinate=function(t,e,r){Dr(this.features,"addCoordinate",t,e,r),this.changed()};Ee.prototype.removeCoordinate=function(t){Dr(this.features,"removeCoordinate",t),this.changed()};Ee.prototype.getFeatures=function(){return this.features};var br=Ee;const ft=G,qp=Nr,pc=_o,dc=So,hc=Eo,yc=br,re=oc.exports=function(t){this.map=t.map,this.drawConfig=JSON.parse(JSON.stringify(t.options||{})),this._ctx=t};re.prototype.setSelected=function(t){return this._ctx.store.setSelected(t)};re.prototype.setSelectedCoordinates=function(t){this._ctx.store.setSelectedCoordinates(t),t.reduce((e,r)=>(e[r.feature_id]===void 0&&(e[r.feature_id]=!0,this._ctx.store.get(r.feature_id).changed()),e),{})};re.prototype.getSelected=function(){return this._ctx.store.getSelected()};re.prototype.getSelectedIds=function(){return this._ctx.store.getSelectedIds()};re.prototype.isSelected=function(t){return this._ctx.store.isSelected(t)};re.prototype.getFeature=function(t){return this._ctx.store.get(t)};re.prototype.select=function(t){return this._ctx.store.select(t)};re.prototype.deselect=function(t){return this._ctx.store.deselect(t)};re.prototype.deleteFeature=function(t,e={}){return this._ctx.store.delete(t,e)};re.prototype.addFeature=function(t){return this._ctx.store.add(t)};re.prototype.clearSelectedFeatures=function(){return this._ctx.store.clearSelected()};re.prototype.clearSelectedCoordinates=function(){return this._ctx.store.clearSelectedCoordinates()};re.prototype.setActionableState=function(t={}){const e={trash:t.trash||!1,combineFeatures:t.combineFeatures||!1,uncombineFeatures:t.uncombineFeatures||!1};return this._ctx.events.actionable(e)};re.prototype.changeMode=function(t,e={},r={}){return this._ctx.events.changeMode(t,e,r)};re.prototype.updateUIClasses=function(t){return this._ctx.ui.queueMapClasses(t)};re.prototype.activateUIButton=function(t){return this._ctx.ui.setActiveButton(t)};re.prototype.featuresAt=function(t,e,r="click"){if(r!=="click"&&r!=="touch")throw new Error("invalid buffer type");return qp[r](t,e,this._ctx)};re.prototype.newFeature=function(t){const e=t.geometry.type;return e===ft.geojsonTypes.POINT?new pc(this._ctx,t):e===ft.geojsonTypes.LINE_STRING?new dc(this._ctx,t):e===ft.geojsonTypes.POLYGON?new hc(this._ctx,t):new yc(this._ctx,t)};re.prototype.isInstanceOf=function(t,e){if(t===ft.geojsonTypes.POINT)return e instanceof pc;if(t===ft.geojsonTypes.LINE_STRING)return e instanceof dc;if(t===ft.geojsonTypes.POLYGON)return e instanceof hc;if(t==="MultiFeature")return e instanceof yc;throw new Error(`Unknown feature class: ${t}`)};re.prototype.doRender=function(t){return this._ctx.store.featureChanged(t)};var jp=oc.exports;const oe=ic.exports=jp;oe.prototype.onSetup=function(){};oe.prototype.onDrag=function(){};oe.prototype.onClick=function(){};oe.prototype.onMouseMove=function(){};oe.prototype.onMouseDown=function(){};oe.prototype.onMouseUp=function(){};oe.prototype.onMouseOut=function(){};oe.prototype.onKeyUp=function(){};oe.prototype.onKeyDown=function(){};oe.prototype.onTouchStart=function(){};oe.prototype.onTouchMove=function(){};oe.prototype.onTouchEnd=function(){};oe.prototype.onTap=function(){};oe.prototype.onStop=function(){};oe.prototype.onTrash=function(){};oe.prototype.onCombineFeature=function(){};oe.prototype.onUncombineFeature=function(){};oe.prototype.toDisplayFeatures=function(){throw new Error("You must overwrite toDisplayFeatures")};var Gp=ic.exports;const Vp=Gp,gc={drag:"onDrag",click:"onClick",mousemove:"onMouseMove",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseout:"onMouseOut",keyup:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",tap:"onTap"},Wp=Object.keys(gc);var zp=function(t){const e=Object.keys(t);return function(r,n={}){let i={};const o=e.reduce((u,s)=>(u[s]=t[s],u),new Vp(r));function a(u){return function(s){o[u](i,s)}}return{start:function(){i=o.onSetup(n),Wp.forEach(u=>{const s=gc[u];let p=()=>!1;t[s]&&(p=()=>!0),this.on(u,p,a(s))})},stop:function(){o.onStop(i)},trash:function(){o.onTrash(i)},combineFeatures:function(){o.onCombineFeatures(i)},uncombineFeatures:function(){o.onUncombineFeatures(i)},render:function(u,s){o.toDisplayFeatures(i,u,s)}}}};const pa=hp,dn=$p,da=Nr,ha=Rp,ya=Bp,st=G,Hp=zp;var Kp=function(t){const e=Object.keys(t.options.modes).reduce((f,c)=>(f[c]=Hp(t.options.modes[c]),f),{});let r={},n={};const i={};let o=null,a=null;i.drag=function(f,c){c({point:f.point,time:new Date().getTime()})?(t.ui.queueMapClasses({mouse:st.cursors.DRAG}),a.drag(f)):f.originalEvent.stopPropagation()},i.mousedrag=function(f){i.drag(f,c=>!ha(r,c))},i.touchdrag=function(f){i.drag(f,c=>!ya(n,c))},i.mousemove=function(f){if((f.originalEvent.buttons!==void 0?f.originalEvent.buttons:f.originalEvent.which)===1)return i.mousedrag(f);const g=dn(f,t);f.featureTarget=g,a.mousemove(f)},i.mousedown=function(f){r={time:new Date().getTime(),point:f.point};const c=dn(f,t);f.featureTarget=c,a.mousedown(f)},i.mouseup=function(f){const c=dn(f,t);f.featureTarget=c,ha(r,{point:f.point,time:new Date().getTime()})?a.click(f):a.mouseup(f)},i.mouseout=function(f){a.mouseout(f)},i.touchstart=function(f){if(f.originalEvent.preventDefault(),!t.options.touchEnabled)return;n={time:new Date().getTime(),point:f.point};const c=da.touch(f,null,t)[0];f.featureTarget=c,a.touchstart(f)},i.touchmove=function(f){if(f.originalEvent.preventDefault(),!!t.options.touchEnabled)return a.touchmove(f),i.touchdrag(f)},i.touchend=function(f){if(f.originalEvent.preventDefault(),!t.options.touchEnabled)return;const c=da.touch(f,null,t)[0];f.featureTarget=c,ya(n,{time:new Date().getTime(),point:f.point})?a.tap(f):a.touchend(f)};const u=f=>!(f===8||f===46||f>=48&&f<=57);i.keydown=function(f){(f.srcElement||f.target).classList[0]==="mapboxgl-canvas"&&((f.keyCode===8||f.keyCode===46)&&t.options.controls.trash?(f.preventDefault(),a.trash()):u(f.keyCode)?a.keydown(f):f.keyCode===49&&t.options.controls.point?s(st.modes.DRAW_POINT):f.keyCode===50&&t.options.controls.line_string?s(st.modes.DRAW_LINE_STRING):f.keyCode===51&&t.options.controls.polygon&&s(st.modes.DRAW_POLYGON))},i.keyup=function(f){u(f.keyCode)&&a.keyup(f)},i.zoomend=function(){t.store.changeZoom()},i.data=function(f){if(f.dataType==="style"){const{setup:c,map:g,options:_,store:w}=t;_.styles.some(O=>g.getLayer(O.id))||(c.addLayers(),w.setDirty(),w.render())}};function s(f,c,g={}){a.stop();const _=e[f];if(_===void 0)throw new Error(`${f} is not valid`);o=f;const w=_(t,c);a=pa(w,t),g.silent||t.map.fire(st.events.MODE_CHANGE,{mode:f}),t.store.setDirty(),t.store.render()}const p={trash:!1,combineFeatures:!1,uncombineFeatures:!1};function d(f){let c=!1;Object.keys(f).forEach(g=>{if(p[g]===void 0)throw new Error("Invalid action type");p[g]!==f[g]&&(c=!0),p[g]=f[g]}),c&&t.map.fire(st.events.ACTIONABLE,{actions:p})}return{start:function(){o=t.options.defaultMode,a=pa(e[o](t),t)},changeMode:s,actionable:d,currentModeName:function(){return o},currentModeRender:function(f,c){return a.render(f,c)},fire:function(f,c){i[f]&&i[f](c)},addEventListeners:function(){t.map.on("mousemove",i.mousemove),t.map.on("mousedown",i.mousedown),t.map.on("mouseup",i.mouseup),t.map.on("data",i.data),t.map.on("touchmove",i.touchmove),t.map.on("touchstart",i.touchstart),t.map.on("touchend",i.touchend),t.container.addEventListener("mouseout",i.mouseout),t.options.keybindings&&(t.container.addEventListener("keydown",i.keydown),t.container.addEventListener("keyup",i.keyup))},removeEventListeners:function(){t.map.off("mousemove",i.mousemove),t.map.off("mousedown",i.mousedown),t.map.off("mouseup",i.mouseup),t.map.off("data",i.data),t.map.off("touchmove",i.touchmove),t.map.off("touchstart",i.touchstart),t.map.off("touchend",i.touchend),t.container.removeEventListener("mouseout",i.mouseout),t.options.keybindings&&(t.container.removeEventListener("keydown",i.keydown),t.container.removeEventListener("keyup",i.keyup))},trash:function(f){a.trash(f)},combineFeatures:function(){a.combineFeatures()},uncombineFeatures:function(){a.uncombineFeatures()},getMode:function(){return o}}},vc={exports:{}};function Jp(t,e,r){let n,i;function o(){n=!1,i&&(a.apply(r,i),i=!1)}function a(){n?i=arguments:(n=!0,t.apply(r,arguments),setTimeout(o,e))}return a}var Yp=Jp;function Zp(t){return[].concat(t).filter(e=>e!==void 0)}var Xp=Zp;const Ie=G;var Qp=function(){const e=this;if(!(e.ctx.map&&e.ctx.map.getSource(Ie.sources.HOT)!==void 0))return p();const n=e.ctx.events.currentModeName();e.ctx.ui.queueMapClasses({mode:n});let i=[],o=[];e.isDirty?o=e.getAllIds():(i=e.getChangedIds().filter(d=>e.get(d)!==void 0),o=e.sources.hot.filter(d=>d.properties.id&&i.indexOf(d.properties.id)===-1&&e.get(d.properties.id)!==void 0).map(d=>d.properties.id)),e.sources.hot=[];const a=e.sources.cold.length;e.sources.cold=e.isDirty?[]:e.sources.cold.filter(d=>{const v=d.properties.id||d.properties.parent;return i.indexOf(v)===-1});const u=a!==e.sources.cold.length||o.length>0;i.forEach(d=>s(d,"hot")),o.forEach(d=>s(d,"cold"));function s(d,v){const c=e.get(d).internal(n);e.ctx.events.currentModeRender(c,g=>{e.sources[v].push(g)})}if(u&&e.ctx.map.getSource(Ie.sources.COLD).setData({type:Ie.geojsonTypes.FEATURE_COLLECTION,features:e.sources.cold}),e.ctx.map.getSource(Ie.sources.HOT).setData({type:Ie.geojsonTypes.FEATURE_COLLECTION,features:e.sources.hot}),e._emitSelectionChange&&(e.ctx.map.fire(Ie.events.SELECTION_CHANGE,{features:e.getSelected().map(d=>d.toGeoJSON()),points:e.getSelectedCoordinates().map(d=>({type:Ie.geojsonTypes.FEATURE,properties:{},geometry:{type:Ie.geojsonTypes.POINT,coordinates:d.coordinates}}))}),e._emitSelectionChange=!1),e._deletedFeaturesToEmit.length){const d=e._deletedFeaturesToEmit.map(v=>v.toGeoJSON());e._deletedFeaturesToEmit=[],e.ctx.map.fire(Ie.events.DELETE,{features:d})}p(),e.ctx.map.fire(Ie.events.RENDER,{});function p(){e.isDirty=!1,e.clearChangedIds()}};const ed=Yp,Ur=Xp,hn=xr,td=Qp,rd=G.interactions,K=vc.exports=function(t){this._features={},this._featureIds=new hn,this._selectedFeatureIds=new hn,this._selectedCoordinates=[],this._changedFeatureIds=new hn,this._deletedFeaturesToEmit=[],this._emitSelectionChange=!1,this._mapInitialConfig={},this.ctx=t,this.sources={hot:[],cold:[]},this.render=ed(td,16,this),this.isDirty=!1};K.prototype.createRenderBatch=function(){const t=this.render;let e=0;return this.render=function(){e++},()=>{this.render=t,e>0&&this.render()}};K.prototype.setDirty=function(){return this.isDirty=!0,this};K.prototype.featureChanged=function(t){return this._changedFeatureIds.add(t),this};K.prototype.getChangedIds=function(){return this._changedFeatureIds.values()};K.prototype.clearChangedIds=function(){return this._changedFeatureIds.clear(),this};K.prototype.getAllIds=function(){return this._featureIds.values()};K.prototype.add=function(t){return this.featureChanged(t.id),this._features[t.id]=t,this._featureIds.add(t.id),this};K.prototype.delete=function(t,e={}){return Ur(t).forEach(r=>{this._featureIds.has(r)&&(this._featureIds.delete(r),this._selectedFeatureIds.delete(r),e.silent||this._deletedFeaturesToEmit.indexOf(this._features[r])===-1&&this._deletedFeaturesToEmit.push(this._features[r]),delete this._features[r],this.isDirty=!0)}),mc.call(this,e),this};K.prototype.get=function(t){return this._features[t]};K.prototype.getAll=function(){return Object.keys(this._features).map(t=>this._features[t])};K.prototype.select=function(t,e={}){return Ur(t).forEach(r=>{this._selectedFeatureIds.has(r)||(this._selectedFeatureIds.add(r),this._changedFeatureIds.add(r),e.silent||(this._emitSelectionChange=!0))}),this};K.prototype.deselect=function(t,e={}){return Ur(t).forEach(r=>{this._selectedFeatureIds.has(r)&&(this._selectedFeatureIds.delete(r),this._changedFeatureIds.add(r),e.silent||(this._emitSelectionChange=!0))}),mc.call(this,e),this};K.prototype.clearSelected=function(t={}){return this.deselect(this._selectedFeatureIds.values(),{silent:t.silent}),this};K.prototype.setSelected=function(t,e={}){return t=Ur(t),this.deselect(this._selectedFeatureIds.values().filter(r=>t.indexOf(r)===-1),{silent:e.silent}),this.select(t.filter(r=>!this._selectedFeatureIds.has(r)),{silent:e.silent}),this};K.prototype.setSelectedCoordinates=function(t){return this._selectedCoordinates=t,this._emitSelectionChange=!0,this};K.prototype.clearSelectedCoordinates=function(){return this._selectedCoordinates=[],this._emitSelectionChange=!0,this};K.prototype.getSelectedIds=function(){return this._selectedFeatureIds.values()};K.prototype.getSelected=function(){return this._selectedFeatureIds.values().map(t=>this.get(t))};K.prototype.getSelectedCoordinates=function(){return this._selectedCoordinates.map(e=>({coordinates:this.get(e.feature_id).getCoordinate(e.coord_path)}))};K.prototype.isSelected=function(t){return this._selectedFeatureIds.has(t)};K.prototype.setFeatureProperty=function(t,e,r){this.get(t).setProperty(e,r),this.featureChanged(t)};function mc(t){const e=this._selectedCoordinates.filter(r=>this._selectedFeatureIds.has(r.feature_id));this._selectedCoordinates.length!==e.length&&!t.silent&&(this._emitSelectionChange=!0),this._selectedCoordinates=e}K.prototype.storeMapConfig=function(){rd.forEach(t=>{this.ctx.map[t]&&(this._mapInitialConfig[t]=this.ctx.map[t].isEnabled())})};K.prototype.restoreMapConfig=function(){Object.keys(this._mapInitialConfig).forEach(t=>{this._mapInitialConfig[t]?this.ctx.map[t].enable():this.ctx.map[t].disable()})};K.prototype.getInitialConfigValue=function(t){return this._mapInitialConfig[t]!==void 0?this._mapInitialConfig[t]:!0};var nd=vc.exports;const ga=go,Y=G,id=["mode","feature","mouse"];var od=function(t){const e={};let r=null,n={mode:null,feature:null,mouse:null},i={mode:null,feature:null,mouse:null};function o(){a({mode:null,feature:null,mouse:null}),u()}function a(c){i=ga(i,c)}function u(){if(!t.container)return;const c=[],g=[];id.forEach(_=>{i[_]!==n[_]&&(c.push(`${_}-${n[_]}`),i[_]!==null&&g.push(`${_}-${i[_]}`))}),c.length>0&&t.container.classList.remove.apply(t.container.classList,c),g.length>0&&t.container.classList.add.apply(t.container.classList,g),n=ga(n,i)}function s(c,g={}){const _=document.createElement("button");return _.className=`${Y.classes.CONTROL_BUTTON} ${g.className}`,_.setAttribute("title",g.title),g.container.appendChild(_),_.addEventListener("click",w=>{if(w.preventDefault(),w.stopPropagation(),w.target===r){p();return}d(c),g.onActivate()},!0),_}function p(){r&&(r.classList.remove(Y.classes.ACTIVE_BUTTON),r=null)}function d(c){p();const g=e[c];g&&g&&c!=="trash"&&(g.classList.add(Y.classes.ACTIVE_BUTTON),r=g)}function v(){const c=t.options.controls,g=document.createElement("div");return g.className=`${Y.classes.CONTROL_GROUP} ${Y.classes.CONTROL_BASE}`,c&&(c[Y.types.LINE]&&(e[Y.types.LINE]=s(Y.types.LINE,{container:g,className:Y.classes.CONTROL_BUTTON_LINE,title:`LineString tool ${t.options.keybindings?"(l)":""}`,onActivate:()=>t.events.changeMode(Y.modes.DRAW_LINE_STRING)})),c[Y.types.POLYGON]&&(e[Y.types.POLYGON]=s(Y.types.POLYGON,{container:g,className:Y.classes.CONTROL_BUTTON_POLYGON,title:`Polygon tool ${t.options.keybindings?"(p)":""}`,onActivate:()=>t.events.changeMode(Y.modes.DRAW_POLYGON)})),c[Y.types.POINT]&&(e[Y.types.POINT]=s(Y.types.POINT,{container:g,className:Y.classes.CONTROL_BUTTON_POINT,title:`Marker tool ${t.options.keybindings?"(m)":""}`,onActivate:()=>t.events.changeMode(Y.modes.DRAW_POINT)})),c.trash&&(e.trash=s("trash",{container:g,className:Y.classes.CONTROL_BUTTON_TRASH,title:"Delete",onActivate:()=>{t.events.trash()}})),c.combine_features&&(e.combine_features=s("combineFeatures",{container:g,className:Y.classes.CONTROL_BUTTON_COMBINE_FEATURES,title:"Combine",onActivate:()=>{t.events.combineFeatures()}})),c.uncombine_features&&(e.uncombine_features=s("uncombineFeatures",{container:g,className:Y.classes.CONTROL_BUTTON_UNCOMBINE_FEATURES,title:"Uncombine",onActivate:()=>{t.events.uncombineFeatures()}}))),g}function f(){Object.keys(e).forEach(c=>{const g=e[c];g.parentNode&&g.parentNode.removeChild(g),delete e[c]})}return{setActiveButton:d,queueMapClasses:a,updateMapClasses:u,clearMapClasses:o,addButtons:v,removeButtons:f}};const ad=Kp,sd=nd,ud=od,Ue=G,cd=go;var ld=function(t){let e=null,r=null;const n={onRemove:function(){return t.map.off("load",n.connect),clearInterval(r),n.removeLayers(),t.store.restoreMapConfig(),t.ui.removeButtons(),t.events.removeEventListeners(),t.ui.clearMapClasses(),t.map=null,t.container=null,t.store=null,e&&e.parentNode&&e.parentNode.removeChild(e),e=null,this},connect:function(){t.map.off("load",n.connect),clearInterval(r),n.addLayers(),t.store.storeMapConfig(),t.events.addEventListeners()},onAdd:function(i){{const o=i.fire;i.fire=function(a,u){let s=arguments;return o.length===1&&arguments.length!==1&&(s=[cd({},{type:a},u)]),o.apply(i,s)}}return t.map=i,t.events=ad(t),t.ui=ud(t),t.container=i.getContainer(),t.store=new sd(t),e=t.ui.addButtons(),t.options.boxSelect&&(i.boxZoom.disable(),i.dragPan.disable(),i.dragPan.enable()),i.loaded()?n.connect():(i.on("load",n.connect),r=setInterval(()=>{i.loaded()&&n.connect()},16)),t.events.start(),e},addLayers:function(){t.map.addSource(Ue.sources.COLD,{data:{type:Ue.geojsonTypes.FEATURE_COLLECTION,features:[]},type:"geojson"}),t.map.addSource(Ue.sources.HOT,{data:{type:Ue.geojsonTypes.FEATURE_COLLECTION,features:[]},type:"geojson"}),t.options.styles.forEach(i=>{t.map.addLayer(i)}),t.store.setDirty(!0),t.store.render()},removeLayers:function(){t.options.styles.forEach(i=>{t.map.getLayer(i.id)&&t.map.removeLayer(i.id)}),t.map.getSource(Ue.sources.COLD)&&t.map.removeSource(Ue.sources.COLD),t.map.getSource(Ue.sources.HOT)&&t.map.removeSource(Ue.sources.HOT)}};return t.setup=n,n},fd=[{id:"gl-draw-polygon-fill-inactive",type:"fill",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#3bb2d0","fill-outline-color":"#3bb2d0","fill-opacity":.1}},{id:"gl-draw-polygon-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"#fbb03b","fill-outline-color":"#fbb03b","fill-opacity":.1}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-stroke-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","active","true"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-polygon-and-line-vertex-stroke-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-color":"#fff"}},{id:"gl-draw-polygon-and-line-vertex-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-point-point-stroke-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-opacity":1,"circle-color":"#fff"}},{id:"gl-draw-point-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#3bb2d0"}},{id:"gl-draw-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["==","active","true"],["!=","meta","midpoint"]],paint:{"circle-radius":7,"circle-color":"#fff"}},{id:"gl-draw-point-active",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","true"]],paint:{"circle-radius":5,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","mode","static"],["==","$type","Polygon"]],paint:{"fill-color":"#404040","fill-outline-color":"#404040","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","mode","static"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-line-static",type:"line",filter:["all",["==","mode","static"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-point-static",type:"circle",filter:["all",["==","mode","static"],["==","$type","Point"]],paint:{"circle-radius":5,"circle-color":"#404040"}}],yn,va;function pt(){if(va)return yn;va=1;const t=G;return yn={isOfMetaType:function(e){return function(r){const n=r.featureTarget;return!n||!n.properties?!1:n.properties.meta===e}},isShiftMousedown:function(e){return!e.originalEvent||!e.originalEvent.shiftKey?!1:e.originalEvent.button===0},isActiveFeature:function(e){return!e.featureTarget||!e.featureTarget.properties?!1:e.featureTarget.properties.active===t.activeStates.ACTIVE&&e.featureTarget.properties.meta===t.meta.FEATURE},isInactiveFeature:function(e){return!e.featureTarget||!e.featureTarget.properties?!1:e.featureTarget.properties.active===t.activeStates.INACTIVE&&e.featureTarget.properties.meta===t.meta.FEATURE},noTarget:function(e){return e.featureTarget===void 0},isFeature:function(e){return!e.featureTarget||!e.featureTarget.properties?!1:e.featureTarget.properties.meta===t.meta.FEATURE},isVertex:function(e){const r=e.featureTarget;return!r||!r.properties?!1:r.properties.meta===t.meta.VERTEX},isShiftDown:function(e){return e.originalEvent?e.originalEvent.shiftKey===!0:!1},isEscapeKey:function(e){return e.keyCode===27},isEnterKey:function(e){return e.keyCode===13},true:function(){return!0}},yn}var gn,ma;function pd(){if(ma)return gn;ma=1,gn=t;function t(e,r){this.x=e,this.y=r}return t.prototype={clone:function(){return new t(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,r){return this.clone()._rotateAround(e,r)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var r=e.x-this.x,n=e.y-this.y;return r*r+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,r){return Math.atan2(this.x*r-this.y*e,this.x*e+this.y*r)},_matMult:function(e){var r=e[0]*this.x+e[1]*this.y,n=e[2]*this.x+e[3]*this.y;return this.x=r,this.y=n,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var r=Math.cos(e),n=Math.sin(e),i=r*this.x-n*this.y,o=n*this.x+r*this.y;return this.x=i,this.y=o,this},_rotateAround:function(e,r){var n=Math.cos(e),i=Math.sin(e),o=r.x+n*(this.x-r.x)-i*(this.y-r.y),a=r.y+i*(this.x-r.x)+n*(this.y-r.y);return this.x=o,this.y=a,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},t.convert=function(e){return e instanceof t?e:Array.isArray(e)?new t(e[0],e[1]):e},gn}var vn,ba;function dd(){if(ba)return vn;ba=1;const t=pd();function e(r,n){const i=n.getBoundingClientRect();return new t(r.clientX-i.left-(n.clientLeft||0),r.clientY-i.top-(n.clientTop||0))}return vn=e,vn}const Bt=G;var kr=function(t,e,r,n){return{type:Bt.geojsonTypes.FEATURE,properties:{meta:Bt.meta.VERTEX,parent:t,coord_path:r,active:n?Bt.activeStates.ACTIVE:Bt.activeStates.INACTIVE},geometry:{type:Bt.geojsonTypes.POINT,coordinates:e}}};const Qe=G;var hd=function(t,e,r,n){const i=e.geometry.coordinates,o=r.geometry.coordinates;if(i[1]>Qe.LAT_RENDERED_MAX||i[1]<Qe.LAT_RENDERED_MIN||o[1]>Qe.LAT_RENDERED_MAX||o[1]<Qe.LAT_RENDERED_MIN)return null;const a=n.project([i[0],i[1]]),u=n.project([o[0],o[1]]),s=n.unproject([(a.x+u.x)/2,(a.y+u.y)/2]);return{type:Qe.geojsonTypes.FEATURE,properties:{meta:Qe.meta.MIDPOINT,parent:t,lng:s.lng,lat:s.lat,coord_path:r.properties.coord_path},geometry:{type:Qe.geojsonTypes.POINT,coordinates:[s.lng,s.lat]}}};const Ta=kr,yd=hd,ut=G;function bc(t,e={},r=null){const{type:n,coordinates:i}=t.geometry,o=t.properties&&t.properties.id;let a=[];n===ut.geojsonTypes.POINT?a.push(Ta(o,i,r,s(r))):n===ut.geojsonTypes.POLYGON?i.forEach((d,v)=>{u(d,r!==null?`${r}.${v}`:String(v))}):n===ut.geojsonTypes.LINE_STRING?u(i,r):n.indexOf(ut.geojsonTypes.MULTI_PREFIX)===0&&p();function u(d,v){let f="",c=null;d.forEach((g,_)=>{const w=v!=null?`${v}.${_}`:String(_),M=Ta(o,g,w,s(w));if(e.midpoints&&c){const T=yd(o,c,M,e.map);T&&a.push(T)}c=M;const O=JSON.stringify(g);f!==O&&a.push(M),_===0&&(f=O)})}function s(d){return e.selectedPaths?e.selectedPaths.indexOf(d)!==-1:!1}function p(){const d=n.replace(ut.geojsonTypes.MULTI_PREFIX,"");i.forEach((v,f)=>{const c={type:ut.geojsonTypes.FEATURE,properties:t.properties,geometry:{type:d,coordinates:v}};a=a.concat(bc(c,e,f))})}return a}var qr=bc,bt={enable(t){setTimeout(()=>{!t.map||!t.map.doubleClickZoom||!t._ctx||!t._ctx.store||!t._ctx.store.getInitialConfigValue||t._ctx.store.getInitialConfigValue("doubleClickZoom")&&t.map.doubleClickZoom.enable()},0)},disable(t){setTimeout(()=>{!t.map||!t.map.doubleClickZoom||t.map.doubleClickZoom.disable()},0)}},jr={exports:{}},gd=function t(e){switch(e&&e.type||null){case"FeatureCollection":return e.features=e.features.reduce(function(r,n){return r.concat(t(n))},[]),e;case"Feature":return e.geometry?t(e.geometry).map(function(r){var n={type:"Feature",properties:JSON.parse(JSON.stringify(e.properties)),geometry:r};return e.id!==void 0&&(n.id=e.id),n}):e;case"MultiPoint":return e.coordinates.map(function(r){return{type:"Point",coordinates:r}});case"MultiPolygon":return e.coordinates.map(function(r){return{type:"Polygon",coordinates:r}});case"MultiLineString":return e.coordinates.map(function(r){return{type:"LineString",coordinates:r}});case"GeometryCollection":return e.geometries.map(t).reduce(function(r,n){return r.concat(n)},[]);case"Point":case"Polygon":case"LineString":return[e]}},vd=function(e){return r(e);function r(n){return Array.isArray(n)&&n.length&&typeof n[0]=="number"?[n]:n.reduce(function(i,o){return Array.isArray(o)&&Array.isArray(o[0])?i.concat(r(o)):(i.push(o),i)},[])}},md=Ku,bd=gd,Td=vd,_d=function(t){if(!t)return[];var e=bd(md(t)),r=[];return e.features.forEach(function(n){n.geometry&&(r=r.concat(Td(n.geometry.coordinates)))}),r},Tc=Function.prototype.toString,lt=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,Zi,Tr;if(typeof lt=="function"&&typeof Object.defineProperty=="function")try{Zi=Object.defineProperty({},"length",{get:function(){throw Tr}}),Tr={},lt(function(){throw 42},null,Zi)}catch(t){t!==Tr&&(lt=null)}else lt=null;var Sd=/^\s*class\b/,Xi=function(e){try{var r=Tc.call(e);return Sd.test(r)}catch{return!1}},mn=function(e){try{return Xi(e)?!1:(Tc.call(e),!0)}catch{return!1}},_r=Object.prototype.toString,Ed="[object Object]",wd="[object Function]",Ad="[object GeneratorFunction]",Id="[object HTMLAllCollection]",Cd="[object HTML document.all class]",$d="[object HTMLCollection]",Od=typeof Symbol=="function"&&!!Symbol.toStringTag,Pd=!(0 in[,]),Qi=function(){return!1};if(typeof document=="object"){var Fd=document.all;_r.call(Fd)===_r.call(document.all)&&(Qi=function(e){if((Pd||!e)&&(typeof e>"u"||typeof e=="object"))try{var r=_r.call(e);return(r===Id||r===Cd||r===$d||r===Ed)&&e("")==null}catch{}return!1})}var Gr=lt?function(e){if(Qi(e))return!0;if(!e||typeof e!="function"&&typeof e!="object")return!1;try{lt(e,null,Zi)}catch(r){if(r!==Tr)return!1}return!Xi(e)&&mn(e)}:function(e){if(Qi(e))return!0;if(!e||typeof e!="function"&&typeof e!="object")return!1;if(Od)return mn(e);if(Xi(e))return!1;var r=_r.call(e);return r!==wd&&r!==Ad&&!/^\[object HTML/.test(r)?!1:mn(e)},Md=Gr,Rd=Object.prototype.toString,_c=Object.prototype.hasOwnProperty,Ld=function(e,r,n){for(var i=0,o=e.length;i<o;i++)_c.call(e,i)&&(n==null?r(e[i],i,e):r.call(n,e[i],i,e))},xd=function(e,r,n){for(var i=0,o=e.length;i<o;i++)n==null?r(e.charAt(i),i,e):r.call(n,e.charAt(i),i,e)},Nd=function(e,r,n){for(var i in e)_c.call(e,i)&&(n==null?r(e[i],i,e):r.call(n,e[i],i,e))};function Bd(t){return Rd.call(t)==="[object Array]"}var wo=function(e,r,n){if(!Md(r))throw new TypeError("iterator must be a function");var i;arguments.length>=3&&(i=n),Bd(e)?Ld(e,r,i):typeof e=="string"?xd(e,r,i):Nd(e,r,i)},Sc=["Float16Array","Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"],bn=Sc,Dd=typeof globalThis>"u"?window:globalThis,zt=function(){for(var e=[],r=0;r<bn.length;r++)typeof Dd[bn[r]]=="function"&&(e[e.length]=bn[r]);return e},Er=wo,Ud=zt,_a=je,Ao=V,Sr=Lr,ir=ht,kd=Ao("Object.prototype.toString"),Ec=tt(),Sa=typeof globalThis>"u"?window:globalThis,eo=Ud(),Io=Ao("String.prototype.slice"),qd=Ao("Array.prototype.indexOf",!0)||function(e,r){for(var n=0;n<e.length;n+=1)if(e[n]===r)return n;return-1},wr={__proto__:null};Ec&&Sr&&ir?Er(eo,function(t){var e=new Sa[t];if(Symbol.toStringTag in e&&ir){var r=ir(e),n=Sr(r,Symbol.toStringTag);if(!n&&r){var i=ir(r);n=Sr(i,Symbol.toStringTag)}wr["$"+t]=_a(n.get)}}):Er(eo,function(t){var e=new Sa[t],r=e.slice||e.set;r&&(wr["$"+t]=_a(r))});var jd=function(e){var r=!1;return Er(wr,function(n,i){if(!r)try{"$"+n(e)===i&&(r=Io(i,1))}catch{}}),r},Gd=function(e){var r=!1;return Er(wr,function(n,i){if(!r)try{n(e),r=Io(i,1)}catch{}}),r},Tt=function(e){if(!e||typeof e!="object")return!1;if(!Ec){var r=Io(kd(e),8,-1);return qd(eo,r)>-1?r:r!=="Object"?!1:Gd(e)}return Sr?jd(e):null};const Vd={},Wd=Object.freeze(Object.defineProperty({__proto__:null,default:Vd},Symbol.toStringTag,{value:"Module"})),to=vo(Wd);var Co=typeof Map=="function"&&Map.prototype,Tn=Object.getOwnPropertyDescriptor&&Co?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,Ar=Co&&Tn&&typeof Tn.get=="function"?Tn.get:null,Ea=Co&&Map.prototype.forEach,$o=typeof Set=="function"&&Set.prototype,_n=Object.getOwnPropertyDescriptor&&$o?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,Ir=$o&&_n&&typeof _n.get=="function"?_n.get:null,wa=$o&&Set.prototype.forEach,zd=typeof WeakMap=="function"&&WeakMap.prototype,qt=zd?WeakMap.prototype.has:null,Hd=typeof WeakSet=="function"&&WeakSet.prototype,jt=Hd?WeakSet.prototype.has:null,Kd=typeof WeakRef=="function"&&WeakRef.prototype,Aa=Kd?WeakRef.prototype.deref:null,Jd=Boolean.prototype.valueOf,Yd=Object.prototype.toString,Zd=Function.prototype.toString,Xd=String.prototype.match,Oo=String.prototype.slice,qe=String.prototype.replace,Qd=String.prototype.toUpperCase,Ia=String.prototype.toLowerCase,wc=RegExp.prototype.test,Ca=Array.prototype.concat,Ce=Array.prototype.join,eh=Array.prototype.slice,$a=Math.floor,ro=typeof BigInt=="function"?BigInt.prototype.valueOf:null,Sn=Object.getOwnPropertySymbols,no=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,dt=typeof Symbol=="function"&&typeof Symbol.iterator=="object",Gt=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===dt||!0)?Symbol.toStringTag:null,Ac=Object.prototype.propertyIsEnumerable,Oa=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(t){return t.__proto__}:null);function Pa(t,e){if(t===1/0||t===-1/0||t!==t||t&&t>-1e3&&t<1e3||wc.call(/e/,e))return e;var r=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof t=="number"){var n=t<0?-$a(-t):$a(t);if(n!==t){var i=String(n),o=Oo.call(e,i.length+1);return qe.call(i,r,"$&_")+"."+qe.call(qe.call(o,/([0-9]{3})/g,"$&_"),/_$/,"")}}return qe.call(e,r,"$&_")}var io=to,Fa=io.custom,Ma=$c(Fa)?Fa:null,Ic={__proto__:null,double:'"',single:"'"},th={__proto__:null,double:/(["\\])/g,single:/(['\\])/g},rh=function t(e,r,n,i){var o=r||{};if(Re(o,"quoteStyle")&&!Re(Ic,o.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Re(o,"maxStringLength")&&(typeof o.maxStringLength=="number"?o.maxStringLength<0&&o.maxStringLength!==1/0:o.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var a=Re(o,"customInspect")?o.customInspect:!0;if(typeof a!="boolean"&&a!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Re(o,"indent")&&o.indent!==null&&o.indent!=="	"&&!(parseInt(o.indent,10)===o.indent&&o.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Re(o,"numericSeparator")&&typeof o.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var u=o.numericSeparator;if(typeof e>"u")return"undefined";if(e===null)return"null";if(typeof e=="boolean")return e?"true":"false";if(typeof e=="string")return Pc(e,o);if(typeof e=="number"){if(e===0)return 1/0/e>0?"0":"-0";var s=String(e);return u?Pa(e,s):s}if(typeof e=="bigint"){var p=String(e)+"n";return u?Pa(e,p):p}var d=typeof o.depth>"u"?5:o.depth;if(typeof n>"u"&&(n=0),n>=d&&d>0&&typeof e=="object")return oo(e)?"[Array]":"[Object]";var v=Th(o,n);if(typeof i>"u")i=[];else if(Oc(i,e)>=0)return"[Circular]";function f(S,F,U){if(F&&(i=eh.call(i),i.push(F)),U){var Q={depth:o.depth};return Re(o,"quoteStyle")&&(Q.quoteStyle=o.quoteStyle),t(S,Q,n+1,i)}return t(S,o,n+1,i)}if(typeof e=="function"&&!Ra(e)){var c=fh(e),g=or(e,f);return"[Function"+(c?": "+c:" (anonymous)")+"]"+(g.length>0?" { "+Ce.call(g,", ")+" }":"")}if($c(e)){var _=dt?qe.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):no.call(e);return typeof e=="object"&&!dt?Dt(_):_}if(vh(e)){for(var w="<"+Ia.call(String(e.nodeName)),M=e.attributes||[],O=0;O<M.length;O++)w+=" "+M[O].name+"="+Cc(nh(M[O].value),"double",o);return w+=">",e.childNodes&&e.childNodes.length&&(w+="..."),w+="</"+Ia.call(String(e.nodeName))+">",w}if(oo(e)){if(e.length===0)return"[]";var T=or(e,f);return v&&!bh(T)?"["+ao(T,v)+"]":"[ "+Ce.call(T,", ")+" ]"}if(oh(e)){var A=or(e,f);return!("cause"in Error.prototype)&&"cause"in e&&!Ac.call(e,"cause")?"{ ["+String(e)+"] "+Ce.call(Ca.call("[cause]: "+f(e.cause),A),", ")+" }":A.length===0?"["+String(e)+"]":"{ ["+String(e)+"] "+Ce.call(A,", ")+" }"}if(typeof e=="object"&&a){if(Ma&&typeof e[Ma]=="function"&&io)return io(e,{depth:d-n});if(a!=="symbol"&&typeof e.inspect=="function")return e.inspect()}if(ph(e)){var C=[];return Ea&&Ea.call(e,function(S,F){C.push(f(F,e,!0)+" => "+f(S,e))}),La("Map",Ar.call(e),C,v)}if(yh(e)){var R=[];return wa&&wa.call(e,function(S){R.push(f(S,e))}),La("Set",Ir.call(e),R,v)}if(dh(e))return En("WeakMap");if(gh(e))return En("WeakSet");if(hh(e))return En("WeakRef");if(sh(e))return Dt(f(Number(e)));if(ch(e))return Dt(f(ro.call(e)));if(uh(e))return Dt(Jd.call(e));if(ah(e))return Dt(f(String(e)));if(typeof window<"u"&&e===window)return"{ [object Window] }";if(typeof globalThis<"u"&&e===globalThis||typeof window<"u"&&e===window)return"{ [object globalThis] }";if(!ih(e)&&!Ra(e)){var $=or(e,f),B=Oa?Oa(e)===Object.prototype:e instanceof Object||e.constructor===Object,y=e instanceof Object?"":"null prototype",I=!B&&Gt&&Object(e)===e&&Gt in e?Oo.call(Ve(e),8,-1):y?"Object":"",m=B||typeof e.constructor!="function"?"":e.constructor.name?e.constructor.name+" ":"",b=m+(I||y?"["+Ce.call(Ca.call([],I||[],y||[]),": ")+"] ":"");return $.length===0?b+"{}":v?b+"{"+ao($,v)+"}":b+"{ "+Ce.call($,", ")+" }"}return String(e)};function Cc(t,e,r){var n=r.quoteStyle||e,i=Ic[n];return i+t+i}function nh(t){return qe.call(String(t),/"/g,"&quot;")}function it(t){return!Gt||!(typeof t=="object"&&(Gt in t||typeof t[Gt]<"u"))}function oo(t){return Ve(t)==="[object Array]"&&it(t)}function ih(t){return Ve(t)==="[object Date]"&&it(t)}function Ra(t){return Ve(t)==="[object RegExp]"&&it(t)}function oh(t){return Ve(t)==="[object Error]"&&it(t)}function ah(t){return Ve(t)==="[object String]"&&it(t)}function sh(t){return Ve(t)==="[object Number]"&&it(t)}function uh(t){return Ve(t)==="[object Boolean]"&&it(t)}function $c(t){if(dt)return t&&typeof t=="object"&&t instanceof Symbol;if(typeof t=="symbol")return!0;if(!t||typeof t!="object"||!no)return!1;try{return no.call(t),!0}catch{}return!1}function ch(t){if(!t||typeof t!="object"||!ro)return!1;try{return ro.call(t),!0}catch{}return!1}var lh=Object.prototype.hasOwnProperty||function(t){return t in this};function Re(t,e){return lh.call(t,e)}function Ve(t){return Yd.call(t)}function fh(t){if(t.name)return t.name;var e=Xd.call(Zd.call(t),/^function\s*([\w$]+)/);return e?e[1]:null}function Oc(t,e){if(t.indexOf)return t.indexOf(e);for(var r=0,n=t.length;r<n;r++)if(t[r]===e)return r;return-1}function ph(t){if(!Ar||!t||typeof t!="object")return!1;try{Ar.call(t);try{Ir.call(t)}catch{return!0}return t instanceof Map}catch{}return!1}function dh(t){if(!qt||!t||typeof t!="object")return!1;try{qt.call(t,qt);try{jt.call(t,jt)}catch{return!0}return t instanceof WeakMap}catch{}return!1}function hh(t){if(!Aa||!t||typeof t!="object")return!1;try{return Aa.call(t),!0}catch{}return!1}function yh(t){if(!Ir||!t||typeof t!="object")return!1;try{Ir.call(t);try{Ar.call(t)}catch{return!0}return t instanceof Set}catch{}return!1}function gh(t){if(!jt||!t||typeof t!="object")return!1;try{jt.call(t,jt);try{qt.call(t,qt)}catch{return!0}return t instanceof WeakSet}catch{}return!1}function vh(t){return!t||typeof t!="object"?!1:typeof HTMLElement<"u"&&t instanceof HTMLElement?!0:typeof t.nodeName=="string"&&typeof t.getAttribute=="function"}function Pc(t,e){if(t.length>e.maxStringLength){var r=t.length-e.maxStringLength,n="... "+r+" more character"+(r>1?"s":"");return Pc(Oo.call(t,0,e.maxStringLength),e)+n}var i=th[e.quoteStyle||"single"];i.lastIndex=0;var o=qe.call(qe.call(t,i,"\\$1"),/[\x00-\x1f]/g,mh);return Cc(o,"single",e)}function mh(t){var e=t.charCodeAt(0),r={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return r?"\\"+r:"\\x"+(e<16?"0":"")+Qd.call(e.toString(16))}function Dt(t){return"Object("+t+")"}function En(t){return t+" { ? }"}function La(t,e,r,n){var i=n?ao(r,n):Ce.call(r,", ");return t+" ("+e+") {"+i+"}"}function bh(t){for(var e=0;e<t.length;e++)if(Oc(t[e],`
`)>=0)return!1;return!0}function Th(t,e){var r;if(t.indent==="	")r="	";else if(typeof t.indent=="number"&&t.indent>0)r=Ce.call(Array(t.indent+1)," ");else return null;return{base:r,prev:Ce.call(Array(e+1),r)}}function ao(t,e){if(t.length===0)return"";var r=`
`+e.prev+e.base;return r+Ce.call(t,","+r)+`
`+e.prev}function or(t,e){var r=oo(t),n=[];if(r){n.length=t.length;for(var i=0;i<t.length;i++)n[i]=Re(t,i)?e(t[i],t):""}var o=typeof Sn=="function"?Sn(t):[],a;if(dt){a={};for(var u=0;u<o.length;u++)a["$"+o[u]]=o[u]}for(var s in t)Re(t,s)&&(r&&String(Number(s))===s&&s<t.length||dt&&a["$"+s]instanceof Symbol||(wc.call(/[^\w$]/,s)?n.push(e(s,t)+": "+e(t[s],t)):n.push(s+": "+e(t[s],t))));if(typeof Sn=="function")for(var p=0;p<o.length;p++)Ac.call(t,o[p])&&n.push("["+e(o[p])+"]: "+e(t[o[p]],t));return n}var Vr=function(e){return typeof e=="string"||typeof e=="symbol"},We=function(e){return!!e&&(typeof e=="function"||typeof e=="object")},xa=q,_h=rh,Sh=Vr,Eh=We,wh=function(e,r){if(!Eh(e))throw new xa("Assertion failed: Type(O) is not Object");if(!Sh(r))throw new xa("Assertion failed: P is not a Property Key, got "+_h(r));return e[r]},Ah=yt,xe=function(e){return(typeof e=="number"||typeof e=="bigint")&&!Ah(e)&&e!==1/0&&e!==-1/0},Ih=mo,Ch=gt,$h=yt,Oh=xe,Wr=function(e){if(typeof e!="number"||$h(e)||!Oh(e))return!1;var r=Ih(e);return Ch(r)===r},wn,Na;function _t(){if(Na)return wn;Na=1;var t=je,e=V,r=Z,n=r("%ArrayBuffer%",!0),i=e("ArrayBuffer.prototype.byteLength",!0),o=e("Object.prototype.toString"),a=!!n&&!i&&new n(0).slice,u=!!a&&t(a);return wn=i||u?function(p){if(!p||typeof p!="object")return!1;try{return i?i(p):u(p,0),!0}catch{return!1}}:n?function(p){return o(p)==="[object ArrayBuffer]"}:function(p){return!1},wn}var Ph=V,Ba=Ph("ArrayBuffer.prototype.byteLength",!0),Fh=_t(),Fc=function(e){return Fh(e)?Ba?Ba(e):e.byteLength:NaN},An,Da;function Ht(){if(Da)return An;Da=1;var t=V,e=t("SharedArrayBuffer.prototype.byteLength",!0);return An=e?function(n){if(!n||typeof n!="object")return!1;try{return e(n),!0}catch{return!1}}:function(n){return!1},An}var Mh=q,Rh=Fc,Lh=zt(),xh=V,Nh=_t(),Bh=Ht(),Dh=xh("SharedArrayBuffer.prototype.byteLength",!0),St=function(e){var r=Bh(e);if(!Nh(e)&&!r)throw new Mh("Assertion failed: `arrayBuffer` must be an Object with an [[ArrayBufferData]] internal slot");if((r?Dh:Rh)(e)===0)try{new window[Lh[0]](e)}catch(n){return!!n&&n.name==="TypeError"}return!1},In,Ua;function Mc(){if(Ua)return In;Ua=1;var t=q,e=rt,r=We,n=Vr;return In=function(o,a){if(!r(o))throw new t("Assertion failed: `O` must be an Object");if(!n(a))throw new t("Assertion failed: `P` must be a Property Key");return e(o,a)},In}var Uh=Z,Rc=Uh("%Array%"),kh=!Rc.isArray&&V("Object.prototype.toString"),Lc=Rc.isArray||function(e){return kh(e)==="[object Array]"},Po=Lc,Cn,ka;function xc(){return ka||(ka=1,Cn=function(e){return e==="BIGUINT64"||e==="BIGINT64"}),Cn}var $n,qa;function qh(){return qa||(qa=1,$n=function(e){return e==="UINT8"||e==="UINT8C"||e==="UINT16"||e==="UINT32"||e==="BIGUINT64"}),$n}var On,ja;function jh(){if(ja)return On;ja=1;var t=vt;return On=function(r){var n=r[3]&128?-1:1,i=(r[3]&127)<<1|r[2]>>7,o=(r[2]&127)<<16|r[1]<<8|r[0];return i===0&&o===0?n===1?0:-0:i===255&&o===0?n===1?1/0:-1/0:i===255&&o!==0?NaN:(i-=127,i===-127?n*o*t(2,-149):n*(1+o*t(2,-23))*t(2,i))},On}var Pn,Ga;function Gh(){if(Ga)return Pn;Ga=1;var t=vt;return Pn=function(r){var n=r[7]&128?-1:1,i=(r[7]&127)<<4|(r[6]&240)>>4,o=(r[6]&15)*281474976710656+r[5]*1099511627776+r[4]*4294967296+r[3]*16777216+r[2]*65536+r[1]*256+r[0];return i===0&&o===0?n*0:i===2047&&o!==0?NaN:i===2047&&o===0?n*(1/0):(i-=1023,i===-1023?n*o*5e-324:n*(1+o/4503599627370496)*t(2,i))},Pn}var Fn,Va;function Vh(){if(Va)return Fn;Va=1;var t=Z,e=vt,r=t("%Number%"),n=t("%BigInt%",!0);return Fn=function(o,a,u,s){for(var p=s?n:r,d=p(0),v=0;v<o.length;v++)d+=p(o[v]*e(2,8*v));if(!u){var f=a*8;o[a-1]&128&&(d-=p(e(2,f)))}return d},Fn}var Mn,Wa;function Wh(){return Wa||(Wa=1,Mn=function(e,r){for(var n=0;n<e.length;n+=1)if(!r(e[n],n,e))return!1;return!0}),Mn}var Rn,za;function zh(){return za||(za=1,Rn=function(e){return typeof e=="number"&&e>=0&&e<=255&&(e|0)===e}),Rn}var Et={__proto__:null,name:{__proto__:null,$Int8Array:"INT8",$Uint8Array:"UINT8",$Uint8ClampedArray:"UINT8C",$Int16Array:"INT16",$Uint16Array:"UINT16",$Int32Array:"INT32",$Uint32Array:"UINT32",$BigInt64Array:"BIGINT64",$BigUint64Array:"BIGUINT64",$Float32Array:"FLOAT32",$Float64Array:"FLOAT64"},size:{__proto__:null,$INT8:1,$UINT8:1,$UINT8C:1,$INT16:2,$UINT16:2,$INT32:4,$UINT32:4,$BIGINT64:8,$BIGUINT64:8,$FLOAT32:4,$FLOAT64:8},choices:'"INT8", "UINT8", "UINT8C", "INT16", "UINT16", "INT32", "UINT32", "BIGINT64", "BIGUINT64", "FLOAT32", or "FLOAT64"'},Ln,Ha;function Hh(){if(Ha)return Ln;Ha=1;var t=Z,e=V,r=Ju,n=Le,i=q,o=t("%BigInt%",!0),a=Mc(),u=Po,s=xc(),p=qh(),d=jh(),v=Gh(),f=Vh(),c=Wh(),g=zh(),_=e("Array.prototype.reverse"),w=e("Array.prototype.slice"),M=Et;return Ln=function(T,A,C){if(!a(M.size,"$"+T))throw new i("Assertion failed: `type` must be a TypedArray element type");if(!u(A)||!c(A,g))throw new i("Assertion failed: `rawBytes` must be an Array of bytes");if(typeof C!="boolean")throw new i("Assertion failed: `isLittleEndian` must be a Boolean");var R=M.size["$"+T];if(A.length!==R)throw new r("Assertion failed: `rawBytes` must have a length of "+R+" for type "+T);var $=s(T);if($&&!o)throw new n("this environment does not support BigInts");return A=w(A,0,R),C||_(A),T==="FLOAT32"?d(A):T==="FLOAT64"?v(A):f(A,R,p(T),$)},Ln}var xn,Ka;function Kh(){if(Ka)return xn;Ka=1;var t={}.toString;return xn=Array.isArray||function(e){return t.call(e)=="[object Array]"},xn}var Nn,Ja;function Jh(){if(Ja)return Nn;Ja=1;var t=Z,e=t("%Array.prototype.concat%"),r=je,n=V,i=n("Array.prototype.slice"),o=ip(),a=o&&Symbol.isConcatSpreadable,u=[],s=a?r.apply(e,u):null,p=a?Kh():null;return Nn=a?function(v){for(var f=0;f<arguments.length;f+=1){var c=arguments[f];if(c&&typeof c=="object"&&typeof c[a]=="boolean"){u[a]||(u[a]=!0);var g=p(c)?i(c):[c];g[a]=!0,arguments[f]=g}}return s(arguments)}:r(e,u),Nn}var Yh=Tt,wt=function(e){return!!Yh(e)},Zh=q,Xh=V,Qh=Xh("TypedArray.prototype.buffer",!0),ey=wt,Kt=Qh||function(e){if(!ey(e))throw new Zh("Not a Typed Array");return e.buffer},Bn,Ya;function Nc(){if(Ya)return Bn;Ya=1;var t=Z,e=t("%Uint8Array%",!0),r=t("%Uint32Array%",!0),n=Kt,i=r&&new r([305419896]),o=i&&new e(n(i));return Bn=o?o[0]===120?"little":o[0]===18?"big":o[0]===52?"mixed":"unknown":"indeterminate",Bn}var ty=Z,ry=Le,Fe=q,ny=V,iy=Wr,oy=ty("%Uint8Array%",!0),Dn=ny("Array.prototype.slice"),ay=St,sy=Hh(),uy=_t(),cy=Ht(),Za=Jh(),ar=Et,ly=Nc(),fy=function(e,r,n,i,o){var a=cy(e);if(!uy(e)&&!a)throw new Fe("Assertion failed: `arrayBuffer` must be an ArrayBuffer or a SharedArrayBuffer");if(!iy(r))throw new Fe("Assertion failed: `byteIndex` must be an integer");if(typeof n!="string"||typeof ar.size["$"+n]!="number")throw new Fe("Assertion failed: `type` must be one of "+ar.choices);if(typeof i!="boolean")throw new Fe("Assertion failed: `isTypedArray` must be a boolean");if(o!=="SEQ-CST"&&o!=="UNORDERED")throw new Fe("Assertion failed: `order` must be either `SEQ-CST` or `UNORDERED`");if(arguments.length>5&&typeof arguments[5]!="boolean")throw new Fe("Assertion failed: `isLittleEndian` must be a boolean, if present");if(ay(e))throw new Fe("Assertion failed: `arrayBuffer` is detached");if(r<0)throw new Fe("Assertion failed: `byteIndex` must be non-negative");var u=ar.size["$"+n];if(!u)throw new Fe("Assertion failed: `type` must be one of "+ar.choices);var s;if(a)throw new ry("SharedArrayBuffer is not supported by this implementation");s=Dn(new oy(e,r),0,u);var p=arguments.length>5?arguments[5]:ly==="little",d=p?Dn(Za([0,0,0,0,0,0,0,0],s),-u):Dn(Za(s,[0,0,0,0,0,0,0,0]),0,u);return sy(n,d,p)},Xa=yt,Bc=function(e,r){return e===r?e===0?1/e===1/r:!0:Xa(e)&&Xa(r)},sr=q,py=We,dy=Vr,Qa=Bc,es=function(){try{return delete[].length,!0}catch{return!1}}(),hy=function(e,r,n,i){if(!py(e))throw new sr("Assertion failed: `O` must be an Object");if(!dy(r))throw new sr("Assertion failed: `P` must be a Property Key");if(typeof i!="boolean")throw new sr("Assertion failed: `Throw` must be a Boolean");if(i){if(e[r]=n,es&&!Qa(e[r],n))throw new sr("Attempted to assign to readonly property.");return!0}try{return e[r]=n,es?Qa(e[r],n):!0}catch{return!1}},Un,ts;function yy(){if(ts)return Un;ts=1;var t=Z,e=t("%BigInt%",!0),r=q,n=Le;return Un=function(o){if(typeof o!="string")throw new r("`argument` must be a string");if(!e)throw new n("BigInts are not supported in this environment");try{return e(o)}catch{return}},Un}var kn,rs;function gy(){return rs||(rs=1,kn=function(e){return e===null||typeof e!="function"&&typeof e!="object"}),kn}var ur={exports:{}},qn,ns;function zr(){if(ns)return qn;ns=1;var t=V,e=Yu,r=t("RegExp.prototype.exec"),n=q;return qn=function(o){if(!e(o))throw new n("`regex` must be a RegExp");return function(u){return r(o,u)!==null}},qn}var is;function Dc(){if(is)return ur.exports;is=1;var t=V,e=t("Object.prototype.toString"),r=op()(),n=zr();if(r){var i=t("Symbol.prototype.toString"),o=n(/^Symbol\(.*\)$/),a=function(s){return typeof s.valueOf()!="symbol"?!1:o(i(s))};ur.exports=function(s){if(typeof s=="symbol")return!0;if(!s||typeof s!="object"||e(s)!=="[object Symbol]")return!1;try{return a(s)}catch{return!1}}}else ur.exports=function(s){return!1};return ur.exports}var jn,os;function vy(){if(os)return jn;os=1;var t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol",e=gy(),r=Gr,n=Zu,i=Dc(),o=function(s,p){if(typeof s>"u"||s===null)throw new TypeError("Cannot call method on "+s);if(typeof p!="string"||p!=="number"&&p!=="string")throw new TypeError('hint must be "string" or "number"');var d=p==="string"?["toString","valueOf"]:["valueOf","toString"],v,f,c;for(c=0;c<d.length;++c)if(v=s[d[c]],r(v)&&(f=v.call(s),e(f)))return f;throw new TypeError("No default value")},a=function(s,p){var d=s[p];if(d!==null&&typeof d<"u"){if(!r(d))throw new TypeError(d+" returned for property "+String(p)+" of object "+s+" is not a function");return d}};return jn=function(s){if(e(s))return s;var p="default";arguments.length>1&&(arguments[1]===String?p="string":arguments[1]===Number&&(p="number"));var d;if(t&&(Symbol.toPrimitive?d=a(s,Symbol.toPrimitive):i(s)&&(d=Symbol.prototype.valueOf)),typeof d<"u"){var v=d.call(s,p);if(e(v))return v;throw new TypeError("unable to convert exotic object to primitive")}return p==="default"&&(n(s)||i(s))&&(p="string"),o(s,p==="default"?"number":p)},jn}var Gn,as;function Uc(){if(as)return Gn;as=1;var t=vy();return Gn=function(r){return arguments.length>1?t(r,arguments[1]):t(r)},Gn}var Vn,ss;function kc(){if(ss)return Vn;ss=1;var t=Z,e=t("%BigInt%",!0),r=t("%Number%"),n=q,i=Le,o=yy(),a=Uc();return Vn=function(s){if(!e)throw new i("BigInts are not supported in this environment");var p=a(s,r);if(p==null)throw new n("Cannot convert null or undefined to a BigInt");if(typeof p=="boolean")return e(p?1:0);if(typeof p=="number")throw new n("Cannot convert a Number value to a BigInt");if(typeof p=="string"){var d=o(p);if(typeof d>"u")throw new n("Failed to parse String to BigInt");return d}if(typeof p=="symbol")throw new n("Cannot convert a Symbol value to a BigInt");if(typeof p!="bigint")throw new i("Assertion failed: unknown primitive type");return p},Vn}var Wn,us;function qc(){if(us)return Wn;us=1;var t=Z,e=t("%BigInt%",!0),r=Ju,n=q,i=e&&e(0);return Wn=function(a,u){if(typeof a!="bigint"||typeof u!="bigint")throw new n("Assertion failed: `n` and `d` arguments must be BigInts");if(u===i)throw new r("Division by zero");return a===i?i:a%u},Wn}var zn,cs;function jc(){return cs||(cs=1,zn=function(e,r,n){var i=e(r,n);return i>=0?i:i+n}),zn}var Hn,ls;function my(){if(ls)return Hn;ls=1;var t=Z,e=t("%BigInt%",!0),r=vt,n=kc(),i=qc(),o=jc(),a=e&&BigInt(r(2,32))*BigInt(r(2,31)),u=e&&BigInt(r(2,32))*BigInt(r(2,32));return Hn=function(p){var d=n(p),v=o(i,d,u);return v>=a?v-u:v},Hn}var Kn,fs;function by(){if(fs)return Kn;fs=1;var t=Z,e=t("%BigInt%",!0),r=vt,n=kc(),i=qc(),o=jc(),a=e&&BigInt(r(2,32))*BigInt(r(2,32));return Kn=function(s){var p=n(s),d=o(i,p,a);return d},Kn}var Jn,ps;function Ty(){if(ps)return Jn;ps=1;var t=gt;return Jn=function(r,n){var i=r%n;return t(i>=0?i:i+n)},Jn}var Yn,ds;function _y(){return ds||(ds=1,Yn=Ty()),Yn}var Zn,hs;function At(){if(hs)return Zn;hs=1;var t=_y();return Zn=function(r,n){return t(r,n)},Zn}var Xn,ys;function Sy(){return ys||(ys=1,Xn=function(e){return e===null||typeof e!="function"&&typeof e!="object"}),Xn}var Qn,gs;function Gc(){if(gs)return Qn;gs=1;var t=q;return Qn=function(r){if(r==null)throw new t(arguments.length>0&&arguments[1]||"Cannot call method on "+r);return r},Qn}var Ey=Z,wy=Ey("%String%"),Ay=q,Vc=function(e){if(typeof e=="symbol")throw new Ay("Cannot convert a Symbol value to a string");return wy(e)},ei,vs;function Wc(){if(vs)return ei;vs=1;var t=Gc(),e=Vc,r=V,n=r("String.prototype.replace"),i=/^\s$/.test(""),o=i?/^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/:/^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/,a=i?/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+$/:/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+$/;return ei=function(){var s=e(t(this));return n(n(s,o,""),a,"")},ei}var ti,ms;function zc(){if(ms)return ti;ms=1;var t=Wc(),e="",r="";return ti=function(){return String.prototype.trim&&e.trim()===e&&r.trim()===r&&("_"+r).trim()==="_"+r&&(r+"_").trim()===r+"_"?String.prototype.trim:t},ti}var ri,bs;function Iy(){if(bs)return ri;bs=1;var t=Xu(),e=ap,r=zc();return ri=function(){var i=r();return String.prototype.trim!==i&&(t?e(String.prototype,"trim",i,!0):e(String.prototype,"trim",i)),i},ri}var ni,Ts;function Cy(){if(Ts)return ni;Ts=1;var t=je,e=Vt,r=Gc(),n=Wc(),i=zc(),o=Iy(),a=t(i()),u=function(p){return r(p),a(p)};return e(u,{getPolyfill:i,implementation:n,shim:o}),ni=u,ni}var ii,_s;function $y(){if(_s)return ii;_s=1;var t=Z,e=t("%RegExp%"),r=q,n=t("%parseInt%"),i=V,o=zr(),a=i("String.prototype.slice"),u=o(/^0b[01]+$/i),s=o(/^0o[0-7]+$/i),p=o(/^[-+]0x[0-9a-f]+$/i),d=["","",""].join(""),v=new e("["+d+"]","g"),f=o(v),c=Cy();return ii=function g(_){if(typeof _!="string")throw new r("Assertion failed: `argument` is not a String");if(u(_))return+n(a(_,2),2);if(s(_))return+n(a(_,2),8);if(f(_)||p(_))return NaN;var w=c(_);return w!==_?g(w):+_},ii}var Oy=Z,Ss=q,Py=Oy("%Number%"),Fy=Sy(),My=Uc(),Ry=$y(),ze=function(e){var r=Fy(e)?e:My(e,Py);if(typeof r=="symbol")throw new Ss("Cannot convert a Symbol value to a number");if(typeof r=="bigint")throw new Ss("Conversion from 'BigInt' to 'number' is not allowed.");return typeof r=="string"?Ry(r):+r},Ly=gt,Fo=function(e){return typeof e=="bigint"?e:Ly(e)},Es=Fo,xy=q,ot=function(e){if(typeof e!="number"&&typeof e!="bigint")throw new xy("argument must be a Number or a BigInt");var r=e<0?-Es(-e):Es(e);return r===0?0:r},oi,ws;function Ny(){if(ws)return oi;ws=1;var t=At(),e=ze,r=ot,n=xe,i=65536;return oi=function(a){var u=e(a);if(!n(u)||u===0)return 0;var s=r(u),p=t(s,i);return p>=32768?p-i:p},oi}var ai,As;function By(){if(As)return ai;As=1;var t=At(),e=ze,r=ot,n=xe,i=2147483648,o=4294967296;return ai=function(u){var s=e(u);if(!n(s)||s===0)return 0;var p=r(s),d=t(p,o),v=d>=i?d-o:d;return v===0?0:v},ai}var si,Is;function Dy(){if(Is)return si;Is=1;var t=At(),e=ze,r=ot,n=xe;return si=function(o){var a=e(o);if(!n(a)||a===0)return 0;var u=r(a),s=t(u,256);return s>=128?s-256:s},si}var ui,Cs;function Uy(){if(Cs)return ui;Cs=1;var t=At(),e=ze,r=ot,n=xe,i=65536;return ui=function(a){var u=e(a);if(!n(u)||u===0)return 0;var s=r(u),p=t(s,i);return p===0?0:p},ui}var ci,$s;function ky(){if($s)return ci;$s=1;var t=At(),e=ze,r=ot,n=xe,i=4294967296;return ci=function(a){var u=e(a);if(!n(u)||u===0)return 0;var s=r(u),p=t(s,i);return p===0?0:p},ci}var li,Os;function qy(){if(Os)return li;Os=1;var t=xe,e=At(),r=ze,n=ot;return li=function(o){var a=r(o);if(!t(a)||a===0)return 0;var u=n(a),s=e(u,256);return s},li}var fi,Ps;function jy(){if(Ps)return fi;Ps=1;var t=q,e=ec,r=Qu;return fi=function(i,o,a){if(typeof i!="number"||typeof o!="number"||typeof a!="number"||!(o<=a))throw new t("Assertion failed: all three arguments must be MVs, and `lower` must be `<= upper`");return r(e(o,i),a)},fi}var pi,Fs;function Gy(){if(Fs)return pi;Fs=1;var t=jy(),e=ze,r=Fo,n=yt;return pi=function(o){var a=e(o);if(n(a))return 0;var u=t(a,0,255),s=r(u);return u<s+.5?s:u>s+.5?s+1:s%2===0?s:s+1},pi}var di,Ms;function Hc(){return Ms||(Ms=1,di=function(e){return e===0&&1/e===-1/0}),di}var hi,Rs;function Vy(){if(Rs)return hi;Rs=1;var t=mo,e=gt,r=vt,n=xe,i=yt,o=Hc(),a=34028234663852886e22;return hi=function(s,p){if(i(s))return p?[0,0,192,127]:[127,192,0,0];var d;if(s===0)return d=o(s)?128:0,p?[0,0,0,d]:[d,0,0,0];if(t(s)>a||!n(s))return d=s<0?255:127,p?[0,0,128,d]:[d,128,0,0];var v=s<0?1:0;s=t(s);for(var f=0;s>=2;)f+=1,s/=2;for(;s<1;)f-=1,s*=2;var c=s-1;c*=r(2,23)+.5,c=e(c),f+=127,f<<=23;var g=v<<31|f|c,_=g&255;g>>=8;var w=g&255;g>>=8;var M=g&255;g>>=8;var O=g&255;return p?[_,w,M,O]:[O,M,w,_]},hi}var yi,Ls;function Wy(){if(Ls)return yi;Ls=1;var t=1075,e=54;return yi=function(n){var i="";if(n===0)return i;for(var o=t,a,u=0;u<t;u+=1)if(a=n*2,a>=1?(n=a-1,i+="1",o===t&&(o=u)):(n=a,i+="0"),a===1||u-o>e)return i;return i},yi}var gi,xs;function zy(){if(xs)return gi;xs=1;var t=gt;return gi=function(r){for(var n="",i;r>0;)i=r/2,r=t(i),i===r?n="0"+n:n="1"+n;return n},gi}var vi,Ns;function Hy(){if(Ns)return vi;Ns=1;var t=Z,e=t("%parseInt%"),r=mo,n=gt,i=Hc(),o=V,a=o("String.prototype.indexOf"),u=o("String.prototype.slice"),s=Wy(),p=zy(),d=1023,v="11111111111",f="00000000000",c=f+f+f+f+"0000000";return vi=function(_,w){var M=_<0||i(_)?"1":"0",O,T;if(isNaN(_))O=v,T="1"+c;else if(!isFinite(_))O=v,T="0"+c;else if(_===0)O=f,T="0"+c;else{_=r(_);var A=n(_),C=p(A),R=s(_-A),$;if(C)O=C.length-1;else{var B=a(R,"1");B>-1&&($=B+1),O=-$}T=C+R,O<0?(O<=-d&&($=d-1),T=u(T,$)):T=u(T,1),O=u(f+p(O+d),-11),T=u(T+c+"0",0,52)}for(var y=M+O+T,I=[],m=0;m<8;m++){var b=w?8-m-1:m;I[b]=e(u(y,m*8,(m+1)*8),2)}return I},vi}var mi,Bs;function Ky(){if(Bs)return mi;Bs=1;var t=Z,e=t("%Number%"),r=t("%BigInt%",!0);return mi=function(i,o,a){var u=typeof i=="bigint"?r:e;i<0&&(i>>>=0);for(var s=[],p=0;p<o;p++)s[a?p:o-1-p]=e(i&u(255)),i>>=u(8);return s},mi}var bi,Ds;function Jy(){if(Ds)return bi;Ds=1;var t=q,e=Mc(),r=my(),n=by(),i=Ny(),o=By(),a=Dy(),u=Uy(),s=ky(),p=qy(),d=Gy(),v=Vy(),f=Hy(),c=Ky(),g=Et,_={__proto__:null,$INT8:a,$UINT8:p,$UINT8C:d,$INT16:i,$UINT16:u,$INT32:o,$UINT32:s,$BIGINT64:r,$BIGUINT64:n};return bi=function(M,O,T){if(typeof M!="string"||!e(g.size,"$"+M))throw new t("Assertion failed: `type` must be a TypedArray element type");if(typeof O!="number"&&typeof O!="bigint")throw new t("Assertion failed: `value` must be a Number or a BigInt");if(typeof T!="boolean")throw new t("Assertion failed: `isLittleEndian` must be a Boolean");if(M==="FLOAT32")return v(O,T);if(M==="FLOAT64")return f(O,T);var A=g.size["$"+M],C=_["$"+M],R=C(O);return c(R,A,T)},bi}var Ti,Us;function Yy(){return Us||(Us=1,Ti=function(e,r){for(var n=0;n<e.length;n+=1)r(e[n],n,e)}),Ti}var Zy=Z,Xy=Le,Me=q,Qy=Wr,eg=Zy("%Uint8Array%",!0),tg=xc(),rg=St,ng=Jy(),ig=_t(),og=Ht(),ag=rt,_i=Et,sg=Nc(),ug=Yy(),cg=function(e,r,n,i,o,a){var u=og(e);if(!ig(e)&&!u)throw new Me("Assertion failed: `arrayBuffer` must be an ArrayBuffer or a SharedArrayBuffer");if(!Qy(r)||r<0)throw new Me("Assertion failed: `byteIndex` must be a non-negative integer");if(typeof n!="string"||!ag(_i.size,"$"+n))throw new Me("Assertion failed: `type` must be one of "+_i.choices);if(typeof i!="number"&&typeof i!="bigint")throw new Me("Assertion failed: `value` must be a Number or a BigInt");if(typeof o!="boolean")throw new Me("Assertion failed: `isTypedArray` must be a boolean");if(a!=="SEQ-CST"&&a!=="UNORDERED"&&a!=="INIT")throw new Me('Assertion failed: `order` must be `"SEQ-CST"`, `"UNORDERED"`, or `"INIT"`');if(arguments.length>6&&typeof arguments[6]!="boolean")throw new Me("Assertion failed: `isLittleEndian` must be a boolean, if present");if(rg(e))throw new Me("Assertion failed: ArrayBuffer is detached");if(tg(n)?typeof i!="bigint":typeof i!="number")throw new Me("Assertion failed: `value` must be a BigInt if type is ~BIGINT64~ or ~BIGUINT64~, otherwise a Number");var s=_i.size["$"+n],p=arguments.length>6?arguments[6]:sg==="little",d=ng(n,i,p);if(u)throw new Xy("SharedArrayBuffer is not supported by this implementation");var v=new eg(e,r,s);ug(d,function(f,c){v[c]=f})},lg=ze,fg=ot,pg=yt,dg=xe,hg=function(e){var r=lg(e);return pg(r)||r===0?0:dg(r)?fg(r):r},yg=Le,gg=q,vg=Wr,mg=Tt,ks=Et,Mo=function(e){var r=mg(e);if(!r)throw new gg("Assertion failed: `O` must be a TypedArray");var n=ks.size["$"+ks.name["$"+r]];if(!vg(n)||n<0)throw new yg("Assertion failed: Unknown TypedArray type `"+r+"`");return n},bg=Le,Tg=q,_g=Tt,Sg=Et,Eg=function(e){var r=_g(e);if(!r)throw new Tg("Assertion failed: `O` must be a TypedArray");var n=Sg.name["$"+r];if(typeof n!="string")throw new bg("Assertion failed: Unknown TypedArray type `"+r+"`");return n},so={exports:{}},wg=Z,Si,qs;function Ro(){if(qs)return Si;qs=1;var t=q,e=rt,r={__proto__:null,"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};return Si=function(i){if(!i||typeof i!="object")return!1;for(var o in i)if(e(i,o)&&!r[o])return!1;var a=e(i,"[[Value]]")||e(i,"[[Writable]]"),u=e(i,"[[Get]]")||e(i,"[[Set]]");if(a&&u)throw new t("Property Descriptors may not be both accessor and data descriptors");return!0},Si}var Ei,js;function Ag(){if(js)return Ei;js=1;var t=Xu,e=sp,r=t.hasArrayLengthDefineBug(),n=r&&Lc,i=V,o=i("Object.prototype.propertyIsEnumerable");return Ei=function(u,s,p,d,v,f){if(!e){if(!u(f)||!f["[[Configurable]]"]||!f["[[Writable]]"]||v in d&&o(d,v)!==!!f["[[Enumerable]]"])return!1;var c=f["[[Value]]"];return d[v]=c,s(d[v],c)}return r&&v==="length"&&"[[Value]]"in f&&n(d)&&d.length!==f["[[Value]]"]?(d.length=f["[[Value]]"],d.length===f["[[Value]]"]):(e(d,v,p(f)),!0)},Ei}var wi,Gs;function Ig(){return Gs||(Gs=1,wi=function(e){if(typeof e>"u")return e;var r={};return"[[Value]]"in e&&(r.value=e["[[Value]]"]),"[[Writable]]"in e&&(r.writable=!!e["[[Writable]]"]),"[[Get]]"in e&&(r.get=e["[[Get]]"]),"[[Set]]"in e&&(r.set=e["[[Set]]"]),"[[Enumerable]]"in e&&(r.enumerable=!!e["[[Enumerable]]"]),"[[Configurable]]"in e&&(r.configurable=!!e["[[Configurable]]"]),r}),wi}var Ai,Vs;function Cg(){if(Vs)return Ai;Vs=1;var t=q,e=Ro(),r=Ig();return Ai=function(i){if(typeof i<"u"&&!e(i))throw new t("Assertion failed: `Desc` must be a Property Descriptor");return r(i)},Ai}var Ii,Ws;function $g(){if(Ws)return Ii;Ws=1;var t=q,e=rt,r=Ro();return Ii=function(i){if(typeof i>"u")return!1;if(!r(i))throw new t("Assertion failed: `Desc` must be a Property Descriptor");return!(!e(i,"[[Value]]")&&!e(i,"[[Writable]]"))},Ii}var Kc=Gr,Ci,zs;function Og(){return zs||(zs=1,Ci=function(e){return!!e}),Ci}var $i,Hs;function Pg(){if(Hs)return $i;Hs=1;var t=rt,e=q,r=We,n=Kc,i=Og();return $i=function(a){if(!r(a))throw new e("ToPropertyDescriptor requires an object");var u={};if(t(a,"enumerable")&&(u["[[Enumerable]]"]=i(a.enumerable)),t(a,"configurable")&&(u["[[Configurable]]"]=i(a.configurable)),t(a,"value")&&(u["[[Value]]"]=a.value),t(a,"writable")&&(u["[[Writable]]"]=i(a.writable)),t(a,"get")){var s=a.get;if(typeof s<"u"&&!n(s))throw new e("getter must be a function");u["[[Get]]"]=s}if(t(a,"set")){var p=a.set;if(typeof p<"u"&&!n(p))throw new e("setter must be a function");u["[[Set]]"]=p}if((t(u,"[[Get]]")||t(u,"[[Set]]"))&&(t(u,"[[Value]]")||t(u,"[[Writable]]")))throw new e("Invalid property descriptor. Cannot both specify accessors and a value or writable attribute");return u},$i}var Oi,Ks;function Fg(){if(Ks)return Oi;Ks=1;var t=q,e=We,r=Ro(),n=Ag(),i=Cg(),o=$g(),a=Vr,u=Bc,s=Pg();return Oi=function(d,v,f){if(!e(d))throw new t("Assertion failed: Type(O) is not Object");if(!a(v))throw new t("Assertion failed: P is not a Property Key");var c=r(f)?f:s(f);if(!r(c))throw new t("Assertion failed: Desc is not a valid Property Descriptor");return n(o,u,i,d,v,c)},Oi}var Mg=wg,Js=Mg("%Reflect.construct%",!0),Cr=Fg();try{Cr({},"",{"[[Get]]":function(){}})}catch{Cr=null}if(Cr&&Js){var Ys={},Zs={};Cr(Zs,"length",{"[[Get]]":function(){throw Ys},"[[Enumerable]]":!0}),so.exports=function(e){try{Js(e,Zs)}catch(r){return r===Ys}}}else so.exports=function(e){return typeof e=="function"&&!!e.prototype};var Jc=so.exports,Rg=Z,Xs=Rg("%Symbol.species%",!0),Pi=q,Qs=We,Lg=Jc,xg=function(e,r){if(!Qs(e))throw new Pi("Assertion failed: Type(O) is not Object");var n=e.constructor;if(typeof n>"u")return r;if(!Qs(n))throw new Pi("O.constructor is not an Object");var i=Xs?n[Xs]:void 0;if(i==null)return r;if(Lg(i))return i;throw new Pi("no constructor found")},Ng=q,Yc=V,eu=Yc("%ArrayBuffer.prototype.resizable%",!0),tu=Yc("%SharedArrayBuffer.prototype.growable%",!0),Bg=_t(),Dg=Ht(),Zc=function(e){var r=Bg(e),n=Dg(e);if(!r&&!n)throw new Ng("Assertion failed: `arrayBuffer` must be an ArrayBuffer or SharedArrayBuffer");return r&&eu?!eu(e):n&&tu?!tu(e):!0},Ug=Wr,ru=rt,kg=wt,qg=Ug,Xc=function(e){return!!e&&typeof e=="object"&&ru(e,"[[Object]]")&&ru(e,"[[CachedBufferByteLength]]")&&(qg(e["[[CachedBufferByteLength]]"])&&e["[[CachedBufferByteLength]]"]>=0||e["[[CachedBufferByteLength]]"]==="DETACHED")&&kg(e["[[Object]]"])},jg=We,Qc=V,Gg=Qc("String.prototype.valueOf"),Vg=function(e){try{return Gg(e),!0}catch{return!1}},Wg=Qc("Object.prototype.toString"),zg="[object String]",Hg=tt(),Kg=function(e){return typeof e=="string"?!0:!e||typeof e!="object"?!1:Hg?Vg(e):Wg(e)===zg},el=V,Jg=el("Number.prototype.toString"),Yg=function(e){try{return Jg(e),!0}catch{return!1}},Zg=el("Object.prototype.toString"),Xg="[object Number]",Qg=tt(),ev=function(e){return typeof e=="number"?!0:!e||typeof e!="object"?!1:Qg?Yg(e):Zg(e)===Xg},tl=V,tv=tl("Boolean.prototype.toString"),rv=tl("Object.prototype.toString"),nv=function(e){try{return tv(e),!0}catch{return!1}},iv="[object Boolean]",ov=tt(),av=function(e){return typeof e=="boolean"?!0:e===null||typeof e!="object"?!1:ov?nv(e):rv(e)===iv},uo={exports:{}},nu=typeof BigInt<"u"&&BigInt,sv=function(){return typeof nu=="function"&&typeof BigInt=="function"&&typeof nu(42)=="bigint"&&typeof BigInt(42)=="bigint"},uv=sv();if(uv){var cv=BigInt.prototype.valueOf,lv=function(e){try{return cv.call(e),!0}catch{}return!1};uo.exports=function(e){return e===null||typeof e>"u"||typeof e=="boolean"||typeof e=="string"||typeof e=="number"||typeof e=="symbol"||typeof e=="function"?!1:typeof e=="bigint"?!0:lv(e)}}else uo.exports=function(e){return!1};var fv=uo.exports,pv=Kg,dv=ev,hv=av,yv=Dc(),gv=fv,vv=function(e){if(e==null||typeof e!="object"&&typeof e!="function")return null;if(pv(e))return"String";if(dv(e))return"Number";if(hv(e))return"Boolean";if(yv(e))return"Symbol";if(gv(e))return"BigInt"},Lo=typeof Map=="function"&&Map.prototype?Map:null,mv=typeof Set=="function"&&Set.prototype?Set:null,$r;Lo||($r=function(e){return!1});var rl=Lo?Map.prototype.has:null,iu=mv?Set.prototype.has:null;!$r&&!rl&&($r=function(e){return!1});var bv=$r||function(e){if(!e||typeof e!="object")return!1;try{if(rl.call(e),iu)try{iu.call(e)}catch{return!0}return e instanceof Lo}catch{}return!1},Tv=typeof Map=="function"&&Map.prototype?Map:null,xo=typeof Set=="function"&&Set.prototype?Set:null,Or;xo||(Or=function(e){return!1});var ou=Tv?Map.prototype.has:null,nl=xo?Set.prototype.has:null;!Or&&!nl&&(Or=function(e){return!1});var _v=Or||function(e){if(!e||typeof e!="object")return!1;try{if(nl.call(e),ou)try{ou.call(e)}catch{return!0}return e instanceof xo}catch{}return!1},Pr=typeof WeakMap=="function"&&WeakMap.prototype?WeakMap:null,au=typeof WeakSet=="function"&&WeakSet.prototype?WeakSet:null,Fr;Pr||(Fr=function(e){return!1});var co=Pr?Pr.prototype.has:null,Fi=au?au.prototype.has:null;!Fr&&!co&&(Fr=function(e){return!1});var Sv=Fr||function(e){if(!e||typeof e!="object")return!1;try{if(co.call(e,co),Fi)try{Fi.call(e,Fi)}catch{return!0}return e instanceof Pr}catch{}return!1},lo={exports:{}},Ev=Z,il=V,wv=Ev("%WeakSet%",!0),Mi=il("WeakSet.prototype.has",!0);if(Mi){var Ri=il("WeakMap.prototype.has",!0);lo.exports=function(e){if(!e||typeof e!="object")return!1;try{if(Mi(e,Mi),Ri)try{Ri(e,Ri)}catch{return!0}return e instanceof wv}catch{}return!1}}else lo.exports=function(e){return!1};var Av=lo.exports,Iv=bv,Cv=_v,$v=Sv,Ov=Av,Pv=function(e){if(e&&typeof e=="object"){if(Iv(e))return"Map";if(Cv(e))return"Set";if($v(e))return"WeakMap";if(Ov(e))return"WeakSet"}return!1},Fv={}.toString,Mv=Array.isArray||function(t){return Fv.call(t)=="[object Array]"},Rv=V,Lv=Rv("WeakRef.prototype.deref",!0),xv=typeof WeakRef>"u"?function(e){return!1}:function(e){if(!e||typeof e!="object")return!1;try{return Lv(e),!0}catch{return!1}},Nv=V,su=Nv("FinalizationRegistry.prototype.register",!0),Bv=su?function(e){if(!e||typeof e!="object")return!1;try{return su(e,{},null),!0}catch{return!1}}:function(e){return!1},ol=Gr,Dv=rt,Uv=tc(),No=V,al=No("Function.prototype.toString"),sl=No("String.prototype.match"),Li=No("Object.prototype.toString"),kv=/^class /,qv=function(e){if(ol(e)||typeof e!="function")return!1;try{var r=sl(al(e),kv);return!!r}catch{}return!1},jv=/\s*function\s+([^(\s]*)\s*/,Gv=!(0 in[,]),Vv="[object Object]",Wv="[object HTMLAllCollection]",zv=Function.prototype,ul=function(){return!1};if(typeof document=="object"){var Hv=document.all;Li(Hv)===Li(document.all)&&(ul=function(e){if((Gv||!e)&&(typeof e>"u"||typeof e=="object"))try{var r=Li(e);return(r===Wv||r===Vv)&&e("")==null}catch{}return!1})}var cl=function(){if(ul(this)||!qv(this)&&!ol(this))throw new TypeError("Function.prototype.name sham getter called on non-function");if(Uv&&Dv(this,"name"))return this.name;if(this===zv)return"";var e=al(this),r=sl(e,jv),n=r&&r[1];return n},Kv=cl,ll=function(){return Kv},Jv=Vt.supportsDescriptors,Yv=tc(),Zv=ll,uu=Object.defineProperty,Xv=TypeError,Qv=function(){var e=Zv();if(Yv)return e;if(!Jv)throw new Xv("Shimming Function.prototype.name support requires ES5 property descriptor support.");var r=Function.prototype;return uu(r,"name",{configurable:!0,enumerable:!1,get:function(){var n=e.call(this);return this!==r&&uu(this,"name",{configurable:!0,enumerable:!1,value:n,writable:!1}),n}}),e},em=Vt,tm=je,fl=cl,rm=ll,nm=Qv,pl=tm(fl);em(pl,{getPolyfill:rm,implementation:fl,shim:nm});var im=pl,xi,cu;function om(){if(cu)return xi;cu=1;const t=(function*(){}).constructor;return xi=()=>t,xi}var dl=V,am=zr(),sm=am(/^\s*(?:function)?\*/),um=tt(),lu=ht,cm=dl("Object.prototype.toString"),lm=dl("Function.prototype.toString"),fm=om(),pm=function(e){if(typeof e!="function")return!1;if(sm(lm(e)))return!0;if(!um){var r=cm(e);return r==="[object GeneratorFunction]"}if(!lu)return!1;var n=fm();return n&&lu(e)===n.prototype},Ni,fu;function dm(){if(fu)return Ni;fu=1;const t=(async function(){}).constructor;return Ni=()=>t,Ni}var hl=V,hm=zr(),ym=hl("Object.prototype.toString"),gm=hl("Function.prototype.toString"),vm=hm(/^\s*async(?:\s+function(?:\s+|\()|\s*\()/),mm=tt(),pu=ht,bm=dm(),Tm=function(e){if(typeof e!="function")return!1;if(vm(gm(e)))return!0;if(!mm){var r=ym(e);return r==="[object AsyncFunction]"}if(!pu)return!1;var n=bm();return n&&n.prototype===pu(e)},_m=vv,Sm=Pv,Em=Tt,wm=Mv,Am=Zu,Im=Yu,Cm=xv,$m=Bv,Om=im,Pm=pm,Fm=Tm,Mm=V,Rm=tt(),Bi=Rm&&Symbol.toStringTag,Lm=Object,du=Mm("Promise.prototype.then",!0),xm=function(e){if(!e||typeof e!="object"||!du)return!1;try{return du(e,null,function(){}),!0}catch{}return!1},hu=function(e){return!!e&&e!=="BigInt"&&e!=="Boolean"&&e!=="Null"&&e!=="Number"&&e!=="String"&&e!=="Symbol"&&e!=="Undefined"&&e!=="Math"&&e!=="JSON"&&e!=="Reflect"&&e!=="Atomics"&&e!=="Map"&&e!=="Set"&&e!=="WeakMap"&&e!=="WeakSet"&&e!=="BigInt64Array"&&e!=="BigUint64Array"&&e!=="Float32Array"&&e!=="Float64Array"&&e!=="Int16Array"&&e!=="Int32Array"&&e!=="Int8Array"&&e!=="Uint16Array"&&e!=="Uint32Array"&&e!=="Uint8Array"&&e!=="Uint8ClampedArray"&&e!=="Array"&&e!=="Date"&&e!=="FinalizationRegistry"&&e!=="Promise"&&e!=="RegExp"&&e!=="WeakRef"&&e!=="Function"&&e!=="GeneratorFunction"&&e!=="AsyncFunction"},Nm=function(e){if(e==null)return e;var r=_m(Lm(e))||Sm(e)||Em(e);if(r)return r;if(wm(e))return"Array";if(Am(e))return"Date";if(Im(e))return"RegExp";if(Cm(e))return"WeakRef";if($m(e))return"FinalizationRegistry";if(typeof e=="function")return Pm(e)?"GeneratorFunction":Fm(e)?"AsyncFunction":"Function";if(xm(e))return"Promise";if(Bi&&Bi in e){var n=e[Bi];if(hu(n))return n}if(typeof e.constructor=="function"){var i=Om(e.constructor);if(hu(i))return i}return"Object"},Bm=Z,Dm=Kc,Um=jg,km=Nm,qm=q,yu=ht,jm=up,Gm=function(e){if(!Um(e))throw new qm("Reflect.getPrototypeOf called on non-object");if(yu)return yu(e);var r=km(e);if(r){var n=Bm("%"+r+".prototype%",!0);if(n)return n}return Dm(e.constructor)?e.constructor.prototype:e instanceof Object?jm.prototype:null},Vm=Gm,gu=ht,yl=function(){return typeof Reflect=="object"&&Reflect&&Reflect.getPrototypeOf?Reflect.getPrototypeOf:gu?function(r){return gu(r)}:Vm},gl=wo,Wm=je,zm=yl(),Hm=zt(),fo={__proto__:null},cr=Lr,vu=Object.defineProperty;if(cr){var Km=function(t){return t.byteOffset};gl(Hm,function(t){if(typeof window[t]=="function"||typeof window[t]=="object"){var e=window[t].prototype,r=cr(e,"byteOffset");if(!r){var n=zm(e);r=cr(n,"byteOffset")}if(r&&r.get)fo[t]=Wm(r.get);else if(vu){var i=new window[t](2);r=cr(i,"byteOffset"),r&&r.configurable&&vu(i,"length",{value:3}),i.length===2&&(fo[t]=Km)}}})}var Jm=function(e){var r;return gl(fo,function(n){if(typeof r!="number")try{var i=n(e);typeof i=="number"&&(r=i)}catch{}}),r},Ym=wt,Bo=function(e){return Ym(e)?Jm(e):!1},Zm=je,vl=wo,lr=Lr,Xm=wt,Qm=Sc,eb=yl(),po={__proto__:null},mu=Object.defineProperty;if(lr){var tb=function(t){return t.length};vl(Qm,function(t){var e=window[t];if(typeof e=="function"||typeof e=="object"){var r=e.prototype,n=lr(r,"length");if(!n){var i=eb(r);n=lr(i,"length")}if(n&&n.get)po["$"+t]=Zm(n.get);else if(mu){var o=new window[t](2);n=lr(o,"length"),n&&n.configurable&&mu(o,"length",{value:3}),o.length===2&&(po["$"+t]=tb)}}})}var rb=function(e){var r;return vl(po,function(n){if(typeof r!="number")try{var i=n(e);typeof i=="number"&&(r=i)}catch{}}),r},ml=function(e){return Xm(e)?rb(e):!1},bu=q,nb=St,ib=Zc,ob=Mo,ab=Xc,Tu=Kt,sb=Bo,ub=ml,Do=function(e){if(!ab(e))throw new bu("Assertion failed: `taRecord` must be a TypedArray With Buffer Witness Record");var r=e["[[Object]]"],n=e["[[CachedBufferByteLength]]"];if(nb(Tu(r))&&n!=="DETACHED")throw new bu("Assertion failed: typed array is detached only if the byte length is ~DETACHED~");if(n==="DETACHED")return!0;var i=sb(r),o=ib(Tu(r)),a,u=o?ub(r):"AUTO";if(u==="AUTO")a=n;else{var s=ob(r);a=i+u*s}return i>n||a>n},fr=q,cb=Fo,lb=Zc,fb=Do,pb=Mo,db=Xc,hb=Kt,yb=Bo,gb=ml,vb=function(e){if(!db(e))throw new fr("Assertion failed: `taRecord` must be a TypedArray With Buffer Witness Record");if(fb(e))throw new fr("Assertion failed: `taRecord` is out of bounds");var r=e["[[Object]]"],n=lb(hb(r)),i=n?gb(r):"AUTO";if(i!=="AUTO")return i;if(n)throw new fr("Assertion failed: array buffer is not fixed length");var o=yb(r),a=pb(r),u=e["[[CachedBufferByteLength]]"];if(u==="DETACHED")throw new fr("Assertion failed: typed array is detached");return cb((u-o)/a)},Di=q,mb=St,bb=_t(),Tb=Ht(),_b=Fc,Sb=V,Eb=Sb("SharedArrayBuffer.prototype.byteLength",!0),wb=function(e,r){var n=Tb(e);if(!bb(e)&&!n)throw new Di("Assertion failed: `arrayBuffer` must be an ArrayBuffer or a SharedArrayBuffer");if(r!=="SEQ-CST"&&r!=="UNORDERED")throw new Di("Assertion failed: `order` must be ~SEQ-CST~ or ~UNORDERED~");if(mb(e))throw new Di("Assertion failed: `arrayBuffer` must not be detached");return n?Eb(e):_b(e)},_u=q,Ab=wb,Ib=St,Cb=wt,$b=Kt,Ob=function(e,r){if(!Cb(e))throw new _u("Assertion failed: `obj` must be a Typed Array");if(r!=="SEQ-CST"&&r!=="UNORDERED")throw new _u("Assertion failed: `order` must be ~SEQ-CST~ or ~UNORDERED~");var n=$b(e),i=Ib(n)?"DETACHED":Ab(n,r);return{"[[Object]]":e,"[[CachedBufferByteLength]]":i}},pr=q,Pb=We,Fb=Do,Mb=Ob,Rb=wt,bl=function(e,r){if(r!=="SEQ-CST"&&r!=="UNORDERED")throw new pr("Assertion failed: `order` must be ~SEQ-CST~ or ~UNORDERED~");if(!Pb(e))throw new pr("Assertion failed: `O` must be an Object");if(!Rb(e))throw new pr("Assertion failed: `O` must be a Typed Array");var n=Mb(e,r);if(Fb(n))throw new pr("`O` must be in-bounds and backed by a non-detached buffer");return n},Lb=Le,dr=q,xb=Po,Nb=Jc,Bb=Do,Db=vb,Ub=bl,kb=zt(),qb=function(e,r){if(!Nb(e))throw new dr("Assertion failed: `constructor` must be a constructor");if(!xb(r))throw new dr("Assertion failed: `argumentList` must be a List");if(kb.length===0)throw new Lb("Assertion failed: Typed Arrays are not supported in this environment");var n;r.length===0?n=new e:r.length===1?n=new e(r[0]):r.length===2?n=new e(r[0],r[1]):n=new e(r[0],r[1],r[2]);var i=Ub(n,"SEQ-CST");if(r.length===1&&typeof r[0]=="number"){if(Bb(i))throw new dr("new Typed Array is out of bounds");var o=Db(i);if(o<r[0])throw new dr("`argumentList[0]` must be <= `newTypedArray.length`")}return n},ve=Z,jb={__proto__:null,$Int8Array:ve("%Int8Array%",!0),$Uint8Array:ve("%Uint8Array%",!0),$Uint8ClampedArray:ve("%Uint8ClampedArray%",!0),$Int16Array:ve("%Int16Array%",!0),$Uint16Array:ve("%Uint16Array%",!0),$Int32Array:ve("%Int32Array%",!0),$Uint32Array:ve("%Uint32Array%",!0),$BigInt64Array:ve("%BigInt64Array%",!0),$BigUint64Array:ve("%BigUint64Array%",!0),$Float16Array:ve("%Float16Array%",!0),$Float32Array:ve("%Float32Array%",!0),$Float64Array:ve("%Float64Array%",!0)},Gb=function(e){return jb["$"+e]},Su=Le,Eu=q,Vb=Tt,Wb=zt(),zb=Po,Hb=xg,Kb=qb,Jb=Gb,Yb=function(e,r){if(Wb.length===0)throw new Su("Assertion failed: Typed Arrays are not supported in this environment");var n=Vb(e);if(!n)throw new Eu("Assertion failed: exemplar must be a TypedArray");if(!zb(r))throw new Eu("Assertion failed: `argumentList` must be a List");var i=Jb(n);if(typeof i!="function")throw new Su("Assertion failed: `constructor` of `exemplar` ("+n+") must exist. Please report this!");var o=Hb(e,i);return Kb(o,r)},Zb=q,Xb=wh,Qb=fy,e0=St,Ui=ec,wu=Qu,t0=hy,r0=cg,Au=hg,Iu=Vc,n0=Mo,Cu=Eg,i0=Yb,o0=bl,ki=Kt,$u=Bo,Tl=function(e,r){var n=this;o0(n,"SEQ-CST");var i=n.length,o=Au(e),a;o===-1/0?a=0:o<0?a=Ui(i+o,0):a=wu(o,i);var u=typeof r>"u"?i:Au(r),s;u===-1/0?s=0:u<0?s=Ui(i+u,0):s=wu(u,i);var p=Ui(s-a,0),d=i0(n,[p]);if(p>0){if(e0(ki(n)))throw new Zb("Cannot use a Typed Array with an underlying ArrayBuffer that is detached");var v=Cu(n),f=Cu(d);if(v===f)for(var c=ki(n),g=ki(d),_=n0(n),w=$u(n),M=a*_+w,O=$u(d),T=O+p*_;O<T;){var A=Qb(c,M,"UINT8",!0,"UNORDERED");r0(g,O,"UINT8",A,!0,"UNORDERED"),M+=1,O+=1}else for(var C=0;a<s;){var R=Iu(a),$=Xb(n,R);t0(d,Iu(C),$,!0),a+=1,C+=1}}return d},a0=Tl,_l=function(){return typeof Uint8Array=="function"&&Uint8Array.prototype.slice||a0},s0=Vt,u0=ht,c0=_l,l0=function(){if(typeof Uint8Array=="function"){var e=c0(),r=u0(Uint8Array.prototype);s0(r,{slice:e},{slice:function(){return r.slice!==e}})}return e},f0=Vt,p0=je,d0=Tl,Sl=_l,h0=l0,El=p0(Sl());f0(El,{getPolyfill:Sl,implementation:d0,shim:h0});var y0=El,wl=Tt,Al=y0,Ou=Lr;function It(t){return Object.prototype.toString.call(t)}function g0(t){return It(t)==="[object Date]"}function v0(t){return It(t)==="[object RegExp]"}function m0(t){return It(t)==="[object Error]"}function b0(t){return It(t)==="[object Boolean]"}function T0(t){return It(t)==="[object Number]"}function _0(t){return It(t)==="[object String]"}var Il=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"};function Hr(t,e){if(t.forEach)return t.forEach(e);for(var r=0;r<t.length;r++)e(t[r],r,t)}var Kr=Object.keys||function(e){var r=[];for(var n in e)r[r.length]=n;return r},S0=Object.prototype.propertyIsEnumerable,Pu=Object.getOwnPropertySymbols;function Jr(t){var e=Kr(t);if(Pu)for(var r=Pu(t),n=0;n<r.length;n++)S0.call(t,r[n])&&(e[e.length]=r[n]);return e}var Yr=Object.prototype.hasOwnProperty||function(t,e){return e in t};function E0(t,e){if(typeof Ou!="function")return!0;var r=Ou(t,e);return!r||!r.writable}function Cl(t,e){if(typeof t=="object"&&t!==null){var r;if(Il(t))r=[];else if(g0(t))r=new Date(t.getTime?t.getTime():t);else if(v0(t))r=new RegExp(t);else if(m0(t))r={message:t.message};else if(b0(t)||T0(t)||_0(t))r=Object(t);else{var n=wl(t);if(n)return Al(t);if(Object.create&&Object.getPrototypeOf)r=Object.create(Object.getPrototypeOf(t));else if(t.constructor===Object)r={};else{var i=t.constructor&&t.constructor.prototype||t.__proto__||{},o=function(){};o.prototype=i,r=new o}}var a=e.includeSymbols?Jr:Kr;return Hr(a(t),function(u){r[u]=t[u]}),r}return t}var Uo={__proto__:null};function $l(t,e){var r=[],n=[],i=!0,o=arguments.length>2?arguments[2]:Uo,a=o.includeSymbols?Jr:Kr,u=!!o.immutable;return function s(p){var d=u?Cl(p,o):p,v={__proto__:null},f=!0,c={node:d,node_:p,path:[].concat(r),parent:n[n.length-1],parents:n,key:r[r.length-1],removedKeys:{__proto__:null},isRoot:r.length===0,level:r.length,circular:null,update:function(w,M){c.isRoot||(c.parent.node[c.key]=w),c.node=w,M&&(f=!1)},delete:function(w){delete c.parent.node[c.key],c.parent.removedKeys[c.key]=!0,w&&(f=!1)},remove:function(w){Il(c.parent.node)?(c.parent.node.splice(c.key,1),c.parent.removedKeys[c.key]=!0,w&&(f=!1)):c.delete(w)},keys:null,before:function(w){v.before=w},after:function(w){v.after=w},pre:function(w){v.pre=w},post:function(w){v.post=w},stop:function(){i=!1},block:function(){f=!1}};if(!i)return c;function g(){if(typeof c.node=="object"&&c.node!==null){(!c.keys||c.node_!==c.node)&&(c.keys=a(c.node)),c.isLeaf=c.keys.length===0;for(var w=0;w<n.length;w++)if(n[w].node_===p){c.circular=n[w];break}}else c.isLeaf=!0,c.keys=null;c.notLeaf=!c.isLeaf,c.notRoot=!c.isRoot}g();var _=e.call(c,c.node);return _!==void 0&&c.update&&c.update(_),v.before&&v.before.call(c,c.node),f&&(typeof c.node=="object"&&c.node!==null&&!c.circular&&(n[n.length]=c,g(),Hr(c.keys,function(w,M){var O=M-1 in c.removedKeys;O&&(w=c.keys[M-1]),r[r.length]=w,v.pre&&v.pre.call(c,c.node[w],w);var T=s(c.node[w]);u&&Yr.call(c.node,w)&&!E0(c.node,w)&&!O&&(c.node[w]=T.node),T.isLast=M===c.keys.length-1,T.isFirst=M===0,v.post&&v.post.call(c,T),r.pop()}),n.pop()),v.after&&v.after.call(c,c.node)),c}(t).node}function me(t){this.options=arguments.length>1?arguments[1]:Uo,this.value=t}me.prototype.get=function(t){for(var e=this.value,r=0;e&&r<t.length;r++){var n=t[r];if(!Yr.call(e,n)||!this.options.includeSymbols&&typeof n=="symbol")return;e=e[n]}return e};me.prototype.has=function(t){var e=this.value;if(!e&&t.length>0)return!1;for(var r=0;e&&r<t.length;r++){var n=t[r];if(!Yr.call(e,n)||!this.options.includeSymbols&&typeof n=="symbol")return!1;e=e[n]}return!0};me.prototype.set=function(t,e){for(var r=this.value,n=0;n<t.length-1;n++){var i=t[n];Yr.call(r,i)||(r[i]={}),r=r[i]}return r[t[n]]=e,e};me.prototype.map=function(t){return $l(this.value,t,{__proto__:null,immutable:!0,includeSymbols:!!this.options.includeSymbols})};me.prototype.forEach=function(t){return this.value=$l(this.value,t,this.options),this.value};me.prototype.reduce=function(t,e){var r=arguments.length===1,n=r?this.value:e;return this.forEach(function(i){(!this.isRoot||!r)&&(n=t.call(this,n,i))}),n};me.prototype.paths=function(){var t=[];return this.forEach(function(){t[t.length]=this.path}),t};me.prototype.nodes=function(){var t=[];return this.forEach(function(){t[t.length]=this.node}),t};me.prototype.clone=function(){var t=[],e=[],r=this.options;return wl(this.value)?Al(this.value):function n(i){for(var o=0;o<t.length;o++)if(t[o]===i)return e[o];if(typeof i=="object"&&i!==null){var a=Cl(i,r);t[t.length]=i,e[e.length]=a;var u=r.includeSymbols?Jr:Kr;return Hr(u(i),function(s){a[s]=n(i[s])}),t.pop(),e.pop(),a}return i}(this.value)};function Ol(t){var e=arguments.length>1?arguments[1]:Uo;return new me(t,e)}Hr(Jr(me.prototype),function(t){Ol[t]=function(e){var r=[].slice.call(arguments,1),n=new me(e);return n[t].apply(n,r)}});var w0=Ol,A0=le;function le(t){if(!(this instanceof le))return new le(t);this._bbox=t||[1/0,1/0,-1/0,-1/0],this._valid=!!t}le.prototype.include=function(t){return this._valid=!0,this._bbox[0]=Math.min(this._bbox[0],t[0]),this._bbox[1]=Math.min(this._bbox[1],t[1]),this._bbox[2]=Math.max(this._bbox[2],t[0]),this._bbox[3]=Math.max(this._bbox[3],t[1]),this};le.prototype.equals=function(t){var e;return t instanceof le?e=t.bbox():e=t,this._bbox[0]==e[0]&&this._bbox[1]==e[1]&&this._bbox[2]==e[2]&&this._bbox[3]==e[3]};le.prototype.center=function(t){return this._valid?[(this._bbox[0]+this._bbox[2])/2,(this._bbox[1]+this._bbox[3])/2]:null};le.prototype.union=function(t){this._valid=!0;var e;return t instanceof le?e=t.bbox():e=t,this._bbox[0]=Math.min(this._bbox[0],e[0]),this._bbox[1]=Math.min(this._bbox[1],e[1]),this._bbox[2]=Math.max(this._bbox[2],e[2]),this._bbox[3]=Math.max(this._bbox[3],e[3]),this};le.prototype.bbox=function(){return this._valid?this._bbox:null};le.prototype.contains=function(t){if(!t)return this._fastContains();if(!this._valid)return null;var e=t[0],r=t[1];return this._bbox[0]<=e&&this._bbox[1]<=r&&this._bbox[2]>=e&&this._bbox[3]>=r};le.prototype.intersect=function(t){if(!this._valid)return null;var e;return t instanceof le?e=t.bbox():e=t,!(this._bbox[0]>e[2]||this._bbox[2]<e[0]||this._bbox[3]<e[1]||this._bbox[1]>e[3])};le.prototype._fastContains=function(){if(!this._valid)return new Function("return null;");var t="return "+this._bbox[0]+"<= ll[0] &&"+this._bbox[1]+"<= ll[1] &&"+this._bbox[2]+">= ll[0] &&"+this._bbox[3]+">= ll[1]";return new Function("ll",t)};le.prototype.polygon=function(){return this._valid?{type:"Polygon",coordinates:[[[this._bbox[0],this._bbox[1]],[this._bbox[2],this._bbox[1]],[this._bbox[2],this._bbox[3]],[this._bbox[0],this._bbox[3]],[this._bbox[0],this._bbox[1]]]]}:null};var I0=_d,C0=w0,$0=A0,Pl={features:["FeatureCollection"],coordinates:["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],geometry:["Feature"],geometries:["GeometryCollection"]},O0=Object.keys(Pl);jr.exports=function(t){return ko(t).bbox()};jr.exports.polygon=function(t){return ko(t).polygon()};jr.exports.bboxify=function(t){return C0(t).map(function(e){if(e){var r=O0.some(function(n){return e[n]?Pl[n].indexOf(e.type)!==-1:!1});r&&(e.bbox=ko(e).bbox(),this.update(e))}})};function ko(t){for(var e=$0(),r=I0(t),n=0;n<r.length;n++)e.include(r[n]);return e}var P0=jr.exports;const F0=P0,M0=G,{LAT_MIN:hr,LAT_MAX:yr,LAT_RENDERED_MIN:Fu,LAT_RENDERED_MAX:Mu,LNG_MIN:Ru,LNG_MAX:Lu}=M0;var qo=function(t,e){let r=hr,n=yr,i=hr,o=yr,a=Lu,u=Ru;t.forEach(p=>{const d=F0(p),v=d[1],f=d[3],c=d[0],g=d[2];v>r&&(r=v),f<n&&(n=f),f>i&&(i=f),v<o&&(o=v),c<a&&(a=c),g>u&&(u=g)});const s=e;return r+s.lat>Mu&&(s.lat=Mu-r),i+s.lat>yr&&(s.lat=yr-i),n+s.lat<Fu&&(s.lat=Fu-n),o+s.lat<hr&&(s.lat=hr-o),a+s.lng<=Ru&&(s.lng+=Math.ceil(Math.abs(s.lng)/360)*360),u+s.lng>=Lu&&(s.lng-=Math.ceil(Math.abs(s.lng)/360)*360),s};const R0=qo,ct=G;var Zr=function(t,e){const r=R0(t.map(n=>n.toGeoJSON()),e);t.forEach(n=>{const i=n.getCoordinates(),o=p=>{const d={lng:p[0]+r.lng,lat:p[1]+r.lat};return[d.lng,d.lat]},a=p=>p.map(d=>o(d)),u=p=>p.map(d=>a(d));let s;n.type===ct.geojsonTypes.POINT?s=o(i):n.type===ct.geojsonTypes.LINE_STRING||n.type===ct.geojsonTypes.MULTI_POINT?s=i.map(o):n.type===ct.geojsonTypes.POLYGON||n.type===ct.geojsonTypes.MULTI_LINE_STRING?s=i.map(a):n.type===ct.geojsonTypes.MULTI_POLYGON&&(s=i.map(u)),n.incomingCoords(s)})},qi,xu;function L0(){if(xu)return qi;xu=1;const t=pt(),e=dd(),r=qr,n=xr,i=bt,o=Zr,a=G,u={};return u.onSetup=function(s){const p={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoveing:!1,canDragMove:!1,initiallySelectedFeatureIds:s.featureIds||[]};return this.setSelected(p.initiallySelectedFeatureIds.filter(d=>this.getFeature(d)!==void 0)),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),p},u.fireUpdate=function(){this.map.fire(a.events.UPDATE,{action:a.updateActions.MOVE,features:this.getSelected().map(s=>s.toGeoJSON())})},u.fireActionable=function(){const s=this.getSelected(),p=s.filter(c=>this.isInstanceOf("MultiFeature",c));let d=!1;if(s.length>1){d=!0;const c=s[0].type.replace("Multi","");s.forEach(g=>{g.type.replace("Multi","")!==c&&(d=!1)})}const v=p.length>0,f=s.length>0;this.setActionableState({combineFeatures:d,uncombineFeatures:v,trash:f})},u.getUniqueIds=function(s){return s.length?s.map(d=>d.properties.id).filter(d=>d!==void 0).reduce((d,v)=>(d.add(v),d),new n).values():[]},u.stopExtendedInteractions=function(s){s.boxSelectElement&&(s.boxSelectElement.parentNode&&s.boxSelectElement.parentNode.removeChild(s.boxSelectElement),s.boxSelectElement=null),this.map.dragPan.enable(),s.boxSelecting=!1,s.canBoxSelect=!1,s.dragMoving=!1,s.canDragMove=!1},u.onStop=function(){i.enable(this)},u.onMouseMove=function(s){return this.stopExtendedInteractions(s)},u.onMouseOut=function(s){if(s.dragMoving)return this.fireUpdate()},u.onTap=u.onClick=function(s,p){if(t.noTarget(p))return this.clickAnywhere(s,p);if(t.isOfMetaType(a.meta.VERTEX)(p))return this.clickOnVertex(s,p);if(t.isFeature(p))return this.clickOnFeature(s,p)},u.clickAnywhere=function(s){const p=this.getSelectedIds();p.length&&(this.clearSelectedFeatures(),p.forEach(d=>this.doRender(d))),i.enable(this),this.stopExtendedInteractions(s)},u.clickOnVertex=function(s,p){this.changeMode(a.modes.DIRECT_SELECT,{featureId:p.featureTarget.properties.parent,coordPath:p.featureTarget.properties.coord_path,startPos:p.lngLat}),this.updateUIClasses({mouse:a.cursors.MOVE})},u.startOnActiveFeature=function(s,p){this.stopExtendedInteractions(s),this.map.dragPan.disable(),this.doRender(p.featureTarget.properties.id),s.canDragMove=!0,s.dragMoveLocation=p.lngLat},u.clickOnFeature=function(s,p){i.disable(this),this.stopExtendedInteractions(s);const d=t.isShiftDown(p),v=this.getSelectedIds(),f=p.featureTarget.properties.id,c=this.isSelected(f);if(!d&&c&&this.getFeature(f).type!==a.geojsonTypes.POINT)return this.changeMode(a.modes.DIRECT_SELECT,{featureId:f});c&&d?(this.deselect(f),this.updateUIClasses({mouse:a.cursors.POINTER}),v.length===1&&i.enable(this)):!c&&d?(this.select(f),this.updateUIClasses({mouse:a.cursors.MOVE})):!c&&!d&&(v.forEach(g=>this.doRender(g)),this.setSelected(f),this.updateUIClasses({mouse:a.cursors.MOVE})),this.doRender(f)},u.onMouseDown=function(s,p){if(t.isActiveFeature(p))return this.startOnActiveFeature(s,p);if(this.drawConfig.boxSelect&&t.isShiftMousedown(p))return this.startBoxSelect(s,p)},u.startBoxSelect=function(s,p){this.stopExtendedInteractions(s),this.map.dragPan.disable(),s.boxSelectStartLocation=e(p.originalEvent,this.map.getContainer()),s.canBoxSelect=!0},u.onTouchStart=function(s,p){if(t.isActiveFeature(p))return this.startOnActiveFeature(s,p)},u.onDrag=function(s,p){if(s.canDragMove)return this.dragMove(s,p);if(this.drawConfig.boxSelect&&s.canBoxSelect)return this.whileBoxSelect(s,p)},u.whileBoxSelect=function(s,p){s.boxSelecting=!0,this.updateUIClasses({mouse:a.cursors.ADD}),s.boxSelectElement||(s.boxSelectElement=document.createElement("div"),s.boxSelectElement.classList.add(a.classes.BOX_SELECT),this.map.getContainer().appendChild(s.boxSelectElement));const d=e(p.originalEvent,this.map.getContainer()),v=Math.min(s.boxSelectStartLocation.x,d.x),f=Math.max(s.boxSelectStartLocation.x,d.x),c=Math.min(s.boxSelectStartLocation.y,d.y),g=Math.max(s.boxSelectStartLocation.y,d.y),_=`translate(${v}px, ${c}px)`;s.boxSelectElement.style.transform=_,s.boxSelectElement.style.WebkitTransform=_,s.boxSelectElement.style.width=`${f-v}px`,s.boxSelectElement.style.height=`${g-c}px`},u.dragMove=function(s,p){s.dragMoving=!0,p.originalEvent.stopPropagation();const d={lng:p.lngLat.lng-s.dragMoveLocation.lng,lat:p.lngLat.lat-s.dragMoveLocation.lat};o(this.getSelected(),d),s.dragMoveLocation=p.lngLat},u.onMouseUp=function(s,p){if(s.dragMoving)this.fireUpdate();else if(s.boxSelecting){const d=[s.boxSelectStartLocation,e(p.originalEvent,this.map.getContainer())],v=this.featuresAt(null,d,"click"),f=this.getUniqueIds(v).filter(c=>!this.isSelected(c));f.length&&(this.select(f),f.forEach(c=>this.doRender(c)),this.updateUIClasses({mouse:a.cursors.MOVE}))}this.stopExtendedInteractions(s)},u.toDisplayFeatures=function(s,p,d){p.properties.active=this.isSelected(p.properties.id)?a.activeStates.ACTIVE:a.activeStates.INACTIVE,d(p),this.fireActionable(),!(p.properties.active!==a.activeStates.ACTIVE||p.geometry.type===a.geojsonTypes.POINT)&&r(p).forEach(d)},u.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()},u.onCombineFeatures=function(){const s=this.getSelected();if(s.length===0||s.length<2)return;const p=[],d=[],v=s[0].type.replace("Multi","");for(let f=0;f<s.length;f++){const c=s[f];if(c.type.replace("Multi","")!==v)return;c.type.includes("Multi")?c.getCoordinates().forEach(g=>{p.push(g)}):p.push(c.getCoordinates()),d.push(c.toGeoJSON())}if(d.length>1){const f=this.newFeature({type:a.geojsonTypes.FEATURE,properties:d[0].properties,geometry:{type:`Multi${v}`,coordinates:p}});this.addFeature(f),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([f.id]),this.map.fire(a.events.COMBINE_FEATURES,{createdFeatures:[f.toGeoJSON()],deletedFeatures:d})}this.fireActionable()},u.onUncombineFeatures=function(){const s=this.getSelected();if(s.length===0)return;const p=[],d=[];for(let v=0;v<s.length;v++){const f=s[v];this.isInstanceOf("MultiFeature",f)&&(f.getFeatures().forEach(c=>{this.addFeature(c),c.properties=f.properties,p.push(c.toGeoJSON()),this.select([c.id])}),this.deleteFeature(f.id,{silent:!0}),d.push(f.toGeoJSON()))}p.length>1&&this.map.fire(a.events.UNCOMBINE_FEATURES,{createdFeatures:p,deletedFeatures:d}),this.fireActionable()},qi=u,qi}var ji,Nu;function x0(){if(Nu)return ji;Nu=1;const{noTarget:t,isOfMetaType:e,isInactiveFeature:r,isShiftDown:n}=pt(),i=qr,o=qo,a=bt,u=G,s=pt(),p=Zr,d=e(u.meta.VERTEX),v=e(u.meta.MIDPOINT),f={};return f.fireUpdate=function(){this.map.fire(u.events.UPDATE,{action:u.updateActions.CHANGE_COORDINATES,features:this.getSelected().map(c=>c.toGeoJSON())})},f.fireActionable=function(c){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:c.selectedCoordPaths.length>0})},f.startDragging=function(c,g){this.map.dragPan.disable(),c.canDragMove=!0,c.dragMoveLocation=g.lngLat},f.stopDragging=function(c){this.map.dragPan.enable(),c.dragMoving=!1,c.canDragMove=!1,c.dragMoveLocation=null},f.onVertex=function(c,g){this.startDragging(c,g);const _=g.featureTarget.properties,w=c.selectedCoordPaths.indexOf(_.coord_path);!n(g)&&w===-1?c.selectedCoordPaths=[_.coord_path]:n(g)&&w===-1&&c.selectedCoordPaths.push(_.coord_path);const M=this.pathsToCoordinates(c.featureId,c.selectedCoordPaths);this.setSelectedCoordinates(M)},f.onMidpoint=function(c,g){this.startDragging(c,g);const _=g.featureTarget.properties;c.feature.addCoordinate(_.coord_path,_.lng,_.lat),this.fireUpdate(),c.selectedCoordPaths=[_.coord_path]},f.pathsToCoordinates=function(c,g){return g.map(_=>({feature_id:c,coord_path:_}))},f.onFeature=function(c,g){c.selectedCoordPaths.length===0?this.startDragging(c,g):this.stopDragging(c)},f.dragFeature=function(c,g,_){p(this.getSelected(),_),c.dragMoveLocation=g.lngLat},f.dragVertex=function(c,g,_){const w=c.selectedCoordPaths.map(T=>c.feature.getCoordinate(T)),M=w.map(T=>({type:u.geojsonTypes.FEATURE,properties:{},geometry:{type:u.geojsonTypes.POINT,coordinates:T}})),O=o(M,_);for(let T=0;T<w.length;T++){const A=w[T];c.feature.updateCoordinate(c.selectedCoordPaths[T],A[0]+O.lng,A[1]+O.lat)}},f.clickNoTarget=function(){this.changeMode(u.modes.SIMPLE_SELECT)},f.clickInactive=function(){this.changeMode(u.modes.SIMPLE_SELECT)},f.clickActiveFeature=function(c){c.selectedCoordPaths=[],this.clearSelectedCoordinates(),c.feature.changed()},f.onSetup=function(c){const g=c.featureId,_=this.getFeature(g);if(!_)throw new Error("You must provide a featureId to enter direct_select mode");if(_.type===u.geojsonTypes.POINT)throw new TypeError("direct_select mode doesn't handle point features");const w={featureId:g,feature:_,dragMoveLocation:c.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:c.coordPath?[c.coordPath]:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(g,w.selectedCoordPaths)),this.setSelected(g),a.disable(this),this.setActionableState({trash:!0}),w},f.onStop=function(){a.enable(this),this.clearSelectedCoordinates()},f.toDisplayFeatures=function(c,g,_){c.featureId===g.properties.id?(g.properties.active=u.activeStates.ACTIVE,_(g),i(g,{map:this.map,midpoints:!0,selectedPaths:c.selectedCoordPaths}).forEach(_)):(g.properties.active=u.activeStates.INACTIVE,_(g)),this.fireActionable(c)},f.onTrash=function(c){c.selectedCoordPaths.sort().reverse().forEach(g=>c.feature.removeCoordinate(g)),this.fireUpdate(),c.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(c),c.feature.isValid()===!1&&(this.deleteFeature([c.featureId]),this.changeMode(u.modes.SIMPLE_SELECT,{}))},f.onMouseMove=function(c,g){const _=s.isActiveFeature(g),w=d(g),M=c.selectedCoordPaths.length===0;_&&M?this.updateUIClasses({mouse:u.cursors.MOVE}):w&&!M?this.updateUIClasses({mouse:u.cursors.MOVE}):this.updateUIClasses({mouse:u.cursors.NONE}),this.stopDragging(c)},f.onMouseOut=function(c){c.dragMoving&&this.fireUpdate()},f.onTouchStart=f.onMouseDown=function(c,g){if(d(g))return this.onVertex(c,g);if(s.isActiveFeature(g))return this.onFeature(c,g);if(v(g))return this.onMidpoint(c,g)},f.onDrag=function(c,g){if(c.canDragMove!==!0)return;c.dragMoving=!0,g.originalEvent.stopPropagation();const _={lng:g.lngLat.lng-c.dragMoveLocation.lng,lat:g.lngLat.lat-c.dragMoveLocation.lat};c.selectedCoordPaths.length>0?this.dragVertex(c,g,_):this.dragFeature(c,g,_),c.dragMoveLocation=g.lngLat},f.onClick=function(c,g){if(t(g))return this.clickNoTarget(c,g);if(s.isActiveFeature(g))return this.clickActiveFeature(c,g);if(r(g))return this.clickInactive(c,g);this.stopDragging(c)},f.onTap=function(c,g){if(t(g))return this.clickNoTarget(c,g);if(s.isActiveFeature(g))return this.clickActiveFeature(c,g);if(r(g))return this.clickInactive(c,g)},f.onTouchEnd=f.onMouseUp=function(c){c.dragMoving&&this.fireUpdate(),this.stopDragging(c)},ji=f,ji}var Gi,Bu;function N0(){if(Bu)return Gi;Bu=1;const t=pt(),e=G,r={};return r.onSetup=function(){const n=this.newFeature({type:e.geojsonTypes.FEATURE,properties:{},geometry:{type:e.geojsonTypes.POINT,coordinates:[]}});return this.addFeature(n),this.clearSelectedFeatures(),this.updateUIClasses({mouse:e.cursors.ADD}),this.activateUIButton(e.types.POINT),this.setActionableState({trash:!0}),{point:n}},r.stopDrawingAndRemove=function(n){this.deleteFeature([n.point.id],{silent:!0}),this.changeMode(e.modes.SIMPLE_SELECT)},r.onTap=r.onClick=function(n,i){this.updateUIClasses({mouse:e.cursors.MOVE}),n.point.updateCoordinate("",i.lngLat.lng,i.lngLat.lat),this.map.fire(e.events.CREATE,{features:[n.point.toGeoJSON()]}),this.changeMode(e.modes.SIMPLE_SELECT,{featureIds:[n.point.id]})},r.onStop=function(n){this.activateUIButton(),n.point.getCoordinate().length||this.deleteFeature([n.point.id],{silent:!0})},r.toDisplayFeatures=function(n,i,o){const a=i.properties.id===n.point.id;if(i.properties.active=a?e.activeStates.ACTIVE:e.activeStates.INACTIVE,!a)return o(i)},r.onTrash=r.stopDrawingAndRemove,r.onKeyUp=function(n,i){if(t.isEscapeKey(i)||t.isEnterKey(i))return this.stopDrawingAndRemove(n,i)},Gi=r,Gi}var Vi,Du;function Fl(){if(Du)return Vi;Du=1;function t(e,r){return e.lngLat?e.lngLat.lng===r[0]&&e.lngLat.lat===r[1]:!1}return Vi=t,Vi}var Wi,Uu;function B0(){if(Uu)return Wi;Uu=1;const t=pt(),e=bt,r=G,n=Fl(),i=kr,o={};return o.onSetup=function(){const a=this.newFeature({type:r.geojsonTypes.FEATURE,properties:{},geometry:{type:r.geojsonTypes.POLYGON,coordinates:[[]]}});return this.addFeature(a),this.clearSelectedFeatures(),e.disable(this),this.updateUIClasses({mouse:r.cursors.ADD}),this.activateUIButton(r.types.POLYGON),this.setActionableState({trash:!0}),{polygon:a,currentVertexPosition:0}},o.clickAnywhere=function(a,u){if(a.currentVertexPosition>0&&n(u,a.polygon.coordinates[0][a.currentVertexPosition-1]))return this.changeMode(r.modes.SIMPLE_SELECT,{featureIds:[a.polygon.id]});this.updateUIClasses({mouse:r.cursors.ADD}),a.polygon.updateCoordinate(`0.${a.currentVertexPosition}`,u.lngLat.lng,u.lngLat.lat),a.currentVertexPosition++,a.polygon.updateCoordinate(`0.${a.currentVertexPosition}`,u.lngLat.lng,u.lngLat.lat)},o.clickOnVertex=function(a){return this.changeMode(r.modes.SIMPLE_SELECT,{featureIds:[a.polygon.id]})},o.onMouseMove=function(a,u){a.polygon.updateCoordinate(`0.${a.currentVertexPosition}`,u.lngLat.lng,u.lngLat.lat),t.isVertex(u)&&this.updateUIClasses({mouse:r.cursors.POINTER})},o.onTap=o.onClick=function(a,u){return t.isVertex(u)?this.clickOnVertex(a,u):this.clickAnywhere(a,u)},o.onKeyUp=function(a,u){t.isEscapeKey(u)?(this.deleteFeature([a.polygon.id],{silent:!0}),this.changeMode(r.modes.SIMPLE_SELECT)):t.isEnterKey(u)&&this.changeMode(r.modes.SIMPLE_SELECT,{featureIds:[a.polygon.id]})},o.onStop=function(a){this.updateUIClasses({mouse:r.cursors.NONE}),e.enable(this),this.activateUIButton(),this.getFeature(a.polygon.id)!==void 0&&(a.polygon.removeCoordinate(`0.${a.currentVertexPosition}`),a.polygon.isValid()?this.map.fire(r.events.CREATE,{features:[a.polygon.toGeoJSON()]}):(this.deleteFeature([a.polygon.id],{silent:!0}),this.changeMode(r.modes.SIMPLE_SELECT,{},{silent:!0})))},o.toDisplayFeatures=function(a,u,s){const p=u.properties.id===a.polygon.id;if(u.properties.active=p?r.activeStates.ACTIVE:r.activeStates.INACTIVE,!p)return s(u);if(u.geometry.coordinates.length===0)return;const d=u.geometry.coordinates[0].length;if(!(d<3)){if(u.properties.meta=r.meta.FEATURE,s(i(a.polygon.id,u.geometry.coordinates[0][0],"0.0",!1)),d>3){const v=u.geometry.coordinates[0].length-3;s(i(a.polygon.id,u.geometry.coordinates[0][v],`0.${v}`,!1))}if(d<=4){const v=[[u.geometry.coordinates[0][0][0],u.geometry.coordinates[0][0][1]],[u.geometry.coordinates[0][1][0],u.geometry.coordinates[0][1][1]]];if(s({type:r.geojsonTypes.FEATURE,properties:u.properties,geometry:{coordinates:v,type:r.geojsonTypes.LINE_STRING}}),d===3)return}return s(u)}},o.onTrash=function(a){this.deleteFeature([a.polygon.id],{silent:!0}),this.changeMode(r.modes.SIMPLE_SELECT)},Wi=o,Wi}var zi,ku;function D0(){if(ku)return zi;ku=1;const t=pt(),e=Fl(),r=bt,n=G,i=kr,o={};return o.onSetup=function(a){a=a||{};const u=a.featureId;let s,p,d="forward";if(u){if(s=this.getFeature(u),!s)throw new Error("Could not find a feature with the provided featureId");let v=a.from;if(v&&v.type==="Feature"&&v.geometry&&v.geometry.type==="Point"&&(v=v.geometry),v&&v.type==="Point"&&v.coordinates&&v.coordinates.length===2&&(v=v.coordinates),!v||!Array.isArray(v))throw new Error("Please use the `from` property to indicate which point to continue the line from");const f=s.coordinates.length-1;if(s.coordinates[f][0]===v[0]&&s.coordinates[f][1]===v[1])p=f+1,s.addCoordinate(p,...s.coordinates[f]);else if(s.coordinates[0][0]===v[0]&&s.coordinates[0][1]===v[1])d="backwards",p=0,s.addCoordinate(p,...s.coordinates[0]);else throw new Error("`from` should match the point at either the start or the end of the provided LineString")}else s=this.newFeature({type:n.geojsonTypes.FEATURE,properties:{},geometry:{type:n.geojsonTypes.LINE_STRING,coordinates:[]}}),p=0,this.addFeature(s);return this.clearSelectedFeatures(),r.disable(this),this.updateUIClasses({mouse:n.cursors.ADD}),this.activateUIButton(n.types.LINE),this.setActionableState({trash:!0}),{line:s,currentVertexPosition:p,direction:d}},o.clickAnywhere=function(a,u){if(a.currentVertexPosition>0&&e(u,a.line.coordinates[a.currentVertexPosition-1])||a.direction==="backwards"&&e(u,a.line.coordinates[a.currentVertexPosition+1]))return this.changeMode(n.modes.SIMPLE_SELECT,{featureIds:[a.line.id]});this.updateUIClasses({mouse:n.cursors.ADD}),a.line.updateCoordinate(a.currentVertexPosition,u.lngLat.lng,u.lngLat.lat),a.direction==="forward"?(a.currentVertexPosition++,a.line.updateCoordinate(a.currentVertexPosition,u.lngLat.lng,u.lngLat.lat)):a.line.addCoordinate(0,u.lngLat.lng,u.lngLat.lat)},o.clickOnVertex=function(a){return this.changeMode(n.modes.SIMPLE_SELECT,{featureIds:[a.line.id]})},o.onMouseMove=function(a,u){a.line.updateCoordinate(a.currentVertexPosition,u.lngLat.lng,u.lngLat.lat),t.isVertex(u)&&this.updateUIClasses({mouse:n.cursors.POINTER})},o.onTap=o.onClick=function(a,u){if(t.isVertex(u))return this.clickOnVertex(a,u);this.clickAnywhere(a,u)},o.onKeyUp=function(a,u){t.isEnterKey(u)?this.changeMode(n.modes.SIMPLE_SELECT,{featureIds:[a.line.id]}):t.isEscapeKey(u)&&(this.deleteFeature([a.line.id],{silent:!0}),this.changeMode(n.modes.SIMPLE_SELECT))},o.onStop=function(a){r.enable(this),this.activateUIButton(),this.getFeature(a.line.id)!==void 0&&(a.line.removeCoordinate(`${a.currentVertexPosition}`),a.line.isValid()?this.map.fire(n.events.CREATE,{features:[a.line.toGeoJSON()]}):(this.deleteFeature([a.line.id],{silent:!0}),this.changeMode(n.modes.SIMPLE_SELECT,{},{silent:!0})))},o.onTrash=function(a){this.deleteFeature([a.line.id],{silent:!0}),this.changeMode(n.modes.SIMPLE_SELECT)},o.toDisplayFeatures=function(a,u,s){const p=u.properties.id===a.line.id;if(u.properties.active=p?n.activeStates.ACTIVE:n.activeStates.INACTIVE,!p)return s(u);u.geometry.coordinates.length<2||(u.properties.meta=n.meta.FEATURE,s(i(a.line.id,u.geometry.coordinates[a.direction==="forward"?u.geometry.coordinates.length-2:1],`${a.direction==="forward"?u.geometry.coordinates.length-2:1}`,!1)),s(u))},zi=o,zi}var Hi,qu;function Ml(){return qu||(qu=1,Hi={simple_select:L0(),direct_select:x0(),draw_point:N0(),draw_polygon:B0(),draw_line_string:D0()}),Hi}const Ut=go,ho=G,U0={defaultMode:ho.modes.SIMPLE_SELECT,keybindings:!0,touchEnabled:!0,clickBuffer:2,touchBuffer:25,boxSelect:!0,displayControlsDefault:!0,styles:fd,modes:Ml(),controls:{},userProperties:!1},k0={point:!0,line_string:!0,polygon:!0,trash:!0,combine_features:!0,uncombine_features:!0},q0={point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1};function ju(t,e){return t.map(r=>r.source?r:Ut(r,{id:`${r.id}.${e}`,source:e==="hot"?ho.sources.HOT:ho.sources.COLD}))}var j0=function(t={}){let e=Ut(t);return t.controls||(e.controls={}),t.displayControlsDefault===!1?e.controls=Ut(q0,t.controls):e.controls=Ut(k0,t.controls),e=Ut(U0,e),e.styles=ju(e.styles,"cold").concat(ju(e.styles,"hot")),e},Mr={exports:{}};Mr.exports;(function(t,e){var r=200,n="__lodash_hash_undefined__",i=1,o=2,a=9007199254740991,u="[object Arguments]",s="[object Array]",p="[object AsyncFunction]",d="[object Boolean]",v="[object Date]",f="[object Error]",c="[object Function]",g="[object GeneratorFunction]",_="[object Map]",w="[object Number]",M="[object Null]",O="[object Object]",T="[object Promise]",A="[object Proxy]",C="[object RegExp]",R="[object Set]",$="[object String]",B="[object Symbol]",y="[object Undefined]",I="[object WeakMap]",m="[object ArrayBuffer]",b="[object DataView]",S="[object Float32Array]",F="[object Float64Array]",U="[object Int8Array]",Q="[object Int16Array]",fe="[object Int32Array]",we="[object Uint8Array]",He="[object Uint8ClampedArray]",Ct="[object Uint16Array]",ne="[object Uint32Array]",x=/[\\^$.*+?()[\]{}|]/g,N=/^\[object .+?Constructor\]$/,j=/^(?:0|[1-9]\d*)$/,L={};L[S]=L[F]=L[U]=L[Q]=L[fe]=L[we]=L[He]=L[Ct]=L[ne]=!0,L[u]=L[s]=L[m]=L[d]=L[b]=L[v]=L[f]=L[c]=L[_]=L[w]=L[O]=L[C]=L[R]=L[$]=L[I]=!1;var W=typeof window=="object"&&window&&window.Object===Object&&window,k=typeof self=="object"&&self&&self.Object===Object&&self,z=W||k||Function("return this")(),de=e&&!e.nodeType&&e,ue=de&&!0&&t&&!t.nodeType&&t,be=ue&&ue.exports===de,$t=be&&W.process,Ot=function(){try{return $t&&$t.binding&&$t.binding("util")}catch{}}(),Te=Ot&&Ot.isTypedArray;function Pt(l,h){for(var E=-1,P=l==null?0:l.length,H=0,D=[];++E<P;){var X=l[E];h(X,E,l)&&(D[H++]=X)}return D}function Ft(l,h){for(var E=-1,P=h.length,H=l.length;++E<P;)l[H+E]=h[E];return l}function Jt(l,h){for(var E=-1,P=l==null?0:l.length;++E<P;)if(h(l[E],E,l))return!0;return!1}function en(l,h){for(var E=-1,P=Array(l);++E<l;)P[E]=h(E);return P}function Ul(l){return function(h){return l(h)}}function kl(l,h){return l.has(h)}function ql(l,h){return l==null?void 0:l[h]}function jl(l){var h=-1,E=Array(l.size);return l.forEach(function(P,H){E[++h]=[H,P]}),E}function Gl(l,h){return function(E){return l(h(E))}}function Vl(l){var h=-1,E=Array(l.size);return l.forEach(function(P){E[++h]=P}),E}var Wl=Array.prototype,zl=Function.prototype,Yt=Object.prototype,tn=z["__core-js_shared__"],Wo=zl.toString,Ae=Yt.hasOwnProperty,zo=function(){var l=/[^.]+$/.exec(tn&&tn.keys&&tn.keys.IE_PROTO||"");return l?"Symbol(src)_1."+l:""}(),Ho=Yt.toString,Hl=RegExp("^"+Wo.call(Ae).replace(x,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ko=be?z.Buffer:void 0,Zt=z.Symbol,Jo=z.Uint8Array,Yo=Yt.propertyIsEnumerable,Kl=Wl.splice,Ke=Zt?Zt.toStringTag:void 0,Zo=Object.getOwnPropertySymbols,Jl=Ko?Ko.isBuffer:void 0,Yl=Gl(Object.keys,Object),rn=at(z,"DataView"),Mt=at(z,"Map"),nn=at(z,"Promise"),on=at(z,"Set"),an=at(z,"WeakMap"),Rt=at(Object,"create"),Zl=Ze(rn),Xl=Ze(Mt),Ql=Ze(nn),ef=Ze(on),tf=Ze(an),Xo=Zt?Zt.prototype:void 0,sn=Xo?Xo.valueOf:void 0;function Je(l){var h=-1,E=l==null?0:l.length;for(this.clear();++h<E;){var P=l[h];this.set(P[0],P[1])}}function rf(){this.__data__=Rt?Rt(null):{},this.size=0}function nf(l){var h=this.has(l)&&delete this.__data__[l];return this.size-=h?1:0,h}function of(l){var h=this.__data__;if(Rt){var E=h[l];return E===n?void 0:E}return Ae.call(h,l)?h[l]:void 0}function af(l){var h=this.__data__;return Rt?h[l]!==void 0:Ae.call(h,l)}function sf(l,h){var E=this.__data__;return this.size+=this.has(l)?0:1,E[l]=Rt&&h===void 0?n:h,this}Je.prototype.clear=rf,Je.prototype.delete=nf,Je.prototype.get=of,Je.prototype.has=af,Je.prototype.set=sf;function Oe(l){var h=-1,E=l==null?0:l.length;for(this.clear();++h<E;){var P=l[h];this.set(P[0],P[1])}}function uf(){this.__data__=[],this.size=0}function cf(l){var h=this.__data__,E=Qt(h,l);if(E<0)return!1;var P=h.length-1;return E==P?h.pop():Kl.call(h,E,1),--this.size,!0}function lf(l){var h=this.__data__,E=Qt(h,l);return E<0?void 0:h[E][1]}function ff(l){return Qt(this.__data__,l)>-1}function pf(l,h){var E=this.__data__,P=Qt(E,l);return P<0?(++this.size,E.push([l,h])):E[P][1]=h,this}Oe.prototype.clear=uf,Oe.prototype.delete=cf,Oe.prototype.get=lf,Oe.prototype.has=ff,Oe.prototype.set=pf;function Ye(l){var h=-1,E=l==null?0:l.length;for(this.clear();++h<E;){var P=l[h];this.set(P[0],P[1])}}function df(){this.size=0,this.__data__={hash:new Je,map:new(Mt||Oe),string:new Je}}function hf(l){var h=er(this,l).delete(l);return this.size-=h?1:0,h}function yf(l){return er(this,l).get(l)}function gf(l){return er(this,l).has(l)}function vf(l,h){var E=er(this,l),P=E.size;return E.set(l,h),this.size+=E.size==P?0:1,this}Ye.prototype.clear=df,Ye.prototype.delete=hf,Ye.prototype.get=yf,Ye.prototype.has=gf,Ye.prototype.set=vf;function Xt(l){var h=-1,E=l==null?0:l.length;for(this.__data__=new Ye;++h<E;)this.add(l[h])}function mf(l){return this.__data__.set(l,n),this}function bf(l){return this.__data__.has(l)}Xt.prototype.add=Xt.prototype.push=mf,Xt.prototype.has=bf;function Ne(l){var h=this.__data__=new Oe(l);this.size=h.size}function Tf(){this.__data__=new Oe,this.size=0}function _f(l){var h=this.__data__,E=h.delete(l);return this.size=h.size,E}function Sf(l){return this.__data__.get(l)}function Ef(l){return this.__data__.has(l)}function wf(l,h){var E=this.__data__;if(E instanceof Oe){var P=E.__data__;if(!Mt||P.length<r-1)return P.push([l,h]),this.size=++E.size,this;E=this.__data__=new Ye(P)}return E.set(l,h),this.size=E.size,this}Ne.prototype.clear=Tf,Ne.prototype.delete=_f,Ne.prototype.get=Sf,Ne.prototype.has=Ef,Ne.prototype.set=wf;function Af(l,h){var E=tr(l),P=!E&&kf(l),H=!E&&!P&&un(l),D=!E&&!P&&!H&&sa(l),X=E||P||H||D,ie=X?en(l.length,String):[],ae=ie.length;for(var J in l)Ae.call(l,J)&&!(X&&(J=="length"||H&&(J=="offset"||J=="parent")||D&&(J=="buffer"||J=="byteLength"||J=="byteOffset")||xf(J,ae)))&&ie.push(J);return ie}function Qt(l,h){for(var E=l.length;E--;)if(na(l[E][0],h))return E;return-1}function If(l,h,E){var P=h(l);return tr(l)?P:Ft(P,E(l))}function Lt(l){return l==null?l===void 0?y:M:Ke&&Ke in Object(l)?Rf(l):Uf(l)}function Qo(l){return xt(l)&&Lt(l)==u}function ea(l,h,E,P,H){return l===h?!0:l==null||h==null||!xt(l)&&!xt(h)?l!==l&&h!==h:Cf(l,h,E,P,ea,H)}function Cf(l,h,E,P,H,D){var X=tr(l),ie=tr(h),ae=X?s:Be(l),J=ie?s:Be(h);ae=ae==u?O:ae,J=J==u?O:J;var pe=ae==O,_e=J==O,se=ae==J;if(se&&un(l)){if(!un(h))return!1;X=!0,pe=!1}if(se&&!pe)return D||(D=new Ne),X||sa(l)?ta(l,h,E,P,H,D):Ff(l,h,ae,E,P,H,D);if(!(E&i)){var he=pe&&Ae.call(l,"__wrapped__"),ye=_e&&Ae.call(h,"__wrapped__");if(he||ye){var De=he?l.value():l,Pe=ye?h.value():h;return D||(D=new Ne),H(De,Pe,E,P,D)}}return se?(D||(D=new Ne),Mf(l,h,E,P,H,D)):!1}function $f(l){if(!aa(l)||Bf(l))return!1;var h=ia(l)?Hl:N;return h.test(Ze(l))}function Of(l){return xt(l)&&oa(l.length)&&!!L[Lt(l)]}function Pf(l){if(!Df(l))return Yl(l);var h=[];for(var E in Object(l))Ae.call(l,E)&&E!="constructor"&&h.push(E);return h}function ta(l,h,E,P,H,D){var X=E&i,ie=l.length,ae=h.length;if(ie!=ae&&!(X&&ae>ie))return!1;var J=D.get(l);if(J&&D.get(h))return J==h;var pe=-1,_e=!0,se=E&o?new Xt:void 0;for(D.set(l,h),D.set(h,l);++pe<ie;){var he=l[pe],ye=h[pe];if(P)var De=X?P(ye,he,pe,h,l,D):P(he,ye,pe,l,h,D);if(De!==void 0){if(De)continue;_e=!1;break}if(se){if(!Jt(h,function(Pe,Xe){if(!kl(se,Xe)&&(he===Pe||H(he,Pe,E,P,D)))return se.push(Xe)})){_e=!1;break}}else if(!(he===ye||H(he,ye,E,P,D))){_e=!1;break}}return D.delete(l),D.delete(h),_e}function Ff(l,h,E,P,H,D,X){switch(E){case b:if(l.byteLength!=h.byteLength||l.byteOffset!=h.byteOffset)return!1;l=l.buffer,h=h.buffer;case m:return!(l.byteLength!=h.byteLength||!D(new Jo(l),new Jo(h)));case d:case v:case w:return na(+l,+h);case f:return l.name==h.name&&l.message==h.message;case C:case $:return l==h+"";case _:var ie=jl;case R:var ae=P&i;if(ie||(ie=Vl),l.size!=h.size&&!ae)return!1;var J=X.get(l);if(J)return J==h;P|=o,X.set(l,h);var pe=ta(ie(l),ie(h),P,H,D,X);return X.delete(l),pe;case B:if(sn)return sn.call(l)==sn.call(h)}return!1}function Mf(l,h,E,P,H,D){var X=E&i,ie=ra(l),ae=ie.length,J=ra(h),pe=J.length;if(ae!=pe&&!X)return!1;for(var _e=ae;_e--;){var se=ie[_e];if(!(X?se in h:Ae.call(h,se)))return!1}var he=D.get(l);if(he&&D.get(h))return he==h;var ye=!0;D.set(l,h),D.set(h,l);for(var De=X;++_e<ae;){se=ie[_e];var Pe=l[se],Xe=h[se];if(P)var ua=X?P(Xe,Pe,se,h,l,D):P(Pe,Xe,se,l,h,D);if(!(ua===void 0?Pe===Xe||H(Pe,Xe,E,P,D):ua)){ye=!1;break}De||(De=se=="constructor")}if(ye&&!De){var rr=l.constructor,nr=h.constructor;rr!=nr&&"constructor"in l&&"constructor"in h&&!(typeof rr=="function"&&rr instanceof rr&&typeof nr=="function"&&nr instanceof nr)&&(ye=!1)}return D.delete(l),D.delete(h),ye}function ra(l){return If(l,Gf,Lf)}function er(l,h){var E=l.__data__;return Nf(h)?E[typeof h=="string"?"string":"hash"]:E.map}function at(l,h){var E=ql(l,h);return $f(E)?E:void 0}function Rf(l){var h=Ae.call(l,Ke),E=l[Ke];try{l[Ke]=void 0;var P=!0}catch{}var H=Ho.call(l);return P&&(h?l[Ke]=E:delete l[Ke]),H}var Lf=Zo?function(l){return l==null?[]:(l=Object(l),Pt(Zo(l),function(h){return Yo.call(l,h)}))}:Vf,Be=Lt;(rn&&Be(new rn(new ArrayBuffer(1)))!=b||Mt&&Be(new Mt)!=_||nn&&Be(nn.resolve())!=T||on&&Be(new on)!=R||an&&Be(new an)!=I)&&(Be=function(l){var h=Lt(l),E=h==O?l.constructor:void 0,P=E?Ze(E):"";if(P)switch(P){case Zl:return b;case Xl:return _;case Ql:return T;case ef:return R;case tf:return I}return h});function xf(l,h){return h=h??a,!!h&&(typeof l=="number"||j.test(l))&&l>-1&&l%1==0&&l<h}function Nf(l){var h=typeof l;return h=="string"||h=="number"||h=="symbol"||h=="boolean"?l!=="__proto__":l===null}function Bf(l){return!!zo&&zo in l}function Df(l){var h=l&&l.constructor,E=typeof h=="function"&&h.prototype||Yt;return l===E}function Uf(l){return Ho.call(l)}function Ze(l){if(l!=null){try{return Wo.call(l)}catch{}try{return l+""}catch{}}return""}function na(l,h){return l===h||l!==l&&h!==h}var kf=Qo(function(){return arguments}())?Qo:function(l){return xt(l)&&Ae.call(l,"callee")&&!Yo.call(l,"callee")},tr=Array.isArray;function qf(l){return l!=null&&oa(l.length)&&!ia(l)}var un=Jl||Wf;function jf(l,h){return ea(l,h)}function ia(l){if(!aa(l))return!1;var h=Lt(l);return h==c||h==g||h==p||h==A}function oa(l){return typeof l=="number"&&l>-1&&l%1==0&&l<=a}function aa(l){var h=typeof l;return l!=null&&(h=="object"||h=="function")}function xt(l){return l!=null&&typeof l=="object"}var sa=Te?Ul(Te):Of;function Gf(l){return qf(l)?Af(l):Pf(l)}function Vf(){return[]}function Wf(){return!1}t.exports=jf})(Mr,Mr.exports);var G0=Mr.exports,V0=function(t,e){return t.length!==e.length?!1:JSON.stringify(t.map(r=>r).sort())===JSON.stringify(e.map(r=>r).sort())},Rl={},yo={exports:{}};(function(t,e){var r={env:{},argv:[]},n=function(){var i=function(O,T,A,C){for(A=A||{},C=O.length;C--;A[O[C]]=T);return A},o=[1,12],a=[1,13],u=[1,9],s=[1,10],p=[1,11],d=[1,14],v=[1,15],f=[14,18,22,24],c=[18,22],g=[22,24],_={trace:function(){},yy:{},symbols_:{error:2,JSONString:3,STRING:4,JSONNumber:5,NUMBER:6,JSONNullLiteral:7,NULL:8,JSONBooleanLiteral:9,TRUE:10,FALSE:11,JSONText:12,JSONValue:13,EOF:14,JSONObject:15,JSONArray:16,"{":17,"}":18,JSONMemberList:19,JSONMember:20,":":21,",":22,"[":23,"]":24,JSONElementList:25,$accept:0,$end:1},terminals_:{2:"error",4:"STRING",6:"NUMBER",8:"NULL",10:"TRUE",11:"FALSE",14:"EOF",17:"{",18:"}",21:":",22:",",23:"[",24:"]"},productions_:[0,[3,1],[5,1],[7,1],[9,1],[9,1],[12,2],[13,1],[13,1],[13,1],[13,1],[13,1],[13,1],[15,2],[15,3],[20,3],[19,1],[19,3],[16,2],[16,3],[25,1],[25,3]],performAction:function(T,A,C,R,$,B,y){var I=B.length-1;switch($){case 1:this.$=T.replace(/\\(\\|")/g,"$1").replace(/\\n/g,`
`).replace(/\\r/g,"\r").replace(/\\t/g,"	").replace(/\\v/g,"\v").replace(/\\f/g,"\f").replace(/\\b/g,"\b");break;case 2:this.$=Number(T);break;case 3:this.$=null;break;case 4:this.$=!0;break;case 5:this.$=!1;break;case 6:return this.$=B[I-1];case 13:this.$={},Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 14:case 19:this.$=B[I-1],Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 15:this.$=[B[I-2],B[I]];break;case 16:this.$={},this.$[B[I][0]]=B[I][1];break;case 17:this.$=B[I-2],B[I-2][B[I][0]]!==void 0&&(this.$.__duplicateProperties__||Object.defineProperty(this.$,"__duplicateProperties__",{value:[],enumerable:!1}),this.$.__duplicateProperties__.push(B[I][0])),B[I-2][B[I][0]]=B[I][1];break;case 18:this.$=[],Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 20:this.$=[B[I]];break;case 21:this.$=B[I-2],B[I-2].push(B[I]);break}},table:[{3:5,4:o,5:6,6:a,7:3,8:u,9:4,10:s,11:p,12:1,13:2,15:7,16:8,17:d,23:v},{1:[3]},{14:[1,16]},i(f,[2,7]),i(f,[2,8]),i(f,[2,9]),i(f,[2,10]),i(f,[2,11]),i(f,[2,12]),i(f,[2,3]),i(f,[2,4]),i(f,[2,5]),i([14,18,21,22,24],[2,1]),i(f,[2,2]),{3:20,4:o,18:[1,17],19:18,20:19},{3:5,4:o,5:6,6:a,7:3,8:u,9:4,10:s,11:p,13:23,15:7,16:8,17:d,23:v,24:[1,21],25:22},{1:[2,6]},i(f,[2,13]),{18:[1,24],22:[1,25]},i(c,[2,16]),{21:[1,26]},i(f,[2,18]),{22:[1,28],24:[1,27]},i(g,[2,20]),i(f,[2,14]),{3:20,4:o,20:29},{3:5,4:o,5:6,6:a,7:3,8:u,9:4,10:s,11:p,13:30,15:7,16:8,17:d,23:v},i(f,[2,19]),{3:5,4:o,5:6,6:a,7:3,8:u,9:4,10:s,11:p,13:31,15:7,16:8,17:d,23:v},i(c,[2,17]),i(c,[2,15]),i(g,[2,21])],defaultActions:{16:[2,6]},parseError:function(T,A){if(A.recoverable)this.trace(T);else{let C=function(R,$){this.message=R,this.hash=$};throw C.prototype=Error,new C(T,A)}},parse:function(T){var A=this,C=[0],R=[null],$=[],B=this.table,y="",I=0,m=0,b=2,S=1,F=$.slice.call(arguments,1),U=Object.create(this.lexer),Q={yy:{}};for(var fe in this.yy)Object.prototype.hasOwnProperty.call(this.yy,fe)&&(Q.yy[fe]=this.yy[fe]);U.setInput(T,Q.yy),Q.yy.lexer=U,Q.yy.parser=this,typeof U.yylloc>"u"&&(U.yylloc={});var we=U.yylloc;$.push(we);var He=U.options&&U.options.ranges;typeof Q.yy.parseError=="function"?this.parseError=Q.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var Ct=function(){var be;return be=U.lex()||S,typeof be!="number"&&(be=A.symbols_[be]||be),be},ne,x,N,j,L={},W,k,z,de;;){if(x=C[C.length-1],this.defaultActions[x]?N=this.defaultActions[x]:((ne===null||typeof ne>"u")&&(ne=Ct()),N=B[x]&&B[x][ne]),typeof N>"u"||!N.length||!N[0]){var ue="";de=[];for(W in B[x])this.terminals_[W]&&W>b&&de.push("'"+this.terminals_[W]+"'");U.showPosition?ue="Parse error on line "+(I+1)+`:
`+U.showPosition()+`
Expecting `+de.join(", ")+", got '"+(this.terminals_[ne]||ne)+"'":ue="Parse error on line "+(I+1)+": Unexpected "+(ne==S?"end of input":"'"+(this.terminals_[ne]||ne)+"'"),this.parseError(ue,{text:U.match,token:this.terminals_[ne]||ne,line:U.yylineno,loc:we,expected:de})}if(N[0]instanceof Array&&N.length>1)throw new Error("Parse Error: multiple actions possible at state: "+x+", token: "+ne);switch(N[0]){case 1:C.push(ne),R.push(U.yytext),$.push(U.yylloc),C.push(N[1]),ne=null,m=U.yyleng,y=U.yytext,I=U.yylineno,we=U.yylloc;break;case 2:if(k=this.productions_[N[1]][1],L.$=R[R.length-k],L._$={first_line:$[$.length-(k||1)].first_line,last_line:$[$.length-1].last_line,first_column:$[$.length-(k||1)].first_column,last_column:$[$.length-1].last_column},He&&(L._$.range=[$[$.length-(k||1)].range[0],$[$.length-1].range[1]]),j=this.performAction.apply(L,[y,m,I,Q.yy,N[1],R,$].concat(F)),typeof j<"u")return j;k&&(C=C.slice(0,-1*k*2),R=R.slice(0,-1*k),$=$.slice(0,-1*k)),C.push(this.productions_[N[1]][0]),R.push(L.$),$.push(L._$),z=B[C[C.length-2]][C[C.length-1]],C.push(z);break;case 3:return!0}}return!0}},w=function(){var O={EOF:1,parseError:function(A,C){if(this.yy.parser)this.yy.parser.parseError(A,C);else throw new Error(A)},setInput:function(T,A){return this.yy=A||this.yy||{},this._input=T,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var T=this._input[0];this.yytext+=T,this.yyleng++,this.offset++,this.match+=T,this.matched+=T;var A=T.match(/(?:\r\n?|\n).*/g);return A?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),T},unput:function(T){var A=T.length,C=T.split(/(?:\r\n?|\n)/g);this._input=T+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-A),this.offset-=A;var R=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),C.length-1&&(this.yylineno-=C.length-1);var $=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:C?(C.length===R.length?this.yylloc.first_column:0)+R[R.length-C.length].length-C[0].length:this.yylloc.first_column-A},this.options.ranges&&(this.yylloc.range=[$[0],$[0]+this.yyleng-A]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(T){this.unput(this.match.slice(T))},pastInput:function(){var T=this.matched.substr(0,this.matched.length-this.match.length);return(T.length>20?"...":"")+T.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var T=this.match;return T.length<20&&(T+=this._input.substr(0,20-T.length)),(T.substr(0,20)+(T.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var T=this.pastInput(),A=new Array(T.length+1).join("-");return T+this.upcomingInput()+`
`+A+"^"},test_match:function(T,A){var C,R,$;if(this.options.backtrack_lexer&&($={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&($.yylloc.range=this.yylloc.range.slice(0))),R=T[0].match(/(?:\r\n?|\n).*/g),R&&(this.yylineno+=R.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:R?R[R.length-1].length-R[R.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+T[0].length},this.yytext+=T[0],this.match+=T[0],this.matches=T,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(T[0].length),this.matched+=T[0],C=this.performAction.call(this,this.yy,this,A,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),C)return C;if(this._backtrack){for(var B in $)this[B]=$[B];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var T,A,C,R;this._more||(this.yytext="",this.match="");for(var $=this._currentRules(),B=0;B<$.length;B++)if(C=this._input.match(this.rules[$[B]]),C&&(!A||C[0].length>A[0].length)){if(A=C,R=B,this.options.backtrack_lexer){if(T=this.test_match(C,$[B]),T!==!1)return T;if(this._backtrack){A=!1;continue}else return!1}else if(!this.options.flex)break}return A?(T=this.test_match(A,$[R]),T!==!1?T:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var A=this.next();return A||this.lex()},begin:function(A){this.conditionStack.push(A)},popState:function(){var A=this.conditionStack.length-1;return A>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(A){return A=this.conditionStack.length-1-Math.abs(A||0),A>=0?this.conditionStack[A]:"INITIAL"},pushState:function(A){this.begin(A)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(A,C,R,$){switch(R){case 0:break;case 1:return 6;case 2:return C.yytext=C.yytext.substr(1,C.yyleng-2),4;case 3:return 17;case 4:return 18;case 5:return 23;case 6:return 24;case 7:return 22;case 8:return 21;case 9:return 10;case 10:return 11;case 11:return 8;case 12:return 14;case 13:return"INVALID"}},rules:[/^(?:\s+)/,/^(?:(-?([0-9]|[1-9][0-9]+))(\.[0-9]+)?([eE][-+]?[0-9]+)?\b)/,/^(?:"(?:\\[\\"bfnrt\/]|\\u[a-fA-F0-9]{4}|[^\\\0-\x09\x0a-\x1f"])*")/,/^(?:\{)/,/^(?:\})/,/^(?:\[)/,/^(?:\])/,/^(?:,)/,/^(?::)/,/^(?:true\b)/,/^(?:false\b)/,/^(?:null\b)/,/^(?:$)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13],inclusive:!0}}};return O}();_.lexer=w;function M(){this.yy={}}return M.prototype=_,_.Parser=M,new M}();typeof pp<"u"&&(e.parser=n,e.Parser=n.Parser,e.parse=function(){return n.parse.apply(n,arguments)},e.main=function(o){o[1]||(console.log("Usage: "+o[0]+" FILE"),r.exit(1));var a=to.readFileSync(to.normalize(o[1]),"utf8");return e.parser.parse(a)},require.main===t&&e.main(r.argv.slice(1)))})(yo,yo.exports);var W0=yo.exports,Ll={};function Ki(t){return t*Math.PI/180}function Gu(t){var e=0;if(t.length>2)for(var r,n,i=0;i<t.length-1;i++)r=t[i],n=t[i+1],e+=Ki(n[0]-r[0])*(2+Math.sin(Ki(r[1]))+Math.sin(Ki(n[1])));return e>=0}function Vu(t){if(t&&t.length>0){if(Gu(t[0]))return!1;var e=t.slice(1,t.length);if(!e.every(Gu))return!1}return!0}function z0(t){if(t.type==="Polygon")return Vu(t.coordinates);if(t.type==="MultiPolygon")return t.coordinates.every(Vu)}var H0=function(e,r){z0(e)||r.push({message:"Polygons and MultiPolygons should follow the right-hand rule",level:"message",line:e.__line__})},Wu=H0;function K0(t,e){var r=[],n=0,i=10,o=6;function a(y){if((!e||e.noDuplicateMembers!==!1)&&y.__duplicateProperties__&&r.push({message:"An object contained duplicate members, making parsing ambigous: "+y.__duplicateProperties__.join(", "),line:y.__line__}),!s(y,"type","string"))if($[y.type])y&&$[y.type](y);else{var I=B[y.type.toLowerCase()];I!==void 0?r.push({message:"Expected "+I+" but got "+y.type+" (case sensitive)",line:y.__line__}):r.push({message:"The type "+y.type+" is unknown",line:y.__line__})}}function u(y,I){return y.every(function(m){return m!==null&&typeof m===I})}function s(y,I,m){if(typeof y[I]>"u")return r.push({message:'"'+I+'" member required',line:y.__line__});if(m==="array"){if(!Array.isArray(y[I]))return r.push({message:'"'+I+'" member should be an array, but is an '+typeof y[I]+" instead",line:y.__line__})}else{if(m==="object"&&y[I]&&y[I].constructor!==Object)return r.push({message:'"'+I+'" member should be '+m+", but is an "+y[I].constructor.name+" instead",line:y.__line__});if(m&&typeof y[I]!==m)return r.push({message:'"'+I+'" member should be '+m+", but is an "+typeof y[I]+" instead",line:y.__line__})}}function p(y){if(f(y),c(y),y.properties!==void 0&&r.push({message:'FeatureCollection object cannot contain a "properties" member',line:y.__line__}),y.coordinates!==void 0&&r.push({message:'FeatureCollection object cannot contain a "coordinates" member',line:y.__line__}),!s(y,"features","array")){if(!u(y.features,"object"))return r.push({message:"Every feature must be an object",line:y.__line__});y.features.forEach(R)}}function d(y,I){if(!Array.isArray(y))return r.push({message:"position should be an array, is a "+typeof y+" instead",line:y.__line__||I});if(y.length<2)return r.push({message:"position must have 2 or more elements",line:y.__line__||I});if(y.length>3)return r.push({message:"position should not have more than 3 elements",level:"message",line:y.__line__||I});if(!u(y,"number"))return r.push({message:"each element in a position must be a number",line:y.__line__||I});if(e&&e.precisionWarning){if(n===i)return n+=1,r.push({message:"truncated warnings: we've encountered coordinate precision warning "+i+" times, no more warnings will be reported",level:"message",line:y.__line__||I});n<i&&y.forEach(function(m){var b=0,S=String(m).split(".")[1];if(S!==void 0&&(b=S.length),b>o)return n+=1,r.push({message:"precision of coordinates should be reduced",level:"message",line:y.__line__||I})})}}function v(y,I,m,b){if(b===void 0&&y.__line__!==void 0&&(b=y.__line__),m===0)return d(y,b);if(m===1&&I){if(I==="LinearRing"){if(!Array.isArray(y[y.length-1]))return r.push({message:"a number was found where a coordinate array should have been found: this needs to be nested more deeply",line:b}),!0;if(y.length<4&&r.push({message:"a LinearRing of coordinates needs to have four or more positions",line:b}),y.length&&(y[y.length-1].length!==y[0].length||!y[y.length-1].every(function(F,U){return y[0][U]===F})))return r.push({message:"the first and last positions in a LinearRing of coordinates must be the same",line:b}),!0}else if(I==="Line"&&y.length<2)return r.push({message:"a line needs to have two or more coordinates to be valid",line:b})}if(!Array.isArray(y))r.push({message:"a number was found where a coordinate array should have been found: this needs to be nested more deeply",line:b});else{var S=y.map(function(F){return v(F,I,m-1,F.__line__||b)});return S.some(function(F){return F})}}function f(y){if(y.crs){var I="urn:ogc:def:crs:OGC:1.3:CRS84";typeof y.crs=="object"&&y.crs.properties&&y.crs.properties.name===I?r.push({message:"old-style crs member is not recommended, this object is equivalent to the default and should be removed",line:y.__line__}):r.push({message:"old-style crs member is not recommended",line:y.__line__})}}function c(y){if(y.bbox){if(Array.isArray(y.bbox))return u(y.bbox,"number")||r.push({message:"each element in a bbox member must be a number",line:y.bbox.__line__}),y.bbox.length===4||y.bbox.length===6||r.push({message:"bbox must contain 4 elements (for 2D) or 6 elements (for 3D)",line:y.bbox.__line__}),r.length;r.push({message:"bbox member must be an array of numbers, but is a "+typeof y.bbox,line:y.__line__})}}function g(y){y.properties!==void 0&&r.push({message:'geometry object cannot contain a "properties" member',line:y.__line__}),y.geometry!==void 0&&r.push({message:'geometry object cannot contain a "geometry" member',line:y.__line__}),y.features!==void 0&&r.push({message:'geometry object cannot contain a "features" member',line:y.__line__})}function _(y){f(y),c(y),g(y),s(y,"coordinates","array")||d(y.coordinates)}function w(y){f(y),c(y),s(y,"coordinates","array")||v(y.coordinates,"LinearRing",2)||Wu(y,r)}function M(y){f(y),c(y),s(y,"coordinates","array")||v(y.coordinates,"LinearRing",3)||Wu(y,r)}function O(y){f(y),c(y),s(y,"coordinates","array")||v(y.coordinates,"Line",1)}function T(y){f(y),c(y),s(y,"coordinates","array")||v(y.coordinates,"Line",2)}function A(y){f(y),c(y),s(y,"coordinates","array")||v(y.coordinates,"",1)}function C(y){f(y),c(y),s(y,"geometries","array")||(u(y.geometries,"object")||r.push({message:"The geometries array in a GeometryCollection must contain only geometry objects",line:y.__line__}),y.geometries.length===1&&r.push({message:"GeometryCollection with a single geometry should be avoided in favor of single part or a single object of multi-part type",line:y.geometries.__line__}),y.geometries.forEach(function(I){I&&(I.type==="GeometryCollection"&&r.push({message:"GeometryCollection should avoid nested geometry collections",line:y.geometries.__line__}),a(I))}))}function R(y){f(y),c(y),y.id!==void 0&&typeof y.id!="string"&&typeof y.id!="number"&&r.push({message:'Feature "id" member must have a string or number value',line:y.__line__}),y.features!==void 0&&r.push({message:'Feature object cannot contain a "features" member',line:y.__line__}),y.coordinates!==void 0&&r.push({message:'Feature object cannot contain a "coordinates" member',line:y.__line__}),y.type!=="Feature"&&r.push({message:"GeoJSON features must have a type=feature member",line:y.__line__}),s(y,"properties","object"),s(y,"geometry","object")||y.geometry&&a(y.geometry)}var $={Point:_,Feature:R,MultiPoint:A,LineString:O,MultiLineString:T,FeatureCollection:p,GeometryCollection:C,Polygon:w,MultiPolygon:M},B=Object.keys($).reduce(function(y,I){return y[I.toLowerCase()]=I,y},{});return typeof t!="object"||t===null||t===void 0?(r.push({message:"The root of a GeoJSON object must be an object.",line:0}),r):(a(t),r.forEach(function(y){({}).hasOwnProperty.call(y,"line")&&y.line===void 0&&delete y.line}),r)}Ll.hint=K0;var J0=W0,Y0=Ll;function Z0(t,e){var r,n=[];if(typeof t=="object")r=t;else if(typeof t=="string")try{r=J0.parse(t)}catch(a){var i=a.message.match(/line (\d+)/),o=parseInt(i[1],10);return[{line:o-1,message:a.message,error:a}]}else return[{message:"Expected string or object as input",line:0}];return n=n.concat(Y0.hint(r,e)),n}Rl.hint=Z0;const X0=G0,Q0=Ku,eT=To,tT=Nr,rT=V0,nT=Rl,ce=G,iT=xr,oT={Polygon:Eo,LineString:So,Point:_o,MultiPolygon:br,MultiLineString:br,MultiPoint:br};var aT=function(t,e){return e.modes=ce.modes,e.getFeatureIdsAt=function(r){return tT.click({point:r},null,t).map(i=>i.properties.id)},e.getSelectedIds=function(){return t.store.getSelectedIds()},e.getSelected=function(){return{type:ce.geojsonTypes.FEATURE_COLLECTION,features:t.store.getSelectedIds().map(r=>t.store.get(r)).map(r=>r.toGeoJSON())}},e.getSelectedPoints=function(){return{type:ce.geojsonTypes.FEATURE_COLLECTION,features:t.store.getSelectedCoordinates().map(r=>({type:ce.geojsonTypes.FEATURE,properties:{},geometry:{type:ce.geojsonTypes.POINT,coordinates:r.coordinates}}))}},e.set=function(r){if(r.type===void 0||r.type!==ce.geojsonTypes.FEATURE_COLLECTION||!Array.isArray(r.features))throw new Error("Invalid FeatureCollection");const n=t.store.createRenderBatch();let i=t.store.getAllIds().slice();const o=e.add(r),a=new iT(o);return i=i.filter(u=>!a.has(u)),i.length&&e.delete(i),n(),o},e.add=function(r){const n=nT.hint(r,{precisionWarning:!1}).filter(a=>a.level!=="message");if(n.length)throw new Error(n[0].message);const o=JSON.parse(JSON.stringify(Q0(r))).features.map(a=>{if(a.id=a.id||eT(),a.geometry===null)throw new Error("Invalid geometry: null");if(t.store.get(a.id)===void 0||t.store.get(a.id).type!==a.geometry.type){const u=oT[a.geometry.type];if(u===void 0)throw new Error(`Invalid geometry type: ${a.geometry.type}.`);const s=new u(t,a);t.store.add(s)}else{const u=t.store.get(a.id);u.properties=a.properties,X0(u.getCoordinates(),a.geometry.coordinates)||u.incomingCoords(a.geometry.coordinates)}return a.id});return t.store.render(),o},e.get=function(r){const n=t.store.get(r);if(n)return n.toGeoJSON()},e.getAll=function(){return{type:ce.geojsonTypes.FEATURE_COLLECTION,features:t.store.getAll().map(r=>r.toGeoJSON())}},e.delete=function(r){return t.store.delete(r,{silent:!0}),e.getMode()===ce.modes.DIRECT_SELECT&&!t.store.getSelectedIds().length?t.events.changeMode(ce.modes.SIMPLE_SELECT,void 0,{silent:!0}):t.store.render(),e},e.deleteAll=function(){return t.store.delete(t.store.getAllIds(),{silent:!0}),e.getMode()===ce.modes.DIRECT_SELECT?t.events.changeMode(ce.modes.SIMPLE_SELECT,void 0,{silent:!0}):t.store.render(),e},e.changeMode=function(r,n={}){return r===ce.modes.SIMPLE_SELECT&&e.getMode()===ce.modes.SIMPLE_SELECT?(rT(n.featureIds||[],t.store.getSelectedIds())||(t.store.setSelected(n.featureIds,{silent:!0}),t.store.render()),e):(r===ce.modes.DIRECT_SELECT&&e.getMode()===ce.modes.DIRECT_SELECT&&n.featureId===t.store.getSelectedIds()[0]||t.events.changeMode(r,n,{silent:!0}),e)},e.getMode=function(){return t.events.getMode()},e.trash=function(){return t.events.trash({silent:!0}),e},e.combineFeatures=function(){return t.events.combineFeatures({silent:!0}),e},e.uncombineFeatures=function(){return t.events.uncombineFeatures({silent:!0}),e},e.setFeatureProperty=function(r,n,i){return t.store.setFeatureProperty(r,n,i),e},e};const sT=ld,uT=j0,cT=aT,lT=G,fT=function(t,e){t=uT(t);const r={options:t};e=cT(r,e),r.api=e;const n=sT(r);return e.onAdd=n.onAdd,e.onRemove=n.onRemove,e.types=lT.types,e.options=t,e};bo.exports=function(t){fT(t,this)};bo.exports.modes=Ml();var Xr=bo.exports;const jo=vo(cp),pT=Xr,kt=G,dT=bt,hT=jo.default,xl={...pT.modes.draw_polygon},yT=2;xl.onSetup=function(t){const e=this.newFeature({type:kt.geojsonTypes.FEATURE,properties:{isCircle:!0,center:[]},geometry:{type:kt.geojsonTypes.POLYGON,coordinates:[[]]}});return this.addFeature(e),this.clearSelectedFeatures(),dT.disable(this),this.updateUIClasses({mouse:kt.cursors.ADD}),this.activateUIButton(kt.types.POLYGON),this.setActionableState({trash:!0}),{initialRadiusInKm:t.initialRadiusInKm||yT,polygon:e,currentVertexPosition:0}};xl.clickAnywhere=function(t,e){if(t.currentVertexPosition===0){t.currentVertexPosition++;const r=[e.lngLat.lng,e.lngLat.lat],n=hT(r,t.initialRadiusInKm);t.polygon.incomingCoords(n.geometry.coordinates),t.polygon.properties.center=r,t.polygon.properties.radiusInKm=t.initialRadiusInKm}return this.changeMode(kt.modes.SIMPLE_SELECT,{featureIds:[t.polygon.id]})};var gT={enable(t){setTimeout(()=>{!t.map||!t.map.dragPan||!t._ctx||!t._ctx.store||!t._ctx.store.getInitialConfigValue||t._ctx.store.getInitialConfigValue("dragPan")&&t.map.dragPan.enable()},0)},disable(t){setTimeout(()=>{!t.map||!t.map.doubleClickZoom||t.map.dragPan.disable()},0)}};const Nl=vo(lp);var Go={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.earthRadius=63710088e-1,t.factors={centimeters:t.earthRadius*100,centimetres:t.earthRadius*100,degrees:t.earthRadius/111325,feet:t.earthRadius*3.28084,inches:t.earthRadius*39.37,kilometers:t.earthRadius/1e3,kilometres:t.earthRadius/1e3,meters:t.earthRadius,metres:t.earthRadius,miles:t.earthRadius/1609.344,millimeters:t.earthRadius*1e3,millimetres:t.earthRadius*1e3,nauticalmiles:t.earthRadius/1852,radians:1,yards:t.earthRadius*1.0936},t.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/t.earthRadius,yards:1.0936133},t.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function e(m,b,S){S===void 0&&(S={});var F={type:"Feature"};return(S.id===0||S.id)&&(F.id=S.id),S.bbox&&(F.bbox=S.bbox),F.properties=b||{},F.geometry=m,F}t.feature=e;function r(m,b,S){switch(m){case"Point":return n(b).geometry;case"LineString":return u(b).geometry;case"Polygon":return o(b).geometry;case"MultiPoint":return v(b).geometry;case"MultiLineString":return d(b).geometry;case"MultiPolygon":return f(b).geometry;default:throw new Error(m+" is invalid")}}t.geometry=r;function n(m,b,S){if(S===void 0&&(S={}),!m)throw new Error("coordinates is required");if(!Array.isArray(m))throw new Error("coordinates must be an Array");if(m.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!$(m[0])||!$(m[1]))throw new Error("coordinates must contain numbers");var F={type:"Point",coordinates:m};return e(F,b,S)}t.point=n;function i(m,b,S){return S===void 0&&(S={}),p(m.map(function(F){return n(F,b)}),S)}t.points=i;function o(m,b,S){S===void 0&&(S={});for(var F=0,U=m;F<U.length;F++){var Q=U[F];if(Q.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var fe=0;fe<Q[Q.length-1].length;fe++)if(Q[Q.length-1][fe]!==Q[0][fe])throw new Error("First and last Position are not equivalent.")}var we={type:"Polygon",coordinates:m};return e(we,b,S)}t.polygon=o;function a(m,b,S){return S===void 0&&(S={}),p(m.map(function(F){return o(F,b)}),S)}t.polygons=a;function u(m,b,S){if(S===void 0&&(S={}),m.length<2)throw new Error("coordinates must be an array of two or more positions");var F={type:"LineString",coordinates:m};return e(F,b,S)}t.lineString=u;function s(m,b,S){return S===void 0&&(S={}),p(m.map(function(F){return u(F,b)}),S)}t.lineStrings=s;function p(m,b){b===void 0&&(b={});var S={type:"FeatureCollection"};return b.id&&(S.id=b.id),b.bbox&&(S.bbox=b.bbox),S.features=m,S}t.featureCollection=p;function d(m,b,S){S===void 0&&(S={});var F={type:"MultiLineString",coordinates:m};return e(F,b,S)}t.multiLineString=d;function v(m,b,S){S===void 0&&(S={});var F={type:"MultiPoint",coordinates:m};return e(F,b,S)}t.multiPoint=v;function f(m,b,S){S===void 0&&(S={});var F={type:"MultiPolygon",coordinates:m};return e(F,b,S)}t.multiPolygon=f;function c(m,b,S){S===void 0&&(S={});var F={type:"GeometryCollection",geometries:m};return e(F,b,S)}t.geometryCollection=c;function g(m,b){if(b===void 0&&(b=0),b&&!(b>=0))throw new Error("precision must be a positive number");var S=Math.pow(10,b||0);return Math.round(m*S)/S}t.round=g;function _(m,b){b===void 0&&(b="kilometers");var S=t.factors[b];if(!S)throw new Error(b+" units is invalid");return m*S}t.radiansToLength=_;function w(m,b){b===void 0&&(b="kilometers");var S=t.factors[b];if(!S)throw new Error(b+" units is invalid");return m/S}t.lengthToRadians=w;function M(m,b){return T(w(m,b))}t.lengthToDegrees=M;function O(m){var b=m%360;return b<0&&(b+=360),b}t.bearingToAzimuth=O;function T(m){var b=m%(2*Math.PI);return b*180/Math.PI}t.radiansToDegrees=T;function A(m){var b=m%360;return b*Math.PI/180}t.degreesToRadians=A;function C(m,b,S){if(b===void 0&&(b="kilometers"),S===void 0&&(S="kilometers"),!(m>=0))throw new Error("length must be a positive number");return _(w(m,b),S)}t.convertLength=C;function R(m,b,S){if(b===void 0&&(b="meters"),S===void 0&&(S="kilometers"),!(m>=0))throw new Error("area must be a positive number");var F=t.areaFactors[b];if(!F)throw new Error("invalid original units");var U=t.areaFactors[S];if(!U)throw new Error("invalid final units");return m/F*U}t.convertArea=R;function $(m){return!isNaN(m)&&m!==null&&!Array.isArray(m)}t.isNumber=$;function B(m){return!!m&&m.constructor===Object}t.isObject=B;function y(m){if(!m)throw new Error("bbox is required");if(!Array.isArray(m))throw new Error("bbox must be an Array");if(m.length!==4&&m.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");m.forEach(function(b){if(!$(b))throw new Error("bbox must only contain numbers")})}t.validateBBox=y;function I(m){if(!m)throw new Error("id is required");if(["string","number"].indexOf(typeof m)===-1)throw new Error("id must be a number or a string")}t.validateId=I})(Go);const vT=Xr,et=G,mT=bt,Bl=gT,bT=jo.default,TT=Nl.default,zu=Go,Se={...vT.modes.draw_polygon};Se.onSetup=function(t){const e=this.newFeature({type:et.geojsonTypes.FEATURE,properties:{isCircle:!0,center:[]},geometry:{type:et.geojsonTypes.POLYGON,coordinates:[[]]}});return this.addFeature(e),this.clearSelectedFeatures(),mT.disable(this),Bl.disable(this),this.updateUIClasses({mouse:et.cursors.ADD}),this.activateUIButton(et.types.POLYGON),this.setActionableState({trash:!0}),{polygon:e,currentVertexPosition:0}};Se.onMouseDown=Se.onTouchStart=function(t,e){t.polygon.properties.center.length===0&&(t.polygon.properties.center=[e.lngLat.lng,e.lngLat.lat])};Se.onDrag=Se.onMouseMove=function(t,e){const r=t.polygon.properties.center;if(r.length>0){const n=TT(zu.point(r),zu.point([e.lngLat.lng,e.lngLat.lat]),{units:"kilometers"}),i=bT(r,n);t.polygon.incomingCoords(i.geometry.coordinates),t.polygon.properties.radiusInKm=n}};Se.onMouseUp=Se.onTouchEnd=function(t,e){return Bl.enable(this),this.changeMode(et.modes.SIMPLE_SELECT,{featureIds:[t.polygon.id]})};Se.onClick=Se.onTap=function(t,e){t.polygon.properties.center=[]};Se.toDisplayFeatures=function(t,e,r){const n=e.properties.id===t.polygon.id;return e.properties.active=n?et.activeStates.ACTIVE:et.activeStates.INACTIVE,r(e)};var _T=Se;const ST=kr;function ET(t){const{properties:e,geometry:r}=t;if(!e.user_isCircle)return null;const n=[],i=r.coordinates[0].slice(0,-1);for(let o=0;o<i.length;o+=Math.round(i.length/4))n.push(ST(e.id,i[o],`0.${o}`,!1));return n}var Dl=ET;const wT=Xr,AT=qr,IT=Zr,Rr=G,CT=qo,$T=Nl.default,Hu=Go,OT=jo.default,PT=Dl,Qr=wT.modes.direct_select;Qr.dragFeature=function(t,e,r){IT(this.getSelected(),r),this.getSelected().filter(n=>n.properties.isCircle).map(n=>n.properties.center).forEach(n=>{n[0]+=r.lng,n[1]+=r.lat}),t.dragMoveLocation=e.lngLat};Qr.dragVertex=function(t,e,r){if(t.feature.properties.isCircle){const n=t.feature.properties.center,i=[e.lngLat.lng,e.lngLat.lat],o=$T(Hu.point(n),Hu.point(i),{units:"kilometers"}),a=OT(n,o);t.feature.incomingCoords(a.geometry.coordinates),t.feature.properties.radiusInKm=o}else{const n=t.selectedCoordPaths.map(a=>t.feature.getCoordinate(a)),i=n.map(a=>({type:Rr.geojsonTypes.FEATURE,properties:{},geometry:{type:Rr.geojsonTypes.POINT,coordinates:a}})),o=CT(i,r);for(let a=0;a<n.length;a++){const u=n[a];t.feature.updateCoordinate(t.selectedCoordPaths[a],u[0]+o.lng,u[1]+o.lat)}}};Qr.toDisplayFeatures=function(t,e,r){t.featureId===e.properties.id?(e.properties.active=Rr.activeStates.ACTIVE,r(e),(e.properties.user_isCircle?PT(e):AT(e,{map:this.map,midpoints:!0,selectedPaths:t.selectedCoordPaths})).forEach(r)):(e.properties.active=Rr.activeStates.INACTIVE,r(e)),this.fireActionable(t)};var FT=Qr;const MT=Xr,RT=qr,LT=Zr,gr=G,xT=Dl,Vo=MT.modes.simple_select;Vo.dragMove=function(t,e){t.dragMoving=!0,e.originalEvent.stopPropagation();const r={lng:e.lngLat.lng-t.dragMoveLocation.lng,lat:e.lngLat.lat-t.dragMoveLocation.lat};LT(this.getSelected(),r),this.getSelected().filter(n=>n.properties.isCircle).map(n=>n.properties.center).forEach(n=>{n[0]+=r.lng,n[1]+=r.lat}),t.dragMoveLocation=e.lngLat};Vo.toDisplayFeatures=function(t,e,r){if(e.properties.active=this.isSelected(e.properties.id)?gr.activeStates.ACTIVE:gr.activeStates.INACTIVE,r(e),this.fireActionable(),e.properties.active!==gr.activeStates.ACTIVE||e.geometry.type===gr.geojsonTypes.POINT)return;(e.properties.user_isCircle?xT(e):RT(e)).forEach(r)};var NT=Vo;const BT=_T,ke=FT,DT=NT,UT={onSetup:function(t){const e=this.newFeature({type:"Feature",properties:{isRectangle:!0},geometry:{type:"Polygon",coordinates:[[[0,0],[0,0],[0,0],[0,0],[0,0]]]}});return this.addFeature(e),this.clearSelectedFeatures(),this.updateUIClasses({mouse:"add"}),this.activateUIButton("polygon"),this.setActionableState({trash:!0}),this.map&&this.map.dragPan&&this.map.dragPan.disable(),{polygon:e,startPoint:null}},onStop:function(t){this.updateUIClasses({mouse:"none"}),this.activateUIButton(),this.setActionableState({trash:!0}),this.map&&this.map.dragPan&&this.map.dragPan.enable()},onMouseDown:function(t,e){e.originalEvent&&(e.originalEvent.preventDefault(),e.originalEvent.stopPropagation()),t.startPoint=[e.lngLat.lng,e.lngLat.lat],this.updateFeature(t,e)},onDrag:function(t,e){t.startPoint&&this.updateFeature(t,e)},onMouseUp:function(t,e){t.startPoint&&(this.updateFeature(t,e),this.map.fire("draw.create",{features:[t.polygon.toGeoJSON()]}),this.changeMode("simple_select",{featureIds:[t.polygon.id]}))},updateFeature:function(t,e){const r=t.startPoint,n=[e.lngLat.lng,e.lngLat.lat],i=Math.min(r[0],n[0]),o=Math.max(r[0],n[0]),a=Math.min(r[1],n[1]),u=Math.max(r[1],n[1]),s=[[i,u],[o,u],[o,a],[i,a],[i,u]];t.polygon.incomingCoords([s])},toDisplayFeatures:function(t,e,r){const n=e.properties.id===t.polygon.id;if(e.properties.active=n?"true":"false",!n)return r(e);e.geometry.coordinates.length!==0&&r(e)},onTrash:function(t){this.deleteFeature(t.polygon.id,{silent:!0}),this.changeMode("simple_select")}},kT={...ke,isRectangle:function(t){return t?!!(t.properties&&(t.properties.isRectangle===!0||t.properties.isRectangle==="true")||t.geometry&&t.geometry.type==="Polygon"&&t.geometry.coordinates.length>0&&t.geometry.coordinates[0].length===5):!1},onSetup:function(t){const e=ke.onSetup.call(this,t);return e.draggingHandle=null,e},onMouseDown:function(t,e){const r=t.featureId,n=this.getFeature(r);this.isRectangle(n),ke.onMouseDown.call(this,t,e)},onDrag:function(t,e){const{featureId:r}=t,n=this.getFeature(r);if(!this.isRectangle(n))return ke.onDrag.call(this,t,e);if(t.selectedCoordPaths&&t.selectedCoordPaths.length>0){const o=t.selectedCoordPaths[0].split("."),a=parseInt(o[0],10),u=parseInt(o[1],10);if(a===0&&u>=0&&u<=4){const s=n.coordinates[0],p=e.lngLat.lng,d=e.lngLat.lat,f=((u===4?0:u)+2)%4,c=s[f];if(!c)return;const g=Math.min(p,c[0]),_=Math.max(p,c[0]),w=Math.min(d,c[1]),M=Math.max(d,c[1]),O=[[g,M],[_,M],[_,w],[g,w],[g,M]];n.incomingCoords([O]),t.draggingHandle=!0;return}}ke.onDrag.call(this,t,e)},onMouseUp:function(t,e){t.draggingHandle&&(t.draggingHandle=null,this.map.dragPan.enable(),this.fireUpdate()),ke.onMouseUp.call(this,t,e)},fireUpdate:function(){this.map.fire("draw.update",{action:"move",features:this.getSelected().map(t=>t.toGeoJSON())})},toDisplayFeatures:function(t,e,r){const n=this.getFeature(t.featureId);if(this.isRectangle(n)){const i=o=>{o.properties.meta!=="midpoint"&&r(o)};ke.toDisplayFeatures.call(this,t,e,i);return}ke.toDisplayFeatures.call(this,t,e,r)}};function qT({currentMode:t,onModeChange:e,onDelete:r,canDelete:n}){const i=[{id:"simple_select",icon:Hf,title:"Select (Pointer)"},{id:"add_waypoint",icon:Kf,title:"Add Waypoint"},{id:"draw_rectangle",icon:Jf,title:"Draw Square"},{id:"draw_polygon",icon:Yf,title:"Draw Polygon"},{id:"drag_circle",icon:Zf,title:"Draw Circle"}];return te.jsxs("div",{className:"absolute top-4 left-4 flex flex-col gap-2 bg-white rounded-md shadow-md p-1 z-10",children:[i.map(o=>{const a=o.icon,u=t===o.id||o.id==="simple_select"&&t==="direct_select";return te.jsx("button",{onClick:()=>{console.log("Switching to mode:",o.id),e(o.id)},className:`p-2 rounded hover:bg-gray-100 flex items-center justify-center ${u?"text-blue-600 bg-blue-50":"text-gray-700"}`,title:o.title,children:te.jsx(a,{size:20})},o.id)}),te.jsx("div",{className:"h-px bg-gray-200 my-1"}),te.jsx("button",{onClick:r,disabled:!n,className:`p-2 rounded flex items-center justify-center ${n?"text-red-600 hover:bg-red-50 cursor-pointer":"text-gray-300 cursor-not-allowed"}`,title:"Delete Selected",children:te.jsx(Xf,{size:20})})]})}vr.accessToken="pk.eyJ1Ijoid2F5Z2VuIiwiYSI6ImNtaThyMXF2czBmZ3QybXBvbW1hazFpamcifQ.P0D5plS_fpnx3qheQytxfQ";const jT="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`
<svg width="40" height="40" viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg">
  <path d="M20 0 L35 20 A 15 15 0 0 1 5 20 Z" fill="#3b82f6" stroke="white" stroke-width="2"/>
</svg>
`),GT="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`
<svg width="40" height="40" viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg">
  <path d="M20 0 L35 20 A 15 15 0 0 1 5 20 Z" fill="#ef4444" stroke="white" stroke-width="2"/>
</svg>
`),VT=[{id:"gl-draw-line",type:"line",filter:["all",["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3b82f6","line-width":2}},{id:"gl-draw-polygon-fill",type:"fill",filter:["all",["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#3b82f6","fill-outline-color":"#3b82f6","fill-opacity":.2}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3b82f6","line-width":2}},{id:"gl-draw-point-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":6,"circle-color":"#fff"}},{id:"gl-draw-point",type:"circle",filter:["all",["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":4,"circle-color":"#3b82f6"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","$type","Polygon"],["==","mode","static"]],paint:{"fill-color":"#000","fill-outline-color":"#000","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","$type","Polygon"],["==","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#000","line-width":2}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","resize-handle"]],paint:{"circle-radius":4,"circle-color":"#fbb03b"}}];function ZT({onPolygonDrawn:t,polygon:e}){const r=ee.useRef(null),n=ee.useRef(null),i=ee.useRef(null),{waypoints:o,selectedIds:a,selectWaypoint:u,setSelectedIds:s,resetTrigger:p,settings:d,updateWaypoint:v,addWaypoint:f,setMapRef:c}=ge(),g=ee.useRef(null),[_,w]=ee.useState("simple_select"),[M,O]=ee.useState("satellite"),T=ee.useRef(_);ee.useEffect(()=>{T.current=_},[_]),ee.useEffect(()=>{p>0&&i.current&&(i.current.deleteAll(),t(null))},[p,t]);const[A,C]=ee.useState(null),[R,$]=ee.useState(!1),B=ee.useRef(null);ee.useEffect(()=>{if(!i.current||!n.current)return;const m=i.current.getSelectedIds();if(m.length===0)return;const b=i.current.get(m[0]);if(!b||b.geometry.type!=="Polygon")return;const S=cn(b),F=ln(S,fn(b.geometry.coordinates[0][0]),{units:"meters"});if(Math.abs(F-d.orbitRadius)>1){const U=la(S.geometry.coordinates,d.orbitRadius,{steps:64,units:"meters"});U.id=b.id,U.properties={...b.properties,isCircle:!0},i.current.add(U),t(U)}},[d.orbitRadius]);const y=m=>{if(!m||m.geometry.type!=="Polygon")return;const b=cn(m),S=ln(b,fn(m.geometry.coordinates[0][0]),{units:"meters"});Math.abs(S-d.orbitRadius)>1&&ge.getState().updateSettings({orbitRadius:Math.round(S)})};ee.useEffect(()=>{if(n.current)return;n.current=new vr.Map({container:r.current,style:"mapbox://styles/mapbox/satellite-streets-v12",center:[-98,39],zoom:4,boxZoom:!1});const m=new np({accessToken:vr.accessToken,mapboxgl:vr,marker:!1,collapsed:!0});n.current.addControl(m,"top-right"),c(n.current),i.current=new ca({userProperties:!0,displayControlsDefault:!1,controls:{point:!1,line:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1},styles:VT,modes:{...ca.modes,drag_circle:BT,draw_rectangle:UT,direct_select:kT,simple_select:DT}}),n.current.addControl(i.current),window.mapboxDraw=i.current,n.current.on("draw.create",x=>{const N=x.features[0];i.current.getMode()==="drag_circle"&&(i.current.setFeatureProperty(N.id,"isCircle",!0),N.properties.isCircle=!0,ge.getState().updateSettings({pathType:"orbit",spacing:10})),(N.properties.isRectangle||i.current.getMode()==="draw_rectangle")&&(i.current.setFeatureProperty(N.id,"isRectangle",!0),N.properties.isRectangle=!0);const j=cn(N);if(ln(j,fn(N.geometry.coordinates[0][0]),{units:"meters"})>500){const W=la(j.geometry.coordinates,50,{steps:64,units:"meters"});W.id=N.id,W.properties={...N.properties,isCircle:!0},i.current.add(W),ge.getState().updateSettings({orbitRadius:50}),t(W)}else y(N),t(N);w("simple_select")}),n.current.on("draw.update",x=>{const N=x.features[0];y(N),t(N)}),n.current.on("draw.selectionchange",x=>{x.features.length>0?(y(x.features[0]),t(x.features[0]),$(!0)):$(!1)}),n.current.on("draw.delete",()=>t(null)),n.current.on("click",x=>{if(x.originalEvent._isDrag)return;if(T.current==="add_waypoint"){const{lng:j,lat:L}=x.lngLat;f({lng:j,lat:L});return}const N=n.current.queryRenderedFeatures(x.point,{layers:["waypoints-symbol"]});if(N.length){const j=N[0].properties.id;u(j,x.originalEvent.shiftKey)}else n.current.queryRenderedFeatures(x.point,{layers:["gl-draw-polygon-fill-static.cold","gl-draw-polygon-fill.hot"]}).length===0&&s([])});const b=x=>{if(!B.current)return;const N=B.current,j=x.point,L=Math.min(N.x,j.x),W=Math.max(N.x,j.x),k=Math.min(N.y,j.y),z=Math.max(N.y,j.y);C({left:L,top:k,width:W-L,height:z-k})},S=x=>{if(!B.current)return;const N=B.current,j=x.point;if(Math.abs(N.x-j.x)<5&&Math.abs(N.y-j.y)<5){B.current=null,C(null),n.current.dragPan.enable(),n.current.off("mousemove",b),n.current.off("mouseup",S);return}const L=[N,j],k=n.current.queryRenderedFeatures(L,{layers:["waypoints-symbol"]}).map(z=>z.properties.id);k.length>0&&s(k),B.current=null,C(null),n.current.dragPan.enable(),x.originalEvent._isDrag=!0,setTimeout(()=>{x.originalEvent&&delete x.originalEvent._isDrag},100),n.current.off("mousemove",b),n.current.off("mouseup",S)};n.current.on("mousedown",x=>{x.originalEvent.shiftKey&&(x.preventDefault(),n.current.dragPan.disable(),B.current=x.point,n.current.on("mousemove",b),n.current.on("mouseup",S))});const F=()=>{g.current||(n.current.getCanvas().style.cursor="pointer")},U=()=>{g.current||(n.current.getCanvas().style.cursor="")},Q=x=>{if(i.current.getMode()!=="simple_select"&&i.current.getMode()!=="direct_select"||x.originalEvent.shiftKey||!x.originalEvent.altKey)return;x.preventDefault();const N=x.features[0];if(!N)return;n.current.dragPan.disable(),n.current.getCanvas().style.cursor="grabbing";const j=N.properties.id,L=ge.getState().waypoints,W=ge.getState().selectedIds,k=W.includes(j),z=k?W:[j],de=L.filter(ue=>z.includes(ue.id)).map(ue=>({id:ue.id,lng:ue.lng,lat:ue.lat}));g.current={ids:z,isMulti:k,initialWaypoints:de,startLngLat:x.lngLat},n.current.on("mousemove",fe),n.current.on("mouseup",we)},fe=x=>{if(!g.current)return;const{lng:N,lat:j}=x.lngLat,{startLngLat:L,initialWaypoints:W}=g.current,k=N-L.lng,z=j-L.lat,de=n.current.getSource("waypoints"),ue=n.current.getSource("mission-path"),be=ge.getState().waypoints,$t=ge.getState().selectedIds,Ot=be.map((Te,Pt)=>{const Ft=W.find(en=>en.id===Te.id);let Jt=[Te.lng,Te.lat];return Ft&&(Jt=[Ft.lng+k,Ft.lat+z]),{type:"Feature",properties:{id:Te.id,index:Pt+1,selected:$t.includes(Te.id),heading:Te.heading||0},geometry:{type:"Point",coordinates:Jt}}});if(de&&de.setData({type:"FeatureCollection",features:Ot}),ue){const Te=Ot.map(Pt=>Pt.geometry.coordinates);ue.setData({type:"Feature",geometry:{type:"LineString",coordinates:Te}})}},we=x=>{if(!g.current)return;const{lng:N,lat:j}=x.lngLat,{startLngLat:L,ids:W}=g.current,k=N-L.lng,z=j-L.lat;ge.getState().moveWaypoints(W,k,z),g.current=null,n.current.dragPan.enable(),n.current.getCanvas().style.cursor="",x.originalEvent._isDrag=!0,n.current.off("mousemove",fe),n.current.off("mouseup",we)};n.current.on("mouseenter","waypoints-symbol",F),n.current.on("mouseleave","waypoints-symbol",U),n.current.on("mousedown","waypoints-symbol",Q);const He=()=>{console.log("Initializing Map Layers...");const x=(L,W)=>{if(n.current.hasImage(L))return;const k=new Image;k.src=W,k.onload=()=>{n.current.hasImage(L)||n.current.addImage(L,k)}};x("teardrop",jT),x("teardrop-selected",GT),n.current.getSource("mission-path")||n.current.addSource("mission-path",{type:"geojson",data:{type:"Feature",geometry:{type:"LineString",coordinates:[]}}}),n.current.getSource("footprints")||n.current.addSource("footprints",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),n.current.getSource("waypoints")||n.current.addSource("waypoints",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),n.current.getLayer("footprints-fill")||n.current.addLayer({id:"footprints-fill",type:"fill",source:"footprints",paint:{"fill-color":["get","color"],"fill-opacity":.15,"fill-outline-color":"rgba(0,0,0,0)"}}),n.current.getLayer("footprints-outline")||n.current.addLayer({id:"footprints-outline",type:"line",source:"footprints",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":["get","color"],"line-width":1,"line-opacity":.6}}),n.current.getLayer("mission-path-line")||n.current.addLayer({id:"mission-path-line",type:"line",source:"mission-path",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#3b82f6","line-width":3,"line-opacity":.8}}),n.current.getLayer("waypoints-symbol")||n.current.addLayer({id:"waypoints-symbol",type:"symbol",source:"waypoints",layout:{"icon-image":["case",["get","selected"],"teardrop-selected","teardrop"],"icon-size":["interpolate",["linear"],["zoom"],10,.5,15,.75,20,1],"icon-anchor":"center","icon-allow-overlap":!0,"icon-rotate":["get","heading"],"icon-rotation-alignment":"map","text-field":["to-string",["get","index"]],"text-font":["Open Sans Bold","Arial Unicode MS Bold"],"text-size":["interpolate",["linear"],["zoom"],10,9,15,11,20,13],"text-offset":[0,0],"text-anchor":"center","text-allow-overlap":!0,"text-rotation-alignment":"viewport"},paint:{"text-color":"#ffffff","text-halo-color":"#000000","text-halo-width":.5}});const N=ge.getState().waypoints,j=ge.getState().selectedIds;if(N.length>0){console.log("Initial waypoints found, updating source...",N.length);const L=N.map((k,z)=>({type:"Feature",properties:{id:k.id,index:z+1,selected:j.includes(k.id),heading:k.heading||0},geometry:{type:"Point",coordinates:[k.lng,k.lat]}}));n.current.getSource("waypoints").setData({type:"FeatureCollection",features:L});const W=N.map(k=>[k.lng,k.lat]);n.current.getSource("mission-path").setData({type:"Feature",geometry:{type:"LineString",coordinates:W}})}};n.current.loaded()?He():n.current.on("load",He),n.current.on("style.load",He);const Ct=x=>{T.current==="add_waypoint"&&x.mode==="simple_select"||w(x.mode)};n.current.on("draw.modechange",Ct);const ne=x=>{x.key==="Escape"&&(T.current!=="simple_select"?(i.current&&i.current.changeMode("simple_select"),w("simple_select")):s([]))};return window.addEventListener("keydown",ne),()=>{window.removeEventListener("keydown",ne)}},[]),ee.useEffect(()=>{if(!i.current||!n.current)return;const m=_,b=i.current.getMode();if(m==="add_waypoint")b!=="simple_select"&&i.current.changeMode("simple_select"),n.current.getCanvas().style.cursor="crosshair";else{if(b!==m)try{i.current.changeMode(m)}catch(S){console.warn("Failed to switch mode:",S)}n.current.getCanvas().style.cursor=""}},[_]),ee.useEffect(()=>{!n.current||!n.current.getLayer("waypoints-symbol")||(n.current.setLayoutProperty("waypoints-symbol","text-offset",[0,0]),n.current.setLayoutProperty("waypoints-symbol","text-anchor","center"),n.current.setLayoutProperty("waypoints-symbol","icon-anchor","center"),n.current.setLayoutProperty("waypoints-symbol","text-rotation-alignment","viewport"))},[]),ee.useEffect(()=>{if(!n.current||!n.current)return;const m=n.current.getSource("waypoints"),b=n.current.getSource("mission-path");if(m){const S=o.map((F,U)=>({type:"Feature",properties:{id:F.id,index:U+1,selected:a.includes(F.id),heading:F.heading||0},geometry:{type:"Point",coordinates:[F.lng,F.lat]}}));m.setData({type:"FeatureCollection",features:S})}if(b){const S=o.map(F=>[F.lng,F.lat]);b.setData({type:"Feature",geometry:{type:"LineString",coordinates:S}})}},[o,a]),ee.useEffect(()=>{if(!n.current||!n.current.getSource("footprints"))return;if(!d.showFootprints){n.current.getSource("footprints").setData({type:"FeatureCollection",features:[]});return}const m=o.map((b,S)=>{const F=b.heading||0;return{...zf({lng:b.lng,lat:b.lat},d.altitude,F,d.customFOV),properties:{index:S+1,color:d.footprintColor}}}).filter(b=>b!==null);n.current.getSource("footprints").setData({type:"FeatureCollection",features:m})},[o,d.showFootprints,d.altitude,d.customFOV,d.footprintColor]),ee.useEffect(()=>{d.orbitRadius>500&&ge.getState().updateSettings({orbitRadius:50})},[]);const I=()=>{i.current&&(i.current.trash(),t(null),$(!1))};return ee.useEffect(()=>{if(!i.current||!n.current)return;if(!e){i.current.getAll().features.length>0&&i.current.deleteAll();return}if(!i.current.getAll().features.some(S=>S.id===e.id)){console.log("Syncing polygon from prop:",e),i.current.deleteAll(),i.current.add(e);try{const S=fp(e);n.current.fitBounds(S,{padding:100})}catch(S){console.warn("Could not fit bounds:",S)}}},[e]),te.jsxs("div",{className:`relative w-full h-full ${_==="add_waypoint"?"force-crosshair":""}`,children:[te.jsx("style",{children:`
        .force-crosshair .mapboxgl-canvas-container {
          cursor: crosshair !important;
        }
        .force-crosshair .mapboxgl-canvas {
          cursor: crosshair !important;
        }
      `}),te.jsx("div",{ref:r,className:"w-full h-full"}),A&&te.jsx("div",{style:{position:"absolute",left:A.left,top:A.top,width:A.width,height:A.height,border:"2px solid #3b82f6",backgroundColor:"rgba(59, 130, 246, 0.2)",pointerEvents:"none",zIndex:20}}),te.jsx(qT,{currentMode:_,onModeChange:w,onDelete:I,canDelete:R}),te.jsxs("div",{className:"absolute bottom-8 left-4 flex flex-col gap-2 z-10",children:[te.jsxs("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 overflow-hidden flex flex-col",children:[te.jsx("button",{onClick:()=>{M!=="satellite"&&(O("satellite"),n.current.setStyle("mapbox://styles/mapbox/satellite-streets-v12"))},className:`p-2 hover:bg-gray-50 transition-colors ${M==="satellite"?"bg-blue-50 text-blue-600":"text-gray-700"}`,title:"Satellite View",children:te.jsx(Qf,{size:20})}),te.jsx("div",{className:"h-px bg-gray-200"}),te.jsx("button",{onClick:()=>{M!=="streets"&&(O("streets"),n.current.setStyle("mapbox://styles/mapbox/streets-v12"))},className:`p-2 hover:bg-gray-50 transition-colors ${M==="streets"?"bg-blue-50 text-blue-600":"text-gray-700"}`,title:"Street Map",children:te.jsx(ep,{size:20})})]}),te.jsx("button",{onClick:()=>{"geolocation"in navigator?navigator.geolocation.getCurrentPosition(m=>{n.current.flyTo({center:[m.coords.longitude,m.coords.latitude],zoom:16})},m=>{console.error("Error getting location:",m),alert("Could not get your location. Please check permissions.")}):alert("Geolocation is not supported by your browser.")},className:"bg-white p-2 rounded-lg shadow-md border border-gray-200 text-gray-700 hover:bg-gray-50 hover:text-blue-600 transition-colors",title:"My Location",children:te.jsx(tp,{size:20})})]})]})}export{ZT as default};
